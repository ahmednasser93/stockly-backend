<?xml version="1.0" encoding="UTF-8" ?>
<testsuites name="vitest tests" tests="876" failures="0" errors="0" time="77.405">
    <testsuite name="test/alerts-evaluate.spec.ts" timestamp="2026-01-01T10:46:50.783Z" hostname="sngvahmed" tests="6" failures="0" errors="0" skipped="0" time="0.597">
        <testcase classname="test/alerts-evaluate.spec.ts" name="evaluateAlerts &gt; notifies only when direction condition transitions from false to true" time="0.037">
        </testcase>
        <testcase classname="test/alerts-evaluate.spec.ts" name="evaluateAlerts &gt; resets state when price falls back below threshold" time="0.094">
        </testcase>
        <testcase classname="test/alerts-evaluate.spec.ts" name="evaluateAlerts &gt; skips alerts that lack a price" time="0.036">
        </testcase>
        <testcase classname="test/alerts-evaluate.spec.ts" name="evaluateAlerts &gt; notifies on significant price change after initial trigger (2% change)" time="0.098">
        </testcase>
        <testcase classname="test/alerts-evaluate.spec.ts" name="evaluateAlerts &gt; suppresses notifications during cooldown period" time="0.099">
        </testcase>
        <testcase classname="test/alerts-evaluate.spec.ts" name="evaluateAlerts &gt; handles &apos;below&apos; direction correctly" time="0.039">
        </testcase>
    </testsuite>
    <testsuite name="test/alerts-handler.spec.ts" timestamp="2026-01-01T10:46:50.792Z" hostname="sngvahmed" tests="5" failures="0" errors="0" skipped="0" time="0.13">
        <testcase classname="test/alerts-handler.spec.ts" name="alerts handler &gt; lists alerts" time="0.03">
        </testcase>
        <testcase classname="test/alerts-handler.spec.ts" name="alerts handler &gt; creates an alert when payload is valid" time="0.026">
        </testcase>
        <testcase classname="test/alerts-handler.spec.ts" name="alerts handler &gt; returns 404 when an alert is missing" time="0.018">
        </testcase>
        <testcase classname="test/alerts-handler.spec.ts" name="alerts handler &gt; updates alerts via PUT" time="0.014">
        </testcase>
        <testcase classname="test/alerts-handler.spec.ts" name="alerts handler &gt; deletes alerts" time="0.018">
        </testcase>
    </testsuite>
    <testsuite name="test/alerts-storage.spec.ts" timestamp="2026-01-01T10:46:50.797Z" hostname="sngvahmed" tests="19" failures="0" errors="0" skipped="0" time="1.634">
        <testcase classname="test/alerts-storage.spec.ts" name="alerts storage queries &gt; lists alerts" time="0.036">
        </testcase>
        <testcase classname="test/alerts-storage.spec.ts" name="alerts storage queries &gt; creates and returns an alert" time="0.123">
            <system-out>
Creating alert with username: testuser, symbol: AAPL

Alert created successfully: id=generated-id, username=testuser, symbol=AAPL

            </system-out>
        </testcase>
        <testcase classname="test/alerts-storage.spec.ts" name="alerts storage queries &gt; throws validation error for invalid data" time="0.232">
            <system-out>
Creating alert with username: u, symbol: BAD

            </system-out>
        </testcase>
        <testcase classname="test/alerts-storage.spec.ts" name="alerts storage queries &gt; throws missing data error" time="0.114">
            <system-out>
Creating alert with username: u, symbol: 

            </system-out>
        </testcase>
        <testcase classname="test/alerts-storage.spec.ts" name="alerts storage queries &gt; throws if alert creation cannot be verified" time="0.127">
            <system-out>
Creating alert with username: u, symbol: A

            </system-out>
        </testcase>
        <testcase classname="test/alerts-storage.spec.ts" name="alerts storage queries &gt; throws if created alert has mismatched username" time="0.083">
            <system-out>
Creating alert with username: me, symbol: A

            </system-out>
        </testcase>
        <testcase classname="test/alerts-storage.spec.ts" name="alerts storage queries &gt; updates alerts with provided fields" time="0.045">
        </testcase>
        <testcase classname="test/alerts-storage.spec.ts" name="alerts storage queries &gt; deletes alerts" time="0.1">
        </testcase>
        <testcase classname="test/alerts-storage.spec.ts" name="alerts storage queries &gt; lists active alerts" time="0.085">
        </testcase>
        <testcase classname="test/alerts-storage.spec.ts" name="alerts storage queries &gt; lists all alerts for admin (null username)" time="0.049">
        </testcase>
        <testcase classname="test/alerts-storage.spec.ts" name="alerts storage queries &gt; throws specific error on unique constraint violation" time="0.081">
            <system-out>
Creating alert with username: testuser, symbol: AAPL

            </system-out>
        </testcase>
        <testcase classname="test/alerts-storage.spec.ts" name="alerts storage queries &gt; lists active alerts for specific user" time="0.03">
        </testcase>
        <testcase classname="test/alerts-storage.spec.ts" name="alerts storage queries &gt; admin updates alert (null username)" time="0.086">
        </testcase>
        <testcase classname="test/alerts-storage.spec.ts" name="alerts storage queries &gt; admin deletes alert (null username)" time="0.034">
        </testcase>
        <testcase classname="test/alerts-storage.spec.ts" name="alerts storage queries &gt; updates all alert fields" time="0.082">
        </testcase>
        <testcase classname="test/alerts-storage.spec.ts" name="alerts state KV &gt; reads and writes state snapshots" time="0.032">
            <system-out>
[KV Cache] Queued state update for alert 1 (1 pending writes)

            </system-out>
        </testcase>
        <testcase classname="test/alerts-storage.spec.ts" name="alerts state KV &gt; reads state from KV when cache misses" time="0.038">
        </testcase>
        <testcase classname="test/alerts-storage.spec.ts" name="alerts state KV &gt; deletes state" time="0.055">
            <system-out>
[KV Cache] Queued state update for alert 1 (1 pending writes)

            </system-out>
        </testcase>
        <testcase classname="test/alerts-storage.spec.ts" name="alerts state KV &gt; handles JSON parse errors in state gracefully" time="0.031">
        </testcase>
    </testsuite>
    <testsuite name="test/alerts-validation.spec.ts" timestamp="2026-01-01T10:46:50.806Z" hostname="sngvahmed" tests="10" failures="0" errors="0" skipped="0" time="1.096">
        <testcase classname="test/alerts-validation.spec.ts" name="alert validation &gt; validates creation payloads" time="0.027">
        </testcase>
        <testcase classname="test/alerts-validation.spec.ts" name="alert validation &gt; validation handles minimal valid payload" time="0.106">
        </testcase>
        <testcase classname="test/alerts-validation.spec.ts" name="alert validation &gt; rejects invalid creation payloads" time="0.102">
        </testcase>
        <testcase classname="test/alerts-validation.spec.ts" name="alert validation &gt; rejects invalid enum values for creation" time="0.099">
        </testcase>
        <testcase classname="test/alerts-validation.spec.ts" name="alert validation &gt; validates updates" time="0.042">
        </testcase>
        <testcase classname="test/alerts-validation.spec.ts" name="alert validation &gt; validates full update success" time="0.131">
        </testcase>
        <testcase classname="test/alerts-validation.spec.ts" name="alert validation &gt; validates partial updates" time="0.129">
        </testcase>
        <testcase classname="test/alerts-validation.spec.ts" name="alert validation &gt; validates clearing notes" time="0.09">
        </testcase>
        <testcase classname="test/alerts-validation.spec.ts" name="alert validation &gt; rejects invalid update values" time="0.105">
        </testcase>
        <testcase classname="test/alerts-validation.spec.ts" name="alert validation &gt; requires at least one field on update" time="0.111">
        </testcase>
    </testsuite>
    <testsuite name="test/api-comprehensive.spec.ts" timestamp="2026-01-01T10:46:50.808Z" hostname="sngvahmed" tests="38" failures="0" errors="0" skipped="0" time="0.748">
        <testcase classname="test/api-comprehensive.spec.ts" name="API - Health Check &gt; GET /v1/api/health returns OK status" time="0.006">
        </testcase>
        <testcase classname="test/api-comprehensive.spec.ts" name="API - Get Single Stock &gt; GET /v1/api/get-stock returns stock data with all required fields" time="0.024">
            <system-out>
{&quot;timestamp&quot;:&quot;2026-01-01T10:46:48.500Z&quot;,&quot;service&quot;:&quot;stockly-api-test&quot;,&quot;level&quot;:&quot;DEBUG&quot;,&quot;traceId&quot;:&quot;test-trace-id&quot;,&quot;userId&quot;:null,&quot;path&quot;:&quot;/test&quot;,&quot;message&quot;:&quot;D1 first: SELECT symbol, price, day_low, day_high, volume, timestamp\n       FROM stock_prices\n       WHERE symbol = ?\n       ORDER BY timestamp DESC\n       LIMIT 1&quot;,&quot;type&quot;:&quot;data_operation&quot;,&quot;operation&quot;:&quot;d1&quot;,&quot;query&quot;:&quot;SELECT symbol, price, day_low, day_high, volume, timestamp\n       FROM stock_prices\n       WHERE symbol = ?\n       ORDER BY timestamp DESC\n       LIMIT 1&quot;,&quot;latencyMs&quot;:0,&quot;cacheStatus&quot;:&quot;N/A&quot;}

{&quot;timestamp&quot;:&quot;2026-01-01T10:46:48.502Z&quot;,&quot;service&quot;:&quot;stockly-api-test&quot;,&quot;level&quot;:&quot;DEBUG&quot;,&quot;traceId&quot;:&quot;test-trace-id&quot;,&quot;userId&quot;:null,&quot;path&quot;:&quot;/test&quot;,&quot;message&quot;:&quot;D1 first: SELECT * FROM api_endpoints WHERE id = ?&quot;,&quot;type&quot;:&quot;data_operation&quot;,&quot;operation&quot;:&quot;d1&quot;,&quot;query&quot;:&quot;SELECT * FROM api_endpoints WHERE id = ?&quot;,&quot;latencyMs&quot;:0,&quot;cacheStatus&quot;:&quot;N/A&quot;}

{&quot;timestamp&quot;:&quot;2026-01-01T10:46:48.504Z&quot;,&quot;service&quot;:&quot;stockly-api-test&quot;,&quot;level&quot;:&quot;DEBUG&quot;,&quot;traceId&quot;:&quot;test-trace-id&quot;,&quot;userId&quot;:null,&quot;path&quot;:&quot;/test&quot;,&quot;message&quot;:&quot;D1 first: SELECT * FROM api_endpoints WHERE id = ?&quot;,&quot;type&quot;:&quot;data_operation&quot;,&quot;operation&quot;:&quot;d1&quot;,&quot;query&quot;:&quot;SELECT * FROM api_endpoints WHERE id = ?&quot;,&quot;latencyMs&quot;:0,&quot;cacheStatus&quot;:&quot;N/A&quot;}

{&quot;timestamp&quot;:&quot;2026-01-01T10:46:48.507Z&quot;,&quot;service&quot;:&quot;stockly-api-test&quot;,&quot;level&quot;:&quot;DEBUG&quot;,&quot;traceId&quot;:&quot;test-trace-id&quot;,&quot;userId&quot;:null,&quot;path&quot;:&quot;/test&quot;,&quot;message&quot;:&quot;D1 run: INSERT INTO stock_prices (symbol, price, day_low, day_high, volume, timestamp)\n       VALUES (?, ?, ?, ?, ?, ?)&quot;,&quot;type&quot;:&quot;data_operation&quot;,&quot;operation&quot;:&quot;d1&quot;,&quot;query&quot;:&quot;INSERT INTO stock_prices (symbol, price, day_low, day_high, volume, timestamp)\n       VALUES (?, ?, ?, ?, ?, ?)&quot;,&quot;latencyMs&quot;:0,&quot;cacheStatus&quot;:&quot;N/A&quot;}

            </system-out>
            <system-err>
{&quot;timestamp&quot;:&quot;2026-01-01T10:46:48.502Z&quot;,&quot;service&quot;:&quot;stockly-api-test&quot;,&quot;level&quot;:&quot;WARN&quot;,&quot;traceId&quot;:&quot;test-trace-id&quot;,&quot;userId&quot;:null,&quot;path&quot;:&quot;/test&quot;,&quot;message&quot;:&quot;Datalake adapter not available for endpoint quote, will fallback to direct FMP&quot;,&quot;type&quot;:&quot;general&quot;}

{&quot;timestamp&quot;:&quot;2026-01-01T10:46:48.504Z&quot;,&quot;service&quot;:&quot;stockly-api-test&quot;,&quot;level&quot;:&quot;WARN&quot;,&quot;traceId&quot;:&quot;test-trace-id&quot;,&quot;userId&quot;:null,&quot;path&quot;:&quot;/test&quot;,&quot;message&quot;:&quot;Datalake adapter not available for endpoint profile, will fallback to direct FMP&quot;,&quot;type&quot;:&quot;general&quot;}

            </system-err>
        </testcase>
        <testcase classname="test/api-comprehensive.spec.ts" name="API - Get Single Stock &gt; GET /v1/api/get-stock returns 400 when symbol is missing" time="0.007">
        </testcase>
        <testcase classname="test/api-comprehensive.spec.ts" name="API - Get Multiple Stocks &gt; GET /v1/api/get-stocks returns array of stocks with all fields" time="0.017">
            <system-out>
{&quot;timestamp&quot;:&quot;2026-01-01T10:46:48.522Z&quot;,&quot;service&quot;:&quot;stockly-api-test&quot;,&quot;level&quot;:&quot;DEBUG&quot;,&quot;traceId&quot;:&quot;test-trace-id&quot;,&quot;userId&quot;:null,&quot;path&quot;:&quot;/test&quot;,&quot;message&quot;:&quot;D1 first: SELECT symbol, price, day_low, day_high, volume, timestamp\n       FROM stock_prices\n       WHERE symbol = ?\n       ORDER BY timestamp DESC\n       LIMIT 1&quot;,&quot;type&quot;:&quot;data_operation&quot;,&quot;operation&quot;:&quot;d1&quot;,&quot;query&quot;:&quot;SELECT symbol, price, day_low, day_high, volume, timestamp\n       FROM stock_prices\n       WHERE symbol = ?\n       ORDER BY timestamp DESC\n       LIMIT 1&quot;,&quot;latencyMs&quot;:0,&quot;cacheStatus&quot;:&quot;N/A&quot;}

{&quot;timestamp&quot;:&quot;2026-01-01T10:46:48.522Z&quot;,&quot;service&quot;:&quot;stockly-api-test&quot;,&quot;level&quot;:&quot;DEBUG&quot;,&quot;traceId&quot;:&quot;test-trace-id&quot;,&quot;userId&quot;:null,&quot;path&quot;:&quot;/test&quot;,&quot;message&quot;:&quot;D1 first: SELECT symbol, price, day_low, day_high, volume, timestamp\n       FROM stock_prices\n       WHERE symbol = ?\n       ORDER BY timestamp DESC\n       LIMIT 1&quot;,&quot;type&quot;:&quot;data_operation&quot;,&quot;operation&quot;:&quot;d1&quot;,&quot;query&quot;:&quot;SELECT symbol, price, day_low, day_high, volume, timestamp\n       FROM stock_prices\n       WHERE symbol = ?\n       ORDER BY timestamp DESC\n       LIMIT 1&quot;,&quot;latencyMs&quot;:0,&quot;cacheStatus&quot;:&quot;N/A&quot;}

{&quot;timestamp&quot;:&quot;2026-01-01T10:46:48.523Z&quot;,&quot;service&quot;:&quot;stockly-api-test&quot;,&quot;level&quot;:&quot;DEBUG&quot;,&quot;traceId&quot;:&quot;test-trace-id&quot;,&quot;userId&quot;:null,&quot;path&quot;:&quot;/test&quot;,&quot;message&quot;:&quot;D1 first: SELECT * FROM api_endpoints WHERE id = ?&quot;,&quot;type&quot;:&quot;data_operation&quot;,&quot;operation&quot;:&quot;d1&quot;,&quot;query&quot;:&quot;SELECT * FROM api_endpoints WHERE id = ?&quot;,&quot;latencyMs&quot;:0,&quot;cacheStatus&quot;:&quot;N/A&quot;}
{&quot;timestamp&quot;:&quot;2026-01-01T10:46:48.523Z&quot;,&quot;service&quot;:&quot;stockly-api-test&quot;,&quot;level&quot;:&quot;DEBUG&quot;,&quot;traceId&quot;:&quot;test-trace-id&quot;,&quot;userId&quot;:null,&quot;path&quot;:&quot;/test&quot;,&quot;message&quot;:&quot;D1 first: SELECT * FROM api_endpoints WHERE id = ?&quot;,&quot;type&quot;:&quot;data_operation&quot;,&quot;operation&quot;:&quot;d1&quot;,&quot;query&quot;:&quot;SELECT * FROM api_endpoints WHERE id = ?&quot;,&quot;latencyMs&quot;:0,&quot;cacheStatus&quot;:&quot;N/A&quot;}

{&quot;timestamp&quot;:&quot;2026-01-01T10:46:48.530Z&quot;,&quot;service&quot;:&quot;stockly-api-test&quot;,&quot;level&quot;:&quot;DEBUG&quot;,&quot;traceId&quot;:&quot;test-trace-id&quot;,&quot;userId&quot;:null,&quot;path&quot;:&quot;/test&quot;,&quot;message&quot;:&quot;D1 first: SELECT * FROM api_endpoints WHERE id = ?&quot;,&quot;type&quot;:&quot;data_operation&quot;,&quot;operation&quot;:&quot;d1&quot;,&quot;query&quot;:&quot;SELECT * FROM api_endpoints WHERE id = ?&quot;,&quot;latencyMs&quot;:0,&quot;cacheStatus&quot;:&quot;N/A&quot;}

{&quot;timestamp&quot;:&quot;2026-01-01T10:46:48.531Z&quot;,&quot;service&quot;:&quot;stockly-api-test&quot;,&quot;level&quot;:&quot;DEBUG&quot;,&quot;traceId&quot;:&quot;test-trace-id&quot;,&quot;userId&quot;:null,&quot;path&quot;:&quot;/test&quot;,&quot;message&quot;:&quot;D1 first: SELECT * FROM api_endpoints WHERE id = ?&quot;,&quot;type&quot;:&quot;data_operation&quot;,&quot;operation&quot;:&quot;d1&quot;,&quot;query&quot;:&quot;SELECT * FROM api_endpoints WHERE id = ?&quot;,&quot;latencyMs&quot;:0,&quot;cacheStatus&quot;:&quot;N/A&quot;}

{&quot;timestamp&quot;:&quot;2026-01-01T10:46:48.533Z&quot;,&quot;service&quot;:&quot;stockly-api-test&quot;,&quot;level&quot;:&quot;DEBUG&quot;,&quot;traceId&quot;:&quot;test-trace-id&quot;,&quot;userId&quot;:null,&quot;path&quot;:&quot;/test&quot;,&quot;message&quot;:&quot;D1 run: INSERT INTO stock_prices (symbol, price, day_low, day_high, volume, timestamp)\n       VALUES (?, ?, ?, ?, ?, ?)&quot;,&quot;type&quot;:&quot;data_operation&quot;,&quot;operation&quot;:&quot;d1&quot;,&quot;query&quot;:&quot;INSERT INTO stock_prices (symbol, price, day_low, day_high, volume, timestamp)\n       VALUES (?, ?, ?, ?, ?, ?)&quot;,&quot;latencyMs&quot;:0,&quot;cacheStatus&quot;:&quot;N/A&quot;}
{&quot;timestamp&quot;:&quot;2026-01-01T10:46:48.533Z&quot;,&quot;service&quot;:&quot;stockly-api-test&quot;,&quot;level&quot;:&quot;DEBUG&quot;,&quot;traceId&quot;:&quot;test-trace-id&quot;,&quot;userId&quot;:null,&quot;path&quot;:&quot;/test&quot;,&quot;message&quot;:&quot;D1 run: INSERT INTO stock_prices (symbol, price, day_low, day_high, volume, timestamp)\n       VALUES (?, ?, ?, ?, ?, ?)&quot;,&quot;type&quot;:&quot;data_operation&quot;,&quot;operation&quot;:&quot;d1&quot;,&quot;query&quot;:&quot;INSERT INTO stock_prices (symbol, price, day_low, day_high, volume, timestamp)\n       VALUES (?, ?, ?, ?, ?, ?)&quot;,&quot;latencyMs&quot;:0,&quot;cacheStatus&quot;:&quot;N/A&quot;}

            </system-out>
            <system-err>
{&quot;timestamp&quot;:&quot;2026-01-01T10:46:48.523Z&quot;,&quot;service&quot;:&quot;stockly-api-test&quot;,&quot;level&quot;:&quot;WARN&quot;,&quot;traceId&quot;:&quot;test-trace-id&quot;,&quot;userId&quot;:null,&quot;path&quot;:&quot;/test&quot;,&quot;message&quot;:&quot;Datalake adapter not available for endpoint quote, will fallback to direct FMP&quot;,&quot;type&quot;:&quot;general&quot;}
{&quot;timestamp&quot;:&quot;2026-01-01T10:46:48.523Z&quot;,&quot;service&quot;:&quot;stockly-api-test&quot;,&quot;level&quot;:&quot;WARN&quot;,&quot;traceId&quot;:&quot;test-trace-id&quot;,&quot;userId&quot;:null,&quot;path&quot;:&quot;/test&quot;,&quot;message&quot;:&quot;Datalake adapter not available for endpoint quote, will fallback to direct FMP&quot;,&quot;type&quot;:&quot;general&quot;}

{&quot;timestamp&quot;:&quot;2026-01-01T10:46:48.530Z&quot;,&quot;service&quot;:&quot;stockly-api-test&quot;,&quot;level&quot;:&quot;WARN&quot;,&quot;traceId&quot;:&quot;test-trace-id&quot;,&quot;userId&quot;:null,&quot;path&quot;:&quot;/test&quot;,&quot;message&quot;:&quot;Datalake adapter not available for endpoint profile, will fallback to direct FMP&quot;,&quot;type&quot;:&quot;general&quot;}

{&quot;timestamp&quot;:&quot;2026-01-01T10:46:48.531Z&quot;,&quot;service&quot;:&quot;stockly-api-test&quot;,&quot;level&quot;:&quot;WARN&quot;,&quot;traceId&quot;:&quot;test-trace-id&quot;,&quot;userId&quot;:null,&quot;path&quot;:&quot;/test&quot;,&quot;message&quot;:&quot;Datalake adapter not available for endpoint profile, will fallback to direct FMP&quot;,&quot;type&quot;:&quot;general&quot;}

{&quot;timestamp&quot;:&quot;2026-01-01T10:46:48.534Z&quot;,&quot;service&quot;:&quot;stockly-api-test&quot;,&quot;level&quot;:&quot;WARN&quot;,&quot;traceId&quot;:&quot;test-trace-id&quot;,&quot;userId&quot;:null,&quot;path&quot;:&quot;/test&quot;,&quot;message&quot;:&quot;Market cache refresh failed (non-blocking)&quot;,&quot;type&quot;:&quot;general&quot;}

            </system-err>
        </testcase>
        <testcase classname="test/api-comprehensive.spec.ts" name="API - Get Multiple Stocks &gt; GET /v1/api/get-stocks returns 400 when symbols parameter is missing" time="0.005">
        </testcase>
        <testcase classname="test/api-comprehensive.spec.ts" name="API - Search Stocks &gt; GET /v1/api/search-stock returns matching stocks" time="0.009">
            <system-out>
{&quot;timestamp&quot;:&quot;2026-01-01T10:46:48.549Z&quot;,&quot;service&quot;:&quot;stockly-api-test&quot;,&quot;level&quot;:&quot;DEBUG&quot;,&quot;traceId&quot;:&quot;test-trace-id&quot;,&quot;userId&quot;:null,&quot;path&quot;:&quot;/test&quot;,&quot;message&quot;:&quot;D1 first: SELECT results, timestamp\n           FROM search_cache\n           WHERE query = ?\n           ORDER BY timestamp DESC\n           LIMIT 1&quot;,&quot;type&quot;:&quot;data_operation&quot;,&quot;operation&quot;:&quot;d1&quot;,&quot;query&quot;:&quot;SELECT results, timestamp\n           FROM search_cache\n           WHERE query = ?\n           ORDER BY timestamp DESC\n           LIMIT 1&quot;,&quot;latencyMs&quot;:0,&quot;cacheStatus&quot;:&quot;N/A&quot;}

{&quot;timestamp&quot;:&quot;2026-01-01T10:46:48.549Z&quot;,&quot;service&quot;:&quot;stockly-api-test&quot;,&quot;level&quot;:&quot;DEBUG&quot;,&quot;traceId&quot;:&quot;test-trace-id&quot;,&quot;userId&quot;:null,&quot;path&quot;:&quot;/test&quot;,&quot;message&quot;:&quot;D1 first: SELECT * FROM api_endpoints WHERE id = ?&quot;,&quot;type&quot;:&quot;data_operation&quot;,&quot;operation&quot;:&quot;d1&quot;,&quot;query&quot;:&quot;SELECT * FROM api_endpoints WHERE id = ?&quot;,&quot;latencyMs&quot;:0,&quot;cacheStatus&quot;:&quot;N/A&quot;}

{&quot;timestamp&quot;:&quot;2026-01-01T10:46:48.549Z&quot;,&quot;service&quot;:&quot;stockly-api-test&quot;,&quot;level&quot;:&quot;DEBUG&quot;,&quot;traceId&quot;:&quot;test-trace-id&quot;,&quot;userId&quot;:null,&quot;path&quot;:&quot;/test&quot;,&quot;message&quot;:&quot;D1 first: SELECT * FROM api_endpoints WHERE id = ?&quot;,&quot;type&quot;:&quot;data_operation&quot;,&quot;operation&quot;:&quot;d1&quot;,&quot;query&quot;:&quot;SELECT * FROM api_endpoints WHERE id = ?&quot;,&quot;latencyMs&quot;:0,&quot;cacheStatus&quot;:&quot;N/A&quot;}

{&quot;timestamp&quot;:&quot;2026-01-01T10:46:48.552Z&quot;,&quot;service&quot;:&quot;stockly-api-test&quot;,&quot;level&quot;:&quot;DEBUG&quot;,&quot;traceId&quot;:&quot;test-trace-id&quot;,&quot;userId&quot;:null,&quot;path&quot;:&quot;/test&quot;,&quot;message&quot;:&quot;D1 run: INSERT INTO search_cache (query, results, timestamp) VALUES (?, ?, ?)&quot;,&quot;type&quot;:&quot;data_operation&quot;,&quot;operation&quot;:&quot;d1&quot;,&quot;query&quot;:&quot;INSERT INTO search_cache (query, results, timestamp) VALUES (?, ?, ?)&quot;,&quot;latencyMs&quot;:0,&quot;cacheStatus&quot;:&quot;N/A&quot;}

            </system-out>
            <system-err>
{&quot;timestamp&quot;:&quot;2026-01-01T10:46:48.549Z&quot;,&quot;service&quot;:&quot;stockly-api-test&quot;,&quot;level&quot;:&quot;WARN&quot;,&quot;traceId&quot;:&quot;test-trace-id&quot;,&quot;userId&quot;:null,&quot;path&quot;:&quot;/test&quot;,&quot;message&quot;:&quot;Datalake adapter not available for endpoint search-name, will fallback to direct FMP&quot;,&quot;type&quot;:&quot;general&quot;}

{&quot;timestamp&quot;:&quot;2026-01-01T10:46:48.550Z&quot;,&quot;service&quot;:&quot;stockly-api-test&quot;,&quot;level&quot;:&quot;WARN&quot;,&quot;traceId&quot;:&quot;test-trace-id&quot;,&quot;userId&quot;:null,&quot;path&quot;:&quot;/test&quot;,&quot;message&quot;:&quot;Datalake adapter not available for endpoint search-symbol, will fallback to direct FMP&quot;,&quot;type&quot;:&quot;general&quot;}

{&quot;timestamp&quot;:&quot;2026-01-01T10:46:48.550Z&quot;,&quot;service&quot;:&quot;stockly-api-test&quot;,&quot;level&quot;:&quot;WARN&quot;,&quot;traceId&quot;:&quot;test-trace-id&quot;,&quot;userId&quot;:null,&quot;path&quot;:&quot;/test&quot;,&quot;message&quot;:&quot;Datalake adapters not available for search endpoints, falling back to direct FMP&quot;,&quot;type&quot;:&quot;general&quot;}

            </system-err>
        </testcase>
        <testcase classname="test/api-comprehensive.spec.ts" name="API - Search Stocks &gt; GET /v1/api/search-stock returns empty array when query is missing" time="0.003">
        </testcase>
        <testcase classname="test/api-comprehensive.spec.ts" name="API - Get Historical &gt; GET /v1/api/get-historical returns historical data" time="0.509">
            <system-out>
[getHistoricalPricesByDateRange] Querying database for AAPL from 2025-07-05 to 2026-01-01

[getHistoricalPricesByDateRange] Found 2 records for AAPL in date range 2025-07-05 to 2026-01-01

[fetchAndSaveHistoricalPrice] Starting fetch for AAPL from FMP API
[fetchAndSaveHistoricalPrice] Fetching from: https://financialmodelingprep.com/stable/historical-chart/30min?symbol=AAPL&amp;apikey=***&amp;from=2025-07-05&amp;to=2026-01-01

[fetchAndSaveHistoricalPrice] Received 2 1-hour OHLC records from FMP API
[fetchAndSaveHistoricalPrice] FMP API returned 2 records for AAPL
[fetchAndSaveHistoricalPrice] Sample record structure: {
  date: undefined,
  hasOpen: false,
  hasHigh: false,
  hasLow: false,
  hasClose: false,
  hasPrice: false,
  keys: [ &apos;symbol&apos;, &apos;name&apos;, &apos;currency&apos;, &apos;stockExchange&apos; ]
}
Saved 0 daily candles (aggregated from 2 1-hour records) for AAPL with OHLC data

[getHistoricalPricesByDateRange] Querying database for AAPL from 2025-07-05 to 2026-01-01

[getHistoricalPricesByDateRange] Found 2 records for AAPL in date range 2025-07-05 to 2026-01-01

            </system-out>
            <system-err>
[fetchAndSaveHistoricalPrice] Failed to parse date from timestamp undefined, skipping record
[fetchAndSaveHistoricalPrice] Failed to parse date from timestamp undefined, skipping record

            </system-err>
        </testcase>
        <testcase classname="test/api-comprehensive.spec.ts" name="API - Get Historical &gt; GET /v1/api/get-historical returns 400 when symbol is missing" time="0.006">
        </testcase>
        <testcase classname="test/api-comprehensive.spec.ts" name="API - Alerts &gt; GET /v1/api/alerts lists all alerts" time="0.004">
        </testcase>
        <testcase classname="test/api-comprehensive.spec.ts" name="API - Alerts &gt; POST /v1/api/alerts creates a new alert" time="0.004">
        </testcase>
        <testcase classname="test/api-comprehensive.spec.ts" name="API - Alerts &gt; GET /v1/api/alerts/:id gets a specific alert" time="0.004">
        </testcase>
        <testcase classname="test/api-comprehensive.spec.ts" name="API - Alerts &gt; PUT /v1/api/alerts/:id updates an alert" time="0.004">
        </testcase>
        <testcase classname="test/api-comprehensive.spec.ts" name="API - Alerts &gt; DELETE /v1/api/alerts/:id deletes an alert" time="0.003">
        </testcase>
        <testcase classname="test/api-comprehensive.spec.ts" name="API - Push Token &gt; POST /v1/api/push-token registers a new push token" time="0.006">
            <system-out>
✅ FCM token validation passed: length=30, format valid

{&quot;timestamp&quot;:&quot;2026-01-01T10:46:49.107Z&quot;,&quot;service&quot;:&quot;stockly-api-test&quot;,&quot;level&quot;:&quot;INFO&quot;,&quot;traceId&quot;:&quot;test-trace-id&quot;,&quot;userId&quot;:&quot;user-123&quot;,&quot;path&quot;:&quot;/test&quot;,&quot;message&quot;:&quot;Creating new device&quot;,&quot;type&quot;:&quot;general&quot;,&quot;username&quot;:&quot;testuser&quot;,&quot;deviceType&quot;:&quot;ios&quot;,&quot;deviceIdentifier&quot;:&quot;1e1a84cb769ec001...&quot;}

{&quot;timestamp&quot;:&quot;2026-01-01T10:46:49.107Z&quot;,&quot;service&quot;:&quot;stockly-api-test&quot;,&quot;level&quot;:&quot;INFO&quot;,&quot;traceId&quot;:&quot;test-trace-id&quot;,&quot;userId&quot;:&quot;user-123&quot;,&quot;path&quot;:&quot;/test&quot;,&quot;message&quot;:&quot;Creating new push token&quot;,&quot;type&quot;:&quot;general&quot;,&quot;username&quot;:&quot;testuser&quot;,&quot;deviceId&quot;:1,&quot;tokenPreview&quot;:&quot;fcm-token-1234567890...&quot;}

{&quot;timestamp&quot;:&quot;2026-01-01T10:46:49.107Z&quot;,&quot;service&quot;:&quot;stockly-api-test&quot;,&quot;level&quot;:&quot;INFO&quot;,&quot;traceId&quot;:&quot;test-trace-id&quot;,&quot;userId&quot;:&quot;user-123&quot;,&quot;path&quot;:&quot;/test&quot;,&quot;message&quot;:&quot;Push token registered successfully&quot;,&quot;type&quot;:&quot;general&quot;,&quot;username&quot;:&quot;testuser&quot;,&quot;deviceId&quot;:1,&quot;deviceType&quot;:&quot;ios&quot;}

            </system-out>
        </testcase>
        <testcase classname="test/api-comprehensive.spec.ts" name="API - Push Token &gt; POST /v1/api/push-token updates existing push token" time="0.007">
            <system-out>
✅ FCM token validation passed: length=30, format valid

{&quot;timestamp&quot;:&quot;2026-01-01T10:46:49.113Z&quot;,&quot;service&quot;:&quot;stockly-api-test&quot;,&quot;level&quot;:&quot;INFO&quot;,&quot;traceId&quot;:&quot;test-trace-id&quot;,&quot;userId&quot;:&quot;user-123&quot;,&quot;path&quot;:&quot;/test&quot;,&quot;message&quot;:&quot;Updating existing device&quot;,&quot;type&quot;:&quot;general&quot;,&quot;username&quot;:&quot;testuser&quot;,&quot;deviceId&quot;:1,&quot;deviceType&quot;:&quot;ios&quot;}

{&quot;timestamp&quot;:&quot;2026-01-01T10:46:49.114Z&quot;,&quot;service&quot;:&quot;stockly-api-test&quot;,&quot;level&quot;:&quot;INFO&quot;,&quot;traceId&quot;:&quot;test-trace-id&quot;,&quot;userId&quot;:&quot;user-123&quot;,&quot;path&quot;:&quot;/test&quot;,&quot;message&quot;:&quot;Updating existing push token&quot;,&quot;type&quot;:&quot;general&quot;,&quot;username&quot;:&quot;testuser&quot;,&quot;deviceId&quot;:1}

{&quot;timestamp&quot;:&quot;2026-01-01T10:46:49.114Z&quot;,&quot;service&quot;:&quot;stockly-api-test&quot;,&quot;level&quot;:&quot;INFO&quot;,&quot;traceId&quot;:&quot;test-trace-id&quot;,&quot;userId&quot;:&quot;user-123&quot;,&quot;path&quot;:&quot;/test&quot;,&quot;message&quot;:&quot;Push token registered successfully&quot;,&quot;type&quot;:&quot;general&quot;,&quot;username&quot;:&quot;testuser&quot;,&quot;deviceId&quot;:1,&quot;deviceType&quot;:&quot;ios&quot;}

            </system-out>
        </testcase>
        <testcase classname="test/api-comprehensive.spec.ts" name="API - Push Token &gt; POST /v1/api/push-token returns 400 for invalid token format" time="0.003">
        </testcase>
        <testcase classname="test/api-comprehensive.spec.ts" name="API - Push Token &gt; GET /v1/api/push-token gets a user&apos;s push token" time="0.004">
        </testcase>
        <testcase classname="test/api-comprehensive.spec.ts" name="API - Push Token &gt; GET /v1/api/push-token returns 404 when token not found" time="0.005">
        </testcase>
        <testcase classname="test/api-comprehensive.spec.ts" name="API - Push Token &gt; GET /v1/api/push-token?check=true&amp;token=XXX returns registered status for specific token" time="0.004">
            <system-out>
{&quot;timestamp&quot;:&quot;2026-01-01T10:46:49.132Z&quot;,&quot;service&quot;:&quot;stockly-api-test&quot;,&quot;level&quot;:&quot;DEBUG&quot;,&quot;traceId&quot;:&quot;test-trace-id&quot;,&quot;userId&quot;:&quot;user-123&quot;,&quot;path&quot;:&quot;/test&quot;,&quot;message&quot;:&quot;Device registration check&quot;,&quot;type&quot;:&quot;general&quot;,&quot;username&quot;:&quot;testuser&quot;,&quot;pushToken&quot;:&quot;fcm-token-1234567890...&quot;,&quot;registered&quot;:true}

            </system-out>
        </testcase>
        <testcase classname="test/api-comprehensive.spec.ts" name="API - Push Token &gt; GET /v1/api/push-token?check=true&amp;token=XXX returns registered=false when token not found" time="0.005">
            <system-out>
{&quot;timestamp&quot;:&quot;2026-01-01T10:46:49.136Z&quot;,&quot;service&quot;:&quot;stockly-api-test&quot;,&quot;level&quot;:&quot;DEBUG&quot;,&quot;traceId&quot;:&quot;test-trace-id&quot;,&quot;userId&quot;:&quot;user-123&quot;,&quot;path&quot;:&quot;/test&quot;,&quot;message&quot;:&quot;Device registration check&quot;,&quot;type&quot;:&quot;general&quot;,&quot;username&quot;:&quot;testuser&quot;,&quot;pushToken&quot;:&quot;fcm-token-unregister...&quot;,&quot;registered&quot;:false}

            </system-out>
        </testcase>
        <testcase classname="test/api-comprehensive.spec.ts" name="API - Push Token &gt; GET /v1/api/push-token?check=true returns 400 when token parameter missing" time="0.005">
        </testcase>
        <testcase classname="test/api-comprehensive.spec.ts" name="API - Preferences &gt; GET /v1/api/preferences gets user preferences" time="0.005">
        </testcase>
        <testcase classname="test/api-comprehensive.spec.ts" name="API - Preferences &gt; GET /v1/api/preferences returns default preferences when not found" time="0.004">
        </testcase>
        <testcase classname="test/api-comprehensive.spec.ts" name="API - Preferences &gt; PUT /v1/api/preferences updates user preferences" time="0.005">
        </testcase>
        <testcase classname="test/api-comprehensive.spec.ts" name="API - Settings &gt; GET /v1/api/settings gets user settings" time="0.004">
        </testcase>
        <testcase classname="test/api-comprehensive.spec.ts" name="API - Settings &gt; GET /v1/api/settings returns default settings when not found" time="0.006">
        </testcase>
        <testcase classname="test/api-comprehensive.spec.ts" name="API - Settings &gt; PUT /v1/api/settings updates user settings" time="0.004">
        </testcase>
        <testcase classname="test/api-comprehensive.spec.ts" name="API - Notifications &gt; GET /v1/api/notifications/recent returns recent notifications" time="0.003">
        </testcase>
        <testcase classname="test/api-comprehensive.spec.ts" name="API - Notifications &gt; GET /v1/api/notifications/failed returns failed notifications" time="0.004">
        </testcase>
        <testcase classname="test/api-comprehensive.spec.ts" name="API - Notifications &gt; POST /v1/api/notifications/retry/:logId retries a failed notification" time="0.004">
        </testcase>
        <testcase classname="test/api-comprehensive.spec.ts" name="API - Devices &gt; GET /v1/api/devices returns all devices" time="0.003">
        </testcase>
        <testcase classname="test/api-comprehensive.spec.ts" name="API - Devices &gt; DELETE /v1/api/devices deletes a device" time="0.003">
            <system-out>
{&quot;timestamp&quot;:&quot;2026-01-01T10:46:49.199Z&quot;,&quot;service&quot;:&quot;stockly-api-test&quot;,&quot;level&quot;:&quot;INFO&quot;,&quot;traceId&quot;:&quot;test-trace-id&quot;,&quot;userId&quot;:null,&quot;path&quot;:&quot;/test&quot;,&quot;message&quot;:&quot;Device deleted successfully&quot;,&quot;type&quot;:&quot;general&quot;,&quot;deletedPushToken&quot;:&quot;fcm-token-1234567890...&quot;,&quot;deletedUserId&quot;:&quot;user-123&quot;,&quot;deletedBy&quot;:&quot;testuser&quot;,&quot;isAdmin&quot;:true}

            </system-out>
        </testcase>
        <testcase classname="test/api-comprehensive.spec.ts" name="API - Admin Config &gt; GET /config/get returns admin configuration" time="0.002">
        </testcase>
        <testcase classname="test/api-comprehensive.spec.ts" name="API - Admin Config &gt; POST /config/update updates admin configuration" time="0.003">
        </testcase>
        <testcase classname="test/api-comprehensive.spec.ts" name="API - Admin Config &gt; POST /v1/api/simulate-provider-failure enables simulation mode" time="0.003">
        </testcase>
        <testcase classname="test/api-comprehensive.spec.ts" name="API - Admin Config &gt; POST /v1/api/disable-provider-failure disables simulation mode" time="0.002">
        </testcase>
        <testcase classname="test/api-comprehensive.spec.ts" name="API - OpenAPI &gt; GET /openapi.json returns OpenAPI specification" time="0.004">
        </testcase>
    </testsuite>
    <testsuite name="test/api-integration.spec.ts" timestamp="2026-01-01T10:46:50.814Z" hostname="sngvahmed" tests="41" failures="0" errors="0" skipped="0" time="1.88">
        <testcase classname="test/api-integration.spec.ts" name="API Integration - Health Check &gt; health endpoint returns OK status" time="0.009">
        </testcase>
        <testcase classname="test/api-integration.spec.ts" name="API Integration - Get Stock &gt; successfully fetches and returns stock data with all required fields" time="0.062">
            <system-out>
{&quot;timestamp&quot;:&quot;2026-01-01T10:46:48.419Z&quot;,&quot;service&quot;:&quot;stockly-api-test&quot;,&quot;level&quot;:&quot;DEBUG&quot;,&quot;traceId&quot;:&quot;test-trace-id&quot;,&quot;userId&quot;:null,&quot;path&quot;:&quot;/test&quot;,&quot;message&quot;:&quot;D1 first: SELECT symbol, price, day_low, day_high, volume, timestamp\n       FROM stock_prices\n       WHERE symbol = ?\n       ORDER BY timestamp DESC\n       LIMIT 1&quot;,&quot;type&quot;:&quot;data_operation&quot;,&quot;operation&quot;:&quot;d1&quot;,&quot;query&quot;:&quot;SELECT symbol, price, day_low, day_high, volume, timestamp\n       FROM stock_prices\n       WHERE symbol = ?\n       ORDER BY timestamp DESC\n       LIMIT 1&quot;,&quot;latencyMs&quot;:0,&quot;cacheStatus&quot;:&quot;N/A&quot;}

{&quot;timestamp&quot;:&quot;2026-01-01T10:46:48.420Z&quot;,&quot;service&quot;:&quot;stockly-api-test&quot;,&quot;level&quot;:&quot;DEBUG&quot;,&quot;traceId&quot;:&quot;test-trace-id&quot;,&quot;userId&quot;:null,&quot;path&quot;:&quot;/test&quot;,&quot;message&quot;:&quot;D1 first: SELECT * FROM api_endpoints WHERE id = ?&quot;,&quot;type&quot;:&quot;data_operation&quot;,&quot;operation&quot;:&quot;d1&quot;,&quot;query&quot;:&quot;SELECT * FROM api_endpoints WHERE id = ?&quot;,&quot;latencyMs&quot;:0,&quot;cacheStatus&quot;:&quot;N/A&quot;}

{&quot;timestamp&quot;:&quot;2026-01-01T10:46:48.423Z&quot;,&quot;service&quot;:&quot;stockly-api-test&quot;,&quot;level&quot;:&quot;DEBUG&quot;,&quot;traceId&quot;:&quot;test-trace-id&quot;,&quot;userId&quot;:null,&quot;path&quot;:&quot;/test&quot;,&quot;message&quot;:&quot;D1 first: SELECT * FROM api_endpoints WHERE id = ?&quot;,&quot;type&quot;:&quot;data_operation&quot;,&quot;operation&quot;:&quot;d1&quot;,&quot;query&quot;:&quot;SELECT * FROM api_endpoints WHERE id = ?&quot;,&quot;latencyMs&quot;:0,&quot;cacheStatus&quot;:&quot;N/A&quot;}

{&quot;timestamp&quot;:&quot;2026-01-01T10:46:48.426Z&quot;,&quot;service&quot;:&quot;stockly-api-test&quot;,&quot;level&quot;:&quot;DEBUG&quot;,&quot;traceId&quot;:&quot;test-trace-id&quot;,&quot;userId&quot;:null,&quot;path&quot;:&quot;/test&quot;,&quot;message&quot;:&quot;D1 run: INSERT INTO stock_prices (symbol, price, day_low, day_high, volume, timestamp)\n       VALUES (?, ?, ?, ?, ?, ?)&quot;,&quot;type&quot;:&quot;data_operation&quot;,&quot;operation&quot;:&quot;d1&quot;,&quot;query&quot;:&quot;INSERT INTO stock_prices (symbol, price, day_low, day_high, volume, timestamp)\n       VALUES (?, ?, ?, ?, ?, ?)&quot;,&quot;latencyMs&quot;:0,&quot;cacheStatus&quot;:&quot;N/A&quot;}

            </system-out>
            <system-err>
{&quot;timestamp&quot;:&quot;2026-01-01T10:46:48.420Z&quot;,&quot;service&quot;:&quot;stockly-api-test&quot;,&quot;level&quot;:&quot;WARN&quot;,&quot;traceId&quot;:&quot;test-trace-id&quot;,&quot;userId&quot;:null,&quot;path&quot;:&quot;/test&quot;,&quot;message&quot;:&quot;Datalake adapter not available for endpoint quote, will fallback to direct FMP&quot;,&quot;type&quot;:&quot;general&quot;}

{&quot;timestamp&quot;:&quot;2026-01-01T10:46:48.423Z&quot;,&quot;service&quot;:&quot;stockly-api-test&quot;,&quot;level&quot;:&quot;WARN&quot;,&quot;traceId&quot;:&quot;test-trace-id&quot;,&quot;userId&quot;:null,&quot;path&quot;:&quot;/test&quot;,&quot;message&quot;:&quot;Datalake adapter not available for endpoint profile, will fallback to direct FMP&quot;,&quot;type&quot;:&quot;general&quot;}

            </system-err>
        </testcase>
        <testcase classname="test/api-integration.spec.ts" name="API Integration - Get Stock &gt; returns error when symbol is missing" time="0.007">
        </testcase>
        <testcase classname="test/api-integration.spec.ts" name="API Integration - Get Stock &gt; uses cache when available" time="0.007">
            <system-out>
{&quot;timestamp&quot;:&quot;2026-01-01T10:46:48.441Z&quot;,&quot;service&quot;:&quot;stockly-api-test&quot;,&quot;level&quot;:&quot;INFO&quot;,&quot;traceId&quot;:&quot;test-trace-id&quot;,&quot;userId&quot;:null,&quot;path&quot;:&quot;/test&quot;,&quot;message&quot;:&quot;Cache hit for MSFT&quot;,&quot;type&quot;:&quot;general&quot;,&quot;ageSeconds&quot;:0,&quot;pollingIntervalSec&quot;:30,&quot;cacheStatus&quot;:&quot;HIT&quot;}

            </system-out>
        </testcase>
        <testcase classname="test/api-integration.spec.ts" name="API Integration - Get Stocks &gt; successfully fetches multiple stocks with all required fields" time="0.02">
            <system-out>
{&quot;timestamp&quot;:&quot;2026-01-01T10:46:48.456Z&quot;,&quot;service&quot;:&quot;stockly-api-test&quot;,&quot;level&quot;:&quot;DEBUG&quot;,&quot;traceId&quot;:&quot;test-trace-id&quot;,&quot;userId&quot;:null,&quot;path&quot;:&quot;/test&quot;,&quot;message&quot;:&quot;D1 first: SELECT symbol, price, day_low, day_high, volume, timestamp\n       FROM stock_prices\n       WHERE symbol = ?\n       ORDER BY timestamp DESC\n       LIMIT 1&quot;,&quot;type&quot;:&quot;data_operation&quot;,&quot;operation&quot;:&quot;d1&quot;,&quot;query&quot;:&quot;SELECT symbol, price, day_low, day_high, volume, timestamp\n       FROM stock_prices\n       WHERE symbol = ?\n       ORDER BY timestamp DESC\n       LIMIT 1&quot;,&quot;latencyMs&quot;:0,&quot;cacheStatus&quot;:&quot;N/A&quot;}

{&quot;timestamp&quot;:&quot;2026-01-01T10:46:48.456Z&quot;,&quot;service&quot;:&quot;stockly-api-test&quot;,&quot;level&quot;:&quot;DEBUG&quot;,&quot;traceId&quot;:&quot;test-trace-id&quot;,&quot;userId&quot;:null,&quot;path&quot;:&quot;/test&quot;,&quot;message&quot;:&quot;D1 first: SELECT symbol, price, day_low, day_high, volume, timestamp\n       FROM stock_prices\n       WHERE symbol = ?\n       ORDER BY timestamp DESC\n       LIMIT 1&quot;,&quot;type&quot;:&quot;data_operation&quot;,&quot;operation&quot;:&quot;d1&quot;,&quot;query&quot;:&quot;SELECT symbol, price, day_low, day_high, volume, timestamp\n       FROM stock_prices\n       WHERE symbol = ?\n       ORDER BY timestamp DESC\n       LIMIT 1&quot;,&quot;latencyMs&quot;:0,&quot;cacheStatus&quot;:&quot;N/A&quot;}

{&quot;timestamp&quot;:&quot;2026-01-01T10:46:48.456Z&quot;,&quot;service&quot;:&quot;stockly-api-test&quot;,&quot;level&quot;:&quot;DEBUG&quot;,&quot;traceId&quot;:&quot;test-trace-id&quot;,&quot;userId&quot;:null,&quot;path&quot;:&quot;/test&quot;,&quot;message&quot;:&quot;D1 first: SELECT * FROM api_endpoints WHERE id = ?&quot;,&quot;type&quot;:&quot;data_operation&quot;,&quot;operation&quot;:&quot;d1&quot;,&quot;query&quot;:&quot;SELECT * FROM api_endpoints WHERE id = ?&quot;,&quot;latencyMs&quot;:0,&quot;cacheStatus&quot;:&quot;N/A&quot;}
{&quot;timestamp&quot;:&quot;2026-01-01T10:46:48.457Z&quot;,&quot;service&quot;:&quot;stockly-api-test&quot;,&quot;level&quot;:&quot;DEBUG&quot;,&quot;traceId&quot;:&quot;test-trace-id&quot;,&quot;userId&quot;:null,&quot;path&quot;:&quot;/test&quot;,&quot;message&quot;:&quot;D1 first: SELECT * FROM api_endpoints WHERE id = ?&quot;,&quot;type&quot;:&quot;data_operation&quot;,&quot;operation&quot;:&quot;d1&quot;,&quot;query&quot;:&quot;SELECT * FROM api_endpoints WHERE id = ?&quot;,&quot;latencyMs&quot;:1,&quot;cacheStatus&quot;:&quot;N/A&quot;}

{&quot;timestamp&quot;:&quot;2026-01-01T10:46:48.461Z&quot;,&quot;service&quot;:&quot;stockly-api-test&quot;,&quot;level&quot;:&quot;DEBUG&quot;,&quot;traceId&quot;:&quot;test-trace-id&quot;,&quot;userId&quot;:null,&quot;path&quot;:&quot;/test&quot;,&quot;message&quot;:&quot;D1 first: SELECT * FROM api_endpoints WHERE id = ?&quot;,&quot;type&quot;:&quot;data_operation&quot;,&quot;operation&quot;:&quot;d1&quot;,&quot;query&quot;:&quot;SELECT * FROM api_endpoints WHERE id = ?&quot;,&quot;latencyMs&quot;:0,&quot;cacheStatus&quot;:&quot;N/A&quot;}

{&quot;timestamp&quot;:&quot;2026-01-01T10:46:48.462Z&quot;,&quot;service&quot;:&quot;stockly-api-test&quot;,&quot;level&quot;:&quot;DEBUG&quot;,&quot;traceId&quot;:&quot;test-trace-id&quot;,&quot;userId&quot;:null,&quot;path&quot;:&quot;/test&quot;,&quot;message&quot;:&quot;D1 first: SELECT * FROM api_endpoints WHERE id = ?&quot;,&quot;type&quot;:&quot;data_operation&quot;,&quot;operation&quot;:&quot;d1&quot;,&quot;query&quot;:&quot;SELECT * FROM api_endpoints WHERE id = ?&quot;,&quot;latencyMs&quot;:0,&quot;cacheStatus&quot;:&quot;N/A&quot;}

{&quot;timestamp&quot;:&quot;2026-01-01T10:46:48.465Z&quot;,&quot;service&quot;:&quot;stockly-api-test&quot;,&quot;level&quot;:&quot;DEBUG&quot;,&quot;traceId&quot;:&quot;test-trace-id&quot;,&quot;userId&quot;:null,&quot;path&quot;:&quot;/test&quot;,&quot;message&quot;:&quot;D1 run: INSERT INTO stock_prices (symbol, price, day_low, day_high, volume, timestamp)\n       VALUES (?, ?, ?, ?, ?, ?)&quot;,&quot;type&quot;:&quot;data_operation&quot;,&quot;operation&quot;:&quot;d1&quot;,&quot;query&quot;:&quot;INSERT INTO stock_prices (symbol, price, day_low, day_high, volume, timestamp)\n       VALUES (?, ?, ?, ?, ?, ?)&quot;,&quot;latencyMs&quot;:0,&quot;cacheStatus&quot;:&quot;N/A&quot;}
{&quot;timestamp&quot;:&quot;2026-01-01T10:46:48.465Z&quot;,&quot;service&quot;:&quot;stockly-api-test&quot;,&quot;level&quot;:&quot;DEBUG&quot;,&quot;traceId&quot;:&quot;test-trace-id&quot;,&quot;userId&quot;:null,&quot;path&quot;:&quot;/test&quot;,&quot;message&quot;:&quot;D1 run: INSERT INTO stock_prices (symbol, price, day_low, day_high, volume, timestamp)\n       VALUES (?, ?, ?, ?, ?, ?)&quot;,&quot;type&quot;:&quot;data_operation&quot;,&quot;operation&quot;:&quot;d1&quot;,&quot;query&quot;:&quot;INSERT INTO stock_prices (symbol, price, day_low, day_high, volume, timestamp)\n       VALUES (?, ?, ?, ?, ?, ?)&quot;,&quot;latencyMs&quot;:0,&quot;cacheStatus&quot;:&quot;N/A&quot;}

            </system-out>
            <system-err>
{&quot;timestamp&quot;:&quot;2026-01-01T10:46:48.457Z&quot;,&quot;service&quot;:&quot;stockly-api-test&quot;,&quot;level&quot;:&quot;WARN&quot;,&quot;traceId&quot;:&quot;test-trace-id&quot;,&quot;userId&quot;:null,&quot;path&quot;:&quot;/test&quot;,&quot;message&quot;:&quot;Datalake adapter not available for endpoint quote, will fallback to direct FMP&quot;,&quot;type&quot;:&quot;general&quot;}
{&quot;timestamp&quot;:&quot;2026-01-01T10:46:48.457Z&quot;,&quot;service&quot;:&quot;stockly-api-test&quot;,&quot;level&quot;:&quot;WARN&quot;,&quot;traceId&quot;:&quot;test-trace-id&quot;,&quot;userId&quot;:null,&quot;path&quot;:&quot;/test&quot;,&quot;message&quot;:&quot;Datalake adapter not available for endpoint quote, will fallback to direct FMP&quot;,&quot;type&quot;:&quot;general&quot;}

{&quot;timestamp&quot;:&quot;2026-01-01T10:46:48.461Z&quot;,&quot;service&quot;:&quot;stockly-api-test&quot;,&quot;level&quot;:&quot;WARN&quot;,&quot;traceId&quot;:&quot;test-trace-id&quot;,&quot;userId&quot;:null,&quot;path&quot;:&quot;/test&quot;,&quot;message&quot;:&quot;Datalake adapter not available for endpoint profile, will fallback to direct FMP&quot;,&quot;type&quot;:&quot;general&quot;}

{&quot;timestamp&quot;:&quot;2026-01-01T10:46:48.462Z&quot;,&quot;service&quot;:&quot;stockly-api-test&quot;,&quot;level&quot;:&quot;WARN&quot;,&quot;traceId&quot;:&quot;test-trace-id&quot;,&quot;userId&quot;:null,&quot;path&quot;:&quot;/test&quot;,&quot;message&quot;:&quot;Datalake adapter not available for endpoint profile, will fallback to direct FMP&quot;,&quot;type&quot;:&quot;general&quot;}

{&quot;timestamp&quot;:&quot;2026-01-01T10:46:48.466Z&quot;,&quot;service&quot;:&quot;stockly-api-test&quot;,&quot;level&quot;:&quot;WARN&quot;,&quot;traceId&quot;:&quot;test-trace-id&quot;,&quot;userId&quot;:null,&quot;path&quot;:&quot;/test&quot;,&quot;message&quot;:&quot;Market cache refresh failed (non-blocking)&quot;,&quot;type&quot;:&quot;general&quot;}

            </system-err>
        </testcase>
        <testcase classname="test/api-integration.spec.ts" name="API Integration - Get Stocks &gt; returns error when symbols parameter is missing" time="0.009">
        </testcase>
        <testcase classname="test/api-integration.spec.ts" name="API Integration - Get Stocks &gt; handles empty symbols list" time="0.006">
        </testcase>
        <testcase classname="test/api-integration.spec.ts" name="API Integration - Search Stock &gt; successfully searches and returns matching stocks" time="0.029">
            <system-out>
{&quot;timestamp&quot;:&quot;2026-01-01T10:46:48.509Z&quot;,&quot;service&quot;:&quot;stockly-api-test&quot;,&quot;level&quot;:&quot;DEBUG&quot;,&quot;traceId&quot;:&quot;test-trace-id&quot;,&quot;userId&quot;:null,&quot;path&quot;:&quot;/test&quot;,&quot;message&quot;:&quot;D1 first: SELECT results, timestamp\n           FROM search_cache\n           WHERE query = ?\n           ORDER BY timestamp DESC\n           LIMIT 1&quot;,&quot;type&quot;:&quot;data_operation&quot;,&quot;operation&quot;:&quot;d1&quot;,&quot;query&quot;:&quot;SELECT results, timestamp\n           FROM search_cache\n           WHERE query = ?\n           ORDER BY timestamp DESC\n           LIMIT 1&quot;,&quot;latencyMs&quot;:0,&quot;cacheStatus&quot;:&quot;N/A&quot;}

{&quot;timestamp&quot;:&quot;2026-01-01T10:46:48.509Z&quot;,&quot;service&quot;:&quot;stockly-api-test&quot;,&quot;level&quot;:&quot;DEBUG&quot;,&quot;traceId&quot;:&quot;test-trace-id&quot;,&quot;userId&quot;:null,&quot;path&quot;:&quot;/test&quot;,&quot;message&quot;:&quot;D1 first: SELECT * FROM api_endpoints WHERE id = ?&quot;,&quot;type&quot;:&quot;data_operation&quot;,&quot;operation&quot;:&quot;d1&quot;,&quot;query&quot;:&quot;SELECT * FROM api_endpoints WHERE id = ?&quot;,&quot;latencyMs&quot;:0,&quot;cacheStatus&quot;:&quot;N/A&quot;}

{&quot;timestamp&quot;:&quot;2026-01-01T10:46:48.509Z&quot;,&quot;service&quot;:&quot;stockly-api-test&quot;,&quot;level&quot;:&quot;DEBUG&quot;,&quot;traceId&quot;:&quot;test-trace-id&quot;,&quot;userId&quot;:null,&quot;path&quot;:&quot;/test&quot;,&quot;message&quot;:&quot;D1 first: SELECT * FROM api_endpoints WHERE id = ?&quot;,&quot;type&quot;:&quot;data_operation&quot;,&quot;operation&quot;:&quot;d1&quot;,&quot;query&quot;:&quot;SELECT * FROM api_endpoints WHERE id = ?&quot;,&quot;latencyMs&quot;:0,&quot;cacheStatus&quot;:&quot;N/A&quot;}

{&quot;timestamp&quot;:&quot;2026-01-01T10:46:48.511Z&quot;,&quot;service&quot;:&quot;stockly-api-test&quot;,&quot;level&quot;:&quot;DEBUG&quot;,&quot;traceId&quot;:&quot;test-trace-id&quot;,&quot;userId&quot;:null,&quot;path&quot;:&quot;/test&quot;,&quot;message&quot;:&quot;D1 run: INSERT INTO search_cache (query, results, timestamp) VALUES (?, ?, ?)&quot;,&quot;type&quot;:&quot;data_operation&quot;,&quot;operation&quot;:&quot;d1&quot;,&quot;query&quot;:&quot;INSERT INTO search_cache (query, results, timestamp) VALUES (?, ?, ?)&quot;,&quot;latencyMs&quot;:0,&quot;cacheStatus&quot;:&quot;N/A&quot;}

            </system-out>
            <system-err>
{&quot;timestamp&quot;:&quot;2026-01-01T10:46:48.509Z&quot;,&quot;service&quot;:&quot;stockly-api-test&quot;,&quot;level&quot;:&quot;WARN&quot;,&quot;traceId&quot;:&quot;test-trace-id&quot;,&quot;userId&quot;:null,&quot;path&quot;:&quot;/test&quot;,&quot;message&quot;:&quot;Datalake adapter not available for endpoint search-name, will fallback to direct FMP&quot;,&quot;type&quot;:&quot;general&quot;}

{&quot;timestamp&quot;:&quot;2026-01-01T10:46:48.509Z&quot;,&quot;service&quot;:&quot;stockly-api-test&quot;,&quot;level&quot;:&quot;WARN&quot;,&quot;traceId&quot;:&quot;test-trace-id&quot;,&quot;userId&quot;:null,&quot;path&quot;:&quot;/test&quot;,&quot;message&quot;:&quot;Datalake adapter not available for endpoint search-symbol, will fallback to direct FMP&quot;,&quot;type&quot;:&quot;general&quot;}

{&quot;timestamp&quot;:&quot;2026-01-01T10:46:48.509Z&quot;,&quot;service&quot;:&quot;stockly-api-test&quot;,&quot;level&quot;:&quot;WARN&quot;,&quot;traceId&quot;:&quot;test-trace-id&quot;,&quot;userId&quot;:null,&quot;path&quot;:&quot;/test&quot;,&quot;message&quot;:&quot;Datalake adapters not available for search endpoints, falling back to direct FMP&quot;,&quot;type&quot;:&quot;general&quot;}

            </system-err>
        </testcase>
        <testcase classname="test/api-integration.spec.ts" name="API Integration - Search Stock &gt; returns empty array when query parameter is missing" time="0.005">
        </testcase>
        <testcase classname="test/api-integration.spec.ts" name="API Integration - Get Historical &gt; successfully fetches historical price data" time="1.563">
            <system-out>
[getHistoricalPricesByDateRange] Querying database for AAPL from 2025-07-05 to 2026-01-01

[getHistoricalPricesByDateRange] Found 3 records for AAPL in date range 2025-07-05 to 2026-01-01

[fetchAndSaveHistoricalPrice] Starting fetch for AAPL from FMP API
[fetchAndSaveHistoricalPrice] Fetching from: https://financialmodelingprep.com/stable/historical-chart/30min?symbol=AAPL&amp;apikey=***&amp;from=2025-07-05&amp;to=2026-01-01

[fetchAndSaveHistoricalPrice] Received 254 1-hour OHLC records from FMP API
[fetchAndSaveHistoricalPrice] FMP API returned 254 records for AAPL
[fetchAndSaveHistoricalPrice] Sample record structure: {
  date: &apos;2025-12-31 15:30:00&apos;,
  hasOpen: true,
  hasHigh: true,
  hasLow: true,
  hasClose: true,
  hasPrice: false,
  keys: [ &apos;date&apos;, &apos;open&apos;, &apos;low&apos;, &apos;high&apos;, &apos;close&apos;, &apos;volume&apos; ]
}

[fetchAndSaveHistoricalPrice] Saved daily candle for AAPL on 2025-12-03 with OHLC: open=286.17, high=288.61, low=283.26, close=284.16

[fetchAndSaveHistoricalPrice] Saved daily candle for AAPL on 2025-12-04 with OHLC: open=284.12, high=284.71, low=278.6, close=280.69

[fetchAndSaveHistoricalPrice] Saved daily candle for AAPL on 2025-12-05 with OHLC: open=280.54, high=281.13, low=278.05, close=278.78

[fetchAndSaveHistoricalPrice] Saved daily candle for AAPL on 2025-12-08 with OHLC: open=278.1, high=279.65, low=276.15, close=277.97

[fetchAndSaveHistoricalPrice] Saved daily candle for AAPL on 2025-12-09 with OHLC: open=278.16, high=280.03, low=276.93, close=277.25

[fetchAndSaveHistoricalPrice] Saved daily candle for AAPL on 2025-12-10 with OHLC: open=277.87, high=279.74, low=276.44, close=278.72

[fetchAndSaveHistoricalPrice] Saved daily candle for AAPL on 2025-12-11 with OHLC: open=279.15, high=279.59, low=273.82, close=278.1

[fetchAndSaveHistoricalPrice] Saved daily candle for AAPL on 2025-12-12 with OHLC: open=278.01, high=279.21, low=276.88, close=278.35

[fetchAndSaveHistoricalPrice] Saved daily candle for AAPL on 2025-12-15 with OHLC: open=280.15, high=280.28, low=272.84, close=274.15

[fetchAndSaveHistoricalPrice] Saved daily candle for AAPL on 2025-12-16 with OHLC: open=272.99, high=275.5, low=271.79, close=274.49

[fetchAndSaveHistoricalPrice] Saved daily candle for AAPL on 2025-12-17 with OHLC: open=275, high=276.15, low=271.69, close=271.82

[fetchAndSaveHistoricalPrice] Saved daily candle for AAPL on 2025-12-18 with OHLC: open=273.5, high=273.62, low=266.96, close=272.14

[fetchAndSaveHistoricalPrice] Saved daily candle for AAPL on 2025-12-19 with OHLC: open=272.25, high=274.97, low=269.9, close=274.25

[fetchAndSaveHistoricalPrice] Saved daily candle for AAPL on 2025-12-22 with OHLC: open=272.8, high=273.88, low=270.23, close=270.83

[fetchAndSaveHistoricalPrice] Saved daily candle for AAPL on 2025-12-23 with OHLC: open=270, high=272.45, low=269.56, close=272.24

[fetchAndSaveHistoricalPrice] Saved daily candle for AAPL on 2025-12-24 with OHLC: open=272.29, high=275.43, low=272.17, close=273.88

[fetchAndSaveHistoricalPrice] Saved daily candle for AAPL on 2025-12-26 with OHLC: open=274.18, high=275.37, low=272.86, close=273.36

[fetchAndSaveHistoricalPrice] Saved daily candle for AAPL on 2025-12-29 with OHLC: open=272.7, high=274.36, low=272.37, close=273.74

[fetchAndSaveHistoricalPrice] Saved daily candle for AAPL on 2025-12-30 with OHLC: open=272.82, high=274.06, low=272.28, close=273

[fetchAndSaveHistoricalPrice] Saved daily candle for AAPL on 2025-12-31 with OHLC: open=273.05, high=273.67, low=271.77, close=271.91
Saved 20 daily candles (aggregated from 254 1-hour records) for AAPL with OHLC data

[getHistoricalPricesByDateRange] Querying database for AAPL from 2025-07-05 to 2026-01-01

[getHistoricalPricesByDateRange] Found 3 records for AAPL in date range 2025-07-05 to 2026-01-01

            </system-out>
        </testcase>
        <testcase classname="test/api-integration.spec.ts" name="API Integration - Get Historical &gt; returns error when symbol is missing" time="0.005">
        </testcase>
        <testcase classname="test/api-integration.spec.ts" name="API Integration - Get Historical &gt; validates days parameter" time="0.004">
        </testcase>
        <testcase classname="test/api-integration.spec.ts" name="API Integration - Alerts &gt; successfully lists all alerts" time="0.004">
        </testcase>
        <testcase classname="test/api-integration.spec.ts" name="API Integration - Alerts &gt; successfully creates an alert" time="0.002">
        </testcase>
        <testcase classname="test/api-integration.spec.ts" name="API Integration - Alerts &gt; successfully updates an alert" time="0.003">
        </testcase>
        <testcase classname="test/api-integration.spec.ts" name="API Integration - Alerts &gt; successfully deletes an alert" time="0.003">
        </testcase>
        <testcase classname="test/api-integration.spec.ts" name="API Integration - Alerts &gt; returns 404 when alert not found" time="0.002">
        </testcase>
        <testcase classname="test/api-integration.spec.ts" name="API Integration - Market Endpoints &gt; GET /v1/api/market/gainers &gt; successfully fetches and returns gainers data" time="0.003">
        </testcase>
        <testcase classname="test/api-integration.spec.ts" name="API Integration - Market Endpoints &gt; GET /v1/api/market/gainers &gt; respects limit parameter" time="0.003">
        </testcase>
        <testcase classname="test/api-integration.spec.ts" name="API Integration - Market Endpoints &gt; GET /v1/api/market/gainers &gt; returns 400 for invalid limit (too low)" time="0.003">
        </testcase>
        <testcase classname="test/api-integration.spec.ts" name="API Integration - Market Endpoints &gt; GET /v1/api/market/gainers &gt; returns 400 for invalid limit (too high)" time="0.003">
        </testcase>
        <testcase classname="test/api-integration.spec.ts" name="API Integration - Market Endpoints &gt; GET /v1/api/market/gainers &gt; returns 500 when service throws error" time="0.008">
            <system-err>
{&quot;timestamp&quot;:&quot;2026-01-01T10:46:50.133Z&quot;,&quot;service&quot;:&quot;stockly-api-test&quot;,&quot;level&quot;:&quot;ERROR&quot;,&quot;traceId&quot;:&quot;test-trace-id&quot;,&quot;userId&quot;:null,&quot;path&quot;:&quot;/test&quot;,&quot;message&quot;:&quot;Failed to get gainers&quot;,&quot;type&quot;:&quot;general&quot;,&quot;errorMessage&quot;:&quot;Service error&quot;,&quot;error&quot;:{&quot;name&quot;:&quot;Error&quot;,&quot;message&quot;:&quot;Service error&quot;,&quot;stack&quot;:&quot;Error: Service error\n    at /home/sngvahmed/workspace/stockly/api/test/api-integration.spec.ts:922:47\n    at home/sngvahmed/workspace/stockly/node_modules/@vitest/runner/dist/chunk-hooks.js:155:11\n    at home/sngvahmed/workspace/stockly/node_modules/@vitest/runner/dist/chunk-hooks.js:752:26\n    at home/sngvahmed/workspace/stockly/node_modules/@vitest/runner/dist/chunk-hooks.js:1897:20\n    at new Promise (&lt;anonymous&gt;)\n    at runWithTimeout (home/sngvahmed/workspace/stockly/node_modules/@vitest/runner/dist/chunk-hooks.js:1863:10)\n    at runTest (home/sngvahmed/workspace/stockly/node_modules/@vitest/runner/dist/chunk-hooks.js:1574:12)\n    at runSuite (home/sngvahmed/workspace/stockly/node_modules/@vitest/runner/dist/chunk-hooks.js:1729:8)\n    at runSuite (home/sngvahmed/workspace/stockly/node_modules/@vitest/runner/dist/chunk-hooks.js:1729:8)\n    at runSuite (home/sngvahmed/workspace/stockly/node_modules/@vitest/runner/dist/chunk-hooks.js:1729:8)&quot;}}

            </system-err>
        </testcase>
        <testcase classname="test/api-integration.spec.ts" name="API Integration - Market Endpoints &gt; GET /v1/api/market/losers &gt; successfully fetches and returns losers data" time="0.003">
        </testcase>
        <testcase classname="test/api-integration.spec.ts" name="API Integration - Market Endpoints &gt; GET /v1/api/market/actives &gt; successfully fetches and returns actives data" time="0.003">
        </testcase>
        <testcase classname="test/api-integration.spec.ts" name="API Integration - Market Endpoints &gt; GET /v1/api/market/screener &gt; successfully fetches and returns screener data with all required fields" time="0.003">
        </testcase>
        <testcase classname="test/api-integration.spec.ts" name="API Integration - Market Endpoints &gt; GET /v1/api/market/screener &gt; uses default parameters when none provided" time="0.003">
        </testcase>
        <testcase classname="test/api-integration.spec.ts" name="API Integration - Market Endpoints &gt; GET /v1/api/market/screener &gt; respects all custom parameters" time="0.002">
        </testcase>
        <testcase classname="test/api-integration.spec.ts" name="API Integration - Market Endpoints &gt; GET /v1/api/market/screener &gt; respects limit parameter" time="0.003">
        </testcase>
        <testcase classname="test/api-integration.spec.ts" name="API Integration - Market Endpoints &gt; GET /v1/api/market/screener &gt; returns 400 for invalid marketCapMoreThan (negative)" time="0.002">
        </testcase>
        <testcase classname="test/api-integration.spec.ts" name="API Integration - Market Endpoints &gt; GET /v1/api/market/screener &gt; returns 400 for invalid peLowerThan (negative)" time="0.002">
        </testcase>
        <testcase classname="test/api-integration.spec.ts" name="API Integration - Market Endpoints &gt; GET /v1/api/market/screener &gt; returns 400 for invalid dividendMoreThan (negative)" time="0.003">
        </testcase>
        <testcase classname="test/api-integration.spec.ts" name="API Integration - Market Endpoints &gt; GET /v1/api/market/screener &gt; returns 400 for invalid limit (too low)" time="0.003">
        </testcase>
        <testcase classname="test/api-integration.spec.ts" name="API Integration - Market Endpoints &gt; GET /v1/api/market/screener &gt; returns 400 for invalid limit (too high)" time="0.002">
        </testcase>
        <testcase classname="test/api-integration.spec.ts" name="API Integration - Market Endpoints &gt; GET /v1/api/market/screener &gt; returns 400 for invalid parameter types" time="0.002">
        </testcase>
        <testcase classname="test/api-integration.spec.ts" name="API Integration - Market Endpoints &gt; GET /v1/api/market/screener &gt; uses KV cache when available" time="0.002">
        </testcase>
        <testcase classname="test/api-integration.spec.ts" name="API Integration - Market Endpoints &gt; GET /v1/api/market/screener &gt; stores result in KV cache after fetch" time="0.003">
        </testcase>
        <testcase classname="test/api-integration.spec.ts" name="API Integration - Market Endpoints &gt; GET /v1/api/market/screener &gt; returns 500 when service throws error" time="0.003">
            <system-err>
{&quot;timestamp&quot;:&quot;2026-01-01T10:46:50.181Z&quot;,&quot;service&quot;:&quot;stockly-api-test&quot;,&quot;level&quot;:&quot;ERROR&quot;,&quot;traceId&quot;:&quot;test-trace-id&quot;,&quot;userId&quot;:null,&quot;path&quot;:&quot;/test&quot;,&quot;message&quot;:&quot;Failed to get screener&quot;,&quot;type&quot;:&quot;general&quot;,&quot;error&quot;:{&quot;name&quot;:&quot;Error&quot;,&quot;message&quot;:&quot;Service error&quot;,&quot;stack&quot;:&quot;Error: Service error\n    at /home/sngvahmed/workspace/stockly/api/test/api-integration.spec.ts:1368:48\n    at home/sngvahmed/workspace/stockly/node_modules/@vitest/runner/dist/chunk-hooks.js:155:11\n    at home/sngvahmed/workspace/stockly/node_modules/@vitest/runner/dist/chunk-hooks.js:752:26\n    at home/sngvahmed/workspace/stockly/node_modules/@vitest/runner/dist/chunk-hooks.js:1897:20\n    at new Promise (&lt;anonymous&gt;)\n    at runWithTimeout (home/sngvahmed/workspace/stockly/node_modules/@vitest/runner/dist/chunk-hooks.js:1863:10)\n    at runTest (home/sngvahmed/workspace/stockly/node_modules/@vitest/runner/dist/chunk-hooks.js:1574:12)\n    at runSuite (home/sngvahmed/workspace/stockly/node_modules/@vitest/runner/dist/chunk-hooks.js:1729:8)\n    at runSuite (home/sngvahmed/workspace/stockly/node_modules/@vitest/runner/dist/chunk-hooks.js:1729:8)\n    at runSuite (home/sngvahmed/workspace/stockly/node_modules/@vitest/runner/dist/chunk-hooks.js:1729:8)&quot;}}

            </system-err>
        </testcase>
        <testcase classname="test/api-integration.spec.ts" name="API Integration - Market Endpoints &gt; GET /v1/api/market/screener &gt; validates response schema matches MarketResponseSchema" time="0.003">
        </testcase>
        <testcase classname="test/api-integration.spec.ts" name="API Integration - Market Endpoints &gt; GET /v1/api/market/screener &gt; handles FMP response with missing optional fields" time="0.003">
        </testcase>
        <testcase classname="test/api-integration.spec.ts" name="API Integration - Get Stock Details &gt; getStockDetails returns profile with beta field when available" time="0.022">
            <system-out>
{&quot;timestamp&quot;:&quot;2026-01-01T10:46:50.209Z&quot;,&quot;service&quot;:&quot;stockly-api-test&quot;,&quot;level&quot;:&quot;INFO&quot;,&quot;traceId&quot;:&quot;test-trace-id&quot;,&quot;userId&quot;:null,&quot;path&quot;:&quot;/test&quot;,&quot;message&quot;:&quot;Cache miss for stock details: AAPL, fetching...&quot;,&quot;type&quot;:&quot;general&quot;}

{&quot;timestamp&quot;:&quot;2026-01-01T10:46:50.209Z&quot;,&quot;service&quot;:&quot;stockly-api-test&quot;,&quot;level&quot;:&quot;DEBUG&quot;,&quot;traceId&quot;:&quot;test-trace-id&quot;,&quot;userId&quot;:null,&quot;path&quot;:&quot;/test&quot;,&quot;message&quot;:&quot;D1 first: SELECT * FROM api_endpoints WHERE id = ?&quot;,&quot;type&quot;:&quot;data_operation&quot;,&quot;operation&quot;:&quot;d1&quot;,&quot;query&quot;:&quot;SELECT * FROM api_endpoints WHERE id = ?&quot;,&quot;latencyMs&quot;:0,&quot;cacheStatus&quot;:&quot;N/A&quot;}
{&quot;timestamp&quot;:&quot;2026-01-01T10:46:50.209Z&quot;,&quot;service&quot;:&quot;stockly-api-test&quot;,&quot;level&quot;:&quot;DEBUG&quot;,&quot;traceId&quot;:&quot;test-trace-id&quot;,&quot;userId&quot;:null,&quot;path&quot;:&quot;/test&quot;,&quot;message&quot;:&quot;D1 first: SELECT * FROM api_endpoints WHERE id = ?&quot;,&quot;type&quot;:&quot;data_operation&quot;,&quot;operation&quot;:&quot;d1&quot;,&quot;query&quot;:&quot;SELECT * FROM api_endpoints WHERE id = ?&quot;,&quot;latencyMs&quot;:0,&quot;cacheStatus&quot;:&quot;N/A&quot;}
{&quot;timestamp&quot;:&quot;2026-01-01T10:46:50.209Z&quot;,&quot;service&quot;:&quot;stockly-api-test&quot;,&quot;level&quot;:&quot;DEBUG&quot;,&quot;traceId&quot;:&quot;test-trace-id&quot;,&quot;userId&quot;:null,&quot;path&quot;:&quot;/test&quot;,&quot;message&quot;:&quot;D1 first: SELECT * FROM api_endpoints WHERE id = ?&quot;,&quot;type&quot;:&quot;data_operation&quot;,&quot;operation&quot;:&quot;d1&quot;,&quot;query&quot;:&quot;SELECT * FROM api_endpoints WHERE id = ?&quot;,&quot;latencyMs&quot;:0,&quot;cacheStatus&quot;:&quot;N/A&quot;}
{&quot;timestamp&quot;:&quot;2026-01-01T10:46:50.209Z&quot;,&quot;service&quot;:&quot;stockly-api-test&quot;,&quot;level&quot;:&quot;DEBUG&quot;,&quot;traceId&quot;:&quot;test-trace-id&quot;,&quot;userId&quot;:null,&quot;path&quot;:&quot;/test&quot;,&quot;message&quot;:&quot;D1 first: SELECT * FROM api_endpoints WHERE id = ?&quot;,&quot;type&quot;:&quot;data_operation&quot;,&quot;operation&quot;:&quot;d1&quot;,&quot;query&quot;:&quot;SELECT * FROM api_endpoints WHERE id = ?&quot;,&quot;latencyMs&quot;:0,&quot;cacheStatus&quot;:&quot;N/A&quot;}
{&quot;timestamp&quot;:&quot;2026-01-01T10:46:50.209Z&quot;,&quot;service&quot;:&quot;stockly-api-test&quot;,&quot;level&quot;:&quot;DEBUG&quot;,&quot;traceId&quot;:&quot;test-trace-id&quot;,&quot;userId&quot;:null,&quot;path&quot;:&quot;/test&quot;,&quot;message&quot;:&quot;D1 first: SELECT * FROM api_endpoints WHERE id = ?&quot;,&quot;type&quot;:&quot;data_operation&quot;,&quot;operation&quot;:&quot;d1&quot;,&quot;query&quot;:&quot;SELECT * FROM api_endpoints WHERE id = ?&quot;,&quot;latencyMs&quot;:0,&quot;cacheStatus&quot;:&quot;N/A&quot;}
{&quot;timestamp&quot;:&quot;2026-01-01T10:46:50.209Z&quot;,&quot;service&quot;:&quot;stockly-api-test&quot;,&quot;level&quot;:&quot;DEBUG&quot;,&quot;traceId&quot;:&quot;test-trace-id&quot;,&quot;userId&quot;:null,&quot;path&quot;:&quot;/test&quot;,&quot;message&quot;:&quot;D1 first: SELECT * FROM api_endpoints WHERE id = ?&quot;,&quot;type&quot;:&quot;data_operation&quot;,&quot;operation&quot;:&quot;d1&quot;,&quot;query&quot;:&quot;SELECT * FROM api_endpoints WHERE id = ?&quot;,&quot;latencyMs&quot;:0,&quot;cacheStatus&quot;:&quot;N/A&quot;}
{&quot;timestamp&quot;:&quot;2026-01-01T10:46:50.209Z&quot;,&quot;service&quot;:&quot;stockly-api-test&quot;,&quot;level&quot;:&quot;DEBUG&quot;,&quot;traceId&quot;:&quot;test-trace-id&quot;,&quot;userId&quot;:null,&quot;path&quot;:&quot;/test&quot;,&quot;message&quot;:&quot;D1 first: SELECT * FROM api_endpoints WHERE id = ?&quot;,&quot;type&quot;:&quot;data_operation&quot;,&quot;operation&quot;:&quot;d1&quot;,&quot;query&quot;:&quot;SELECT * FROM api_endpoints WHERE id = ?&quot;,&quot;latencyMs&quot;:0,&quot;cacheStatus&quot;:&quot;N/A&quot;}

            </system-out>
            <system-err>
{&quot;timestamp&quot;:&quot;2026-01-01T10:46:50.209Z&quot;,&quot;service&quot;:&quot;stockly-api-test&quot;,&quot;level&quot;:&quot;WARN&quot;,&quot;traceId&quot;:&quot;test-trace-id&quot;,&quot;userId&quot;:null,&quot;path&quot;:&quot;/test&quot;,&quot;message&quot;:&quot;Datalake adapter not available for endpoint profile, will fallback to direct FMP&quot;,&quot;type&quot;:&quot;general&quot;}
{&quot;timestamp&quot;:&quot;2026-01-01T10:46:50.209Z&quot;,&quot;service&quot;:&quot;stockly-api-test&quot;,&quot;level&quot;:&quot;WARN&quot;,&quot;traceId&quot;:&quot;test-trace-id&quot;,&quot;userId&quot;:null,&quot;path&quot;:&quot;/test&quot;,&quot;message&quot;:&quot;Datalake adapter not available for endpoint quote, will fallback to direct FMP&quot;,&quot;type&quot;:&quot;general&quot;}
{&quot;timestamp&quot;:&quot;2026-01-01T10:46:50.209Z&quot;,&quot;service&quot;:&quot;stockly-api-test&quot;,&quot;level&quot;:&quot;WARN&quot;,&quot;traceId&quot;:&quot;test-trace-id&quot;,&quot;userId&quot;:null,&quot;path&quot;:&quot;/test&quot;,&quot;message&quot;:&quot;Datalake adapter not available for endpoint historical-price-full, will fallback to direct FMP&quot;,&quot;type&quot;:&quot;general&quot;}
{&quot;timestamp&quot;:&quot;2026-01-01T10:46:50.209Z&quot;,&quot;service&quot;:&quot;stockly-api-test&quot;,&quot;level&quot;:&quot;WARN&quot;,&quot;traceId&quot;:&quot;test-trace-id&quot;,&quot;userId&quot;:null,&quot;path&quot;:&quot;/test&quot;,&quot;message&quot;:&quot;Datalake adapter not available for endpoint key-metrics, will fallback to direct FMP&quot;,&quot;type&quot;:&quot;general&quot;}
{&quot;timestamp&quot;:&quot;2026-01-01T10:46:50.209Z&quot;,&quot;service&quot;:&quot;stockly-api-test&quot;,&quot;level&quot;:&quot;WARN&quot;,&quot;traceId&quot;:&quot;test-trace-id&quot;,&quot;userId&quot;:null,&quot;path&quot;:&quot;/test&quot;,&quot;message&quot;:&quot;Datalake adapter not available for endpoint income-statement, will fallback to direct FMP&quot;,&quot;type&quot;:&quot;general&quot;}
{&quot;timestamp&quot;:&quot;2026-01-01T10:46:50.209Z&quot;,&quot;service&quot;:&quot;stockly-api-test&quot;,&quot;level&quot;:&quot;WARN&quot;,&quot;traceId&quot;:&quot;test-trace-id&quot;,&quot;userId&quot;:null,&quot;path&quot;:&quot;/test&quot;,&quot;message&quot;:&quot;Datalake adapter not available for endpoint stock-news, will fallback to direct FMP&quot;,&quot;type&quot;:&quot;general&quot;}
{&quot;timestamp&quot;:&quot;2026-01-01T10:46:50.209Z&quot;,&quot;service&quot;:&quot;stockly-api-test&quot;,&quot;level&quot;:&quot;WARN&quot;,&quot;traceId&quot;:&quot;test-trace-id&quot;,&quot;userId&quot;:null,&quot;path&quot;:&quot;/test&quot;,&quot;message&quot;:&quot;Datalake adapter not available for endpoint ratios, will fallback to direct FMP&quot;,&quot;type&quot;:&quot;general&quot;}

{&quot;timestamp&quot;:&quot;2026-01-01T10:46:50.211Z&quot;,&quot;service&quot;:&quot;stockly-api-test&quot;,&quot;level&quot;:&quot;WARN&quot;,&quot;traceId&quot;:&quot;test-trace-id&quot;,&quot;userId&quot;:null,&quot;path&quot;:&quot;/test&quot;,&quot;message&quot;:&quot;Failed to fetch news for AAPL:&quot;,&quot;type&quot;:&quot;general&quot;}

            </system-err>
        </testcase>
        <testcase classname="test/api-integration.spec.ts" name="API Integration - Get Stock Details &gt; getStockDetails handles missing beta field gracefully" time="0.008">
            <system-out>
{&quot;timestamp&quot;:&quot;2026-01-01T10:46:50.217Z&quot;,&quot;service&quot;:&quot;stockly-api-test&quot;,&quot;level&quot;:&quot;INFO&quot;,&quot;traceId&quot;:&quot;test-trace-id&quot;,&quot;userId&quot;:null,&quot;path&quot;:&quot;/test&quot;,&quot;message&quot;:&quot;Cache miss for stock details: AAPL, fetching...&quot;,&quot;type&quot;:&quot;general&quot;}

{&quot;timestamp&quot;:&quot;2026-01-01T10:46:50.217Z&quot;,&quot;service&quot;:&quot;stockly-api-test&quot;,&quot;level&quot;:&quot;DEBUG&quot;,&quot;traceId&quot;:&quot;test-trace-id&quot;,&quot;userId&quot;:null,&quot;path&quot;:&quot;/test&quot;,&quot;message&quot;:&quot;D1 first: SELECT * FROM api_endpoints WHERE id = ?&quot;,&quot;type&quot;:&quot;data_operation&quot;,&quot;operation&quot;:&quot;d1&quot;,&quot;query&quot;:&quot;SELECT * FROM api_endpoints WHERE id = ?&quot;,&quot;latencyMs&quot;:0,&quot;cacheStatus&quot;:&quot;N/A&quot;}
{&quot;timestamp&quot;:&quot;2026-01-01T10:46:50.217Z&quot;,&quot;service&quot;:&quot;stockly-api-test&quot;,&quot;level&quot;:&quot;DEBUG&quot;,&quot;traceId&quot;:&quot;test-trace-id&quot;,&quot;userId&quot;:null,&quot;path&quot;:&quot;/test&quot;,&quot;message&quot;:&quot;D1 first: SELECT * FROM api_endpoints WHERE id = ?&quot;,&quot;type&quot;:&quot;data_operation&quot;,&quot;operation&quot;:&quot;d1&quot;,&quot;query&quot;:&quot;SELECT * FROM api_endpoints WHERE id = ?&quot;,&quot;latencyMs&quot;:0,&quot;cacheStatus&quot;:&quot;N/A&quot;}
{&quot;timestamp&quot;:&quot;2026-01-01T10:46:50.217Z&quot;,&quot;service&quot;:&quot;stockly-api-test&quot;,&quot;level&quot;:&quot;DEBUG&quot;,&quot;traceId&quot;:&quot;test-trace-id&quot;,&quot;userId&quot;:null,&quot;path&quot;:&quot;/test&quot;,&quot;message&quot;:&quot;D1 first: SELECT * FROM api_endpoints WHERE id = ?&quot;,&quot;type&quot;:&quot;data_operation&quot;,&quot;operation&quot;:&quot;d1&quot;,&quot;query&quot;:&quot;SELECT * FROM api_endpoints WHERE id = ?&quot;,&quot;latencyMs&quot;:0,&quot;cacheStatus&quot;:&quot;N/A&quot;}
{&quot;timestamp&quot;:&quot;2026-01-01T10:46:50.217Z&quot;,&quot;service&quot;:&quot;stockly-api-test&quot;,&quot;level&quot;:&quot;DEBUG&quot;,&quot;traceId&quot;:&quot;test-trace-id&quot;,&quot;userId&quot;:null,&quot;path&quot;:&quot;/test&quot;,&quot;message&quot;:&quot;D1 first: SELECT * FROM api_endpoints WHERE id = ?&quot;,&quot;type&quot;:&quot;data_operation&quot;,&quot;operation&quot;:&quot;d1&quot;,&quot;query&quot;:&quot;SELECT * FROM api_endpoints WHERE id = ?&quot;,&quot;latencyMs&quot;:0,&quot;cacheStatus&quot;:&quot;N/A&quot;}
{&quot;timestamp&quot;:&quot;2026-01-01T10:46:50.217Z&quot;,&quot;service&quot;:&quot;stockly-api-test&quot;,&quot;level&quot;:&quot;DEBUG&quot;,&quot;traceId&quot;:&quot;test-trace-id&quot;,&quot;userId&quot;:null,&quot;path&quot;:&quot;/test&quot;,&quot;message&quot;:&quot;D1 first: SELECT * FROM api_endpoints WHERE id = ?&quot;,&quot;type&quot;:&quot;data_operation&quot;,&quot;operation&quot;:&quot;d1&quot;,&quot;query&quot;:&quot;SELECT * FROM api_endpoints WHERE id = ?&quot;,&quot;latencyMs&quot;:0,&quot;cacheStatus&quot;:&quot;N/A&quot;}
{&quot;timestamp&quot;:&quot;2026-01-01T10:46:50.217Z&quot;,&quot;service&quot;:&quot;stockly-api-test&quot;,&quot;level&quot;:&quot;DEBUG&quot;,&quot;traceId&quot;:&quot;test-trace-id&quot;,&quot;userId&quot;:null,&quot;path&quot;:&quot;/test&quot;,&quot;message&quot;:&quot;D1 first: SELECT * FROM api_endpoints WHERE id = ?&quot;,&quot;type&quot;:&quot;data_operation&quot;,&quot;operation&quot;:&quot;d1&quot;,&quot;query&quot;:&quot;SELECT * FROM api_endpoints WHERE id = ?&quot;,&quot;latencyMs&quot;:0,&quot;cacheStatus&quot;:&quot;N/A&quot;}
{&quot;timestamp&quot;:&quot;2026-01-01T10:46:50.217Z&quot;,&quot;service&quot;:&quot;stockly-api-test&quot;,&quot;level&quot;:&quot;DEBUG&quot;,&quot;traceId&quot;:&quot;test-trace-id&quot;,&quot;userId&quot;:null,&quot;path&quot;:&quot;/test&quot;,&quot;message&quot;:&quot;D1 first: SELECT * FROM api_endpoints WHERE id = ?&quot;,&quot;type&quot;:&quot;data_operation&quot;,&quot;operation&quot;:&quot;d1&quot;,&quot;query&quot;:&quot;SELECT * FROM api_endpoints WHERE id = ?&quot;,&quot;latencyMs&quot;:0,&quot;cacheStatus&quot;:&quot;N/A&quot;}

            </system-out>
            <system-err>
{&quot;timestamp&quot;:&quot;2026-01-01T10:46:50.217Z&quot;,&quot;service&quot;:&quot;stockly-api-test&quot;,&quot;level&quot;:&quot;WARN&quot;,&quot;traceId&quot;:&quot;test-trace-id&quot;,&quot;userId&quot;:null,&quot;path&quot;:&quot;/test&quot;,&quot;message&quot;:&quot;Datalake adapter not available for endpoint profile, will fallback to direct FMP&quot;,&quot;type&quot;:&quot;general&quot;}
{&quot;timestamp&quot;:&quot;2026-01-01T10:46:50.217Z&quot;,&quot;service&quot;:&quot;stockly-api-test&quot;,&quot;level&quot;:&quot;WARN&quot;,&quot;traceId&quot;:&quot;test-trace-id&quot;,&quot;userId&quot;:null,&quot;path&quot;:&quot;/test&quot;,&quot;message&quot;:&quot;Datalake adapter not available for endpoint quote, will fallback to direct FMP&quot;,&quot;type&quot;:&quot;general&quot;}
{&quot;timestamp&quot;:&quot;2026-01-01T10:46:50.217Z&quot;,&quot;service&quot;:&quot;stockly-api-test&quot;,&quot;level&quot;:&quot;WARN&quot;,&quot;traceId&quot;:&quot;test-trace-id&quot;,&quot;userId&quot;:null,&quot;path&quot;:&quot;/test&quot;,&quot;message&quot;:&quot;Datalake adapter not available for endpoint historical-price-full, will fallback to direct FMP&quot;,&quot;type&quot;:&quot;general&quot;}
{&quot;timestamp&quot;:&quot;2026-01-01T10:46:50.217Z&quot;,&quot;service&quot;:&quot;stockly-api-test&quot;,&quot;level&quot;:&quot;WARN&quot;,&quot;traceId&quot;:&quot;test-trace-id&quot;,&quot;userId&quot;:null,&quot;path&quot;:&quot;/test&quot;,&quot;message&quot;:&quot;Datalake adapter not available for endpoint key-metrics, will fallback to direct FMP&quot;,&quot;type&quot;:&quot;general&quot;}
{&quot;timestamp&quot;:&quot;2026-01-01T10:46:50.217Z&quot;,&quot;service&quot;:&quot;stockly-api-test&quot;,&quot;level&quot;:&quot;WARN&quot;,&quot;traceId&quot;:&quot;test-trace-id&quot;,&quot;userId&quot;:null,&quot;path&quot;:&quot;/test&quot;,&quot;message&quot;:&quot;Datalake adapter not available for endpoint income-statement, will fallback to direct FMP&quot;,&quot;type&quot;:&quot;general&quot;}
{&quot;timestamp&quot;:&quot;2026-01-01T10:46:50.217Z&quot;,&quot;service&quot;:&quot;stockly-api-test&quot;,&quot;level&quot;:&quot;WARN&quot;,&quot;traceId&quot;:&quot;test-trace-id&quot;,&quot;userId&quot;:null,&quot;path&quot;:&quot;/test&quot;,&quot;message&quot;:&quot;Datalake adapter not available for endpoint stock-news, will fallback to direct FMP&quot;,&quot;type&quot;:&quot;general&quot;}
{&quot;timestamp&quot;:&quot;2026-01-01T10:46:50.217Z&quot;,&quot;service&quot;:&quot;stockly-api-test&quot;,&quot;level&quot;:&quot;WARN&quot;,&quot;traceId&quot;:&quot;test-trace-id&quot;,&quot;userId&quot;:null,&quot;path&quot;:&quot;/test&quot;,&quot;message&quot;:&quot;Datalake adapter not available for endpoint ratios, will fallback to direct FMP&quot;,&quot;type&quot;:&quot;general&quot;}

{&quot;timestamp&quot;:&quot;2026-01-01T10:46:50.219Z&quot;,&quot;service&quot;:&quot;stockly-api-test&quot;,&quot;level&quot;:&quot;WARN&quot;,&quot;traceId&quot;:&quot;test-trace-id&quot;,&quot;userId&quot;:null,&quot;path&quot;:&quot;/test&quot;,&quot;message&quot;:&quot;Failed to fetch news for AAPL:&quot;,&quot;type&quot;:&quot;general&quot;}

            </system-err>
        </testcase>
    </testsuite>
    <testsuite name="test/api-schema-validation.spec.ts" timestamp="2026-01-01T10:46:50.825Z" hostname="sngvahmed" tests="16" failures="0" errors="0" skipped="0" time="1.156">
        <testcase classname="test/api-schema-validation.spec.ts" name="API Schema Validation - Health Check &gt; health endpoint returns valid HealthCheckResponse schema" time="0.007">
        </testcase>
        <testcase classname="test/api-schema-validation.spec.ts" name="API Schema Validation - Get Stock &gt; getStock returns valid StockQuoteResponse schema on success" time="0.026">
            <system-out>
{&quot;timestamp&quot;:&quot;2026-01-01T10:46:48.452Z&quot;,&quot;service&quot;:&quot;stockly-api-test&quot;,&quot;level&quot;:&quot;DEBUG&quot;,&quot;traceId&quot;:&quot;test-trace-id&quot;,&quot;userId&quot;:null,&quot;path&quot;:&quot;/test&quot;,&quot;message&quot;:&quot;D1 first: SELECT symbol, price, day_low, day_high, volume, timestamp\n       FROM stock_prices\n       WHERE symbol = ?\n       ORDER BY timestamp DESC\n       LIMIT 1&quot;,&quot;type&quot;:&quot;data_operation&quot;,&quot;operation&quot;:&quot;d1&quot;,&quot;query&quot;:&quot;SELECT symbol, price, day_low, day_high, volume, timestamp\n       FROM stock_prices\n       WHERE symbol = ?\n       ORDER BY timestamp DESC\n       LIMIT 1&quot;,&quot;latencyMs&quot;:0,&quot;cacheStatus&quot;:&quot;N/A&quot;}

{&quot;timestamp&quot;:&quot;2026-01-01T10:46:48.453Z&quot;,&quot;service&quot;:&quot;stockly-api-test&quot;,&quot;level&quot;:&quot;DEBUG&quot;,&quot;traceId&quot;:&quot;test-trace-id&quot;,&quot;userId&quot;:null,&quot;path&quot;:&quot;/test&quot;,&quot;message&quot;:&quot;D1 first: SELECT * FROM api_endpoints WHERE id = ?&quot;,&quot;type&quot;:&quot;data_operation&quot;,&quot;operation&quot;:&quot;d1&quot;,&quot;query&quot;:&quot;SELECT * FROM api_endpoints WHERE id = ?&quot;,&quot;latencyMs&quot;:0,&quot;cacheStatus&quot;:&quot;N/A&quot;}

{&quot;timestamp&quot;:&quot;2026-01-01T10:46:48.455Z&quot;,&quot;service&quot;:&quot;stockly-api-test&quot;,&quot;level&quot;:&quot;DEBUG&quot;,&quot;traceId&quot;:&quot;test-trace-id&quot;,&quot;userId&quot;:null,&quot;path&quot;:&quot;/test&quot;,&quot;message&quot;:&quot;D1 first: SELECT * FROM api_endpoints WHERE id = ?&quot;,&quot;type&quot;:&quot;data_operation&quot;,&quot;operation&quot;:&quot;d1&quot;,&quot;query&quot;:&quot;SELECT * FROM api_endpoints WHERE id = ?&quot;,&quot;latencyMs&quot;:0,&quot;cacheStatus&quot;:&quot;N/A&quot;}

{&quot;timestamp&quot;:&quot;2026-01-01T10:46:48.456Z&quot;,&quot;service&quot;:&quot;stockly-api-test&quot;,&quot;level&quot;:&quot;DEBUG&quot;,&quot;traceId&quot;:&quot;test-trace-id&quot;,&quot;userId&quot;:null,&quot;path&quot;:&quot;/test&quot;,&quot;message&quot;:&quot;D1 run: INSERT INTO stock_prices (symbol, price, day_low, day_high, volume, timestamp)\n       VALUES (?, ?, ?, ?, ?, ?)&quot;,&quot;type&quot;:&quot;data_operation&quot;,&quot;operation&quot;:&quot;d1&quot;,&quot;query&quot;:&quot;INSERT INTO stock_prices (symbol, price, day_low, day_high, volume, timestamp)\n       VALUES (?, ?, ?, ?, ?, ?)&quot;,&quot;latencyMs&quot;:0,&quot;cacheStatus&quot;:&quot;N/A&quot;}

            </system-out>
            <system-err>
{&quot;timestamp&quot;:&quot;2026-01-01T10:46:48.453Z&quot;,&quot;service&quot;:&quot;stockly-api-test&quot;,&quot;level&quot;:&quot;WARN&quot;,&quot;traceId&quot;:&quot;test-trace-id&quot;,&quot;userId&quot;:null,&quot;path&quot;:&quot;/test&quot;,&quot;message&quot;:&quot;Datalake adapter not available for endpoint quote, will fallback to direct FMP&quot;,&quot;type&quot;:&quot;general&quot;}

{&quot;timestamp&quot;:&quot;2026-01-01T10:46:48.455Z&quot;,&quot;service&quot;:&quot;stockly-api-test&quot;,&quot;level&quot;:&quot;WARN&quot;,&quot;traceId&quot;:&quot;test-trace-id&quot;,&quot;userId&quot;:null,&quot;path&quot;:&quot;/test&quot;,&quot;message&quot;:&quot;Datalake adapter not available for endpoint profile, will fallback to direct FMP&quot;,&quot;type&quot;:&quot;general&quot;}

            </system-err>
        </testcase>
        <testcase classname="test/api-schema-validation.spec.ts" name="API Schema Validation - Get Stock &gt; getStock returns valid ErrorResponse schema on error" time="0.006">
        </testcase>
        <testcase classname="test/api-schema-validation.spec.ts" name="API Schema Validation - Get Stocks &gt; getStocks returns valid StockQuotesResponse schema on success" time="0.013">
            <system-out>
{&quot;timestamp&quot;:&quot;2026-01-01T10:46:48.475Z&quot;,&quot;service&quot;:&quot;stockly-api-test&quot;,&quot;level&quot;:&quot;DEBUG&quot;,&quot;traceId&quot;:&quot;test-trace-id&quot;,&quot;userId&quot;:null,&quot;path&quot;:&quot;/test&quot;,&quot;message&quot;:&quot;D1 first: SELECT symbol, price, day_low, day_high, volume, timestamp\n       FROM stock_prices\n       WHERE symbol = ?\n       ORDER BY timestamp DESC\n       LIMIT 1&quot;,&quot;type&quot;:&quot;data_operation&quot;,&quot;operation&quot;:&quot;d1&quot;,&quot;query&quot;:&quot;SELECT symbol, price, day_low, day_high, volume, timestamp\n       FROM stock_prices\n       WHERE symbol = ?\n       ORDER BY timestamp DESC\n       LIMIT 1&quot;,&quot;latencyMs&quot;:0,&quot;cacheStatus&quot;:&quot;N/A&quot;}

{&quot;timestamp&quot;:&quot;2026-01-01T10:46:48.475Z&quot;,&quot;service&quot;:&quot;stockly-api-test&quot;,&quot;level&quot;:&quot;DEBUG&quot;,&quot;traceId&quot;:&quot;test-trace-id&quot;,&quot;userId&quot;:null,&quot;path&quot;:&quot;/test&quot;,&quot;message&quot;:&quot;D1 first: SELECT symbol, price, day_low, day_high, volume, timestamp\n       FROM stock_prices\n       WHERE symbol = ?\n       ORDER BY timestamp DESC\n       LIMIT 1&quot;,&quot;type&quot;:&quot;data_operation&quot;,&quot;operation&quot;:&quot;d1&quot;,&quot;query&quot;:&quot;SELECT symbol, price, day_low, day_high, volume, timestamp\n       FROM stock_prices\n       WHERE symbol = ?\n       ORDER BY timestamp DESC\n       LIMIT 1&quot;,&quot;latencyMs&quot;:0,&quot;cacheStatus&quot;:&quot;N/A&quot;}

{&quot;timestamp&quot;:&quot;2026-01-01T10:46:48.475Z&quot;,&quot;service&quot;:&quot;stockly-api-test&quot;,&quot;level&quot;:&quot;DEBUG&quot;,&quot;traceId&quot;:&quot;test-trace-id&quot;,&quot;userId&quot;:null,&quot;path&quot;:&quot;/test&quot;,&quot;message&quot;:&quot;D1 first: SELECT * FROM api_endpoints WHERE id = ?&quot;,&quot;type&quot;:&quot;data_operation&quot;,&quot;operation&quot;:&quot;d1&quot;,&quot;query&quot;:&quot;SELECT * FROM api_endpoints WHERE id = ?&quot;,&quot;latencyMs&quot;:0,&quot;cacheStatus&quot;:&quot;N/A&quot;}
{&quot;timestamp&quot;:&quot;2026-01-01T10:46:48.475Z&quot;,&quot;service&quot;:&quot;stockly-api-test&quot;,&quot;level&quot;:&quot;DEBUG&quot;,&quot;traceId&quot;:&quot;test-trace-id&quot;,&quot;userId&quot;:null,&quot;path&quot;:&quot;/test&quot;,&quot;message&quot;:&quot;D1 first: SELECT * FROM api_endpoints WHERE id = ?&quot;,&quot;type&quot;:&quot;data_operation&quot;,&quot;operation&quot;:&quot;d1&quot;,&quot;query&quot;:&quot;SELECT * FROM api_endpoints WHERE id = ?&quot;,&quot;latencyMs&quot;:0,&quot;cacheStatus&quot;:&quot;N/A&quot;}

{&quot;timestamp&quot;:&quot;2026-01-01T10:46:48.478Z&quot;,&quot;service&quot;:&quot;stockly-api-test&quot;,&quot;level&quot;:&quot;DEBUG&quot;,&quot;traceId&quot;:&quot;test-trace-id&quot;,&quot;userId&quot;:null,&quot;path&quot;:&quot;/test&quot;,&quot;message&quot;:&quot;D1 first: SELECT * FROM api_endpoints WHERE id = ?&quot;,&quot;type&quot;:&quot;data_operation&quot;,&quot;operation&quot;:&quot;d1&quot;,&quot;query&quot;:&quot;SELECT * FROM api_endpoints WHERE id = ?&quot;,&quot;latencyMs&quot;:0,&quot;cacheStatus&quot;:&quot;N/A&quot;}

{&quot;timestamp&quot;:&quot;2026-01-01T10:46:48.479Z&quot;,&quot;service&quot;:&quot;stockly-api-test&quot;,&quot;level&quot;:&quot;DEBUG&quot;,&quot;traceId&quot;:&quot;test-trace-id&quot;,&quot;userId&quot;:null,&quot;path&quot;:&quot;/test&quot;,&quot;message&quot;:&quot;D1 first: SELECT * FROM api_endpoints WHERE id = ?&quot;,&quot;type&quot;:&quot;data_operation&quot;,&quot;operation&quot;:&quot;d1&quot;,&quot;query&quot;:&quot;SELECT * FROM api_endpoints WHERE id = ?&quot;,&quot;latencyMs&quot;:0,&quot;cacheStatus&quot;:&quot;N/A&quot;}

{&quot;timestamp&quot;:&quot;2026-01-01T10:46:48.481Z&quot;,&quot;service&quot;:&quot;stockly-api-test&quot;,&quot;level&quot;:&quot;DEBUG&quot;,&quot;traceId&quot;:&quot;test-trace-id&quot;,&quot;userId&quot;:null,&quot;path&quot;:&quot;/test&quot;,&quot;message&quot;:&quot;D1 run: INSERT INTO stock_prices (symbol, price, day_low, day_high, volume, timestamp)\n       VALUES (?, ?, ?, ?, ?, ?)&quot;,&quot;type&quot;:&quot;data_operation&quot;,&quot;operation&quot;:&quot;d1&quot;,&quot;query&quot;:&quot;INSERT INTO stock_prices (symbol, price, day_low, day_high, volume, timestamp)\n       VALUES (?, ?, ?, ?, ?, ?)&quot;,&quot;latencyMs&quot;:0,&quot;cacheStatus&quot;:&quot;N/A&quot;}
{&quot;timestamp&quot;:&quot;2026-01-01T10:46:48.482Z&quot;,&quot;service&quot;:&quot;stockly-api-test&quot;,&quot;level&quot;:&quot;DEBUG&quot;,&quot;traceId&quot;:&quot;test-trace-id&quot;,&quot;userId&quot;:null,&quot;path&quot;:&quot;/test&quot;,&quot;message&quot;:&quot;D1 run: INSERT INTO stock_prices (symbol, price, day_low, day_high, volume, timestamp)\n       VALUES (?, ?, ?, ?, ?, ?)&quot;,&quot;type&quot;:&quot;data_operation&quot;,&quot;operation&quot;:&quot;d1&quot;,&quot;query&quot;:&quot;INSERT INTO stock_prices (symbol, price, day_low, day_high, volume, timestamp)\n       VALUES (?, ?, ?, ?, ?, ?)&quot;,&quot;latencyMs&quot;:1,&quot;cacheStatus&quot;:&quot;N/A&quot;}

            </system-out>
            <system-err>
{&quot;timestamp&quot;:&quot;2026-01-01T10:46:48.475Z&quot;,&quot;service&quot;:&quot;stockly-api-test&quot;,&quot;level&quot;:&quot;WARN&quot;,&quot;traceId&quot;:&quot;test-trace-id&quot;,&quot;userId&quot;:null,&quot;path&quot;:&quot;/test&quot;,&quot;message&quot;:&quot;Datalake adapter not available for endpoint quote, will fallback to direct FMP&quot;,&quot;type&quot;:&quot;general&quot;}
{&quot;timestamp&quot;:&quot;2026-01-01T10:46:48.475Z&quot;,&quot;service&quot;:&quot;stockly-api-test&quot;,&quot;level&quot;:&quot;WARN&quot;,&quot;traceId&quot;:&quot;test-trace-id&quot;,&quot;userId&quot;:null,&quot;path&quot;:&quot;/test&quot;,&quot;message&quot;:&quot;Datalake adapter not available for endpoint quote, will fallback to direct FMP&quot;,&quot;type&quot;:&quot;general&quot;}

{&quot;timestamp&quot;:&quot;2026-01-01T10:46:48.478Z&quot;,&quot;service&quot;:&quot;stockly-api-test&quot;,&quot;level&quot;:&quot;WARN&quot;,&quot;traceId&quot;:&quot;test-trace-id&quot;,&quot;userId&quot;:null,&quot;path&quot;:&quot;/test&quot;,&quot;message&quot;:&quot;Datalake adapter not available for endpoint profile, will fallback to direct FMP&quot;,&quot;type&quot;:&quot;general&quot;}

{&quot;timestamp&quot;:&quot;2026-01-01T10:46:48.479Z&quot;,&quot;service&quot;:&quot;stockly-api-test&quot;,&quot;level&quot;:&quot;WARN&quot;,&quot;traceId&quot;:&quot;test-trace-id&quot;,&quot;userId&quot;:null,&quot;path&quot;:&quot;/test&quot;,&quot;message&quot;:&quot;Datalake adapter not available for endpoint profile, will fallback to direct FMP&quot;,&quot;type&quot;:&quot;general&quot;}

{&quot;timestamp&quot;:&quot;2026-01-01T10:46:48.482Z&quot;,&quot;service&quot;:&quot;stockly-api-test&quot;,&quot;level&quot;:&quot;WARN&quot;,&quot;traceId&quot;:&quot;test-trace-id&quot;,&quot;userId&quot;:null,&quot;path&quot;:&quot;/test&quot;,&quot;message&quot;:&quot;Market cache refresh failed (non-blocking)&quot;,&quot;type&quot;:&quot;general&quot;}

            </system-err>
        </testcase>
        <testcase classname="test/api-schema-validation.spec.ts" name="API Schema Validation - Get Stocks &gt; getStocks returns valid ErrorResponse schema on error" time="0.003">
        </testcase>
        <testcase classname="test/api-schema-validation.spec.ts" name="API Schema Validation - Search Stock &gt; searchStock returns valid SearchStockResponse schema" time="0.01">
            <system-out>
{&quot;timestamp&quot;:&quot;2026-01-01T10:46:48.494Z&quot;,&quot;service&quot;:&quot;stockly-api-test&quot;,&quot;level&quot;:&quot;DEBUG&quot;,&quot;traceId&quot;:&quot;test-trace-id&quot;,&quot;userId&quot;:null,&quot;path&quot;:&quot;/test&quot;,&quot;message&quot;:&quot;D1 first: SELECT results, timestamp\n           FROM search_cache\n           WHERE query = ?\n           ORDER BY timestamp DESC\n           LIMIT 1&quot;,&quot;type&quot;:&quot;data_operation&quot;,&quot;operation&quot;:&quot;d1&quot;,&quot;query&quot;:&quot;SELECT results, timestamp\n           FROM search_cache\n           WHERE query = ?\n           ORDER BY timestamp DESC\n           LIMIT 1&quot;,&quot;latencyMs&quot;:0,&quot;cacheStatus&quot;:&quot;N/A&quot;}

{&quot;timestamp&quot;:&quot;2026-01-01T10:46:48.495Z&quot;,&quot;service&quot;:&quot;stockly-api-test&quot;,&quot;level&quot;:&quot;DEBUG&quot;,&quot;traceId&quot;:&quot;test-trace-id&quot;,&quot;userId&quot;:null,&quot;path&quot;:&quot;/test&quot;,&quot;message&quot;:&quot;D1 first: SELECT * FROM api_endpoints WHERE id = ?&quot;,&quot;type&quot;:&quot;data_operation&quot;,&quot;operation&quot;:&quot;d1&quot;,&quot;query&quot;:&quot;SELECT * FROM api_endpoints WHERE id = ?&quot;,&quot;latencyMs&quot;:0,&quot;cacheStatus&quot;:&quot;N/A&quot;}

{&quot;timestamp&quot;:&quot;2026-01-01T10:46:48.495Z&quot;,&quot;service&quot;:&quot;stockly-api-test&quot;,&quot;level&quot;:&quot;DEBUG&quot;,&quot;traceId&quot;:&quot;test-trace-id&quot;,&quot;userId&quot;:null,&quot;path&quot;:&quot;/test&quot;,&quot;message&quot;:&quot;D1 first: SELECT * FROM api_endpoints WHERE id = ?&quot;,&quot;type&quot;:&quot;data_operation&quot;,&quot;operation&quot;:&quot;d1&quot;,&quot;query&quot;:&quot;SELECT * FROM api_endpoints WHERE id = ?&quot;,&quot;latencyMs&quot;:0,&quot;cacheStatus&quot;:&quot;N/A&quot;}

{&quot;timestamp&quot;:&quot;2026-01-01T10:46:48.497Z&quot;,&quot;service&quot;:&quot;stockly-api-test&quot;,&quot;level&quot;:&quot;DEBUG&quot;,&quot;traceId&quot;:&quot;test-trace-id&quot;,&quot;userId&quot;:null,&quot;path&quot;:&quot;/test&quot;,&quot;message&quot;:&quot;D1 run: INSERT INTO search_cache (query, results, timestamp) VALUES (?, ?, ?)&quot;,&quot;type&quot;:&quot;data_operation&quot;,&quot;operation&quot;:&quot;d1&quot;,&quot;query&quot;:&quot;INSERT INTO search_cache (query, results, timestamp) VALUES (?, ?, ?)&quot;,&quot;latencyMs&quot;:0,&quot;cacheStatus&quot;:&quot;N/A&quot;}

            </system-out>
            <system-err>
{&quot;timestamp&quot;:&quot;2026-01-01T10:46:48.495Z&quot;,&quot;service&quot;:&quot;stockly-api-test&quot;,&quot;level&quot;:&quot;WARN&quot;,&quot;traceId&quot;:&quot;test-trace-id&quot;,&quot;userId&quot;:null,&quot;path&quot;:&quot;/test&quot;,&quot;message&quot;:&quot;Datalake adapter not available for endpoint search-name, will fallback to direct FMP&quot;,&quot;type&quot;:&quot;general&quot;}

{&quot;timestamp&quot;:&quot;2026-01-01T10:46:48.495Z&quot;,&quot;service&quot;:&quot;stockly-api-test&quot;,&quot;level&quot;:&quot;WARN&quot;,&quot;traceId&quot;:&quot;test-trace-id&quot;,&quot;userId&quot;:null,&quot;path&quot;:&quot;/test&quot;,&quot;message&quot;:&quot;Datalake adapter not available for endpoint search-symbol, will fallback to direct FMP&quot;,&quot;type&quot;:&quot;general&quot;}

{&quot;timestamp&quot;:&quot;2026-01-01T10:46:48.495Z&quot;,&quot;service&quot;:&quot;stockly-api-test&quot;,&quot;level&quot;:&quot;WARN&quot;,&quot;traceId&quot;:&quot;test-trace-id&quot;,&quot;userId&quot;:null,&quot;path&quot;:&quot;/test&quot;,&quot;message&quot;:&quot;Datalake adapters not available for search endpoints, falling back to direct FMP&quot;,&quot;type&quot;:&quot;general&quot;}

            </system-err>
        </testcase>
        <testcase classname="test/api-schema-validation.spec.ts" name="API Schema Validation - Get Historical &gt; getHistorical returns valid HistoricalPricesResponse schema" time="1.045">
            <system-out>
[getHistoricalPricesByDateRange] Querying database for AAPL from 2025-07-05 to 2026-01-01

[getHistoricalPricesByDateRange] Found 2 records for AAPL in date range 2025-07-05 to 2026-01-01

[fetchAndSaveHistoricalPrice] Starting fetch for AAPL from FMP API
[fetchAndSaveHistoricalPrice] Fetching from: https://financialmodelingprep.com/stable/historical-chart/30min?symbol=AAPL&amp;apikey=***&amp;from=2025-07-05&amp;to=2026-01-01

[fetchAndSaveHistoricalPrice] Received 254 1-hour OHLC records from FMP API
[fetchAndSaveHistoricalPrice] FMP API returned 254 records for AAPL
[fetchAndSaveHistoricalPrice] Sample record structure: {
  date: &apos;2025-12-31 15:30:00&apos;,
  hasOpen: true,
  hasHigh: true,
  hasLow: true,
  hasClose: true,
  hasPrice: false,
  keys: [ &apos;date&apos;, &apos;open&apos;, &apos;low&apos;, &apos;high&apos;, &apos;close&apos;, &apos;volume&apos; ]
}
Saved 20 daily candles (aggregated from 254 1-hour records) for AAPL with OHLC data

[getHistoricalPricesByDateRange] Querying database for AAPL from 2025-07-05 to 2026-01-01

[getHistoricalPricesByDateRange] Found 2 records for AAPL in date range 2025-07-05 to 2026-01-01

            </system-out>
            <system-err>
[fetchAndSaveHistoricalPrice] Insert with OHLC failed for AAPL on 2025-12-03, trying fallback without OHLC: env.stockly.prepare(...).bind(...).run is not a function
[fetchAndSaveHistoricalPrice] Failed to insert historical record for AAPL on 2025-12-03: env.stockly.prepare(...).bind(...).run is not a function
[fetchAndSaveHistoricalPrice] Insert with OHLC failed for AAPL on 2025-12-04, trying fallback without OHLC: env.stockly.prepare(...).bind(...).run is not a function
[fetchAndSaveHistoricalPrice] Failed to insert historical record for AAPL on 2025-12-04: env.stockly.prepare(...).bind(...).run is not a function
[fetchAndSaveHistoricalPrice] Insert with OHLC failed for AAPL on 2025-12-05, trying fallback without OHLC: env.stockly.prepare(...).bind(...).run is not a function
[fetchAndSaveHistoricalPrice] Failed to insert historical record for AAPL on 2025-12-05: env.stockly.prepare(...).bind(...).run is not a function
[fetchAndSaveHistoricalPrice] Insert with OHLC failed for AAPL on 2025-12-08, trying fallback without OHLC: env.stockly.prepare(...).bind(...).run is not a function
[fetchAndSaveHistoricalPrice] Failed to insert historical record for AAPL on 2025-12-08: env.stockly.prepare(...).bind(...).run is not a function
[fetchAndSaveHistoricalPrice] Insert with OHLC failed for AAPL on 2025-12-09, trying fallback without OHLC: env.stockly.prepare(...).bind(...).run is not a function
[fetchAndSaveHistoricalPrice] Failed to insert historical record for AAPL on 2025-12-09: env.stockly.prepare(...).bind(...).run is not a function
[fetchAndSaveHistoricalPrice] Insert with OHLC failed for AAPL on 2025-12-10, trying fallback without OHLC: env.stockly.prepare(...).bind(...).run is not a function
[fetchAndSaveHistoricalPrice] Failed to insert historical record for AAPL on 2025-12-10: env.stockly.prepare(...).bind(...).run is not a function
[fetchAndSaveHistoricalPrice] Insert with OHLC failed for AAPL on 2025-12-11, trying fallback without OHLC: env.stockly.prepare(...).bind(...).run is not a function
[fetchAndSaveHistoricalPrice] Failed to insert historical record for AAPL on 2025-12-11: env.stockly.prepare(...).bind(...).run is not a function
[fetchAndSaveHistoricalPrice] Insert with OHLC failed for AAPL on 2025-12-12, trying fallback without OHLC: env.stockly.prepare(...).bind(...).run is not a function
[fetchAndSaveHistoricalPrice] Failed to insert historical record for AAPL on 2025-12-12: env.stockly.prepare(...).bind(...).run is not a function
[fetchAndSaveHistoricalPrice] Insert with OHLC failed for AAPL on 2025-12-15, trying fallback without OHLC: env.stockly.prepare(...).bind(...).run is not a function
[fetchAndSaveHistoricalPrice] Failed to insert historical record for AAPL on 2025-12-15: env.stockly.prepare(...).bind(...).run is not a function
[fetchAndSaveHistoricalPrice] Insert with OHLC failed for AAPL on 2025-12-16, trying fallback without OHLC: env.stockly.prepare(...).bind(...).run is not a function
[fetchAndSaveHistoricalPrice] Failed to insert historical record for AAPL on 2025-12-16: env.stockly.prepare(...).bind(...).run is not a function
[fetchAndSaveHistoricalPrice] Insert with OHLC failed for AAPL on 2025-12-17, trying fallback without OHLC: env.stockly.prepare(...).bind(...).run is not a function
[fetchAndSaveHistoricalPrice] Failed to insert historical record for AAPL on 2025-12-17: env.stockly.prepare(...).bind(...).run is not a function
[fetchAndSaveHistoricalPrice] Insert with OHLC failed for AAPL on 2025-12-18, trying fallback without OHLC: env.stockly.prepare(...).bind(...).run is not a function
[fetchAndSaveHistoricalPrice] Failed to insert historical record for AAPL on 2025-12-18: env.stockly.prepare(...).bind(...).run is not a function
[fetchAndSaveHistoricalPrice] Insert with OHLC failed for AAPL on 2025-12-19, trying fallback without OHLC: env.stockly.prepare(...).bind(...).run is not a function
[fetchAndSaveHistoricalPrice] Failed to insert historical record for AAPL on 2025-12-19: env.stockly.prepare(...).bind(...).run is not a function
[fetchAndSaveHistoricalPrice] Insert with OHLC failed for AAPL on 2025-12-22, trying fallback without OHLC: env.stockly.prepare(...).bind(...).run is not a function
[fetchAndSaveHistoricalPrice] Failed to insert historical record for AAPL on 2025-12-22: env.stockly.prepare(...).bind(...).run is not a function
[fetchAndSaveHistoricalPrice] Insert with OHLC failed for AAPL on 2025-12-23, trying fallback without OHLC: env.stockly.prepare(...).bind(...).run is not a function
[fetchAndSaveHistoricalPrice] Failed to insert historical record for AAPL on 2025-12-23: env.stockly.prepare(...).bind(...).run is not a function
[fetchAndSaveHistoricalPrice] Insert with OHLC failed for AAPL on 2025-12-24, trying fallback without OHLC: env.stockly.prepare(...).bind(...).run is not a function
[fetchAndSaveHistoricalPrice] Failed to insert historical record for AAPL on 2025-12-24: env.stockly.prepare(...).bind(...).run is not a function
[fetchAndSaveHistoricalPrice] Insert with OHLC failed for AAPL on 2025-12-26, trying fallback without OHLC: env.stockly.prepare(...).bind(...).run is not a function
[fetchAndSaveHistoricalPrice] Failed to insert historical record for AAPL on 2025-12-26: env.stockly.prepare(...).bind(...).run is not a function
[fetchAndSaveHistoricalPrice] Insert with OHLC failed for AAPL on 2025-12-29, trying fallback without OHLC: env.stockly.prepare(...).bind(...).run is not a function
[fetchAndSaveHistoricalPrice] Failed to insert historical record for AAPL on 2025-12-29: env.stockly.prepare(...).bind(...).run is not a function
[fetchAndSaveHistoricalPrice] Insert with OHLC failed for AAPL on 2025-12-30, trying fallback without OHLC: env.stockly.prepare(...).bind(...).run is not a function
[fetchAndSaveHistoricalPrice] Failed to insert historical record for AAPL on 2025-12-30: env.stockly.prepare(...).bind(...).run is not a function
[fetchAndSaveHistoricalPrice] Insert with OHLC failed for AAPL on 2025-12-31, trying fallback without OHLC: env.stockly.prepare(...).bind(...).run is not a function
[fetchAndSaveHistoricalPrice] Failed to insert historical record for AAPL on 2025-12-31: env.stockly.prepare(...).bind(...).run is not a function

            </system-err>
        </testcase>
        <testcase classname="test/api-schema-validation.spec.ts" name="API Schema Validation - Get Historical &gt; getHistorical returns valid ErrorResponse schema on error" time="0.003">
        </testcase>
        <testcase classname="test/api-schema-validation.spec.ts" name="API Schema Validation - Alerts &gt; listAlerts returns valid AlertsListResponse schema" time="0.002">
        </testcase>
        <testcase classname="test/api-schema-validation.spec.ts" name="API Schema Validation - Alerts &gt; createAlert accepts valid CreateAlertRequest schema" time="0.003">
        </testcase>
        <testcase classname="test/api-schema-validation.spec.ts" name="API Schema Validation - Alerts &gt; updateAlert accepts valid UpdateAlertRequest schema" time="0.002">
        </testcase>
        <testcase classname="test/api-schema-validation.spec.ts" name="API Schema Validation - Alerts &gt; getAlert returns valid Alert schema" time="0.003">
        </testcase>
        <testcase classname="test/api-schema-validation.spec.ts" name="API Schema Validation - Input Validation &gt; rejects invalid CreateAlertRequest" time="0.002">
        </testcase>
        <testcase classname="test/api-schema-validation.spec.ts" name="API Schema Validation - Input Validation &gt; accepts valid CreateAlertRequest with optional fields" time="0.002">
        </testcase>
        <testcase classname="test/api-schema-validation.spec.ts" name="API Schema Validation - Input Validation &gt; rejects invalid UpdateAlertRequest" time="0.001">
        </testcase>
        <testcase classname="test/api-schema-validation.spec.ts" name="API Schema Validation - Input Validation &gt; accepts partial UpdateAlertRequest" time="0.002">
        </testcase>
    </testsuite>
    <testsuite name="test/cache.spec.ts" timestamp="2026-01-01T10:46:50.829Z" hostname="sngvahmed" tests="2" failures="0" errors="0" skipped="0" time="0.231">
        <testcase classname="test/cache.spec.ts" name="cache helpers &gt; returns cached entries while TTL is valid" time="0.043">
        </testcase>
        <testcase classname="test/cache.spec.ts" name="cache helpers &gt; expires entries once TTL elapses" time="0.094">
        </testcase>
    </testsuite>
    <testsuite name="test/config.spec.ts" timestamp="2026-01-01T10:46:50.829Z" hostname="sngvahmed" tests="13" failures="0" errors="0" skipped="0" time="1.478">
        <testcase classname="test/config.spec.ts" name="Config System &gt; getConfig &gt; returns default config when KV is not available" time="0.054">
            <system-err>
alertsKv not available, using default config

            </system-err>
        </testcase>
        <testcase classname="test/config.spec.ts" name="Config System &gt; getConfig &gt; returns default config when no stored config exists" time="0.147">
        </testcase>
        <testcase classname="test/config.spec.ts" name="Config System &gt; getConfig &gt; returns stored config when available" time="0.126">
        </testcase>
        <testcase classname="test/config.spec.ts" name="Config System &gt; getConfig &gt; merges partial stored config with defaults" time="0.089">
        </testcase>
        <testcase classname="test/config.spec.ts" name="Config System &gt; updateConfig &gt; updates config with new values" time="0.105">
        </testcase>
        <testcase classname="test/config.spec.ts" name="Config System &gt; updateConfig &gt; merges nested objects correctly" time="0.095">
        </testcase>
        <testcase classname="test/config.spec.ts" name="Config System &gt; simulateProviderFailureEndpoint &gt; enables simulation mode" time="0.093">
        </testcase>
        <testcase classname="test/config.spec.ts" name="Config System &gt; simulateProviderFailureEndpoint &gt; persists the config change" time="0.079">
        </testcase>
        <testcase classname="test/config.spec.ts" name="Config System &gt; disableProviderFailureEndpoint &gt; disables simulation mode" time="0.083">
        </testcase>
        <testcase classname="test/config.spec.ts" name="Config System &gt; disableProviderFailureEndpoint &gt; persists the config change" time="0.036">
        </testcase>
        <testcase classname="test/config.spec.ts" name="Config System &gt; Error Handling &gt; getConfig catches errors and returns default" time="0.033">
        </testcase>
        <testcase classname="test/config.spec.ts" name="Config System &gt; Error Handling &gt; updateConfig throws on error" time="0.058">
        </testcase>
        <testcase classname="test/config.spec.ts" name="Config System &gt; Error Handling &gt; updateConfig warns when KV is missing" time="0.034">
        </testcase>
    </testsuite>
    <testsuite name="test/devices.spec.ts" timestamp="2026-01-01T10:46:50.831Z" hostname="sngvahmed" tests="9" failures="0" errors="0" skipped="0" time="0.491">
        <testcase classname="test/devices.spec.ts" name="Devices API &gt; getAllDevices &gt; should return list of devices" time="0.042">
        </testcase>
        <testcase classname="test/devices.spec.ts" name="Devices API &gt; getAllDevices &gt; should return empty array when no devices" time="0.029">
        </testcase>
        <testcase classname="test/devices.spec.ts" name="Devices API &gt; getAllDevices &gt; should handle database errors" time="0.058">
            <system-err>
{&quot;timestamp&quot;:&quot;2026-01-01T10:46:47.495Z&quot;,&quot;service&quot;:&quot;stockly-api-test&quot;,&quot;level&quot;:&quot;ERROR&quot;,&quot;traceId&quot;:&quot;test-trace-id&quot;,&quot;userId&quot;:null,&quot;path&quot;:&quot;/test&quot;,&quot;message&quot;:&quot;Failed to get devices&quot;,&quot;type&quot;:&quot;general&quot;,&quot;username&quot;:null,&quot;error&quot;:{&quot;name&quot;:&quot;Error&quot;,&quot;message&quot;:&quot;Database error&quot;,&quot;stack&quot;:&quot;Error: Database error\n    at Object.&lt;anonymous&gt; (/home/sngvahmed/workspace/stockly/api/test/devices.spec.ts:158:42)\n    at Object.mockCall (home/sngvahmed/workspace/stockly/node_modules/@vitest/spy/dist/index.js:96:15)\n    at Object.spy [as prepare] (home/sngvahmed/workspace/stockly/node_modules/tinyspy/dist/index.js:47:80)\n    at Module.getAllDevices (/home/sngvahmed/workspace/stockly/api/src/api/devices.ts:69:10)\n    at /home/sngvahmed/workspace/stockly/api/test/devices.spec.ts:163:24\n    at home/sngvahmed/workspace/stockly/node_modules/@vitest/runner/dist/chunk-hooks.js:752:20&quot;}}

            </system-err>
        </testcase>
        <testcase classname="test/devices.spec.ts" name="Devices API &gt; sendTestNotification &gt; should send test notification successfully" time="0.033">
            <system-out>
{&quot;timestamp&quot;:&quot;2026-01-01T10:46:47.562Z&quot;,&quot;service&quot;:&quot;stockly-api-test&quot;,&quot;level&quot;:&quot;INFO&quot;,&quot;traceId&quot;:&quot;test-trace-id&quot;,&quot;userId&quot;:&quot;user-1&quot;,&quot;path&quot;:&quot;/test&quot;,&quot;message&quot;:&quot;Test notification sent successfully&quot;,&quot;type&quot;:&quot;general&quot;}

            </system-out>
        </testcase>
        <testcase classname="test/devices.spec.ts" name="Devices API &gt; sendTestNotification &gt; should use default message when no custom message provided" time="0.042">
            <system-out>
{&quot;timestamp&quot;:&quot;2026-01-01T10:46:47.601Z&quot;,&quot;service&quot;:&quot;stockly-api-test&quot;,&quot;level&quot;:&quot;INFO&quot;,&quot;traceId&quot;:&quot;test-trace-id&quot;,&quot;userId&quot;:&quot;user-1&quot;,&quot;path&quot;:&quot;/test&quot;,&quot;message&quot;:&quot;Test notification sent successfully&quot;,&quot;type&quot;:&quot;general&quot;}

            </system-out>
        </testcase>
        <testcase classname="test/devices.spec.ts" name="Devices API &gt; sendTestNotification &gt; should return 404 when device not found" time="0.037">
        </testcase>
        <testcase classname="test/devices.spec.ts" name="Devices API &gt; sendTestNotification &gt; should return 400 when userId is missing" time="0.053">
        </testcase>
        <testcase classname="test/devices.spec.ts" name="Devices API &gt; sendTestNotification &gt; should return 405 for non-POST methods" time="0.041">
        </testcase>
        <testcase classname="test/devices.spec.ts" name="Devices API &gt; sendTestNotification &gt; should handle FCM send failures" time="0.033">
            <system-err>
{&quot;timestamp&quot;:&quot;2026-01-01T10:46:47.770Z&quot;,&quot;service&quot;:&quot;stockly-api-test&quot;,&quot;level&quot;:&quot;ERROR&quot;,&quot;traceId&quot;:&quot;test-trace-id&quot;,&quot;userId&quot;:null,&quot;path&quot;:&quot;/test&quot;,&quot;message&quot;:&quot;FCM push notification failed&quot;,&quot;type&quot;:&quot;fcm_error&quot;,&quot;fcmErrorCode&quot;:&quot;400&quot;,&quot;fcmErrorType&quot;:&quot;INVALID_ARGUMENT&quot;,&quot;isPermanent&quot;:true,&quot;shouldCleanupToken&quot;:true,&quot;requestPayload&quot;:{&quot;token&quot;:&quot;invalid-token...&quot;,&quot;title&quot;:&quot;Test Notification&quot;,&quot;body&quot;:&quot;This is a test notification from Stockly! 🚀&quot;,&quot;dataKeys&quot;:[&quot;type&quot;,&quot;timestamp&quot;]},&quot;errorMessage&quot;:&quot;Invalid token&quot;}

            </system-err>
        </testcase>
    </testsuite>
    <testsuite name="test/index.spec.ts" timestamp="2026-01-01T10:46:50.833Z" hostname="sngvahmed" tests="53" failures="0" errors="0" skipped="1" time="0.152">
        <testcase classname="test/index.spec.ts" name="worker router &gt; delegates /get-stock" time="0.005">
        </testcase>
        <testcase classname="test/index.spec.ts" name="worker router &gt; delegates /get-stocks" time="0.003">
        </testcase>
        <testcase classname="test/index.spec.ts" name="worker router &gt; delegates /get-news" time="0.003">
        </testcase>
        <testcase classname="test/index.spec.ts" name="worker router &gt; delegates /news/general" time="0.003">
        </testcase>
        <testcase classname="test/index.spec.ts" name="worker router &gt; delegates /news/favorites" time="0.002">
        </testcase>
        <testcase classname="test/index.spec.ts" name="worker router &gt; delegates /get-stock-news" time="0.002">
        </testcase>
        <testcase classname="test/index.spec.ts" name="worker router &gt; delegates /search-stock" time="0.003">
        </testcase>
        <testcase classname="test/index.spec.ts" name="worker router &gt; delegates /get-historical" time="0.004">
        </testcase>
        <testcase classname="test/index.spec.ts" name="worker router &gt; delegates /get-historical-intraday" time="0.003">
        </testcase>
        <testcase classname="test/index.spec.ts" name="worker router &gt; delegates /health" time="0.002">
        </testcase>
        <testcase classname="test/index.spec.ts" name="worker router &gt; delegates /openapi.json" time="0.004">
        </testcase>
        <testcase classname="test/index.spec.ts" name="worker router &gt; delegates /alerts prefix" time="0.002">
        </testcase>
        <testcase classname="test/index.spec.ts" name="worker router &gt; delegates /push-token GET" time="0.002">
        </testcase>
        <testcase classname="test/index.spec.ts" name="worker router &gt; delegates /push-token POST" time="0.003">
        </testcase>
        <testcase classname="test/index.spec.ts" name="worker router &gt; delegates /preferences GET" time="0.002">
        </testcase>
        <testcase classname="test/index.spec.ts" name="worker router &gt; delegates /preferences PUT" time="0.002">
        </testcase>
        <testcase classname="test/index.spec.ts" name="worker router &gt; delegates /settings GET" time="0.003">
        </testcase>
        <testcase classname="test/index.spec.ts" name="worker router &gt; delegates /settings PUT" time="0.002">
        </testcase>
        <testcase classname="test/index.spec.ts" name="worker router &gt; delegates /users/preferences/update" time="0.001">
        </testcase>
        <testcase classname="test/index.spec.ts" name="worker router &gt; delegates /news/archive GET" time="0.002">
        </testcase>
        <testcase classname="test/index.spec.ts" name="worker router &gt; delegates /news/archive/:id POST" time="0.004">
        </testcase>
        <testcase classname="test/index.spec.ts" name="worker router &gt; delegates /favorite-stocks GET" time="0.001">
        </testcase>
        <testcase classname="test/index.spec.ts" name="worker router &gt; delegates /favorite-stocks POST" time="0.002">
        </testcase>
        <testcase classname="test/index.spec.ts" name="worker router &gt; delegates /favorite-stocks ALL (moved to /v1/api/users/all)" time="0">
            <skipped/>
        </testcase>
        <testcase classname="test/index.spec.ts" name="worker router &gt; delegates /users/all" time="0.003">
        </testcase>
        <testcase classname="test/index.spec.ts" name="worker router &gt; delegates /favorite-stocks/:symbol DELETE" time="0.003">
        </testcase>
        <testcase classname="test/index.spec.ts" name="worker router &gt; delegates /notifications/recent" time="0.003">
        </testcase>
        <testcase classname="test/index.spec.ts" name="worker router &gt; delegates /notifications/failed" time="0.002">
        </testcase>
        <testcase classname="test/index.spec.ts" name="worker router &gt; delegates /notifications/retry/:id" time="0.002">
        </testcase>
        <testcase classname="test/index.spec.ts" name="worker router &gt; delegates /devices GET" time="0.002">
        </testcase>
        <testcase classname="test/index.spec.ts" name="worker router &gt; delegates /devices DELETE" time="0.003">
        </testcase>
        <testcase classname="test/index.spec.ts" name="worker router &gt; delegates /devices/test POST" time="0.002">
        </testcase>
        <testcase classname="test/index.spec.ts" name="worker router &gt; delegates /config/get" time="0.002">
        </testcase>
        <testcase classname="test/index.spec.ts" name="worker router &gt; delegates /config/update" time="0.002">
        </testcase>
        <testcase classname="test/index.spec.ts" name="worker router &gt; delegates /simulate-provider-failure" time="0.002">
        </testcase>
        <testcase classname="test/index.spec.ts" name="worker router &gt; delegates /disable-provider-failure" time="0.003">
        </testcase>
        <testcase classname="test/index.spec.ts" name="worker router &gt; delegates /auth/google" time="0.005">
        </testcase>
        <testcase classname="test/index.spec.ts" name="worker router &gt; delegates /auth/username/check" time="0.003">
        </testcase>
        <testcase classname="test/index.spec.ts" name="worker router &gt; delegates /auth/username" time="0.004">
        </testcase>
        <testcase classname="test/index.spec.ts" name="worker router &gt; delegates /auth/refresh" time="0.002">
        </testcase>
        <testcase classname="test/index.spec.ts" name="worker router &gt; delegates /auth/me" time="0.002">
        </testcase>
        <testcase classname="test/index.spec.ts" name="worker router &gt; delegates /auth/logout" time="0.002">
        </testcase>
        <testcase classname="test/index.spec.ts" name="worker router &gt; returns 404 for unknown routes" time="0.004">
            <system-err>
{&quot;timestamp&quot;:&quot;2026-01-01T10:46:48.784Z&quot;,&quot;service&quot;:&quot;stockly-api&quot;,&quot;level&quot;:&quot;WARN&quot;,&quot;traceId&quot;:&quot;26f4c5fa-c72f-47fb-aa5f-2e8025bf7ed8&quot;,&quot;userId&quot;:null,&quot;path&quot;:&quot;/unknown&quot;,&quot;message&quot;:&quot;Route not found&quot;,&quot;type&quot;:&quot;general&quot;,&quot;pathname&quot;:&quot;/unknown&quot;,&quot;method&quot;:&quot;GET&quot;}

            </system-err>
        </testcase>
        <testcase classname="test/index.spec.ts" name="worker router &gt; handles CORS OPTIONS request" time="0.003">
        </testcase>
        <testcase classname="test/index.spec.ts" name="worker router &gt; Scheduled events &gt; runs alerts cron on correct schedule" time="0.003">
        </testcase>
        <testcase classname="test/index.spec.ts" name="worker router &gt; Scheduled events &gt; runs news alerts cron on correct schedule" time="0.005">
            <system-out>
{&quot;timestamp&quot;:&quot;2026-01-01T10:46:48.794Z&quot;,&quot;service&quot;:&quot;stockly-api&quot;,&quot;level&quot;:&quot;INFO&quot;,&quot;traceId&quot;:&quot;senate-cron-1767264408794&quot;,&quot;userId&quot;:null,&quot;path&quot;:&quot;/cron/senate-trading&quot;,&quot;message&quot;:&quot;Starting senate trading cron job&quot;,&quot;type&quot;:&quot;general&quot;}
{&quot;timestamp&quot;:&quot;2026-01-01T10:46:48.794Z&quot;,&quot;service&quot;:&quot;stockly-api&quot;,&quot;level&quot;:&quot;INFO&quot;,&quot;traceId&quot;:&quot;senate-cron-1767264408794&quot;,&quot;userId&quot;:null,&quot;path&quot;:&quot;/cron/senate-trading&quot;,&quot;message&quot;:&quot;Starting senate trades sync from FMP API&quot;,&quot;type&quot;:&quot;general&quot;}
[fetchSenateTradingFromFmp] Fetching from: https://financialmodelingprep.com/stable/senate-latest?page=0&amp;limit=100&amp;apikey=***
{&quot;timestamp&quot;:&quot;2026-01-01T10:46:48.795Z&quot;,&quot;service&quot;:&quot;stockly-api&quot;,&quot;level&quot;:&quot;INFO&quot;,&quot;traceId&quot;:&quot;house-cron-1767264408795&quot;,&quot;userId&quot;:null,&quot;path&quot;:&quot;/cron/house-trading&quot;,&quot;message&quot;:&quot;Starting house trading cron job&quot;,&quot;type&quot;:&quot;general&quot;}
{&quot;timestamp&quot;:&quot;2026-01-01T10:46:48.795Z&quot;,&quot;service&quot;:&quot;stockly-api&quot;,&quot;level&quot;:&quot;INFO&quot;,&quot;traceId&quot;:&quot;house-cron-1767264408795&quot;,&quot;userId&quot;:null,&quot;path&quot;:&quot;/cron/house-trading&quot;,&quot;message&quot;:&quot;Starting house trades sync from FMP API&quot;,&quot;type&quot;:&quot;general&quot;}
[fetchHouseTradingFromFmp] Fetching from: https://financialmodelingprep.com/stable/house-latest?page=0&amp;limit=100&amp;apikey=***

            </system-out>
        </testcase>
        <testcase classname="test/index.spec.ts" name="worker router &gt; Scheduled events &gt; skips cron jobs when outside working hours" time="0.003">
            <system-out>
{&quot;timestamp&quot;:&quot;2026-01-01T10:46:48.799Z&quot;,&quot;service&quot;:&quot;stockly-api&quot;,&quot;level&quot;:&quot;INFO&quot;,&quot;traceId&quot;:&quot;cron-1767264408799&quot;,&quot;userId&quot;:null,&quot;path&quot;:&quot;/cron&quot;,&quot;message&quot;:&quot;Skipping cron job - outside working hours&quot;,&quot;type&quot;:&quot;general&quot;,&quot;cron&quot;:&quot;*/5 * * * *&quot;,&quot;workingHours&quot;:{&quot;enabled&quot;:true,&quot;startHour&quot;:10,&quot;endHour&quot;:23,&quot;timezone&quot;:&quot;Europe/Madrid&quot;}}

            </system-out>
        </testcase>
        <testcase classname="test/index.spec.ts" name="worker router &gt; Scheduled events &gt; runs cron jobs when within working hours" time="0.002">
        </testcase>
        <testcase classname="test/index.spec.ts" name="worker router &gt; Scheduled events &gt; handles unhandled errors" time="0.007">
            <system-err>
{&quot;timestamp&quot;:&quot;2026-01-01T10:46:48.805Z&quot;,&quot;service&quot;:&quot;stockly-api&quot;,&quot;level&quot;:&quot;ERROR&quot;,&quot;traceId&quot;:&quot;aa2a355a-9c66-431a-a487-5469817fa45d&quot;,&quot;userId&quot;:null,&quot;path&quot;:&quot;/v1/api/health&quot;,&quot;message&quot;:&quot;Unhandled error in fetch handler&quot;,&quot;type&quot;:&quot;general&quot;,&quot;pathname&quot;:&quot;/v1/api/health&quot;,&quot;method&quot;:&quot;GET&quot;,&quot;error&quot;:{&quot;name&quot;:&quot;Error&quot;,&quot;message&quot;:&quot;Test error&quot;,&quot;stack&quot;:&quot;Error: Test error\n    at /home/sngvahmed/workspace/stockly/api/test/index.spec.ts:466:15\n    at mockCall (home/sngvahmed/workspace/stockly/node_modules/@vitest/spy/dist/index.js:96:15)\n    at spy (home/sngvahmed/workspace/stockly/node_modules/tinyspy/dist/index.js:47:80)\n    at Object.fetch (/home/sngvahmed/workspace/stockly/api/src/index.ts:199:20)\n    at /home/sngvahmed/workspace/stockly/api/test/index.spec.ts:469:37\n    at home/sngvahmed/workspace/stockly/node_modules/@vitest/runner/dist/chunk-hooks.js:155:11\n    at home/sngvahmed/workspace/stockly/node_modules/@vitest/runner/dist/chunk-hooks.js:752:26\n    at home/sngvahmed/workspace/stockly/node_modules/@vitest/runner/dist/chunk-hooks.js:1897:20\n    at new Promise (&lt;anonymous&gt;)\n    at runWithTimeout (home/sngvahmed/workspace/stockly/node_modules/@vitest/runner/dist/chunk-hooks.js:1863:10)&quot;}}

            </system-err>
        </testcase>
        <testcase classname="test/index.spec.ts" name="worker router &gt; Scheduled events &gt; ships logs if LOKI_URL is present" time="0.002">
        </testcase>
        <testcase classname="test/index.spec.ts" name="worker router &gt; Scheduled events &gt; handles CORS requests with specific headers" time="0.002">
        </testcase>
        <testcase classname="test/index.spec.ts" name="worker router &gt; Scheduled events &gt; ships logs on OPTIONS request if LOKI_URL is present" time="0.003">
        </testcase>
        <testcase classname="test/index.spec.ts" name="worker router &gt; Scheduled events &gt; returns 405 for invalid method on retry notification" time="0.002">
        </testcase>
    </testsuite>
    <testsuite name="test/util.spec.ts" timestamp="2026-01-01T10:46:50.840Z" hostname="sngvahmed" tests="7" failures="0" errors="0" skipped="0" time="0.822">
        <testcase classname="test/util.spec.ts" name="json utility &gt; serializes payload into a JSON Response" time="0.051">
        </testcase>
        <testcase classname="test/util.spec.ts" name="json utility &gt; allows overriding the status code" time="0.086">
        </testcase>
        <testcase classname="test/util.spec.ts" name="CORS headers &gt; returns wildcard for unknown origin" time="0.092">
        </testcase>
        <testcase classname="test/util.spec.ts" name="CORS headers &gt; returns specific origin for allowed domain" time="0.041">
        </testcase>
        <testcase classname="test/util.spec.ts" name="CORS headers &gt; allows localhost" time="0.103">
        </testcase>
        <testcase classname="test/util.spec.ts" name="CORS headers &gt; allows localhost with random port" time="0.126">
        </testcase>
        <testcase classname="test/util.spec.ts" name="CORS headers &gt; falls back to * if origin not allowed" time="0.117">
        </testcase>
    </testsuite>
    <testsuite name="test/alerts/state-cache.spec.ts" timestamp="2026-01-01T10:46:50.841Z" hostname="sngvahmed" tests="19" failures="0" errors="0" skipped="0" time="2.155">
        <testcase classname="test/alerts/state-cache.spec.ts" name="Alert State Cache &gt; getCachedState &gt; should return null when state not cached" time="0.033">
        </testcase>
        <testcase classname="test/alerts/state-cache.spec.ts" name="Alert State Cache &gt; getCachedState &gt; should return cached state" time="0.095">
            <system-out>
[KV Cache] Queued state update for alert alert-1 (1 pending writes)

            </system-out>
        </testcase>
        <testcase classname="test/alerts/state-cache.spec.ts" name="Alert State Cache &gt; updateStateInCache &gt; should update state in cache" time="0.096">
            <system-out>
[KV Cache] Queued state update for alert alert-1 (1 pending writes)

            </system-out>
        </testcase>
        <testcase classname="test/alerts/state-cache.spec.ts" name="Alert State Cache &gt; updateStateInCache &gt; should queue state for KV write" time="0.098">
            <system-out>
[KV Cache] Queued state update for alert alert-1 (1 pending writes)

            </system-out>
        </testcase>
        <testcase classname="test/alerts/state-cache.spec.ts" name="Alert State Cache &gt; loadAllStatesFromKV &gt; should load states from KV" time="0.142">
            <system-out>
[KV Cache] Loading 2 alert states from KV...

[KV Cache] Loaded 2 states from KV

            </system-out>
        </testcase>
        <testcase classname="test/alerts/state-cache.spec.ts" name="Alert State Cache &gt; loadAllStatesFromKV &gt; should cache loaded states in memory" time="0.13">
            <system-out>
[KV Cache] Loading 1 alert states from KV...

[KV Cache] Loaded 1 states from KV

            </system-out>
        </testcase>
        <testcase classname="test/alerts/state-cache.spec.ts" name="Alert State Cache &gt; loadAllStatesFromKV &gt; should return cached data if cache is fresh" time="0.213">
            <system-out>
[KV Cache] Loading 1 alert states from KV...

[KV Cache] Loaded 1 states from KV

            </system-out>
        </testcase>
        <testcase classname="test/alerts/state-cache.spec.ts" name="Alert State Cache &gt; loadAllStatesFromKV &gt; should handle missing states" time="0.091">
            <system-out>
[KV Cache] Loading 2 alert states from KV...

[KV Cache] Loaded 1 states from KV

            </system-out>
        </testcase>
        <testcase classname="test/alerts/state-cache.spec.ts" name="Alert State Cache &gt; loadAllStatesFromKV &gt; should handle invalid JSON" time="0.108">
            <system-out>
[KV Cache] Loading 1 alert states from KV...

[KV Cache] Loaded 0 states from KV

            </system-out>
            <system-err>
[KV Cache] Failed to load state for alert alert-1: SyntaxError: Unexpected token &apos;i&apos;, &quot;invalid json&quot; is not valid JSON
    at JSON.parse (&lt;anonymous&gt;)
    at /home/sngvahmed/workspace/stockly/api/src/alerts/state-cache.ts:54:29
    at async Promise.all (index 0)
    at loadAllStatesFromKV (/home/sngvahmed/workspace/stockly/api/src/alerts/state-cache.ts:64:19)
    at /home/sngvahmed/workspace/stockly/api/test/alerts/state-cache.spec.ts:158:22
    at home/sngvahmed/workspace/stockly/node_modules/@vitest/runner/dist/chunk-hooks.js:752:20

            </system-err>
        </testcase>
        <testcase classname="test/alerts/state-cache.spec.ts" name="Alert State Cache &gt; loadAllStatesFromKV &gt; should handle KV read errors" time="0.102">
            <system-out>
[KV Cache] Loading 1 alert states from KV...

[KV Cache] Loaded 0 states from KV

            </system-out>
            <system-err>
[KV Cache] Failed to load state for alert alert-1: Error: KV error
    at /home/sngvahmed/workspace/stockly/api/test/alerts/state-cache.spec.ts:166:47
    at home/sngvahmed/workspace/stockly/node_modules/@vitest/runner/dist/chunk-hooks.js:155:11
    at home/sngvahmed/workspace/stockly/node_modules/@vitest/runner/dist/chunk-hooks.js:752:26
    at home/sngvahmed/workspace/stockly/node_modules/@vitest/runner/dist/chunk-hooks.js:1897:20
    at new Promise (&lt;anonymous&gt;)
    at runWithTimeout (home/sngvahmed/workspace/stockly/node_modules/@vitest/runner/dist/chunk-hooks.js:1863:10)
    at runTest (home/sngvahmed/workspace/stockly/node_modules/@vitest/runner/dist/chunk-hooks.js:1574:12)
    at runSuite (home/sngvahmed/workspace/stockly/node_modules/@vitest/runner/dist/chunk-hooks.js:1729:8)
    at runSuite (home/sngvahmed/workspace/stockly/node_modules/@vitest/runner/dist/chunk-hooks.js:1729:8)
    at runSuite (home/sngvahmed/workspace/stockly/node_modules/@vitest/runner/dist/chunk-hooks.js:1729:8)

            </system-err>
        </testcase>
        <testcase classname="test/alerts/state-cache.spec.ts" name="Alert State Cache &gt; flushPendingWritesToKV &gt; should write pending states to KV" time="0.039">
            <system-out>
[KV Cache] Queued state update for alert alert-1 (1 pending writes)
[KV Cache] Flushing 1 pending writes to KV...

[KV Cache] Flushed 1/1 writes to KV

            </system-out>
        </testcase>
        <testcase classname="test/alerts/state-cache.spec.ts" name="Alert State Cache &gt; flushPendingWritesToKV &gt; should batch multiple writes" time="0.097">
            <system-out>
[KV Cache] Queued state update for alert alert-1 (1 pending writes)
[KV Cache] Queued state update for alert alert-2 (2 pending writes)
[KV Cache] Flushing 2 pending writes to KV...

[KV Cache] Flushed 2/2 writes to KV

            </system-out>
        </testcase>
        <testcase classname="test/alerts/state-cache.spec.ts" name="Alert State Cache &gt; flushPendingWritesToKV &gt; should not write if interval has not passed" time="0.085">
            <system-out>
[KV Cache] Queued state update for alert alert-1 (1 pending writes)
[KV Cache] Flushing 1 pending writes to KV...

[KV Cache] Flushed 1/1 writes to KV

[KV Cache] Queued state update for alert alert-2 (1 pending writes)
[KV Cache] Skipping KV write - only 0s since last write (interval: 3600s)

            </system-out>
        </testcase>
        <testcase classname="test/alerts/state-cache.spec.ts" name="Alert State Cache &gt; flushPendingWritesToKV &gt; should write if interval has passed" time="0.05">
            <system-out>
[KV Cache] Queued state update for alert alert-1 (1 pending writes)
[KV Cache] Flushing 1 pending writes to KV...

[KV Cache] Flushed 1/1 writes to KV

[KV Cache] Queued state update for alert alert-2 (1 pending writes)
[KV Cache] Flushing 1 pending writes to KV...

[KV Cache] Flushed 1/1 writes to KV

            </system-out>
        </testcase>
        <testcase classname="test/alerts/state-cache.spec.ts" name="Alert State Cache &gt; flushPendingWritesToKV &gt; should handle KV write errors gracefully" time="0.145">
            <system-out>
[KV Cache] Queued state update for alert alert-1 (1 pending writes)
[KV Cache] Flushing 1 pending writes to KV...

[KV Cache] Flushed 0/1 writes to KV

            </system-out>
            <system-err>
[KV Cache] Failed to write state for alert alert-1: Error: KV write failed
    at /home/sngvahmed/workspace/stockly/api/test/alerts/state-cache.spec.ts:264:47
    at home/sngvahmed/workspace/stockly/node_modules/@vitest/runner/dist/chunk-hooks.js:155:11
    at home/sngvahmed/workspace/stockly/node_modules/@vitest/runner/dist/chunk-hooks.js:752:26
    at home/sngvahmed/workspace/stockly/node_modules/@vitest/runner/dist/chunk-hooks.js:1897:20
    at new Promise (&lt;anonymous&gt;)
    at runWithTimeout (home/sngvahmed/workspace/stockly/node_modules/@vitest/runner/dist/chunk-hooks.js:1863:10)
    at runTest (home/sngvahmed/workspace/stockly/node_modules/@vitest/runner/dist/chunk-hooks.js:1574:12)
    at runSuite (home/sngvahmed/workspace/stockly/node_modules/@vitest/runner/dist/chunk-hooks.js:1729:8)
    at runSuite (home/sngvahmed/workspace/stockly/node_modules/@vitest/runner/dist/chunk-hooks.js:1729:8)
    at runSuite (home/sngvahmed/workspace/stockly/node_modules/@vitest/runner/dist/chunk-hooks.js:1729:8)

            </system-err>
        </testcase>
        <testcase classname="test/alerts/state-cache.spec.ts" name="Alert State Cache &gt; flushPendingWritesToKV &gt; should return early if no pending writes" time="0.03">
        </testcase>
        <testcase classname="test/alerts/state-cache.spec.ts" name="Alert State Cache &gt; invalidateState &gt; should remove state from cache and pending writes" time="0.032">
            <system-out>
[KV Cache] Queued state update for alert alert-1 (1 pending writes)

            </system-out>
        </testcase>
        <testcase classname="test/alerts/state-cache.spec.ts" name="Alert State Cache &gt; clearCache &gt; should clear all cached states" time="0.032">
            <system-out>
[KV Cache] Queued state update for alert alert-1 (1 pending writes)
[KV Cache] Queued state update for alert alert-2 (2 pending writes)

            </system-out>
        </testcase>
        <testcase classname="test/alerts/state-cache.spec.ts" name="Alert State Cache &gt; getCacheStats &gt; should return cache statistics" time="0.036">
            <system-out>
[KV Cache] Queued state update for alert alert-1 (1 pending writes)
[KV Cache] Queued state update for alert alert-2 (2 pending writes)

            </system-out>
        </testcase>
    </testsuite>
    <testsuite name="test/api/admin.spec.ts" timestamp="2026-01-01T10:46:50.845Z" hostname="sngvahmed" tests="18" failures="0" errors="0" skipped="0" time="0.833">
        <testcase classname="test/api/admin.spec.ts" name="Admin API &gt; getRecentNotifications &gt; should return recent notifications" time="0.04">
        </testcase>
        <testcase classname="test/api/admin.spec.ts" name="Admin API &gt; getRecentNotifications &gt; should return empty array when no notifications" time="0.033">
        </testcase>
        <testcase classname="test/api/admin.spec.ts" name="Admin API &gt; getRecentNotifications &gt; should handle database errors" time="0.058">
            <system-err>
Failed to retrieve recent notifications: Error: Database error
    at /home/sngvahmed/workspace/stockly/api/test/api/admin.spec.ts:131:40
    at home/sngvahmed/workspace/stockly/node_modules/@vitest/runner/dist/chunk-hooks.js:155:11
    at home/sngvahmed/workspace/stockly/node_modules/@vitest/runner/dist/chunk-hooks.js:752:26
    at home/sngvahmed/workspace/stockly/node_modules/@vitest/runner/dist/chunk-hooks.js:1897:20
    at new Promise (&lt;anonymous&gt;)
    at runWithTimeout (home/sngvahmed/workspace/stockly/node_modules/@vitest/runner/dist/chunk-hooks.js:1863:10)
    at runTest (home/sngvahmed/workspace/stockly/node_modules/@vitest/runner/dist/chunk-hooks.js:1574:12)
    at runSuite (home/sngvahmed/workspace/stockly/node_modules/@vitest/runner/dist/chunk-hooks.js:1729:8)
    at runSuite (home/sngvahmed/workspace/stockly/node_modules/@vitest/runner/dist/chunk-hooks.js:1729:8)
    at runSuite (home/sngvahmed/workspace/stockly/node_modules/@vitest/runner/dist/chunk-hooks.js:1729:8)

            </system-err>
        </testcase>
        <testcase classname="test/api/admin.spec.ts" name="Admin API &gt; getRecentNotifications &gt; should limit to 100 notifications" time="0.032">
        </testcase>
        <testcase classname="test/api/admin.spec.ts" name="Admin API &gt; getRecentNotifications &gt; should order by sent_at DESC" time="0.032">
        </testcase>
        <testcase classname="test/api/admin.spec.ts" name="Admin API &gt; getFailedNotifications &gt; should return only failed notifications" time="0.036">
        </testcase>
        <testcase classname="test/api/admin.spec.ts" name="Admin API &gt; getFailedNotifications &gt; should return empty array when no failed notifications" time="0.033">
        </testcase>
        <testcase classname="test/api/admin.spec.ts" name="Admin API &gt; getFailedNotifications &gt; should handle database errors" time="0.033">
            <system-err>
Failed to retrieve failed notifications: Error: Database error
    at /home/sngvahmed/workspace/stockly/api/test/api/admin.spec.ts:237:40
    at home/sngvahmed/workspace/stockly/node_modules/@vitest/runner/dist/chunk-hooks.js:155:11
    at home/sngvahmed/workspace/stockly/node_modules/@vitest/runner/dist/chunk-hooks.js:752:26
    at home/sngvahmed/workspace/stockly/node_modules/@vitest/runner/dist/chunk-hooks.js:1897:20
    at new Promise (&lt;anonymous&gt;)
    at runWithTimeout (home/sngvahmed/workspace/stockly/node_modules/@vitest/runner/dist/chunk-hooks.js:1863:10)
    at runTest (home/sngvahmed/workspace/stockly/node_modules/@vitest/runner/dist/chunk-hooks.js:1574:12)
    at runSuite (home/sngvahmed/workspace/stockly/node_modules/@vitest/runner/dist/chunk-hooks.js:1729:8)
    at runSuite (home/sngvahmed/workspace/stockly/node_modules/@vitest/runner/dist/chunk-hooks.js:1729:8)
    at runSuite (home/sngvahmed/workspace/stockly/node_modules/@vitest/runner/dist/chunk-hooks.js:1729:8)

            </system-err>
        </testcase>
        <testcase classname="test/api/admin.spec.ts" name="Admin API &gt; getFilteredNotifications &gt; should return filtered notifications" time="0.043">
        </testcase>
        <testcase classname="test/api/admin.spec.ts" name="Admin API &gt; getFilteredNotifications &gt; should filter by date range" time="0.027">
        </testcase>
        <testcase classname="test/api/admin.spec.ts" name="Admin API &gt; getFilteredNotifications &gt; should fail if env not provided" time="0.033">
        </testcase>
        <testcase classname="test/api/admin.spec.ts" name="Admin API &gt; getFilteredNotifications &gt; should handle db errors" time="0.033">
            <system-err>
Failed to retrieve filtered notifications: Error: DB Error
    at Object.&lt;anonymous&gt; (/home/sngvahmed/workspace/stockly/api/test/api/admin.spec.ts:323:15)
    at Object.mockCall (home/sngvahmed/workspace/stockly/node_modules/@vitest/spy/dist/index.js:96:15)
    at Object.spy [as prepare] (home/sngvahmed/workspace/stockly/node_modules/tinyspy/dist/index.js:47:80)
    at Module.getFilteredNotifications (/home/sngvahmed/workspace/stockly/api/src/api/admin.ts:242:30)
    at /home/sngvahmed/workspace/stockly/api/test/api/admin.spec.ts:327:24
    at home/sngvahmed/workspace/stockly/node_modules/@vitest/runner/dist/chunk-hooks.js:752:20

            </system-err>
        </testcase>
        <testcase classname="test/api/admin.spec.ts" name="Admin API &gt; retryNotification &gt; should retry failed notification successfully" time="0.035">
        </testcase>
        <testcase classname="test/api/admin.spec.ts" name="Admin API &gt; retryNotification &gt; should return 404 when log not found" time="0.043">
        </testcase>
        <testcase classname="test/api/admin.spec.ts" name="Admin API &gt; retryNotification &gt; should handle retry failure" time="0.028">
        </testcase>
        <testcase classname="test/api/admin.spec.ts" name="Admin API &gt; retryNotification &gt; should create new log entry with attempt count 1" time="0.026">
        </testcase>
        <testcase classname="test/api/admin.spec.ts" name="Admin API &gt; retryNotification &gt; should handle database errors during retry" time="0.03">
            <system-err>
Failed to retry notification: Error: Database error
    at /home/sngvahmed/workspace/stockly/api/test/api/admin.spec.ts:557:40
    at home/sngvahmed/workspace/stockly/node_modules/@vitest/runner/dist/chunk-hooks.js:155:11
    at home/sngvahmed/workspace/stockly/node_modules/@vitest/runner/dist/chunk-hooks.js:752:26
    at home/sngvahmed/workspace/stockly/node_modules/@vitest/runner/dist/chunk-hooks.js:1897:20
    at new Promise (&lt;anonymous&gt;)
    at runWithTimeout (home/sngvahmed/workspace/stockly/node_modules/@vitest/runner/dist/chunk-hooks.js:1863:10)
    at runTest (home/sngvahmed/workspace/stockly/node_modules/@vitest/runner/dist/chunk-hooks.js:1574:12)
    at runSuite (home/sngvahmed/workspace/stockly/node_modules/@vitest/runner/dist/chunk-hooks.js:1729:8)
    at runSuite (home/sngvahmed/workspace/stockly/node_modules/@vitest/runner/dist/chunk-hooks.js:1729:8)
    at runSuite (home/sngvahmed/workspace/stockly/node_modules/@vitest/runner/dist/chunk-hooks.js:1729:8)

            </system-err>
        </testcase>
        <testcase classname="test/api/admin.spec.ts" name="Admin API &gt; retryNotification &gt; should handle FCM send errors" time="0.025">
        </testcase>
    </testsuite>
    <testsuite name="test/api/auth.spec.ts" timestamp="2026-01-01T10:46:50.848Z" hostname="sngvahmed" tests="26" failures="0" errors="0" skipped="0" time="0.67">
        <testcase classname="test/api/auth.spec.ts" name="Auth API &gt; handleGoogleAuth &gt; should return 405 for non-POST requests" time="0.04">
        </testcase>
        <testcase classname="test/api/auth.spec.ts" name="Auth API &gt; handleGoogleAuth &gt; should return error if idToken is missing" time="0.029">
        </testcase>
        <testcase classname="test/api/auth.spec.ts" name="Auth API &gt; handleGoogleAuth &gt; should authenticate existing user" time="0.048">
            <system-out>
{&quot;timestamp&quot;:&quot;2026-01-01T10:46:47.834Z&quot;,&quot;service&quot;:&quot;stockly-api-test&quot;,&quot;level&quot;:&quot;INFO&quot;,&quot;traceId&quot;:&quot;test-trace-id&quot;,&quot;userId&quot;:&quot;google-user-123&quot;,&quot;path&quot;:&quot;/test&quot;,&quot;message&quot;:&quot;User authenticated successfully&quot;,&quot;type&quot;:&quot;general&quot;,&quot;email&quot;:&quot;test@example.com&quot;,&quot;requiresUsername&quot;:false}
{&quot;timestamp&quot;:&quot;2026-01-01T10:46:47.835Z&quot;,&quot;service&quot;:&quot;stockly-api-test&quot;,&quot;level&quot;:&quot;INFO&quot;,&quot;traceId&quot;:&quot;test-trace-id&quot;,&quot;userId&quot;:&quot;google-user-123&quot;,&quot;path&quot;:&quot;/test&quot;,&quot;message&quot;:&quot;Auth event: sign_in&quot;,&quot;type&quot;:&quot;sign_in&quot;,&quot;email&quot;:&quot;test@example.com&quot;,&quot;success&quot;:true}

            </system-out>
        </testcase>
        <testcase classname="test/api/auth.spec.ts" name="Auth API &gt; handleGoogleAuth &gt; should create new user if not found" time="0.027">
            <system-out>
{&quot;timestamp&quot;:&quot;2026-01-01T10:46:47.869Z&quot;,&quot;service&quot;:&quot;stockly-api-test&quot;,&quot;level&quot;:&quot;INFO&quot;,&quot;traceId&quot;:&quot;test-trace-id&quot;,&quot;userId&quot;:&quot;google-user-123&quot;,&quot;path&quot;:&quot;/test&quot;,&quot;message&quot;:&quot;New user created and authenticated&quot;,&quot;type&quot;:&quot;general&quot;,&quot;email&quot;:&quot;test@example.com&quot;}
{&quot;timestamp&quot;:&quot;2026-01-01T10:46:47.869Z&quot;,&quot;service&quot;:&quot;stockly-api-test&quot;,&quot;level&quot;:&quot;INFO&quot;,&quot;traceId&quot;:&quot;test-trace-id&quot;,&quot;userId&quot;:&quot;google-user-123&quot;,&quot;path&quot;:&quot;/test&quot;,&quot;message&quot;:&quot;Auth event: sign_in&quot;,&quot;type&quot;:&quot;sign_in&quot;,&quot;email&quot;:&quot;test@example.com&quot;,&quot;success&quot;:true}

            </system-out>
        </testcase>
        <testcase classname="test/api/auth.spec.ts" name="Auth API &gt; handleGoogleAuth &gt; should return 401 if Google token verification fails" time="0.031">
            <system-err>
{&quot;timestamp&quot;:&quot;2026-01-01T10:46:47.894Z&quot;,&quot;service&quot;:&quot;stockly-api-test&quot;,&quot;level&quot;:&quot;WARN&quot;,&quot;traceId&quot;:&quot;test-trace-id&quot;,&quot;userId&quot;:null,&quot;path&quot;:&quot;/test&quot;,&quot;message&quot;:&quot;Google token verification failed&quot;,&quot;type&quot;:&quot;general&quot;,&quot;idToken&quot;:&quot;bad.token.struct...&quot;}
{&quot;timestamp&quot;:&quot;2026-01-01T10:46:47.895Z&quot;,&quot;service&quot;:&quot;stockly-api-test&quot;,&quot;level&quot;:&quot;WARN&quot;,&quot;traceId&quot;:&quot;test-trace-id&quot;,&quot;userId&quot;:null,&quot;path&quot;:&quot;/test&quot;,&quot;message&quot;:&quot;Auth event failed: sign_in&quot;,&quot;type&quot;:&quot;sign_in&quot;,&quot;success&quot;:false,&quot;error&quot;:&quot;Google token verification failed&quot;}

            </system-err>
        </testcase>
        <testcase classname="test/api/auth.spec.ts" name="Auth API &gt; handleGoogleAuth &gt; should return 500 on DB error during user lookup" time="0.05">
            <system-err>
{&quot;timestamp&quot;:&quot;2026-01-01T10:46:47.938Z&quot;,&quot;service&quot;:&quot;stockly-api-test&quot;,&quot;level&quot;:&quot;ERROR&quot;,&quot;traceId&quot;:&quot;test-trace-id&quot;,&quot;userId&quot;:null,&quot;path&quot;:&quot;/test&quot;,&quot;message&quot;:&quot;Google authentication failed&quot;,&quot;type&quot;:&quot;general&quot;,&quot;error&quot;:{&quot;name&quot;:&quot;Error&quot;,&quot;message&quot;:&quot;DB Error&quot;,&quot;stack&quot;:&quot;Error: DB Error\n    at /home/sngvahmed/workspace/stockly/api/test/api/auth.spec.ts:179:38\n    at home/sngvahmed/workspace/stockly/node_modules/@vitest/runner/dist/chunk-hooks.js:155:11\n    at home/sngvahmed/workspace/stockly/node_modules/@vitest/runner/dist/chunk-hooks.js:752:26\n    at home/sngvahmed/workspace/stockly/node_modules/@vitest/runner/dist/chunk-hooks.js:1897:20\n    at new Promise (&lt;anonymous&gt;)\n    at runWithTimeout (home/sngvahmed/workspace/stockly/node_modules/@vitest/runner/dist/chunk-hooks.js:1863:10)\n    at runTest (home/sngvahmed/workspace/stockly/node_modules/@vitest/runner/dist/chunk-hooks.js:1574:12)\n    at runSuite (home/sngvahmed/workspace/stockly/node_modules/@vitest/runner/dist/chunk-hooks.js:1729:8)\n    at runSuite (home/sngvahmed/workspace/stockly/node_modules/@vitest/runner/dist/chunk-hooks.js:1729:8)\n    at runSuite (home/sngvahmed/workspace/stockly/node_modules/@vitest/runner/dist/chunk-hooks.js:1729:8)&quot;}}

            </system-err>
        </testcase>
        <testcase classname="test/api/auth.spec.ts" name="Auth API &gt; checkUsernameAvailability &gt; should return available true if username not taken" time="0.03">
        </testcase>
        <testcase classname="test/api/auth.spec.ts" name="Auth API &gt; checkUsernameAvailability &gt; should return available false if username taken" time="0.032">
        </testcase>
        <testcase classname="test/api/auth.spec.ts" name="Auth API &gt; checkUsernameAvailability &gt; should return error for invalid format" time="0.029">
        </testcase>
        <testcase classname="test/api/auth.spec.ts" name="Auth API &gt; checkUsernameAvailability &gt; should return 500 on DB error" time="0.027">
            <system-err>
{&quot;timestamp&quot;:&quot;2026-01-01T10:46:48.103Z&quot;,&quot;service&quot;:&quot;stockly-api-test&quot;,&quot;level&quot;:&quot;ERROR&quot;,&quot;traceId&quot;:&quot;test-trace-id&quot;,&quot;userId&quot;:null,&quot;path&quot;:&quot;/test&quot;,&quot;message&quot;:&quot;Username availability check failed&quot;,&quot;type&quot;:&quot;general&quot;,&quot;username&quot;:&quot;newuser&quot;,&quot;error&quot;:{&quot;name&quot;:&quot;Error&quot;,&quot;message&quot;:&quot;DB Error&quot;,&quot;stack&quot;:&quot;Error: DB Error\n    at /home/sngvahmed/workspace/stockly/api/test/api/auth.spec.ts:214:38\n    at home/sngvahmed/workspace/stockly/node_modules/@vitest/runner/dist/chunk-hooks.js:155:11\n    at home/sngvahmed/workspace/stockly/node_modules/@vitest/runner/dist/chunk-hooks.js:752:26\n    at home/sngvahmed/workspace/stockly/node_modules/@vitest/runner/dist/chunk-hooks.js:1897:20\n    at new Promise (&lt;anonymous&gt;)\n    at runWithTimeout (home/sngvahmed/workspace/stockly/node_modules/@vitest/runner/dist/chunk-hooks.js:1863:10)\n    at runTest (home/sngvahmed/workspace/stockly/node_modules/@vitest/runner/dist/chunk-hooks.js:1574:12)\n    at runSuite (home/sngvahmed/workspace/stockly/node_modules/@vitest/runner/dist/chunk-hooks.js:1729:8)\n    at runSuite (home/sngvahmed/workspace/stockly/node_modules/@vitest/runner/dist/chunk-hooks.js:1729:8)\n    at runSuite (home/sngvahmed/workspace/stockly/node_modules/@vitest/runner/dist/chunk-hooks.js:1729:8)&quot;}}

            </system-err>
        </testcase>
        <testcase classname="test/api/auth.spec.ts" name="Auth API &gt; setUsername &gt; should set username using idToken flow (new user)" time="0.025">
            <system-out>
{&quot;timestamp&quot;:&quot;2026-01-01T10:46:48.157Z&quot;,&quot;service&quot;:&quot;stockly-api-test&quot;,&quot;level&quot;:&quot;INFO&quot;,&quot;traceId&quot;:&quot;test-trace-id&quot;,&quot;userId&quot;:&quot;google-user-123&quot;,&quot;path&quot;:&quot;/test&quot;,&quot;message&quot;:&quot;Username set successfully&quot;,&quot;type&quot;:&quot;general&quot;,&quot;username&quot;:&quot;finaluser&quot;}

{&quot;timestamp&quot;:&quot;2026-01-01T10:46:48.157Z&quot;,&quot;service&quot;:&quot;stockly-api-test&quot;,&quot;level&quot;:&quot;INFO&quot;,&quot;traceId&quot;:&quot;test-trace-id&quot;,&quot;userId&quot;:&quot;google-user-123&quot;,&quot;path&quot;:&quot;/test&quot;,&quot;message&quot;:&quot;Auth event: username_set&quot;,&quot;type&quot;:&quot;username_set&quot;,&quot;success&quot;:true}

            </system-out>
        </testcase>
        <testcase classname="test/api/auth.spec.ts" name="Auth API &gt; setUsername &gt; should handle UNIQUE constraint violation" time="0.021">
        </testcase>
        <testcase classname="test/api/auth.spec.ts" name="Auth API &gt; setUsername &gt; should handle race condition (changes=0)" time="0.015">
        </testcase>
        <testcase classname="test/api/auth.spec.ts" name="Auth API &gt; setUsername &gt; should return 500 if updated user cannot be fetched" time="0.012">
            <system-err>
{&quot;timestamp&quot;:&quot;2026-01-01T10:46:48.216Z&quot;,&quot;service&quot;:&quot;stockly-api-test&quot;,&quot;level&quot;:&quot;ERROR&quot;,&quot;traceId&quot;:&quot;test-trace-id&quot;,&quot;userId&quot;:null,&quot;path&quot;:&quot;/test&quot;,&quot;message&quot;:&quot;User not found after username update&quot;,&quot;type&quot;:&quot;general&quot;,&quot;error&quot;:&quot;[object Object]&quot;}

            </system-err>
        </testcase>
        <testcase classname="test/api/auth.spec.ts" name="Auth API &gt; setUsername &gt; should return 400 if user already has username" time="0.013">
        </testcase>
        <testcase classname="test/api/auth.spec.ts" name="Auth API &gt; refreshToken &gt; should return 405 for non-POST requests" time="0.008">
        </testcase>
        <testcase classname="test/api/auth.spec.ts" name="Auth API &gt; refreshToken &gt; should extract token from cookie" time="0.008">
            <system-out>
{&quot;timestamp&quot;:&quot;2026-01-01T10:46:48.263Z&quot;,&quot;service&quot;:&quot;stockly-api-test&quot;,&quot;level&quot;:&quot;INFO&quot;,&quot;traceId&quot;:&quot;test-trace-id&quot;,&quot;userId&quot;:null,&quot;path&quot;:&quot;/test&quot;,&quot;message&quot;:&quot;Token refreshed successfully&quot;,&quot;type&quot;:&quot;general&quot;,&quot;username&quot;:&quot;testuser&quot;}
{&quot;timestamp&quot;:&quot;2026-01-01T10:46:48.263Z&quot;,&quot;service&quot;:&quot;stockly-api-test&quot;,&quot;level&quot;:&quot;INFO&quot;,&quot;traceId&quot;:&quot;test-trace-id&quot;,&quot;userId&quot;:null,&quot;path&quot;:&quot;/test&quot;,&quot;message&quot;:&quot;Auth event: token_refresh&quot;,&quot;type&quot;:&quot;token_refresh&quot;,&quot;success&quot;:true}

            </system-out>
        </testcase>
        <testcase classname="test/api/auth.spec.ts" name="Auth API &gt; refreshToken &gt; should extract token from body (mobile)" time="0.011">
        </testcase>
        <testcase classname="test/api/auth.spec.ts" name="Auth API &gt; refreshToken &gt; should return 400 if token missing" time="0.008">
        </testcase>
        <testcase classname="test/api/auth.spec.ts" name="Auth API &gt; refreshToken &gt; should return 401 if token invalid" time="0.007">
        </testcase>
        <testcase classname="test/api/auth.spec.ts" name="Auth API &gt; getCurrentUser &gt; should return 405 for non-GET requests" time="0.007">
        </testcase>
        <testcase classname="test/api/auth.spec.ts" name="Auth API &gt; getCurrentUser &gt; should return 401 if not authenticated" time="0.014">
        </testcase>
        <testcase classname="test/api/auth.spec.ts" name="Auth API &gt; getCurrentUser &gt; should return user info if authenticated" time="0.009">
        </testcase>
        <testcase classname="test/api/auth.spec.ts" name="Auth API &gt; getCurrentUser &gt; should return 404 if user not found in DB" time="0.011">
        </testcase>
        <testcase classname="test/api/auth.spec.ts" name="Auth API &gt; logout &gt; should return 405 for non-POST requests" time="0.005">
        </testcase>
        <testcase classname="test/api/auth.spec.ts" name="Auth API &gt; logout &gt; should clear cookies and log event" time="0.011">
            <system-out>
{&quot;timestamp&quot;:&quot;2026-01-01T10:46:48.361Z&quot;,&quot;service&quot;:&quot;stockly-api-test&quot;,&quot;level&quot;:&quot;INFO&quot;,&quot;traceId&quot;:&quot;test-trace-id&quot;,&quot;userId&quot;:null,&quot;path&quot;:&quot;/test&quot;,&quot;message&quot;:&quot;User logged out&quot;,&quot;type&quot;:&quot;general&quot;}
{&quot;timestamp&quot;:&quot;2026-01-01T10:46:48.362Z&quot;,&quot;service&quot;:&quot;stockly-api-test&quot;,&quot;level&quot;:&quot;INFO&quot;,&quot;traceId&quot;:&quot;test-trace-id&quot;,&quot;userId&quot;:null,&quot;path&quot;:&quot;/test&quot;,&quot;message&quot;:&quot;Auth event: sign_out&quot;,&quot;type&quot;:&quot;sign_out&quot;,&quot;success&quot;:true}

            </system-out>
        </testcase>
    </testsuite>
    <testsuite name="test/api/devices.spec.ts" timestamp="2026-01-01T10:46:50.852Z" hostname="sngvahmed" tests="25" failures="0" errors="0" skipped="0" time="0.653">
        <testcase classname="test/api/devices.spec.ts" name="Devices API &gt; getAllDevices &gt; should return devices for regular user" time="0.045">
        </testcase>
        <testcase classname="test/api/devices.spec.ts" name="Devices API &gt; getAllDevices &gt; should return all devices for admin user" time="0.028">
        </testcase>
        <testcase classname="test/api/devices.spec.ts" name="Devices API &gt; getAllDevices &gt; should handle missing device_type column gracefully" time="0.043">
        </testcase>
        <testcase classname="test/api/devices.spec.ts" name="Devices API &gt; getAllDevices &gt; should handle missing username column gracefully" time="0.034">
        </testcase>
        <testcase classname="test/api/devices.spec.ts" name="Devices API &gt; getAllDevices &gt; should return empty array when no devices found" time="0.025">
        </testcase>
        <testcase classname="test/api/devices.spec.ts" name="Devices API &gt; getAllDevices &gt; should return 401 when authentication fails" time="0.039">
        </testcase>
        <testcase classname="test/api/devices.spec.ts" name="Devices API &gt; getAllDevices &gt; should handle database errors gracefully" time="0.036">
        </testcase>
        <testcase classname="test/api/devices.spec.ts" name="Devices API &gt; getAllDevices &gt; should log warning when devices have null username" time="0.034">
        </testcase>
        <testcase classname="test/api/devices.spec.ts" name="Devices API &gt; deleteDevice &gt; should delete device for regular user" time="0.027">
        </testcase>
        <testcase classname="test/api/devices.spec.ts" name="Devices API &gt; deleteDevice &gt; should allow admin to delete any device" time="0.031">
        </testcase>
        <testcase classname="test/api/devices.spec.ts" name="Devices API &gt; deleteDevice &gt; should return 403 when user tries to delete another user&apos;s device" time="0.035">
        </testcase>
        <testcase classname="test/api/devices.spec.ts" name="Devices API &gt; deleteDevice &gt; should return 400 when pushToken is missing" time="0.023">
        </testcase>
        <testcase classname="test/api/devices.spec.ts" name="Devices API &gt; deleteDevice &gt; should return 404 when device not found" time="0.026">
        </testcase>
        <testcase classname="test/api/devices.spec.ts" name="Devices API &gt; deleteDevice &gt; should return 401 when authentication fails" time="0.015">
        </testcase>
        <testcase classname="test/api/devices.spec.ts" name="Devices API &gt; deleteDevice &gt; should handle database errors gracefully" time="0.013">
        </testcase>
        <testcase classname="test/api/devices.spec.ts" name="Devices API &gt; sendTestNotification &gt; should send test notification successfully" time="0.013">
        </testcase>
        <testcase classname="test/api/devices.spec.ts" name="Devices API &gt; sendTestNotification &gt; should use default message when not provided" time="0.009">
        </testcase>
        <testcase classname="test/api/devices.spec.ts" name="Devices API &gt; sendTestNotification &gt; should return 405 for non-POST requests" time="0.007">
        </testcase>
        <testcase classname="test/api/devices.spec.ts" name="Devices API &gt; sendTestNotification &gt; should return 400 when pushToken is missing" time="0.01">
        </testcase>
        <testcase classname="test/api/devices.spec.ts" name="Devices API &gt; sendTestNotification &gt; should return 404 when user not found" time="0.009">
        </testcase>
        <testcase classname="test/api/devices.spec.ts" name="Devices API &gt; sendTestNotification &gt; should return 404 when device not found" time="0.007">
        </testcase>
        <testcase classname="test/api/devices.spec.ts" name="Devices API &gt; sendTestNotification &gt; should return 500 when FCM notification fails" time="0.007">
        </testcase>
        <testcase classname="test/api/devices.spec.ts" name="Devices API &gt; sendTestNotification &gt; should return 401 when authentication fails" time="0.007">
        </testcase>
        <testcase classname="test/api/devices.spec.ts" name="Devices API &gt; sendTestNotification &gt; should handle invalid JSON body gracefully" time="0.014">
        </testcase>
        <testcase classname="test/api/devices.spec.ts" name="Devices API &gt; sendTestNotification &gt; should handle database errors gracefully" time="0.008">
        </testcase>
    </testsuite>
    <testsuite name="test/api/news-archive.spec.ts" timestamp="2026-01-01T10:46:50.855Z" hostname="sngvahmed" tests="4" failures="0" errors="0" skipped="0" time="0.306">
        <testcase classname="test/api/news-archive.spec.ts" name="News Archive API &gt; getArchivedNews &gt; should return archived news for authenticated user" time="0.039">
            <system-out>
{&quot;timestamp&quot;:&quot;2026-01-01T10:46:47.346Z&quot;,&quot;service&quot;:&quot;stockly-api-test&quot;,&quot;level&quot;:&quot;INFO&quot;,&quot;traceId&quot;:&quot;test-trace-id&quot;,&quot;userId&quot;:&quot;user-123&quot;,&quot;path&quot;:&quot;/test&quot;,&quot;message&quot;:&quot;Fetching archived news&quot;,&quot;type&quot;:&quot;general&quot;,&quot;username&quot;:&quot;testuser&quot;,&quot;page&quot;:1,&quot;limit&quot;:10}

{&quot;timestamp&quot;:&quot;2026-01-01T10:46:47.347Z&quot;,&quot;service&quot;:&quot;stockly-api-test&quot;,&quot;level&quot;:&quot;INFO&quot;,&quot;traceId&quot;:&quot;test-trace-id&quot;,&quot;userId&quot;:&quot;user-123&quot;,&quot;path&quot;:&quot;/test&quot;,&quot;message&quot;:&quot;Archived news fetched successfully&quot;,&quot;type&quot;:&quot;general&quot;,&quot;username&quot;:&quot;testuser&quot;,&quot;page&quot;:1,&quot;limit&quot;:10,&quot;total&quot;:10,&quot;returned&quot;:1,&quot;hasMore&quot;:false}

            </system-out>
        </testcase>
        <testcase classname="test/api/news-archive.spec.ts" name="News Archive API &gt; getArchivedNews &gt; should handle pagination correctly" time="0.039">
            <system-out>
{&quot;timestamp&quot;:&quot;2026-01-01T10:46:47.380Z&quot;,&quot;service&quot;:&quot;stockly-api-test&quot;,&quot;level&quot;:&quot;INFO&quot;,&quot;traceId&quot;:&quot;test-trace-id&quot;,&quot;userId&quot;:&quot;user-123&quot;,&quot;path&quot;:&quot;/test&quot;,&quot;message&quot;:&quot;Fetching archived news&quot;,&quot;type&quot;:&quot;general&quot;,&quot;username&quot;:&quot;testuser&quot;,&quot;page&quot;:2,&quot;limit&quot;:10}

{&quot;timestamp&quot;:&quot;2026-01-01T10:46:47.380Z&quot;,&quot;service&quot;:&quot;stockly-api-test&quot;,&quot;level&quot;:&quot;INFO&quot;,&quot;traceId&quot;:&quot;test-trace-id&quot;,&quot;userId&quot;:&quot;user-123&quot;,&quot;path&quot;:&quot;/test&quot;,&quot;message&quot;:&quot;Archived news fetched successfully&quot;,&quot;type&quot;:&quot;general&quot;,&quot;username&quot;:&quot;testuser&quot;,&quot;page&quot;:2,&quot;limit&quot;:10,&quot;total&quot;:25,&quot;returned&quot;:0,&quot;hasMore&quot;:true}

            </system-out>
        </testcase>
        <testcase classname="test/api/news-archive.spec.ts" name="News Archive API &gt; toggleArchivedNews &gt; should save article to archive" time="0.026">
            <system-out>
{&quot;timestamp&quot;:&quot;2026-01-01T10:46:47.474Z&quot;,&quot;service&quot;:&quot;stockly-api-test&quot;,&quot;level&quot;:&quot;INFO&quot;,&quot;traceId&quot;:&quot;test-trace-id&quot;,&quot;userId&quot;:null,&quot;path&quot;:&quot;/test&quot;,&quot;message&quot;:&quot;Article saved successfully&quot;,&quot;type&quot;:&quot;general&quot;,&quot;username&quot;:&quot;testuser&quot;,&quot;articleId&quot;:&quot;article-123&quot;,&quot;symbol&quot;:&quot;AAPL&quot;}

            </system-out>
        </testcase>
        <testcase classname="test/api/news-archive.spec.ts" name="News Archive API &gt; toggleArchivedNews &gt; should remove article from archive if already saved" time="0.032">
            <system-out>
{&quot;timestamp&quot;:&quot;2026-01-01T10:46:47.503Z&quot;,&quot;service&quot;:&quot;stockly-api-test&quot;,&quot;level&quot;:&quot;INFO&quot;,&quot;traceId&quot;:&quot;test-trace-id&quot;,&quot;userId&quot;:null,&quot;path&quot;:&quot;/test&quot;,&quot;message&quot;:&quot;Article unsaved successfully&quot;,&quot;type&quot;:&quot;general&quot;,&quot;username&quot;:&quot;testuser&quot;,&quot;articleId&quot;:&quot;article-123&quot;}

            </system-out>
        </testcase>
    </testsuite>
    <testsuite name="test/api/preferences.spec.ts" timestamp="2026-01-01T10:46:50.856Z" hostname="sngvahmed" tests="12" failures="0" errors="0" skipped="0" time="0.633">
        <testcase classname="test/api/preferences.spec.ts" name="Preferences API &gt; getPreferences &gt; should return preferences for authenticated user" time="0.031">
        </testcase>
        <testcase classname="test/api/preferences.spec.ts" name="Preferences API &gt; getPreferences &gt; should return 404 if user not found (getPreferences)" time="0.035">
        </testcase>
        <testcase classname="test/api/preferences.spec.ts" name="Preferences API &gt; getPreferences &gt; should return default preferences if none exist" time="0.069">
        </testcase>
        <testcase classname="test/api/preferences.spec.ts" name="Preferences API &gt; updatePreferences &gt; should update preferences for authenticated user" time="0.045">
        </testcase>
        <testcase classname="test/api/preferences.spec.ts" name="Preferences API &gt; updatePreferences &gt; should create preferences if they don&apos;t exist" time="0.032">
        </testcase>
        <testcase classname="test/api/preferences.spec.ts" name="Preferences API &gt; updatePreferences &gt; should validate quiet hours format" time="0.033">
        </testcase>
        <testcase classname="test/api/preferences.spec.ts" name="Preferences API &gt; updatePreferences &gt; should return 400 for invalid quietStart type" time="0.052">
        </testcase>
        <testcase classname="test/api/preferences.spec.ts" name="Preferences API &gt; updatePreferences &gt; should return 400 for invalid quietEnd type" time="0.038">
        </testcase>
        <testcase classname="test/api/preferences.spec.ts" name="Preferences API &gt; updatePreferences &gt; should return 400 for invalid enabled type" time="0.058">
        </testcase>
        <testcase classname="test/api/preferences.spec.ts" name="Preferences API &gt; updatePreferences &gt; should return 400 for invalid maxDaily" time="0.033">
        </testcase>
        <testcase classname="test/api/preferences.spec.ts" name="Preferences API &gt; updatePreferences &gt; should return 400 for invalid allowedSymbols" time="0.041">
        </testcase>
        <testcase classname="test/api/preferences.spec.ts" name="Preferences API &gt; updatePreferences &gt; should return 500 on DB error" time="0.032">
            <system-err>
{&quot;timestamp&quot;:&quot;2026-01-01T10:46:47.788Z&quot;,&quot;service&quot;:&quot;stockly-api-test&quot;,&quot;level&quot;:&quot;ERROR&quot;,&quot;traceId&quot;:&quot;test-trace-id&quot;,&quot;userId&quot;:null,&quot;path&quot;:&quot;/test&quot;,&quot;message&quot;:&quot;Failed to update preferences&quot;,&quot;type&quot;:&quot;general&quot;,&quot;username&quot;:&quot;t&quot;,&quot;error&quot;:{&quot;name&quot;:&quot;Error&quot;,&quot;message&quot;:&quot;DB Fail&quot;,&quot;stack&quot;:&quot;Error: DB Fail\n    at Object.&lt;anonymous&gt; (/home/sngvahmed/workspace/stockly/api/test/api/preferences.spec.ts:323:55)\n    at Object.mockCall (home/sngvahmed/workspace/stockly/node_modules/@vitest/spy/dist/index.js:96:15)\n    at Object.spy [as prepare] (home/sngvahmed/workspace/stockly/node_modules/tinyspy/dist/index.js:47:80)\n    at Module.updatePreferences (/home/sngvahmed/workspace/stockly/api/src/api/preferences.ts:155:8)\n    at /home/sngvahmed/workspace/stockly/api/test/api/preferences.spec.ts:326:19\n    at home/sngvahmed/workspace/stockly/node_modules/@vitest/runner/dist/chunk-hooks.js:752:20&quot;}}

            </system-err>
        </testcase>
    </testsuite>
    <testsuite name="test/api/push-token.spec.ts" timestamp="2026-01-01T10:46:50.858Z" hostname="sngvahmed" tests="17" failures="0" errors="0" skipped="0" time="0.858">
        <testcase classname="test/api/push-token.spec.ts" name="Push Token API &gt; registerPushToken &gt; should register new push token" time="0.038">
            <system-out>
✅ FCM token validation passed: length=30, format valid

{&quot;timestamp&quot;:&quot;2026-01-01T10:46:47.354Z&quot;,&quot;service&quot;:&quot;stockly-api-test&quot;,&quot;level&quot;:&quot;INFO&quot;,&quot;traceId&quot;:&quot;test-trace-id&quot;,&quot;userId&quot;:&quot;user-123&quot;,&quot;path&quot;:&quot;/test&quot;,&quot;message&quot;:&quot;Creating new device&quot;,&quot;type&quot;:&quot;general&quot;,&quot;username&quot;:&quot;testuser&quot;,&quot;deviceType&quot;:&quot;android&quot;,&quot;deviceIdentifier&quot;:&quot;32590f504cc7cc7c...&quot;}

{&quot;timestamp&quot;:&quot;2026-01-01T10:46:47.354Z&quot;,&quot;service&quot;:&quot;stockly-api-test&quot;,&quot;level&quot;:&quot;INFO&quot;,&quot;traceId&quot;:&quot;test-trace-id&quot;,&quot;userId&quot;:&quot;user-123&quot;,&quot;path&quot;:&quot;/test&quot;,&quot;message&quot;:&quot;Creating new push token&quot;,&quot;type&quot;:&quot;general&quot;,&quot;username&quot;:&quot;testuser&quot;,&quot;deviceId&quot;:1,&quot;tokenPreview&quot;:&quot;fcm-token-1234567890...&quot;}

{&quot;timestamp&quot;:&quot;2026-01-01T10:46:47.354Z&quot;,&quot;service&quot;:&quot;stockly-api-test&quot;,&quot;level&quot;:&quot;INFO&quot;,&quot;traceId&quot;:&quot;test-trace-id&quot;,&quot;userId&quot;:&quot;user-123&quot;,&quot;path&quot;:&quot;/test&quot;,&quot;message&quot;:&quot;Push token registered successfully&quot;,&quot;type&quot;:&quot;general&quot;,&quot;username&quot;:&quot;testuser&quot;,&quot;deviceId&quot;:1,&quot;deviceType&quot;:&quot;android&quot;}

            </system-out>
        </testcase>
        <testcase classname="test/api/push-token.spec.ts" name="Push Token API &gt; registerPushToken &gt; should update existing push token" time="0.04">
            <system-out>
✅ FCM token validation passed: length=30, format valid

{&quot;timestamp&quot;:&quot;2026-01-01T10:46:47.387Z&quot;,&quot;service&quot;:&quot;stockly-api-test&quot;,&quot;level&quot;:&quot;INFO&quot;,&quot;traceId&quot;:&quot;test-trace-id&quot;,&quot;userId&quot;:&quot;user-123&quot;,&quot;path&quot;:&quot;/test&quot;,&quot;message&quot;:&quot;Updating existing device&quot;,&quot;type&quot;:&quot;general&quot;,&quot;username&quot;:&quot;testuser&quot;,&quot;deviceId&quot;:1,&quot;deviceType&quot;:&quot;android&quot;}

{&quot;timestamp&quot;:&quot;2026-01-01T10:46:47.388Z&quot;,&quot;service&quot;:&quot;stockly-api-test&quot;,&quot;level&quot;:&quot;INFO&quot;,&quot;traceId&quot;:&quot;test-trace-id&quot;,&quot;userId&quot;:&quot;user-123&quot;,&quot;path&quot;:&quot;/test&quot;,&quot;message&quot;:&quot;Updating existing push token&quot;,&quot;type&quot;:&quot;general&quot;,&quot;username&quot;:&quot;testuser&quot;,&quot;deviceId&quot;:1}

{&quot;timestamp&quot;:&quot;2026-01-01T10:46:47.388Z&quot;,&quot;service&quot;:&quot;stockly-api-test&quot;,&quot;level&quot;:&quot;INFO&quot;,&quot;traceId&quot;:&quot;test-trace-id&quot;,&quot;userId&quot;:&quot;user-123&quot;,&quot;path&quot;:&quot;/test&quot;,&quot;message&quot;:&quot;Push token registered successfully&quot;,&quot;type&quot;:&quot;general&quot;,&quot;username&quot;:&quot;testuser&quot;,&quot;deviceId&quot;:1,&quot;deviceType&quot;:&quot;android&quot;}

            </system-out>
        </testcase>
        <testcase classname="test/api/push-token.spec.ts" name="Push Token API &gt; registerPushToken &gt; should reassign token to new user if different user" time="0.105">
            <system-out>
✅ FCM token validation passed: length=30, format valid

{&quot;timestamp&quot;:&quot;2026-01-01T10:46:47.504Z&quot;,&quot;service&quot;:&quot;stockly-api-test&quot;,&quot;level&quot;:&quot;INFO&quot;,&quot;traceId&quot;:&quot;test-trace-id&quot;,&quot;userId&quot;:&quot;user-123&quot;,&quot;path&quot;:&quot;/test&quot;,&quot;message&quot;:&quot;Creating new device&quot;,&quot;type&quot;:&quot;general&quot;,&quot;username&quot;:&quot;testuser&quot;,&quot;deviceType&quot;:&quot;android&quot;,&quot;deviceIdentifier&quot;:&quot;32590f504cc7cc7c...&quot;}

{&quot;timestamp&quot;:&quot;2026-01-01T10:46:47.504Z&quot;,&quot;service&quot;:&quot;stockly-api-test&quot;,&quot;level&quot;:&quot;INFO&quot;,&quot;traceId&quot;:&quot;test-trace-id&quot;,&quot;userId&quot;:&quot;user-123&quot;,&quot;path&quot;:&quot;/test&quot;,&quot;message&quot;:&quot;Reassigning push token to different device&quot;,&quot;type&quot;:&quot;general&quot;,&quot;username&quot;:&quot;testuser&quot;,&quot;deviceId&quot;:2,&quot;previousDeviceId&quot;:1}

{&quot;timestamp&quot;:&quot;2026-01-01T10:46:47.504Z&quot;,&quot;service&quot;:&quot;stockly-api-test&quot;,&quot;level&quot;:&quot;INFO&quot;,&quot;traceId&quot;:&quot;test-trace-id&quot;,&quot;userId&quot;:&quot;user-123&quot;,&quot;path&quot;:&quot;/test&quot;,&quot;message&quot;:&quot;Push token registered successfully&quot;,&quot;type&quot;:&quot;general&quot;,&quot;username&quot;:&quot;testuser&quot;,&quot;deviceId&quot;:2,&quot;deviceType&quot;:&quot;android&quot;}

            </system-out>
        </testcase>
        <testcase classname="test/api/push-token.spec.ts" name="Push Token API &gt; registerPushToken &gt; should validate token format" time="0.078">
        </testcase>
        <testcase classname="test/api/push-token.spec.ts" name="Push Token API &gt; registerPushToken &gt; should reject Expo tokens" time="0.036">
        </testcase>
        <testcase classname="test/api/push-token.spec.ts" name="Push Token API &gt; registerPushToken &gt; should reject short FCM tokens" time="0.047">
        </testcase>
        <testcase classname="test/api/push-token.spec.ts" name="Push Token API &gt; registerPushToken &gt; should normalize deviceType from info" time="0.033">
            <system-out>
✅ FCM token validation passed: length=26, format valid

{&quot;timestamp&quot;:&quot;2026-01-01T10:46:47.695Z&quot;,&quot;service&quot;:&quot;stockly-api-test&quot;,&quot;level&quot;:&quot;INFO&quot;,&quot;traceId&quot;:&quot;test-trace-id&quot;,&quot;userId&quot;:&quot;u&quot;,&quot;path&quot;:&quot;/test&quot;,&quot;message&quot;:&quot;Creating new device&quot;,&quot;type&quot;:&quot;general&quot;,&quot;username&quot;:&quot;t&quot;,&quot;deviceType&quot;:&quot;ios&quot;,&quot;deviceIdentifier&quot;:&quot;a3420e6be9170b6f...&quot;}

{&quot;timestamp&quot;:&quot;2026-01-01T10:46:47.695Z&quot;,&quot;service&quot;:&quot;stockly-api-test&quot;,&quot;level&quot;:&quot;INFO&quot;,&quot;traceId&quot;:&quot;test-trace-id&quot;,&quot;userId&quot;:&quot;u&quot;,&quot;path&quot;:&quot;/test&quot;,&quot;message&quot;:&quot;Creating new push token&quot;,&quot;type&quot;:&quot;general&quot;,&quot;username&quot;:&quot;t&quot;,&quot;deviceId&quot;:1,&quot;tokenPreview&quot;:&quot;valid-fcm-token-1234...&quot;}

{&quot;timestamp&quot;:&quot;2026-01-01T10:46:47.695Z&quot;,&quot;service&quot;:&quot;stockly-api-test&quot;,&quot;level&quot;:&quot;INFO&quot;,&quot;traceId&quot;:&quot;test-trace-id&quot;,&quot;userId&quot;:&quot;u&quot;,&quot;path&quot;:&quot;/test&quot;,&quot;message&quot;:&quot;Push token registered successfully&quot;,&quot;type&quot;:&quot;general&quot;,&quot;username&quot;:&quot;t&quot;,&quot;deviceId&quot;:1,&quot;deviceType&quot;:&quot;ios&quot;}

            </system-out>
        </testcase>
        <testcase classname="test/api/push-token.spec.ts" name="Push Token API &gt; registerPushToken &gt; should return 500 on DB error" time="0.064">
            <system-err>
{&quot;timestamp&quot;:&quot;2026-01-01T10:46:47.730Z&quot;,&quot;service&quot;:&quot;stockly-api-test&quot;,&quot;level&quot;:&quot;ERROR&quot;,&quot;traceId&quot;:&quot;test-trace-id&quot;,&quot;path&quot;:&quot;/test&quot;,&quot;message&quot;:&quot;Failed to register push token&quot;,&quot;type&quot;:&quot;general&quot;,&quot;username&quot;:&quot;t&quot;,&quot;error&quot;:{&quot;name&quot;:&quot;Error&quot;,&quot;message&quot;:&quot;DB Fail&quot;,&quot;stack&quot;:&quot;Error: DB Fail\n    at Object.&lt;anonymous&gt; (/home/sngvahmed/workspace/stockly/api/test/api/push-token.spec.ts:339:55)\n    at Object.mockCall (home/sngvahmed/workspace/stockly/node_modules/@vitest/spy/dist/index.js:96:15)\n    at Object.spy [as prepare] (home/sngvahmed/workspace/stockly/node_modules/tinyspy/dist/index.js:47:80)\n    at Module.registerPushToken (/home/sngvahmed/workspace/stockly/api/src/api/push-token.ts:74:8)\n    at /home/sngvahmed/workspace/stockly/api/test/api/push-token.spec.ts:342:19\n    at home/sngvahmed/workspace/stockly/node_modules/@vitest/runner/dist/chunk-hooks.js:752:20&quot;}}

            </system-err>
        </testcase>
        <testcase classname="test/api/push-token.spec.ts" name="Push Token API &gt; getPushToken &gt; should return push tokens for authenticated user" time="0.029">
        </testcase>
        <testcase classname="test/api/push-token.spec.ts" name="Push Token API &gt; getPushToken &gt; should return 404 if user not found" time="0.034">
        </testcase>
        <testcase classname="test/api/push-token.spec.ts" name="Push Token API &gt; getPushToken &gt; should return 404 if no tokens found" time="0.024">
        </testcase>
        <testcase classname="test/api/push-token.spec.ts" name="Push Token API &gt; getPushToken &gt; should return 500 on DB error" time="0.035">
            <system-err>
{&quot;timestamp&quot;:&quot;2026-01-01T10:46:47.906Z&quot;,&quot;service&quot;:&quot;stockly-api-test&quot;,&quot;level&quot;:&quot;ERROR&quot;,&quot;traceId&quot;:&quot;test-trace-id&quot;,&quot;path&quot;:&quot;/test&quot;,&quot;message&quot;:&quot;Failed to get push tokens&quot;,&quot;type&quot;:&quot;general&quot;,&quot;username&quot;:&quot;t&quot;,&quot;error&quot;:{&quot;name&quot;:&quot;Error&quot;,&quot;message&quot;:&quot;DB Fail&quot;,&quot;stack&quot;:&quot;Error: DB Fail\n    at Object.&lt;anonymous&gt; (/home/sngvahmed/workspace/stockly/api/test/api/push-token.spec.ts:424:55)\n    at Object.mockCall (home/sngvahmed/workspace/stockly/node_modules/@vitest/spy/dist/index.js:96:15)\n    at Object.spy [as prepare] (home/sngvahmed/workspace/stockly/node_modules/tinyspy/dist/index.js:47:80)\n    at Module.getPushToken (/home/sngvahmed/workspace/stockly/api/src/api/push-token.ts:343:8)\n    at /home/sngvahmed/workspace/stockly/api/test/api/push-token.spec.ts:427:24\n    at home/sngvahmed/workspace/stockly/node_modules/@vitest/runner/dist/chunk-hooks.js:752:20&quot;}}

            </system-err>
        </testcase>
        <testcase classname="test/api/push-token.spec.ts" name="Push Token API &gt; getPushToken &gt; should handle legacy schema (no device_type column)" time="0.044">
        </testcase>
        <testcase classname="test/api/push-token.spec.ts" name="Push Token API &gt; getPushToken &gt; should return registered=true when token is registered for user (check mode)" time="0.034">
            <system-out>
{&quot;timestamp&quot;:&quot;2026-01-01T10:46:47.987Z&quot;,&quot;service&quot;:&quot;stockly-api-test&quot;,&quot;level&quot;:&quot;DEBUG&quot;,&quot;traceId&quot;:&quot;test-trace-id&quot;,&quot;userId&quot;:&quot;user-123&quot;,&quot;path&quot;:&quot;/test&quot;,&quot;message&quot;:&quot;Device registration check&quot;,&quot;type&quot;:&quot;general&quot;,&quot;username&quot;:&quot;testuser&quot;,&quot;pushToken&quot;:&quot;fcm-token-1234567890...&quot;,&quot;registered&quot;:true}

            </system-out>
        </testcase>
        <testcase classname="test/api/push-token.spec.ts" name="Push Token API &gt; getPushToken &gt; should return registered=false when token is not registered for user (check mode)" time="0.03">
            <system-out>
{&quot;timestamp&quot;:&quot;2026-01-01T10:46:48.021Z&quot;,&quot;service&quot;:&quot;stockly-api-test&quot;,&quot;level&quot;:&quot;DEBUG&quot;,&quot;traceId&quot;:&quot;test-trace-id&quot;,&quot;userId&quot;:&quot;user-123&quot;,&quot;path&quot;:&quot;/test&quot;,&quot;message&quot;:&quot;Device registration check&quot;,&quot;type&quot;:&quot;general&quot;,&quot;username&quot;:&quot;testuser&quot;,&quot;pushToken&quot;:&quot;fcm-token-unregister...&quot;,&quot;registered&quot;:false}

            </system-out>
        </testcase>
        <testcase classname="test/api/push-token.spec.ts" name="Push Token API &gt; getPushToken &gt; should return 400 when check=true but token parameter is missing" time="0.035">
        </testcase>
        <testcase classname="test/api/push-token.spec.ts" name="Push Token API &gt; getPushToken &gt; should return registered=false when token belongs to different user (check mode)" time="0.03">
            <system-out>
{&quot;timestamp&quot;:&quot;2026-01-01T10:46:48.086Z&quot;,&quot;service&quot;:&quot;stockly-api-test&quot;,&quot;level&quot;:&quot;DEBUG&quot;,&quot;traceId&quot;:&quot;test-trace-id&quot;,&quot;userId&quot;:&quot;user-123&quot;,&quot;path&quot;:&quot;/test&quot;,&quot;message&quot;:&quot;Device registration check&quot;,&quot;type&quot;:&quot;general&quot;,&quot;username&quot;:&quot;testuser&quot;,&quot;pushToken&quot;:&quot;fcm-token-other-user...&quot;,&quot;registered&quot;:false}

            </system-out>
        </testcase>
    </testsuite>
    <testsuite name="test/api/settings.spec.ts" timestamp="2026-01-01T10:46:50.861Z" hostname="sngvahmed" tests="6" failures="0" errors="0" skipped="0" time="0.39">
        <testcase classname="test/api/settings.spec.ts" name="Settings API &gt; getSettings &gt; should return settings for authenticated user" time="0.043">
        </testcase>
        <testcase classname="test/api/settings.spec.ts" name="Settings API &gt; getSettings &gt; should return default settings if none exist" time="0.058">
        </testcase>
        <testcase classname="test/api/settings.spec.ts" name="Settings API &gt; updateSettings &gt; should update settings for authenticated user" time="0.033">
        </testcase>
        <testcase classname="test/api/settings.spec.ts" name="Settings API &gt; updateSettings &gt; should create settings if they don&apos;t exist" time="0.05">
        </testcase>
        <testcase classname="test/api/settings.spec.ts" name="Settings API &gt; updateSettings &gt; should return 400 for invalid refreshIntervalMinutes" time="0.029">
        </testcase>
        <testcase classname="test/api/settings.spec.ts" name="Settings API &gt; updateSettings &gt; should return 500 on DB error during update" time="0.041">
            <system-err>
{&quot;timestamp&quot;:&quot;2026-01-01T10:46:47.613Z&quot;,&quot;service&quot;:&quot;stockly-api-test&quot;,&quot;level&quot;:&quot;ERROR&quot;,&quot;traceId&quot;:&quot;test-trace-id&quot;,&quot;userId&quot;:null,&quot;path&quot;:&quot;/test&quot;,&quot;message&quot;:&quot;Failed to update settings&quot;,&quot;type&quot;:&quot;general&quot;,&quot;username&quot;:&quot;testuser&quot;,&quot;error&quot;:{&quot;name&quot;:&quot;Error&quot;,&quot;message&quot;:&quot;DB Fail&quot;,&quot;stack&quot;:&quot;Error: DB Fail\n    at Object.&lt;anonymous&gt; (/home/sngvahmed/workspace/stockly/api/test/api/settings.spec.ts:234:55)\n    at Object.mockCall (home/sngvahmed/workspace/stockly/node_modules/@vitest/spy/dist/index.js:96:15)\n    at Object.spy [as prepare] (home/sngvahmed/workspace/stockly/node_modules/tinyspy/dist/index.js:47:80)\n    at Module.updateSettings (/home/sngvahmed/workspace/stockly/api/src/api/settings.ts:137:8)\n    at /home/sngvahmed/workspace/stockly/api/test/api/settings.spec.ts:241:24\n    at home/sngvahmed/workspace/stockly/node_modules/@vitest/runner/dist/chunk-hooks.js:752:20&quot;}}

            </system-err>
        </testcase>
    </testsuite>
    <testsuite name="test/api/throttle-cache.spec.ts" timestamp="2026-01-01T10:46:50.862Z" hostname="sngvahmed" tests="21" failures="0" errors="0" skipped="0" time="1.981">
        <testcase classname="test/api/throttle-cache.spec.ts" name="Throttle Cache &gt; isThrottled &gt; should return false if key is not throttled" time="0.026">
        </testcase>
        <testcase classname="test/api/throttle-cache.spec.ts" name="Throttle Cache &gt; isThrottled &gt; should return true if key was recently throttled" time="0.103">
        </testcase>
        <testcase classname="test/api/throttle-cache.spec.ts" name="Throttle Cache &gt; isThrottled &gt; should return false if throttle window has expired" time="0.099">
        </testcase>
        <testcase classname="test/api/throttle-cache.spec.ts" name="Throttle Cache &gt; isThrottled &gt; should return true if within throttle window" time="0.095">
        </testcase>
        <testcase classname="test/api/throttle-cache.spec.ts" name="Throttle Cache &gt; isThrottled &gt; should handle multiple keys independently" time="0.125">
        </testcase>
        <testcase classname="test/api/throttle-cache.spec.ts" name="Throttle Cache &gt; markThrottled &gt; should mark a key as throttled" time="0.06">
        </testcase>
        <testcase classname="test/api/throttle-cache.spec.ts" name="Throttle Cache &gt; markThrottled &gt; should update throttle timestamp when called again" time="0.113">
        </testcase>
        <testcase classname="test/api/throttle-cache.spec.ts" name="Throttle Cache &gt; markThrottled &gt; should handle empty string key" time="0.112">
        </testcase>
        <testcase classname="test/api/throttle-cache.spec.ts" name="Throttle Cache &gt; markThrottled &gt; should handle special characters in key" time="0.072">
        </testcase>
        <testcase classname="test/api/throttle-cache.spec.ts" name="Throttle Cache &gt; clearThrottle &gt; should clear throttle for a key" time="0.049">
        </testcase>
        <testcase classname="test/api/throttle-cache.spec.ts" name="Throttle Cache &gt; clearThrottle &gt; should not throw if clearing non-existent key" time="0.077">
        </testcase>
        <testcase classname="test/api/throttle-cache.spec.ts" name="Throttle Cache &gt; clearThrottle &gt; should clear one key without affecting others" time="0.049">
        </testcase>
        <testcase classname="test/api/throttle-cache.spec.ts" name="Throttle Cache &gt; getThrottleCacheStats &gt; should return cache statistics" time="0.037">
        </testcase>
        <testcase classname="test/api/throttle-cache.spec.ts" name="Throttle Cache &gt; getThrottleCacheStats &gt; should reflect correct number of cached keys" time="0.08">
        </testcase>
        <testcase classname="test/api/throttle-cache.spec.ts" name="Throttle Cache &gt; getThrottleCacheStats &gt; should handle empty cache" time="0.037">
        </testcase>
        <testcase classname="test/api/throttle-cache.spec.ts" name="Throttle Cache &gt; getThrottleCacheStats &gt; should increase count when marking multiple unique keys" time="0.083">
        </testcase>
        <testcase classname="test/api/throttle-cache.spec.ts" name="Throttle Cache &gt; Throttle window (5 minutes) &gt; should throttle for approximately 5 minutes" time="0.038">
        </testcase>
        <testcase classname="test/api/throttle-cache.spec.ts" name="Throttle Cache &gt; Throttle window (5 minutes) &gt; should use seconds precision (not milliseconds)" time="0.032">
        </testcase>
        <testcase classname="test/api/throttle-cache.spec.ts" name="Throttle Cache &gt; Edge cases &gt; should handle very long keys" time="0.024">
        </testcase>
        <testcase classname="test/api/throttle-cache.spec.ts" name="Throttle Cache &gt; Edge cases &gt; should handle unicode keys" time="0.03">
        </testcase>
        <testcase classname="test/api/throttle-cache.spec.ts" name="Throttle Cache &gt; Edge cases &gt; should handle concurrent marks and clears" time="0.041">
        </testcase>
    </testsuite>
    <testsuite name="test/api/user-preferences.spec.ts" timestamp="2026-01-01T10:46:50.864Z" hostname="sngvahmed" tests="3" failures="0" errors="0" skipped="0" time="0.227">
        <testcase classname="test/api/user-preferences.spec.ts" name="User Preferences API &gt; updateUserPreferences &gt; should update news favorite symbols" time="0.037">
        </testcase>
        <testcase classname="test/api/user-preferences.spec.ts" name="User Preferences API &gt; updateUserPreferences &gt; should create settings if they don&apos;t exist" time="0.039">
        </testcase>
        <testcase classname="test/api/user-preferences.spec.ts" name="User Preferences API &gt; updateUserPreferences &gt; should validate symbols array" time="0.056">
            <system-err>
{&quot;timestamp&quot;:&quot;2026-01-01T10:46:47.449Z&quot;,&quot;service&quot;:&quot;stockly-api-test&quot;,&quot;level&quot;:&quot;ERROR&quot;,&quot;traceId&quot;:&quot;test-trace-id&quot;,&quot;path&quot;:&quot;/test&quot;,&quot;message&quot;:&quot;Failed to update user preferences&quot;,&quot;type&quot;:&quot;general&quot;,&quot;username&quot;:&quot;testuser&quot;,&quot;error&quot;:{&quot;name&quot;:&quot;TypeError&quot;,&quot;message&quot;:&quot;Cannot read properties of undefined (reading &apos;bind&apos;)&quot;,&quot;stack&quot;:&quot;TypeError: Cannot read properties of undefined (reading &apos;bind&apos;)\n    at Module.updateUserPreferences (/home/sngvahmed/workspace/stockly/api/src/api/user-preferences.ts:36:63)\n    at /home/sngvahmed/workspace/stockly/api/test/api/user-preferences.spec.ts:136:24\n    at home/sngvahmed/workspace/stockly/node_modules/@vitest/runner/dist/chunk-hooks.js:752:20&quot;}}

            </system-err>
        </testcase>
    </testsuite>
    <testsuite name="test/api/users.spec.ts" timestamp="2026-01-01T10:46:50.865Z" hostname="sngvahmed" tests="13" failures="0" errors="0" skipped="0" time="0.395">
        <testcase classname="test/api/users.spec.ts" name="Users API &gt; getAllUsers &gt; should return all users with activity status for admin" time="0.04">
        </testcase>
        <testcase classname="test/api/users.spec.ts" name="Users API &gt; getAllUsers &gt; should deny non-admin access" time="0.031">
        </testcase>
        <testcase classname="test/api/users.spec.ts" name="Users API &gt; getAllUsers &gt; should return empty array when no users exist" time="0.04">
        </testcase>
        <testcase classname="test/api/users.spec.ts" name="Users API &gt; getAllUsers &gt; should return users with no activity" time="0.026">
        </testcase>
        <testcase classname="test/api/users.spec.ts" name="Users API &gt; getUserByUsername &gt; should return user details for admin" time="0.027">
        </testcase>
        <testcase classname="test/api/users.spec.ts" name="Users API &gt; getUserByUsername &gt; should return 404 if user not found" time="0.033">
        </testcase>
        <testcase classname="test/api/users.spec.ts" name="Users API &gt; getUserByUsername &gt; should deny non-admin access" time="0.025">
        </testcase>
        <testcase classname="test/api/users.spec.ts" name="Users API &gt; getUserDevices &gt; should return devices for a user" time="0.013">
        </testcase>
        <testcase classname="test/api/users.spec.ts" name="Users API &gt; getUserDevices &gt; should return 404 if user not found" time="0.012">
        </testcase>
        <testcase classname="test/api/users.spec.ts" name="Users API &gt; getUserAlerts &gt; should return alerts for a user" time="0.012">
        </testcase>
        <testcase classname="test/api/users.spec.ts" name="Users API &gt; getUserAlerts &gt; should return 404 if user not found" time="0.009">
        </testcase>
        <testcase classname="test/api/users.spec.ts" name="Users API &gt; getUserFavoriteStocks &gt; should return favorite stocks for a user" time="0.008">
        </testcase>
        <testcase classname="test/api/users.spec.ts" name="Users API &gt; getUserFavoriteStocks &gt; should return 404 if user not found" time="0.009">
        </testcase>
    </testsuite>
    <testsuite name="test/auth/jwt.spec.ts" timestamp="2026-01-01T10:46:50.866Z" hostname="sngvahmed" tests="13" failures="0" errors="0" skipped="0" time="1.341">
        <testcase classname="test/auth/jwt.spec.ts" name="JWT Utilities &gt; generateAccessToken &gt; should generate a valid access token" time="0.118">
        </testcase>
        <testcase classname="test/auth/jwt.spec.ts" name="JWT Utilities &gt; generateAccessToken &gt; should set custom expiration" time="0.105">
        </testcase>
        <testcase classname="test/auth/jwt.spec.ts" name="JWT Utilities &gt; generateRefreshToken &gt; should generate a valid refresh token" time="0.087">
        </testcase>
        <testcase classname="test/auth/jwt.spec.ts" name="JWT Utilities &gt; verifyToken &gt; should return payload for valid access token" time="0.033">
        </testcase>
        <testcase classname="test/auth/jwt.spec.ts" name="JWT Utilities &gt; verifyToken &gt; should return payload for valid refresh token" time="0.101">
        </testcase>
        <testcase classname="test/auth/jwt.spec.ts" name="JWT Utilities &gt; verifyToken &gt; should return null for invalid signature" time="0.077">
        </testcase>
        <testcase classname="test/auth/jwt.spec.ts" name="JWT Utilities &gt; verifyToken &gt; should return null for malformed token" time="0.035">
        </testcase>
        <testcase classname="test/auth/jwt.spec.ts" name="JWT Utilities &gt; verifyToken &gt; should return null if token payload is missing required fields" time="0.085">
        </testcase>
        <testcase classname="test/auth/jwt.spec.ts" name="JWT Utilities &gt; verifyToken &gt; should return null if token type is invalid" time="0.031">
        </testcase>
        <testcase classname="test/auth/jwt.spec.ts" name="JWT Utilities &gt; extractUsernameFromToken &gt; should extract username from valid token string" time="0.031">
        </testcase>
        <testcase classname="test/auth/jwt.spec.ts" name="JWT Utilities &gt; extractUsernameFromToken &gt; should return null for malformed token" time="0.068">
        </testcase>
        <testcase classname="test/auth/jwt.spec.ts" name="JWT Utilities &gt; extractUsernameFromToken &gt; should return null if token cannot be decoded" time="0.038">
        </testcase>
        <testcase classname="test/auth/jwt.spec.ts" name="JWT Utilities &gt; extractUserIdFromToken &gt; should extract username (alias)" time="0.023">
        </testcase>
    </testsuite>
    <testsuite name="test/auth/middleware.spec.ts" timestamp="2026-01-01T10:46:50.868Z" hostname="sngvahmed" tests="12" failures="0" errors="0" skipped="0" time="1.13">
        <testcase classname="test/auth/middleware.spec.ts" name="Auth Middleware &gt; authenticateRequest &gt; should authenticate with valid Authorization header" time="0.11">
        </testcase>
        <testcase classname="test/auth/middleware.spec.ts" name="Auth Middleware &gt; authenticateRequest &gt; should authenticate with valid access token cookie" time="0.112">
        </testcase>
        <testcase classname="test/auth/middleware.spec.ts" name="Auth Middleware &gt; authenticateRequest &gt; should fallback to refresh token in header if access token fails and refresh secret provided" time="0.078">
        </testcase>
        <testcase classname="test/auth/middleware.spec.ts" name="Auth Middleware &gt; authenticateRequest &gt; should fallback to refresh token cookie if access token cookie missing" time="0.037">
        </testcase>
        <testcase classname="test/auth/middleware.spec.ts" name="Auth Middleware &gt; authenticateRequest &gt; should return null if no tokens provided" time="0.077">
        </testcase>
        <testcase classname="test/auth/middleware.spec.ts" name="Auth Middleware &gt; authenticateRequest &gt; should return null for invalid token" time="0.04">
        </testcase>
        <testcase classname="test/auth/middleware.spec.ts" name="Auth Middleware &gt; isAdmin &gt; should return true for admin username" time="0.043">
        </testcase>
        <testcase classname="test/auth/middleware.spec.ts" name="Auth Middleware &gt; isAdmin &gt; should return false for other usernames" time="0.065">
        </testcase>
        <testcase classname="test/auth/middleware.spec.ts" name="Auth Middleware &gt; authenticateRequestWithAdmin &gt; should return admin status true for admin user" time="0.084">
        </testcase>
        <testcase classname="test/auth/middleware.spec.ts" name="Auth Middleware &gt; authenticateRequestWithAdmin &gt; should return admin status false for normal user" time="0.033">
        </testcase>
        <testcase classname="test/auth/middleware.spec.ts" name="Auth Middleware &gt; Cookie Helpers &gt; setHttpOnlyCookie should add Set-Cookie header" time="0.033">
        </testcase>
        <testcase classname="test/auth/middleware.spec.ts" name="Auth Middleware &gt; Cookie Helpers &gt; clearHttpOnlyCookie should set immediate expiration" time="0.066">
        </testcase>
    </testsuite>
    <testsuite name="test/auth/username-validation.spec.ts" timestamp="2026-01-01T10:46:50.869Z" hostname="sngvahmed" tests="15" failures="0" errors="0" skipped="0" time="1.662">
        <testcase classname="test/auth/username-validation.spec.ts" name="Username Validation &gt; validateUsernameFormat &gt; accepts valid usernames" time="0.042">
        </testcase>
        <testcase classname="test/auth/username-validation.spec.ts" name="Username Validation &gt; validateUsernameFormat &gt; rejects too short usernames (&lt; 3)" time="0.094">
        </testcase>
        <testcase classname="test/auth/username-validation.spec.ts" name="Username Validation &gt; validateUsernameFormat &gt; rejects too long usernames (&gt; 20)" time="0.032">
        </testcase>
        <testcase classname="test/auth/username-validation.spec.ts" name="Username Validation &gt; validateUsernameFormat &gt; rejects usernames starting with special char" time="0.101">
        </testcase>
        <testcase classname="test/auth/username-validation.spec.ts" name="Username Validation &gt; validateUsernameFormat &gt; rejects usernames ending with special char" time="0.101">
        </testcase>
        <testcase classname="test/auth/username-validation.spec.ts" name="Username Validation &gt; validateUsernameFormat &gt; rejects consecutive underscores" time="0.128">
        </testcase>
        <testcase classname="test/auth/username-validation.spec.ts" name="Username Validation &gt; validateUsernameFormat &gt; rejects consecutive hyphens" time="0.111">
        </testcase>
        <testcase classname="test/auth/username-validation.spec.ts" name="Username Validation &gt; validateUsernameFormat &gt; rejects mixed consecutive special chars" time="0.125">
        </testcase>
        <testcase classname="test/auth/username-validation.spec.ts" name="Username Validation &gt; validateUsernameFormat &gt; rejects invalid characters" time="0.091">
        </testcase>
        <testcase classname="test/auth/username-validation.spec.ts" name="Username Validation &gt; isReservedWord &gt; identifies reserved words (case insensitive)" time="0.084">
        </testcase>
        <testcase classname="test/auth/username-validation.spec.ts" name="Username Validation &gt; isReservedWord &gt; allows non-reserved words" time="0.046">
        </testcase>
        <testcase classname="test/auth/username-validation.spec.ts" name="Username Validation &gt; normalizeUsername &gt; lowercases and trims" time="0.035">
        </testcase>
        <testcase classname="test/auth/username-validation.spec.ts" name="Username Validation &gt; validateUsername (Comprehensive) &gt; returns valid for good username" time="0.07">
        </testcase>
        <testcase classname="test/auth/username-validation.spec.ts" name="Username Validation &gt; validateUsername (Comprehensive) &gt; returns error for reserved word" time="0.037">
        </testcase>
        <testcase classname="test/auth/username-validation.spec.ts" name="Username Validation &gt; validateUsername (Comprehensive) &gt; returns error for invalid format" time="0.079">
        </testcase>
    </testsuite>
    <testsuite name="test/cron/alerts-cron.spec.ts" timestamp="2026-01-01T10:46:50.871Z" hostname="sngvahmed" tests="15" failures="0" errors="0" skipped="0" time="0.937">
        <testcase classname="test/cron/alerts-cron.spec.ts" name="Alert Cron Job &gt; runAlertCron &gt; should skip cron if alertsKv is not configured" time="0.032">
            <system-err>
{&quot;timestamp&quot;:&quot;2026-01-01T10:46:47.291Z&quot;,&quot;service&quot;:&quot;stockly-api&quot;,&quot;level&quot;:&quot;WARN&quot;,&quot;traceId&quot;:&quot;cron-1767264407291&quot;,&quot;userId&quot;:null,&quot;path&quot;:&quot;/cron/alerts&quot;,&quot;message&quot;:&quot;Alerts KV is not configured; skipping cron&quot;,&quot;type&quot;:&quot;general&quot;}

            </system-err>
        </testcase>
        <testcase classname="test/cron/alerts-cron.spec.ts" name="Alert Cron Job &gt; runAlertCron &gt; should skip cron if no active alerts found" time="0.07">
            <system-out>
{&quot;timestamp&quot;:&quot;2026-01-01T10:46:47.326Z&quot;,&quot;service&quot;:&quot;stockly-api&quot;,&quot;level&quot;:&quot;INFO&quot;,&quot;traceId&quot;:&quot;cron-1767264407326&quot;,&quot;userId&quot;:null,&quot;path&quot;:&quot;/cron/alerts&quot;,&quot;message&quot;:&quot;Starting alert evaluation cron job&quot;,&quot;type&quot;:&quot;general&quot;}

{&quot;timestamp&quot;:&quot;2026-01-01T10:46:47.327Z&quot;,&quot;service&quot;:&quot;stockly-api&quot;,&quot;level&quot;:&quot;INFO&quot;,&quot;traceId&quot;:&quot;cron-1767264407326&quot;,&quot;userId&quot;:null,&quot;path&quot;:&quot;/cron/alerts&quot;,&quot;message&quot;:&quot;No active alerts found&quot;,&quot;type&quot;:&quot;general&quot;}

            </system-out>
        </testcase>
        <testcase classname="test/cron/alerts-cron.spec.ts" name="Alert Cron Job &gt; runAlertCron &gt; should process alerts and send notifications" time="0.045">
            <system-out>
{&quot;timestamp&quot;:&quot;2026-01-01T10:46:47.397Z&quot;,&quot;service&quot;:&quot;stockly-api&quot;,&quot;level&quot;:&quot;INFO&quot;,&quot;traceId&quot;:&quot;cron-1767264407397&quot;,&quot;userId&quot;:null,&quot;path&quot;:&quot;/cron/alerts&quot;,&quot;message&quot;:&quot;Starting alert evaluation cron job&quot;,&quot;type&quot;:&quot;general&quot;}

{&quot;timestamp&quot;:&quot;2026-01-01T10:46:47.397Z&quot;,&quot;service&quot;:&quot;stockly-api&quot;,&quot;level&quot;:&quot;INFO&quot;,&quot;traceId&quot;:&quot;cron-1767264407397&quot;,&quot;userId&quot;:null,&quot;path&quot;:&quot;/cron/alerts&quot;,&quot;message&quot;:&quot;Processing 1 active alerts&quot;,&quot;type&quot;:&quot;general&quot;}
{&quot;timestamp&quot;:&quot;2026-01-01T10:46:47.397Z&quot;,&quot;service&quot;:&quot;stockly-api&quot;,&quot;level&quot;:&quot;DEBUG&quot;,&quot;traceId&quot;:&quot;cron-1767264407397&quot;,&quot;userId&quot;:null,&quot;path&quot;:&quot;/cron/alerts&quot;,&quot;message&quot;:&quot;Fetching prices for 1 unique symbols&quot;,&quot;type&quot;:&quot;general&quot;,&quot;symbols&quot;:[&quot;AAPL&quot;]}

{&quot;timestamp&quot;:&quot;2026-01-01T10:46:47.397Z&quot;,&quot;service&quot;:&quot;stockly-api&quot;,&quot;level&quot;:&quot;INFO&quot;,&quot;traceId&quot;:&quot;cron-1767264407397&quot;,&quot;userId&quot;:null,&quot;path&quot;:&quot;/cron/alerts&quot;,&quot;message&quot;:&quot;Successfully fetched prices for 1 symbols&quot;,&quot;type&quot;:&quot;general&quot;}

{&quot;timestamp&quot;:&quot;2026-01-01T10:46:47.398Z&quot;,&quot;service&quot;:&quot;stockly-api&quot;,&quot;level&quot;:&quot;INFO&quot;,&quot;traceId&quot;:&quot;cron-1767264407397&quot;,&quot;userId&quot;:null,&quot;path&quot;:&quot;/cron/alerts&quot;,&quot;message&quot;:&quot;Evaluated 1 alerts, 1 triggered&quot;,&quot;type&quot;:&quot;general&quot;}
{&quot;timestamp&quot;:&quot;2026-01-01T10:46:47.398Z&quot;,&quot;service&quot;:&quot;stockly-api&quot;,&quot;level&quot;:&quot;INFO&quot;,&quot;traceId&quot;:&quot;cron-1767264407397&quot;,&quot;userId&quot;:null,&quot;path&quot;:&quot;/cron/alerts&quot;,&quot;message&quot;:&quot;Alert triggered&quot;,&quot;type&quot;:&quot;general&quot;,&quot;alertId&quot;:&quot;alert-1&quot;,&quot;symbol&quot;:&quot;AAPL&quot;,&quot;price&quot;:205,&quot;direction&quot;:&quot;above&quot;,&quot;threshold&quot;:200,&quot;channel&quot;:&quot;notification&quot;}

{&quot;timestamp&quot;:&quot;2026-01-01T10:46:47.398Z&quot;,&quot;service&quot;:&quot;stockly-api&quot;,&quot;level&quot;:&quot;INFO&quot;,&quot;traceId&quot;:&quot;cron-1767264407397&quot;,&quot;userId&quot;:null,&quot;path&quot;:&quot;/cron/alerts&quot;,&quot;message&quot;:&quot;FCM notification sent successfully&quot;,&quot;type&quot;:&quot;general&quot;,&quot;alertId&quot;:&quot;alert-1&quot;,&quot;symbol&quot;:&quot;AAPL&quot;,&quot;pushToken&quot;:&quot;fcm-token-123&quot;}

{&quot;timestamp&quot;:&quot;2026-01-01T10:46:47.398Z&quot;,&quot;service&quot;:&quot;stockly-api&quot;,&quot;level&quot;:&quot;INFO&quot;,&quot;traceId&quot;:&quot;cron-1767264407397&quot;,&quot;userId&quot;:null,&quot;path&quot;:&quot;/cron/alerts&quot;,&quot;message&quot;:&quot;Alert notification sent to all user devices&quot;,&quot;type&quot;:&quot;general&quot;,&quot;alertId&quot;:&quot;alert-1&quot;,&quot;symbol&quot;:&quot;AAPL&quot;,&quot;username&quot;:&quot;testuser&quot;,&quot;devicesCount&quot;:1,&quot;successCount&quot;:1,&quot;failCount&quot;:0}
{&quot;timestamp&quot;:&quot;2026-01-01T10:46:47.398Z&quot;,&quot;service&quot;:&quot;stockly-api&quot;,&quot;level&quot;:&quot;INFO&quot;,&quot;traceId&quot;:&quot;cron-1767264407397&quot;,&quot;userId&quot;:null,&quot;path&quot;:&quot;/cron/alerts&quot;,&quot;message&quot;:&quot;Alert cron job completed successfully&quot;,&quot;type&quot;:&quot;general&quot;,&quot;alertsProcessed&quot;:1,&quot;notificationsSent&quot;:1}

            </system-out>
            <system-err>
{&quot;timestamp&quot;:&quot;2026-01-01T10:46:47.397Z&quot;,&quot;service&quot;:&quot;stockly-api&quot;,&quot;level&quot;:&quot;WARN&quot;,&quot;traceId&quot;:&quot;cron-1767264407397&quot;,&quot;userId&quot;:null,&quot;path&quot;:&quot;/cron/alerts&quot;,&quot;message&quot;:&quot;Market cache refresh failed (non-blocking)&quot;,&quot;type&quot;:&quot;general&quot;}

            </system-err>
        </testcase>
        <testcase classname="test/cron/alerts-cron.spec.ts" name="Alert Cron Job &gt; runAlertCron &gt; should handle fetch price failures gracefully" time="0.121">
            <system-out>
{&quot;timestamp&quot;:&quot;2026-01-01T10:46:47.525Z&quot;,&quot;service&quot;:&quot;stockly-api&quot;,&quot;level&quot;:&quot;INFO&quot;,&quot;traceId&quot;:&quot;cron-1767264407525&quot;,&quot;userId&quot;:null,&quot;path&quot;:&quot;/cron/alerts&quot;,&quot;message&quot;:&quot;Starting alert evaluation cron job&quot;,&quot;type&quot;:&quot;general&quot;}

{&quot;timestamp&quot;:&quot;2026-01-01T10:46:47.525Z&quot;,&quot;service&quot;:&quot;stockly-api&quot;,&quot;level&quot;:&quot;INFO&quot;,&quot;traceId&quot;:&quot;cron-1767264407525&quot;,&quot;userId&quot;:null,&quot;path&quot;:&quot;/cron/alerts&quot;,&quot;message&quot;:&quot;Processing 1 active alerts&quot;,&quot;type&quot;:&quot;general&quot;}
{&quot;timestamp&quot;:&quot;2026-01-01T10:46:47.525Z&quot;,&quot;service&quot;:&quot;stockly-api&quot;,&quot;level&quot;:&quot;DEBUG&quot;,&quot;traceId&quot;:&quot;cron-1767264407525&quot;,&quot;userId&quot;:null,&quot;path&quot;:&quot;/cron/alerts&quot;,&quot;message&quot;:&quot;Fetching prices for 1 unique symbols&quot;,&quot;type&quot;:&quot;general&quot;,&quot;symbols&quot;:[&quot;AAPL&quot;]}

            </system-out>
            <system-err>
{&quot;timestamp&quot;:&quot;2026-01-01T10:46:47.525Z&quot;,&quot;service&quot;:&quot;stockly-api&quot;,&quot;level&quot;:&quot;ERROR&quot;,&quot;traceId&quot;:&quot;cron-1767264407525&quot;,&quot;userId&quot;:null,&quot;path&quot;:&quot;/cron/alerts&quot;,&quot;message&quot;:&quot;Failed to fetch quote for alert&quot;,&quot;type&quot;:&quot;general&quot;,&quot;symbol&quot;:&quot;AAPL&quot;,&quot;error&quot;:{&quot;name&quot;:&quot;Error&quot;,&quot;message&quot;:&quot;Network error&quot;,&quot;stack&quot;:&quot;Error: Network error\n    at /home/sngvahmed/workspace/stockly/api/test/cron/alerts-cron.spec.ts:261:49\n    at home/sngvahmed/workspace/stockly/node_modules/@vitest/runner/dist/chunk-hooks.js:155:11\n    at home/sngvahmed/workspace/stockly/node_modules/@vitest/runner/dist/chunk-hooks.js:752:26\n    at home/sngvahmed/workspace/stockly/node_modules/@vitest/runner/dist/chunk-hooks.js:1897:20\n    at new Promise (&lt;anonymous&gt;)\n    at runWithTimeout (home/sngvahmed/workspace/stockly/node_modules/@vitest/runner/dist/chunk-hooks.js:1863:10)\n    at runTest (home/sngvahmed/workspace/stockly/node_modules/@vitest/runner/dist/chunk-hooks.js:1574:12)\n    at runSuite (home/sngvahmed/workspace/stockly/node_modules/@vitest/runner/dist/chunk-hooks.js:1729:8)\n    at runSuite (home/sngvahmed/workspace/stockly/node_modules/@vitest/runner/dist/chunk-hooks.js:1729:8)\n    at runSuite (home/sngvahmed/workspace/stockly/node_modules/@vitest/runner/dist/chunk-hooks.js:1729:8)&quot;}}

{&quot;timestamp&quot;:&quot;2026-01-01T10:46:47.528Z&quot;,&quot;service&quot;:&quot;stockly-api&quot;,&quot;level&quot;:&quot;WARN&quot;,&quot;traceId&quot;:&quot;cron-1767264407525&quot;,&quot;userId&quot;:null,&quot;path&quot;:&quot;/cron/alerts&quot;,&quot;message&quot;:&quot;No prices available for alerts run&quot;,&quot;type&quot;:&quot;general&quot;,&quot;symbols&quot;:[&quot;AAPL&quot;]}

            </system-err>
        </testcase>
        <testcase classname="test/cron/alerts-cron.spec.ts" name="Alert Cron Job &gt; runAlertCron &gt; should skip alert with old Expo token" time="0.079">
            <system-out>
{&quot;timestamp&quot;:&quot;2026-01-01T10:46:47.601Z&quot;,&quot;service&quot;:&quot;stockly-api&quot;,&quot;level&quot;:&quot;INFO&quot;,&quot;traceId&quot;:&quot;cron-1767264407601&quot;,&quot;userId&quot;:null,&quot;path&quot;:&quot;/cron/alerts&quot;,&quot;message&quot;:&quot;Starting alert evaluation cron job&quot;,&quot;type&quot;:&quot;general&quot;}

{&quot;timestamp&quot;:&quot;2026-01-01T10:46:47.601Z&quot;,&quot;service&quot;:&quot;stockly-api&quot;,&quot;level&quot;:&quot;INFO&quot;,&quot;traceId&quot;:&quot;cron-1767264407601&quot;,&quot;userId&quot;:null,&quot;path&quot;:&quot;/cron/alerts&quot;,&quot;message&quot;:&quot;Processing 1 active alerts&quot;,&quot;type&quot;:&quot;general&quot;}
{&quot;timestamp&quot;:&quot;2026-01-01T10:46:47.601Z&quot;,&quot;service&quot;:&quot;stockly-api&quot;,&quot;level&quot;:&quot;DEBUG&quot;,&quot;traceId&quot;:&quot;cron-1767264407601&quot;,&quot;userId&quot;:null,&quot;path&quot;:&quot;/cron/alerts&quot;,&quot;message&quot;:&quot;Fetching prices for 1 unique symbols&quot;,&quot;type&quot;:&quot;general&quot;,&quot;symbols&quot;:[&quot;AAPL&quot;]}

{&quot;timestamp&quot;:&quot;2026-01-01T10:46:47.602Z&quot;,&quot;service&quot;:&quot;stockly-api&quot;,&quot;level&quot;:&quot;INFO&quot;,&quot;traceId&quot;:&quot;cron-1767264407601&quot;,&quot;userId&quot;:null,&quot;path&quot;:&quot;/cron/alerts&quot;,&quot;message&quot;:&quot;Successfully fetched prices for 1 symbols&quot;,&quot;type&quot;:&quot;general&quot;}

{&quot;timestamp&quot;:&quot;2026-01-01T10:46:47.602Z&quot;,&quot;service&quot;:&quot;stockly-api&quot;,&quot;level&quot;:&quot;INFO&quot;,&quot;traceId&quot;:&quot;cron-1767264407601&quot;,&quot;userId&quot;:null,&quot;path&quot;:&quot;/cron/alerts&quot;,&quot;message&quot;:&quot;Evaluated 1 alerts, 1 triggered&quot;,&quot;type&quot;:&quot;general&quot;}
{&quot;timestamp&quot;:&quot;2026-01-01T10:46:47.602Z&quot;,&quot;service&quot;:&quot;stockly-api&quot;,&quot;level&quot;:&quot;INFO&quot;,&quot;traceId&quot;:&quot;cron-1767264407601&quot;,&quot;userId&quot;:null,&quot;path&quot;:&quot;/cron/alerts&quot;,&quot;message&quot;:&quot;Alert triggered&quot;,&quot;type&quot;:&quot;general&quot;,&quot;alertId&quot;:&quot;alert-1&quot;,&quot;symbol&quot;:&quot;AAPL&quot;,&quot;price&quot;:205,&quot;direction&quot;:&quot;above&quot;,&quot;threshold&quot;:200,&quot;channel&quot;:&quot;notification&quot;}

{&quot;timestamp&quot;:&quot;2026-01-01T10:46:47.602Z&quot;,&quot;service&quot;:&quot;stockly-api&quot;,&quot;level&quot;:&quot;INFO&quot;,&quot;traceId&quot;:&quot;cron-1767264407601&quot;,&quot;userId&quot;:null,&quot;path&quot;:&quot;/cron/alerts&quot;,&quot;message&quot;:&quot;Alert notification sent to all user devices&quot;,&quot;type&quot;:&quot;general&quot;,&quot;alertId&quot;:&quot;alert-1&quot;,&quot;symbol&quot;:&quot;AAPL&quot;,&quot;username&quot;:&quot;testuser&quot;,&quot;devicesCount&quot;:1,&quot;successCount&quot;:0,&quot;failCount&quot;:1}
{&quot;timestamp&quot;:&quot;2026-01-01T10:46:47.602Z&quot;,&quot;service&quot;:&quot;stockly-api&quot;,&quot;level&quot;:&quot;INFO&quot;,&quot;traceId&quot;:&quot;cron-1767264407601&quot;,&quot;userId&quot;:null,&quot;path&quot;:&quot;/cron/alerts&quot;,&quot;message&quot;:&quot;Alert cron job completed successfully&quot;,&quot;type&quot;:&quot;general&quot;,&quot;alertsProcessed&quot;:1,&quot;notificationsSent&quot;:1}

            </system-out>
            <system-err>
{&quot;timestamp&quot;:&quot;2026-01-01T10:46:47.602Z&quot;,&quot;service&quot;:&quot;stockly-api&quot;,&quot;level&quot;:&quot;WARN&quot;,&quot;traceId&quot;:&quot;cron-1767264407601&quot;,&quot;userId&quot;:null,&quot;path&quot;:&quot;/cron/alerts&quot;,&quot;message&quot;:&quot;Market cache refresh failed (non-blocking)&quot;,&quot;type&quot;:&quot;general&quot;}

{&quot;timestamp&quot;:&quot;2026-01-01T10:46:47.602Z&quot;,&quot;service&quot;:&quot;stockly-api&quot;,&quot;level&quot;:&quot;WARN&quot;,&quot;traceId&quot;:&quot;cron-1767264407601&quot;,&quot;userId&quot;:null,&quot;path&quot;:&quot;/cron/alerts&quot;,&quot;message&quot;:&quot;Skipping alert with old Expo token - FCM migration required&quot;,&quot;type&quot;:&quot;general&quot;,&quot;alertId&quot;:&quot;alert-1&quot;,&quot;symbol&quot;:&quot;AAPL&quot;,&quot;pushToken&quot;:&quot;ExponentPushToken[123]&quot;}

            </system-err>
        </testcase>
        <testcase classname="test/cron/alerts-cron.spec.ts" name="Alert Cron Job &gt; runAlertCron &gt; should log failed FCM notifications" time="0.091">
            <system-out>
{&quot;timestamp&quot;:&quot;2026-01-01T10:46:47.640Z&quot;,&quot;service&quot;:&quot;stockly-api&quot;,&quot;level&quot;:&quot;INFO&quot;,&quot;traceId&quot;:&quot;cron-1767264407640&quot;,&quot;userId&quot;:null,&quot;path&quot;:&quot;/cron/alerts&quot;,&quot;message&quot;:&quot;Starting alert evaluation cron job&quot;,&quot;type&quot;:&quot;general&quot;}

{&quot;timestamp&quot;:&quot;2026-01-01T10:46:47.641Z&quot;,&quot;service&quot;:&quot;stockly-api&quot;,&quot;level&quot;:&quot;INFO&quot;,&quot;traceId&quot;:&quot;cron-1767264407640&quot;,&quot;userId&quot;:null,&quot;path&quot;:&quot;/cron/alerts&quot;,&quot;message&quot;:&quot;Processing 1 active alerts&quot;,&quot;type&quot;:&quot;general&quot;}
{&quot;timestamp&quot;:&quot;2026-01-01T10:46:47.641Z&quot;,&quot;service&quot;:&quot;stockly-api&quot;,&quot;level&quot;:&quot;DEBUG&quot;,&quot;traceId&quot;:&quot;cron-1767264407640&quot;,&quot;userId&quot;:null,&quot;path&quot;:&quot;/cron/alerts&quot;,&quot;message&quot;:&quot;Fetching prices for 1 unique symbols&quot;,&quot;type&quot;:&quot;general&quot;,&quot;symbols&quot;:[&quot;AAPL&quot;]}

{&quot;timestamp&quot;:&quot;2026-01-01T10:46:47.641Z&quot;,&quot;service&quot;:&quot;stockly-api&quot;,&quot;level&quot;:&quot;INFO&quot;,&quot;traceId&quot;:&quot;cron-1767264407640&quot;,&quot;userId&quot;:null,&quot;path&quot;:&quot;/cron/alerts&quot;,&quot;message&quot;:&quot;Successfully fetched prices for 1 symbols&quot;,&quot;type&quot;:&quot;general&quot;}

{&quot;timestamp&quot;:&quot;2026-01-01T10:46:47.641Z&quot;,&quot;service&quot;:&quot;stockly-api&quot;,&quot;level&quot;:&quot;INFO&quot;,&quot;traceId&quot;:&quot;cron-1767264407640&quot;,&quot;userId&quot;:null,&quot;path&quot;:&quot;/cron/alerts&quot;,&quot;message&quot;:&quot;Evaluated 1 alerts, 1 triggered&quot;,&quot;type&quot;:&quot;general&quot;}
{&quot;timestamp&quot;:&quot;2026-01-01T10:46:47.641Z&quot;,&quot;service&quot;:&quot;stockly-api&quot;,&quot;level&quot;:&quot;INFO&quot;,&quot;traceId&quot;:&quot;cron-1767264407640&quot;,&quot;userId&quot;:null,&quot;path&quot;:&quot;/cron/alerts&quot;,&quot;message&quot;:&quot;Alert triggered&quot;,&quot;type&quot;:&quot;general&quot;,&quot;alertId&quot;:&quot;alert-1&quot;,&quot;symbol&quot;:&quot;AAPL&quot;,&quot;price&quot;:205,&quot;direction&quot;:&quot;above&quot;,&quot;threshold&quot;:200,&quot;channel&quot;:&quot;notification&quot;}

{&quot;timestamp&quot;:&quot;2026-01-01T10:46:47.642Z&quot;,&quot;service&quot;:&quot;stockly-api&quot;,&quot;level&quot;:&quot;INFO&quot;,&quot;traceId&quot;:&quot;cron-1767264407640&quot;,&quot;userId&quot;:null,&quot;path&quot;:&quot;/cron/alerts&quot;,&quot;message&quot;:&quot;Alert notification sent to all user devices&quot;,&quot;type&quot;:&quot;general&quot;,&quot;alertId&quot;:&quot;alert-1&quot;,&quot;symbol&quot;:&quot;AAPL&quot;,&quot;username&quot;:&quot;testuser&quot;,&quot;devicesCount&quot;:1,&quot;successCount&quot;:0,&quot;failCount&quot;:1}
{&quot;timestamp&quot;:&quot;2026-01-01T10:46:47.642Z&quot;,&quot;service&quot;:&quot;stockly-api&quot;,&quot;level&quot;:&quot;INFO&quot;,&quot;traceId&quot;:&quot;cron-1767264407640&quot;,&quot;userId&quot;:null,&quot;path&quot;:&quot;/cron/alerts&quot;,&quot;message&quot;:&quot;Alert cron job completed successfully&quot;,&quot;type&quot;:&quot;general&quot;,&quot;alertsProcessed&quot;:1,&quot;notificationsSent&quot;:1}

            </system-out>
            <system-err>
{&quot;timestamp&quot;:&quot;2026-01-01T10:46:47.641Z&quot;,&quot;service&quot;:&quot;stockly-api&quot;,&quot;level&quot;:&quot;WARN&quot;,&quot;traceId&quot;:&quot;cron-1767264407640&quot;,&quot;userId&quot;:null,&quot;path&quot;:&quot;/cron/alerts&quot;,&quot;message&quot;:&quot;Market cache refresh failed (non-blocking)&quot;,&quot;type&quot;:&quot;general&quot;}

{&quot;timestamp&quot;:&quot;2026-01-01T10:46:47.641Z&quot;,&quot;service&quot;:&quot;stockly-api&quot;,&quot;level&quot;:&quot;ERROR&quot;,&quot;traceId&quot;:&quot;cron-1767264407640&quot;,&quot;userId&quot;:null,&quot;path&quot;:&quot;/cron/alerts&quot;,&quot;message&quot;:&quot;Failed to send FCM notification&quot;,&quot;type&quot;:&quot;general&quot;,&quot;alertId&quot;:&quot;alert-1&quot;,&quot;symbol&quot;:&quot;AAPL&quot;,&quot;pushToken&quot;:&quot;fcm-token-123&quot;,&quot;error&quot;:{&quot;name&quot;:&quot;Error&quot;,&quot;message&quot;:&quot;FCM send returned false&quot;,&quot;stack&quot;:&quot;Error: FCM send returned false\n    at Module.runAlertCron (/home/sngvahmed/workspace/stockly/api/src/cron/alerts-cron.ts:247:63)\n    at /home/sngvahmed/workspace/stockly/api/test/cron/alerts-cron.spec.ts:390:7\n    at home/sngvahmed/workspace/stockly/node_modules/@vitest/runner/dist/chunk-hooks.js:752:20&quot;}}

            </system-err>
        </testcase>
        <testcase classname="test/cron/alerts-cron.spec.ts" name="Alert Cron Job &gt; runAlertCron &gt; should handle FCM notification errors" time="0.043">
            <system-out>
{&quot;timestamp&quot;:&quot;2026-01-01T10:46:47.731Z&quot;,&quot;service&quot;:&quot;stockly-api&quot;,&quot;level&quot;:&quot;INFO&quot;,&quot;traceId&quot;:&quot;cron-1767264407731&quot;,&quot;userId&quot;:null,&quot;path&quot;:&quot;/cron/alerts&quot;,&quot;message&quot;:&quot;Starting alert evaluation cron job&quot;,&quot;type&quot;:&quot;general&quot;}

{&quot;timestamp&quot;:&quot;2026-01-01T10:46:47.732Z&quot;,&quot;service&quot;:&quot;stockly-api&quot;,&quot;level&quot;:&quot;INFO&quot;,&quot;traceId&quot;:&quot;cron-1767264407731&quot;,&quot;userId&quot;:null,&quot;path&quot;:&quot;/cron/alerts&quot;,&quot;message&quot;:&quot;Processing 1 active alerts&quot;,&quot;type&quot;:&quot;general&quot;}
{&quot;timestamp&quot;:&quot;2026-01-01T10:46:47.732Z&quot;,&quot;service&quot;:&quot;stockly-api&quot;,&quot;level&quot;:&quot;DEBUG&quot;,&quot;traceId&quot;:&quot;cron-1767264407731&quot;,&quot;userId&quot;:null,&quot;path&quot;:&quot;/cron/alerts&quot;,&quot;message&quot;:&quot;Fetching prices for 1 unique symbols&quot;,&quot;type&quot;:&quot;general&quot;,&quot;symbols&quot;:[&quot;AAPL&quot;]}

{&quot;timestamp&quot;:&quot;2026-01-01T10:46:47.732Z&quot;,&quot;service&quot;:&quot;stockly-api&quot;,&quot;level&quot;:&quot;INFO&quot;,&quot;traceId&quot;:&quot;cron-1767264407731&quot;,&quot;userId&quot;:null,&quot;path&quot;:&quot;/cron/alerts&quot;,&quot;message&quot;:&quot;Successfully fetched prices for 1 symbols&quot;,&quot;type&quot;:&quot;general&quot;}

{&quot;timestamp&quot;:&quot;2026-01-01T10:46:47.732Z&quot;,&quot;service&quot;:&quot;stockly-api&quot;,&quot;level&quot;:&quot;INFO&quot;,&quot;traceId&quot;:&quot;cron-1767264407731&quot;,&quot;userId&quot;:null,&quot;path&quot;:&quot;/cron/alerts&quot;,&quot;message&quot;:&quot;Evaluated 1 alerts, 1 triggered&quot;,&quot;type&quot;:&quot;general&quot;}
{&quot;timestamp&quot;:&quot;2026-01-01T10:46:47.732Z&quot;,&quot;service&quot;:&quot;stockly-api&quot;,&quot;level&quot;:&quot;INFO&quot;,&quot;traceId&quot;:&quot;cron-1767264407731&quot;,&quot;userId&quot;:null,&quot;path&quot;:&quot;/cron/alerts&quot;,&quot;message&quot;:&quot;Alert triggered&quot;,&quot;type&quot;:&quot;general&quot;,&quot;alertId&quot;:&quot;alert-1&quot;,&quot;symbol&quot;:&quot;AAPL&quot;,&quot;price&quot;:205,&quot;direction&quot;:&quot;above&quot;,&quot;threshold&quot;:200,&quot;channel&quot;:&quot;notification&quot;}

{&quot;timestamp&quot;:&quot;2026-01-01T10:46:47.732Z&quot;,&quot;service&quot;:&quot;stockly-api&quot;,&quot;level&quot;:&quot;INFO&quot;,&quot;traceId&quot;:&quot;cron-1767264407731&quot;,&quot;userId&quot;:null,&quot;path&quot;:&quot;/cron/alerts&quot;,&quot;message&quot;:&quot;Alert notification sent to all user devices&quot;,&quot;type&quot;:&quot;general&quot;,&quot;alertId&quot;:&quot;alert-1&quot;,&quot;symbol&quot;:&quot;AAPL&quot;,&quot;username&quot;:&quot;testuser&quot;,&quot;devicesCount&quot;:1,&quot;successCount&quot;:0,&quot;failCount&quot;:1}
{&quot;timestamp&quot;:&quot;2026-01-01T10:46:47.732Z&quot;,&quot;service&quot;:&quot;stockly-api&quot;,&quot;level&quot;:&quot;INFO&quot;,&quot;traceId&quot;:&quot;cron-1767264407731&quot;,&quot;userId&quot;:null,&quot;path&quot;:&quot;/cron/alerts&quot;,&quot;message&quot;:&quot;Alert cron job completed successfully&quot;,&quot;type&quot;:&quot;general&quot;,&quot;alertsProcessed&quot;:1,&quot;notificationsSent&quot;:1}

            </system-out>
            <system-err>
{&quot;timestamp&quot;:&quot;2026-01-01T10:46:47.732Z&quot;,&quot;service&quot;:&quot;stockly-api&quot;,&quot;level&quot;:&quot;WARN&quot;,&quot;traceId&quot;:&quot;cron-1767264407731&quot;,&quot;userId&quot;:null,&quot;path&quot;:&quot;/cron/alerts&quot;,&quot;message&quot;:&quot;Market cache refresh failed (non-blocking)&quot;,&quot;type&quot;:&quot;general&quot;}

{&quot;timestamp&quot;:&quot;2026-01-01T10:46:47.732Z&quot;,&quot;service&quot;:&quot;stockly-api&quot;,&quot;level&quot;:&quot;ERROR&quot;,&quot;traceId&quot;:&quot;cron-1767264407731&quot;,&quot;userId&quot;:null,&quot;path&quot;:&quot;/cron/alerts&quot;,&quot;message&quot;:&quot;Error sending FCM notification&quot;,&quot;type&quot;:&quot;general&quot;,&quot;alertId&quot;:&quot;alert-1&quot;,&quot;symbol&quot;:&quot;AAPL&quot;,&quot;pushToken&quot;:&quot;fcm-token-123&quot;,&quot;error&quot;:{&quot;name&quot;:&quot;Error&quot;,&quot;message&quot;:&quot;FCM send failed&quot;,&quot;stack&quot;:&quot;Error: FCM send failed\n    at /home/sngvahmed/workspace/stockly/api/test/cron/alerts-cron.spec.ts:428:9\n    at home/sngvahmed/workspace/stockly/node_modules/@vitest/runner/dist/chunk-hooks.js:155:11\n    at home/sngvahmed/workspace/stockly/node_modules/@vitest/runner/dist/chunk-hooks.js:752:26\n    at home/sngvahmed/workspace/stockly/node_modules/@vitest/runner/dist/chunk-hooks.js:1897:20\n    at new Promise (&lt;anonymous&gt;)\n    at runWithTimeout (home/sngvahmed/workspace/stockly/node_modules/@vitest/runner/dist/chunk-hooks.js:1863:10)\n    at runTest (home/sngvahmed/workspace/stockly/node_modules/@vitest/runner/dist/chunk-hooks.js:1574:12)\n    at runSuite (home/sngvahmed/workspace/stockly/node_modules/@vitest/runner/dist/chunk-hooks.js:1729:8)\n    at runSuite (home/sngvahmed/workspace/stockly/node_modules/@vitest/runner/dist/chunk-hooks.js:1729:8)\n    at runSuite (home/sngvahmed/workspace/stockly/node_modules/@vitest/runner/dist/chunk-hooks.js:1729:8)&quot;}}

            </system-err>
        </testcase>
        <testcase classname="test/cron/alerts-cron.spec.ts" name="Alert Cron Job &gt; runAlertCron &gt; should handle multiple alerts" time="0.096">
            <system-out>
{&quot;timestamp&quot;:&quot;2026-01-01T10:46:47.835Z&quot;,&quot;service&quot;:&quot;stockly-api&quot;,&quot;level&quot;:&quot;INFO&quot;,&quot;traceId&quot;:&quot;cron-1767264407835&quot;,&quot;userId&quot;:null,&quot;path&quot;:&quot;/cron/alerts&quot;,&quot;message&quot;:&quot;Starting alert evaluation cron job&quot;,&quot;type&quot;:&quot;general&quot;}

{&quot;timestamp&quot;:&quot;2026-01-01T10:46:47.835Z&quot;,&quot;service&quot;:&quot;stockly-api&quot;,&quot;level&quot;:&quot;INFO&quot;,&quot;traceId&quot;:&quot;cron-1767264407835&quot;,&quot;userId&quot;:null,&quot;path&quot;:&quot;/cron/alerts&quot;,&quot;message&quot;:&quot;Processing 2 active alerts&quot;,&quot;type&quot;:&quot;general&quot;}
{&quot;timestamp&quot;:&quot;2026-01-01T10:46:47.835Z&quot;,&quot;service&quot;:&quot;stockly-api&quot;,&quot;level&quot;:&quot;DEBUG&quot;,&quot;traceId&quot;:&quot;cron-1767264407835&quot;,&quot;userId&quot;:null,&quot;path&quot;:&quot;/cron/alerts&quot;,&quot;message&quot;:&quot;Fetching prices for 2 unique symbols&quot;,&quot;type&quot;:&quot;general&quot;,&quot;symbols&quot;:[&quot;AAPL&quot;,&quot;MSFT&quot;]}

{&quot;timestamp&quot;:&quot;2026-01-01T10:46:47.835Z&quot;,&quot;service&quot;:&quot;stockly-api&quot;,&quot;level&quot;:&quot;INFO&quot;,&quot;traceId&quot;:&quot;cron-1767264407835&quot;,&quot;userId&quot;:null,&quot;path&quot;:&quot;/cron/alerts&quot;,&quot;message&quot;:&quot;Successfully fetched prices for 2 symbols&quot;,&quot;type&quot;:&quot;general&quot;}

{&quot;timestamp&quot;:&quot;2026-01-01T10:46:47.835Z&quot;,&quot;service&quot;:&quot;stockly-api&quot;,&quot;level&quot;:&quot;INFO&quot;,&quot;traceId&quot;:&quot;cron-1767264407835&quot;,&quot;userId&quot;:null,&quot;path&quot;:&quot;/cron/alerts&quot;,&quot;message&quot;:&quot;Evaluated 2 alerts, 2 triggered&quot;,&quot;type&quot;:&quot;general&quot;}
{&quot;timestamp&quot;:&quot;2026-01-01T10:46:47.835Z&quot;,&quot;service&quot;:&quot;stockly-api&quot;,&quot;level&quot;:&quot;INFO&quot;,&quot;traceId&quot;:&quot;cron-1767264407835&quot;,&quot;userId&quot;:null,&quot;path&quot;:&quot;/cron/alerts&quot;,&quot;message&quot;:&quot;Alert triggered&quot;,&quot;type&quot;:&quot;general&quot;,&quot;alertId&quot;:&quot;alert-1&quot;,&quot;symbol&quot;:&quot;AAPL&quot;,&quot;price&quot;:205,&quot;direction&quot;:&quot;above&quot;,&quot;threshold&quot;:200,&quot;channel&quot;:&quot;notification&quot;}

{&quot;timestamp&quot;:&quot;2026-01-01T10:46:47.835Z&quot;,&quot;service&quot;:&quot;stockly-api&quot;,&quot;level&quot;:&quot;INFO&quot;,&quot;traceId&quot;:&quot;cron-1767264407835&quot;,&quot;userId&quot;:null,&quot;path&quot;:&quot;/cron/alerts&quot;,&quot;message&quot;:&quot;FCM notification sent successfully&quot;,&quot;type&quot;:&quot;general&quot;,&quot;alertId&quot;:&quot;alert-1&quot;,&quot;symbol&quot;:&quot;AAPL&quot;,&quot;pushToken&quot;:&quot;fcm-token-123&quot;}

{&quot;timestamp&quot;:&quot;2026-01-01T10:46:47.835Z&quot;,&quot;service&quot;:&quot;stockly-api&quot;,&quot;level&quot;:&quot;INFO&quot;,&quot;traceId&quot;:&quot;cron-1767264407835&quot;,&quot;userId&quot;:null,&quot;path&quot;:&quot;/cron/alerts&quot;,&quot;message&quot;:&quot;Alert notification sent to all user devices&quot;,&quot;type&quot;:&quot;general&quot;,&quot;alertId&quot;:&quot;alert-1&quot;,&quot;symbol&quot;:&quot;AAPL&quot;,&quot;username&quot;:&quot;testuser&quot;,&quot;devicesCount&quot;:1,&quot;successCount&quot;:1,&quot;failCount&quot;:0}
{&quot;timestamp&quot;:&quot;2026-01-01T10:46:47.835Z&quot;,&quot;service&quot;:&quot;stockly-api&quot;,&quot;level&quot;:&quot;INFO&quot;,&quot;traceId&quot;:&quot;cron-1767264407835&quot;,&quot;userId&quot;:null,&quot;path&quot;:&quot;/cron/alerts&quot;,&quot;message&quot;:&quot;Alert triggered&quot;,&quot;type&quot;:&quot;general&quot;,&quot;alertId&quot;:&quot;alert-2&quot;,&quot;symbol&quot;:&quot;MSFT&quot;,&quot;price&quot;:310,&quot;direction&quot;:&quot;above&quot;,&quot;threshold&quot;:300,&quot;channel&quot;:&quot;notification&quot;}

{&quot;timestamp&quot;:&quot;2026-01-01T10:46:47.835Z&quot;,&quot;service&quot;:&quot;stockly-api&quot;,&quot;level&quot;:&quot;INFO&quot;,&quot;traceId&quot;:&quot;cron-1767264407835&quot;,&quot;userId&quot;:null,&quot;path&quot;:&quot;/cron/alerts&quot;,&quot;message&quot;:&quot;FCM notification sent successfully&quot;,&quot;type&quot;:&quot;general&quot;,&quot;alertId&quot;:&quot;alert-2&quot;,&quot;symbol&quot;:&quot;MSFT&quot;,&quot;pushToken&quot;:&quot;fcm-token-123&quot;}

{&quot;timestamp&quot;:&quot;2026-01-01T10:46:47.835Z&quot;,&quot;service&quot;:&quot;stockly-api&quot;,&quot;level&quot;:&quot;INFO&quot;,&quot;traceId&quot;:&quot;cron-1767264407835&quot;,&quot;userId&quot;:null,&quot;path&quot;:&quot;/cron/alerts&quot;,&quot;message&quot;:&quot;Alert notification sent to all user devices&quot;,&quot;type&quot;:&quot;general&quot;,&quot;alertId&quot;:&quot;alert-2&quot;,&quot;symbol&quot;:&quot;MSFT&quot;,&quot;username&quot;:&quot;testuser&quot;,&quot;devicesCount&quot;:1,&quot;successCount&quot;:1,&quot;failCount&quot;:0}
{&quot;timestamp&quot;:&quot;2026-01-01T10:46:47.835Z&quot;,&quot;service&quot;:&quot;stockly-api&quot;,&quot;level&quot;:&quot;INFO&quot;,&quot;traceId&quot;:&quot;cron-1767264407835&quot;,&quot;userId&quot;:null,&quot;path&quot;:&quot;/cron/alerts&quot;,&quot;message&quot;:&quot;Alert cron job completed successfully&quot;,&quot;type&quot;:&quot;general&quot;,&quot;alertsProcessed&quot;:2,&quot;notificationsSent&quot;:2}

            </system-out>
            <system-err>
{&quot;timestamp&quot;:&quot;2026-01-01T10:46:47.835Z&quot;,&quot;service&quot;:&quot;stockly-api&quot;,&quot;level&quot;:&quot;WARN&quot;,&quot;traceId&quot;:&quot;cron-1767264407835&quot;,&quot;userId&quot;:null,&quot;path&quot;:&quot;/cron/alerts&quot;,&quot;message&quot;:&quot;Market cache refresh failed (non-blocking)&quot;,&quot;type&quot;:&quot;general&quot;}

            </system-err>
        </testcase>
        <testcase classname="test/cron/alerts-cron.spec.ts" name="Alert Cron Job &gt; runAlertCron &gt; should skip when no prices available" time="0.057">
            <system-out>
{&quot;timestamp&quot;:&quot;2026-01-01T10:46:47.868Z&quot;,&quot;service&quot;:&quot;stockly-api&quot;,&quot;level&quot;:&quot;INFO&quot;,&quot;traceId&quot;:&quot;cron-1767264407868&quot;,&quot;userId&quot;:null,&quot;path&quot;:&quot;/cron/alerts&quot;,&quot;message&quot;:&quot;Starting alert evaluation cron job&quot;,&quot;type&quot;:&quot;general&quot;}

{&quot;timestamp&quot;:&quot;2026-01-01T10:46:47.869Z&quot;,&quot;service&quot;:&quot;stockly-api&quot;,&quot;level&quot;:&quot;INFO&quot;,&quot;traceId&quot;:&quot;cron-1767264407868&quot;,&quot;userId&quot;:null,&quot;path&quot;:&quot;/cron/alerts&quot;,&quot;message&quot;:&quot;Processing 1 active alerts&quot;,&quot;type&quot;:&quot;general&quot;}
{&quot;timestamp&quot;:&quot;2026-01-01T10:46:47.869Z&quot;,&quot;service&quot;:&quot;stockly-api&quot;,&quot;level&quot;:&quot;DEBUG&quot;,&quot;traceId&quot;:&quot;cron-1767264407868&quot;,&quot;userId&quot;:null,&quot;path&quot;:&quot;/cron/alerts&quot;,&quot;message&quot;:&quot;Fetching prices for 1 unique symbols&quot;,&quot;type&quot;:&quot;general&quot;,&quot;symbols&quot;:[&quot;AAPL&quot;]}

            </system-out>
            <system-err>
{&quot;timestamp&quot;:&quot;2026-01-01T10:46:47.869Z&quot;,&quot;service&quot;:&quot;stockly-api&quot;,&quot;level&quot;:&quot;WARN&quot;,&quot;traceId&quot;:&quot;cron-1767264407868&quot;,&quot;userId&quot;:null,&quot;path&quot;:&quot;/cron/alerts&quot;,&quot;message&quot;:&quot;No prices available for alerts run&quot;,&quot;type&quot;:&quot;general&quot;,&quot;symbols&quot;:[&quot;AAPL&quot;]}

            </system-err>
        </testcase>
        <testcase classname="test/cron/alerts-cron.spec.ts" name="Alert Cron Job &gt; runAlertCron &gt; should flush pending KV writes" time="0.033">
            <system-out>
{&quot;timestamp&quot;:&quot;2026-01-01T10:46:47.926Z&quot;,&quot;service&quot;:&quot;stockly-api&quot;,&quot;level&quot;:&quot;INFO&quot;,&quot;traceId&quot;:&quot;cron-1767264407926&quot;,&quot;userId&quot;:null,&quot;path&quot;:&quot;/cron/alerts&quot;,&quot;message&quot;:&quot;Starting alert evaluation cron job&quot;,&quot;type&quot;:&quot;general&quot;}

{&quot;timestamp&quot;:&quot;2026-01-01T10:46:47.926Z&quot;,&quot;service&quot;:&quot;stockly-api&quot;,&quot;level&quot;:&quot;INFO&quot;,&quot;traceId&quot;:&quot;cron-1767264407926&quot;,&quot;userId&quot;:null,&quot;path&quot;:&quot;/cron/alerts&quot;,&quot;message&quot;:&quot;Processing 1 active alerts&quot;,&quot;type&quot;:&quot;general&quot;}
{&quot;timestamp&quot;:&quot;2026-01-01T10:46:47.926Z&quot;,&quot;service&quot;:&quot;stockly-api&quot;,&quot;level&quot;:&quot;DEBUG&quot;,&quot;traceId&quot;:&quot;cron-1767264407926&quot;,&quot;userId&quot;:null,&quot;path&quot;:&quot;/cron/alerts&quot;,&quot;message&quot;:&quot;Fetching prices for 1 unique symbols&quot;,&quot;type&quot;:&quot;general&quot;,&quot;symbols&quot;:[&quot;AAPL&quot;]}

{&quot;timestamp&quot;:&quot;2026-01-01T10:46:47.926Z&quot;,&quot;service&quot;:&quot;stockly-api&quot;,&quot;level&quot;:&quot;INFO&quot;,&quot;traceId&quot;:&quot;cron-1767264407926&quot;,&quot;userId&quot;:null,&quot;path&quot;:&quot;/cron/alerts&quot;,&quot;message&quot;:&quot;Successfully fetched prices for 1 symbols&quot;,&quot;type&quot;:&quot;general&quot;}

{&quot;timestamp&quot;:&quot;2026-01-01T10:46:47.926Z&quot;,&quot;service&quot;:&quot;stockly-api&quot;,&quot;level&quot;:&quot;INFO&quot;,&quot;traceId&quot;:&quot;cron-1767264407926&quot;,&quot;userId&quot;:null,&quot;path&quot;:&quot;/cron/alerts&quot;,&quot;message&quot;:&quot;Evaluated 1 alerts, 0 triggered&quot;,&quot;type&quot;:&quot;general&quot;}
{&quot;timestamp&quot;:&quot;2026-01-01T10:46:47.926Z&quot;,&quot;service&quot;:&quot;stockly-api&quot;,&quot;level&quot;:&quot;INFO&quot;,&quot;traceId&quot;:&quot;cron-1767264407926&quot;,&quot;userId&quot;:null,&quot;path&quot;:&quot;/cron/alerts&quot;,&quot;message&quot;:&quot;Alert cron job completed successfully&quot;,&quot;type&quot;:&quot;general&quot;,&quot;alertsProcessed&quot;:1,&quot;notificationsSent&quot;:0}

            </system-out>
            <system-err>
{&quot;timestamp&quot;:&quot;2026-01-01T10:46:47.926Z&quot;,&quot;service&quot;:&quot;stockly-api&quot;,&quot;level&quot;:&quot;WARN&quot;,&quot;traceId&quot;:&quot;cron-1767264407926&quot;,&quot;userId&quot;:null,&quot;path&quot;:&quot;/cron/alerts&quot;,&quot;message&quot;:&quot;Market cache refresh failed (non-blocking)&quot;,&quot;type&quot;:&quot;general&quot;}

            </system-err>
        </testcase>
        <testcase classname="test/cron/alerts-cron.spec.ts" name="Alert Cron Job &gt; runAlertCron &gt; should send logs to Loki if configured" time="0.034">
            <system-out>
{&quot;timestamp&quot;:&quot;2026-01-01T10:46:47.961Z&quot;,&quot;service&quot;:&quot;stockly-api&quot;,&quot;level&quot;:&quot;INFO&quot;,&quot;traceId&quot;:&quot;cron-1767264407961&quot;,&quot;userId&quot;:null,&quot;path&quot;:&quot;/cron/alerts&quot;,&quot;message&quot;:&quot;Starting alert evaluation cron job&quot;,&quot;type&quot;:&quot;general&quot;}

{&quot;timestamp&quot;:&quot;2026-01-01T10:46:47.961Z&quot;,&quot;service&quot;:&quot;stockly-api&quot;,&quot;level&quot;:&quot;INFO&quot;,&quot;traceId&quot;:&quot;cron-1767264407961&quot;,&quot;userId&quot;:null,&quot;path&quot;:&quot;/cron/alerts&quot;,&quot;message&quot;:&quot;Processing 1 active alerts&quot;,&quot;type&quot;:&quot;general&quot;}
{&quot;timestamp&quot;:&quot;2026-01-01T10:46:47.962Z&quot;,&quot;service&quot;:&quot;stockly-api&quot;,&quot;level&quot;:&quot;DEBUG&quot;,&quot;traceId&quot;:&quot;cron-1767264407961&quot;,&quot;userId&quot;:null,&quot;path&quot;:&quot;/cron/alerts&quot;,&quot;message&quot;:&quot;Fetching prices for 1 unique symbols&quot;,&quot;type&quot;:&quot;general&quot;,&quot;symbols&quot;:[&quot;AAPL&quot;]}

{&quot;timestamp&quot;:&quot;2026-01-01T10:46:47.962Z&quot;,&quot;service&quot;:&quot;stockly-api&quot;,&quot;level&quot;:&quot;INFO&quot;,&quot;traceId&quot;:&quot;cron-1767264407961&quot;,&quot;userId&quot;:null,&quot;path&quot;:&quot;/cron/alerts&quot;,&quot;message&quot;:&quot;Successfully fetched prices for 1 symbols&quot;,&quot;type&quot;:&quot;general&quot;}

{&quot;timestamp&quot;:&quot;2026-01-01T10:46:47.962Z&quot;,&quot;service&quot;:&quot;stockly-api&quot;,&quot;level&quot;:&quot;INFO&quot;,&quot;traceId&quot;:&quot;cron-1767264407961&quot;,&quot;userId&quot;:null,&quot;path&quot;:&quot;/cron/alerts&quot;,&quot;message&quot;:&quot;Evaluated 1 alerts, 0 triggered&quot;,&quot;type&quot;:&quot;general&quot;}
{&quot;timestamp&quot;:&quot;2026-01-01T10:46:47.962Z&quot;,&quot;service&quot;:&quot;stockly-api&quot;,&quot;level&quot;:&quot;INFO&quot;,&quot;traceId&quot;:&quot;cron-1767264407961&quot;,&quot;userId&quot;:null,&quot;path&quot;:&quot;/cron/alerts&quot;,&quot;message&quot;:&quot;Alert cron job completed successfully&quot;,&quot;type&quot;:&quot;general&quot;,&quot;alertsProcessed&quot;:1,&quot;notificationsSent&quot;:0}

            </system-out>
            <system-err>
{&quot;timestamp&quot;:&quot;2026-01-01T10:46:47.962Z&quot;,&quot;service&quot;:&quot;stockly-api&quot;,&quot;level&quot;:&quot;WARN&quot;,&quot;traceId&quot;:&quot;cron-1767264407961&quot;,&quot;userId&quot;:null,&quot;path&quot;:&quot;/cron/alerts&quot;,&quot;message&quot;:&quot;Market cache refresh failed (non-blocking)&quot;,&quot;type&quot;:&quot;general&quot;}

            </system-err>
        </testcase>
        <testcase classname="test/cron/alerts-cron.spec.ts" name="Alert Cron Job &gt; runAlertCron &gt; should not send logs to Loki if not configured" time="0.046">
            <system-out>
{&quot;timestamp&quot;:&quot;2026-01-01T10:46:48.008Z&quot;,&quot;service&quot;:&quot;stockly-api&quot;,&quot;level&quot;:&quot;INFO&quot;,&quot;traceId&quot;:&quot;cron-1767264408008&quot;,&quot;userId&quot;:null,&quot;path&quot;:&quot;/cron/alerts&quot;,&quot;message&quot;:&quot;Starting alert evaluation cron job&quot;,&quot;type&quot;:&quot;general&quot;}

{&quot;timestamp&quot;:&quot;2026-01-01T10:46:48.008Z&quot;,&quot;service&quot;:&quot;stockly-api&quot;,&quot;level&quot;:&quot;INFO&quot;,&quot;traceId&quot;:&quot;cron-1767264408008&quot;,&quot;userId&quot;:null,&quot;path&quot;:&quot;/cron/alerts&quot;,&quot;message&quot;:&quot;Processing 1 active alerts&quot;,&quot;type&quot;:&quot;general&quot;}
{&quot;timestamp&quot;:&quot;2026-01-01T10:46:48.008Z&quot;,&quot;service&quot;:&quot;stockly-api&quot;,&quot;level&quot;:&quot;DEBUG&quot;,&quot;traceId&quot;:&quot;cron-1767264408008&quot;,&quot;userId&quot;:null,&quot;path&quot;:&quot;/cron/alerts&quot;,&quot;message&quot;:&quot;Fetching prices for 1 unique symbols&quot;,&quot;type&quot;:&quot;general&quot;,&quot;symbols&quot;:[&quot;AAPL&quot;]}

            </system-out>
            <system-err>
{&quot;timestamp&quot;:&quot;2026-01-01T10:46:48.009Z&quot;,&quot;service&quot;:&quot;stockly-api&quot;,&quot;level&quot;:&quot;WARN&quot;,&quot;traceId&quot;:&quot;cron-1767264408008&quot;,&quot;userId&quot;:null,&quot;path&quot;:&quot;/cron/alerts&quot;,&quot;message&quot;:&quot;No prices available for alerts run&quot;,&quot;type&quot;:&quot;general&quot;,&quot;symbols&quot;:[&quot;AAPL&quot;]}

            </system-err>
        </testcase>
        <testcase classname="test/cron/alerts-cron.spec.ts" name="Alert Cron Job &gt; runAlertCron &gt; should handle fatal errors and re-throw" time="0.026">
            <system-out>
{&quot;timestamp&quot;:&quot;2026-01-01T10:46:48.037Z&quot;,&quot;service&quot;:&quot;stockly-api&quot;,&quot;level&quot;:&quot;INFO&quot;,&quot;traceId&quot;:&quot;cron-1767264408037&quot;,&quot;userId&quot;:null,&quot;path&quot;:&quot;/cron/alerts&quot;,&quot;message&quot;:&quot;Starting alert evaluation cron job&quot;,&quot;type&quot;:&quot;general&quot;}

            </system-out>
            <system-err>
{&quot;timestamp&quot;:&quot;2026-01-01T10:46:48.038Z&quot;,&quot;service&quot;:&quot;stockly-api&quot;,&quot;level&quot;:&quot;ERROR&quot;,&quot;traceId&quot;:&quot;cron-1767264408037&quot;,&quot;userId&quot;:null,&quot;path&quot;:&quot;/cron/alerts&quot;,&quot;message&quot;:&quot;Fatal error in alert cron job&quot;,&quot;type&quot;:&quot;general&quot;,&quot;error&quot;:{&quot;name&quot;:&quot;Error&quot;,&quot;message&quot;:&quot;Fatal error&quot;,&quot;stack&quot;:&quot;Error: Fatal error\n    at /home/sngvahmed/workspace/stockly/api/test/cron/alerts-cron.spec.ts:635:21\n    at home/sngvahmed/workspace/stockly/node_modules/@vitest/runner/dist/chunk-hooks.js:155:11\n    at home/sngvahmed/workspace/stockly/node_modules/@vitest/runner/dist/chunk-hooks.js:752:26\n    at home/sngvahmed/workspace/stockly/node_modules/@vitest/runner/dist/chunk-hooks.js:1897:20\n    at new Promise (&lt;anonymous&gt;)\n    at runWithTimeout (home/sngvahmed/workspace/stockly/node_modules/@vitest/runner/dist/chunk-hooks.js:1863:10)\n    at runTest (home/sngvahmed/workspace/stockly/node_modules/@vitest/runner/dist/chunk-hooks.js:1574:12)\n    at runSuite (home/sngvahmed/workspace/stockly/node_modules/@vitest/runner/dist/chunk-hooks.js:1729:8)\n    at runSuite (home/sngvahmed/workspace/stockly/node_modules/@vitest/runner/dist/chunk-hooks.js:1729:8)\n    at runSuite (home/sngvahmed/workspace/stockly/node_modules/@vitest/runner/dist/chunk-hooks.js:1729:8)&quot;}}

            </system-err>
        </testcase>
        <testcase classname="test/cron/alerts-cron.spec.ts" name="Alert Cron Job &gt; runAlertCron &gt; should use default KV write interval if not in config" time="0.028">
            <system-out>
{&quot;timestamp&quot;:&quot;2026-01-01T10:46:48.063Z&quot;,&quot;service&quot;:&quot;stockly-api&quot;,&quot;level&quot;:&quot;INFO&quot;,&quot;traceId&quot;:&quot;cron-1767264408063&quot;,&quot;userId&quot;:null,&quot;path&quot;:&quot;/cron/alerts&quot;,&quot;message&quot;:&quot;Starting alert evaluation cron job&quot;,&quot;type&quot;:&quot;general&quot;}

{&quot;timestamp&quot;:&quot;2026-01-01T10:46:48.063Z&quot;,&quot;service&quot;:&quot;stockly-api&quot;,&quot;level&quot;:&quot;INFO&quot;,&quot;traceId&quot;:&quot;cron-1767264408063&quot;,&quot;userId&quot;:null,&quot;path&quot;:&quot;/cron/alerts&quot;,&quot;message&quot;:&quot;Processing 1 active alerts&quot;,&quot;type&quot;:&quot;general&quot;}
{&quot;timestamp&quot;:&quot;2026-01-01T10:46:48.063Z&quot;,&quot;service&quot;:&quot;stockly-api&quot;,&quot;level&quot;:&quot;DEBUG&quot;,&quot;traceId&quot;:&quot;cron-1767264408063&quot;,&quot;userId&quot;:null,&quot;path&quot;:&quot;/cron/alerts&quot;,&quot;message&quot;:&quot;Fetching prices for 1 unique symbols&quot;,&quot;type&quot;:&quot;general&quot;,&quot;symbols&quot;:[&quot;AAPL&quot;]}

{&quot;timestamp&quot;:&quot;2026-01-01T10:46:48.063Z&quot;,&quot;service&quot;:&quot;stockly-api&quot;,&quot;level&quot;:&quot;INFO&quot;,&quot;traceId&quot;:&quot;cron-1767264408063&quot;,&quot;userId&quot;:null,&quot;path&quot;:&quot;/cron/alerts&quot;,&quot;message&quot;:&quot;Successfully fetched prices for 1 symbols&quot;,&quot;type&quot;:&quot;general&quot;}

{&quot;timestamp&quot;:&quot;2026-01-01T10:46:48.063Z&quot;,&quot;service&quot;:&quot;stockly-api&quot;,&quot;level&quot;:&quot;INFO&quot;,&quot;traceId&quot;:&quot;cron-1767264408063&quot;,&quot;userId&quot;:null,&quot;path&quot;:&quot;/cron/alerts&quot;,&quot;message&quot;:&quot;Evaluated 1 alerts, 0 triggered&quot;,&quot;type&quot;:&quot;general&quot;}
{&quot;timestamp&quot;:&quot;2026-01-01T10:46:48.063Z&quot;,&quot;service&quot;:&quot;stockly-api&quot;,&quot;level&quot;:&quot;INFO&quot;,&quot;traceId&quot;:&quot;cron-1767264408063&quot;,&quot;userId&quot;:null,&quot;path&quot;:&quot;/cron/alerts&quot;,&quot;message&quot;:&quot;Alert cron job completed successfully&quot;,&quot;type&quot;:&quot;general&quot;,&quot;alertsProcessed&quot;:1,&quot;notificationsSent&quot;:0}

            </system-out>
            <system-err>
{&quot;timestamp&quot;:&quot;2026-01-01T10:46:48.063Z&quot;,&quot;service&quot;:&quot;stockly-api&quot;,&quot;level&quot;:&quot;WARN&quot;,&quot;traceId&quot;:&quot;cron-1767264408063&quot;,&quot;userId&quot;:null,&quot;path&quot;:&quot;/cron/alerts&quot;,&quot;message&quot;:&quot;Market cache refresh failed (non-blocking)&quot;,&quot;type&quot;:&quot;general&quot;}

            </system-err>
        </testcase>
        <testcase classname="test/cron/alerts-cron.spec.ts" name="Alert Cron Job &gt; runAlertCron &gt; should handle array response from quote API" time="0.036">
            <system-out>
{&quot;timestamp&quot;:&quot;2026-01-01T10:46:48.092Z&quot;,&quot;service&quot;:&quot;stockly-api&quot;,&quot;level&quot;:&quot;INFO&quot;,&quot;traceId&quot;:&quot;cron-1767264408092&quot;,&quot;userId&quot;:null,&quot;path&quot;:&quot;/cron/alerts&quot;,&quot;message&quot;:&quot;Starting alert evaluation cron job&quot;,&quot;type&quot;:&quot;general&quot;}

{&quot;timestamp&quot;:&quot;2026-01-01T10:46:48.092Z&quot;,&quot;service&quot;:&quot;stockly-api&quot;,&quot;level&quot;:&quot;INFO&quot;,&quot;traceId&quot;:&quot;cron-1767264408092&quot;,&quot;userId&quot;:null,&quot;path&quot;:&quot;/cron/alerts&quot;,&quot;message&quot;:&quot;Processing 1 active alerts&quot;,&quot;type&quot;:&quot;general&quot;}
{&quot;timestamp&quot;:&quot;2026-01-01T10:46:48.092Z&quot;,&quot;service&quot;:&quot;stockly-api&quot;,&quot;level&quot;:&quot;DEBUG&quot;,&quot;traceId&quot;:&quot;cron-1767264408092&quot;,&quot;userId&quot;:null,&quot;path&quot;:&quot;/cron/alerts&quot;,&quot;message&quot;:&quot;Fetching prices for 1 unique symbols&quot;,&quot;type&quot;:&quot;general&quot;,&quot;symbols&quot;:[&quot;AAPL&quot;]}

{&quot;timestamp&quot;:&quot;2026-01-01T10:46:48.093Z&quot;,&quot;service&quot;:&quot;stockly-api&quot;,&quot;level&quot;:&quot;INFO&quot;,&quot;traceId&quot;:&quot;cron-1767264408092&quot;,&quot;userId&quot;:null,&quot;path&quot;:&quot;/cron/alerts&quot;,&quot;message&quot;:&quot;Successfully fetched prices for 1 symbols&quot;,&quot;type&quot;:&quot;general&quot;}

{&quot;timestamp&quot;:&quot;2026-01-01T10:46:48.093Z&quot;,&quot;service&quot;:&quot;stockly-api&quot;,&quot;level&quot;:&quot;INFO&quot;,&quot;traceId&quot;:&quot;cron-1767264408092&quot;,&quot;userId&quot;:null,&quot;path&quot;:&quot;/cron/alerts&quot;,&quot;message&quot;:&quot;Evaluated 1 alerts, 0 triggered&quot;,&quot;type&quot;:&quot;general&quot;}
{&quot;timestamp&quot;:&quot;2026-01-01T10:46:48.093Z&quot;,&quot;service&quot;:&quot;stockly-api&quot;,&quot;level&quot;:&quot;INFO&quot;,&quot;traceId&quot;:&quot;cron-1767264408092&quot;,&quot;userId&quot;:null,&quot;path&quot;:&quot;/cron/alerts&quot;,&quot;message&quot;:&quot;Alert cron job completed successfully&quot;,&quot;type&quot;:&quot;general&quot;,&quot;alertsProcessed&quot;:1,&quot;notificationsSent&quot;:0}

            </system-out>
            <system-err>
{&quot;timestamp&quot;:&quot;2026-01-01T10:46:48.093Z&quot;,&quot;service&quot;:&quot;stockly-api&quot;,&quot;level&quot;:&quot;WARN&quot;,&quot;traceId&quot;:&quot;cron-1767264408092&quot;,&quot;userId&quot;:null,&quot;path&quot;:&quot;/cron/alerts&quot;,&quot;message&quot;:&quot;Market cache refresh failed (non-blocking)&quot;,&quot;type&quot;:&quot;general&quot;}

            </system-err>
        </testcase>
    </testsuite>
    <testsuite name="test/cron/news-alert-cron.spec.ts" timestamp="2026-01-01T10:46:50.877Z" hostname="sngvahmed" tests="18" failures="0" errors="0" skipped="0" time="2.16">
        <testcase classname="test/cron/news-alert-cron.spec.ts" name="News Alert Cron Job &gt; User Symbol Collection &gt; should collect unique symbols from all users" time="0.134">
            <system-out>
{&quot;timestamp&quot;:&quot;2026-01-01T10:46:46.259Z&quot;,&quot;service&quot;:&quot;stockly-api&quot;,&quot;level&quot;:&quot;INFO&quot;,&quot;traceId&quot;:&quot;cron-news-1767264406259&quot;,&quot;userId&quot;:null,&quot;path&quot;:&quot;/cron/news-alerts&quot;,&quot;message&quot;:&quot;Starting news alert cron job&quot;,&quot;type&quot;:&quot;general&quot;}

{&quot;timestamp&quot;:&quot;2026-01-01T10:46:46.261Z&quot;,&quot;service&quot;:&quot;stockly-api&quot;,&quot;level&quot;:&quot;INFO&quot;,&quot;traceId&quot;:&quot;cron-news-1767264406259&quot;,&quot;userId&quot;:null,&quot;path&quot;:&quot;/cron/news-alerts&quot;,&quot;message&quot;:&quot;Checking news for 4 unique symbols: LXEO, AMZN, AAPL, BABA&quot;,&quot;type&quot;:&quot;general&quot;}
{&quot;timestamp&quot;:&quot;2026-01-01T10:46:46.261Z&quot;,&quot;service&quot;:&quot;stockly-api&quot;,&quot;level&quot;:&quot;INFO&quot;,&quot;traceId&quot;:&quot;cron-news-1767264406259&quot;,&quot;userId&quot;:null,&quot;path&quot;:&quot;/cron/news-alerts&quot;,&quot;message&quot;:&quot;Fetching news for all symbols published today (2026-01-01)&quot;,&quot;type&quot;:&quot;general&quot;}

{&quot;timestamp&quot;:&quot;2026-01-01T10:46:46.261Z&quot;,&quot;service&quot;:&quot;stockly-api&quot;,&quot;level&quot;:&quot;INFO&quot;,&quot;traceId&quot;:&quot;cron-news-1767264406259&quot;,&quot;userId&quot;:null,&quot;path&quot;:&quot;/cron/news-alerts&quot;,&quot;message&quot;:&quot;Fetched 0 news articles published today&quot;,&quot;type&quot;:&quot;general&quot;}
{&quot;timestamp&quot;:&quot;2026-01-01T10:46:46.261Z&quot;,&quot;service&quot;:&quot;stockly-api&quot;,&quot;level&quot;:&quot;INFO&quot;,&quot;traceId&quot;:&quot;cron-news-1767264406259&quot;,&quot;userId&quot;:null,&quot;path&quot;:&quot;/cron/news-alerts&quot;,&quot;message&quot;:&quot;Found news for 0 symbols: &quot;,&quot;type&quot;:&quot;general&quot;}
{&quot;timestamp&quot;:&quot;2026-01-01T10:46:46.261Z&quot;,&quot;service&quot;:&quot;stockly-api&quot;,&quot;level&quot;:&quot;INFO&quot;,&quot;traceId&quot;:&quot;cron-news-1767264406259&quot;,&quot;userId&quot;:null,&quot;path&quot;:&quot;/cron/news-alerts&quot;,&quot;message&quot;:&quot;News alert cron job completed&quot;,&quot;type&quot;:&quot;general&quot;}

            </system-out>
        </testcase>
        <testcase classname="test/cron/news-alert-cron.spec.ts" name="News Alert Cron Job &gt; User Symbol Collection &gt; should normalize symbols to uppercase" time="0.228">
            <system-out>
{&quot;timestamp&quot;:&quot;2026-01-01T10:46:46.495Z&quot;,&quot;service&quot;:&quot;stockly-api&quot;,&quot;level&quot;:&quot;INFO&quot;,&quot;traceId&quot;:&quot;cron-news-1767264406495&quot;,&quot;userId&quot;:null,&quot;path&quot;:&quot;/cron/news-alerts&quot;,&quot;message&quot;:&quot;Starting news alert cron job&quot;,&quot;type&quot;:&quot;general&quot;}

{&quot;timestamp&quot;:&quot;2026-01-01T10:46:46.495Z&quot;,&quot;service&quot;:&quot;stockly-api&quot;,&quot;level&quot;:&quot;INFO&quot;,&quot;traceId&quot;:&quot;cron-news-1767264406495&quot;,&quot;userId&quot;:null,&quot;path&quot;:&quot;/cron/news-alerts&quot;,&quot;message&quot;:&quot;Checking news for 2 unique symbols: LXEO, AMZN&quot;,&quot;type&quot;:&quot;general&quot;}
{&quot;timestamp&quot;:&quot;2026-01-01T10:46:46.495Z&quot;,&quot;service&quot;:&quot;stockly-api&quot;,&quot;level&quot;:&quot;INFO&quot;,&quot;traceId&quot;:&quot;cron-news-1767264406495&quot;,&quot;userId&quot;:null,&quot;path&quot;:&quot;/cron/news-alerts&quot;,&quot;message&quot;:&quot;Fetching news for all symbols published today (2026-01-01)&quot;,&quot;type&quot;:&quot;general&quot;}

{&quot;timestamp&quot;:&quot;2026-01-01T10:46:46.495Z&quot;,&quot;service&quot;:&quot;stockly-api&quot;,&quot;level&quot;:&quot;INFO&quot;,&quot;traceId&quot;:&quot;cron-news-1767264406495&quot;,&quot;userId&quot;:null,&quot;path&quot;:&quot;/cron/news-alerts&quot;,&quot;message&quot;:&quot;Fetched 0 news articles published today&quot;,&quot;type&quot;:&quot;general&quot;}
{&quot;timestamp&quot;:&quot;2026-01-01T10:46:46.495Z&quot;,&quot;service&quot;:&quot;stockly-api&quot;,&quot;level&quot;:&quot;INFO&quot;,&quot;traceId&quot;:&quot;cron-news-1767264406495&quot;,&quot;userId&quot;:null,&quot;path&quot;:&quot;/cron/news-alerts&quot;,&quot;message&quot;:&quot;Found news for 0 symbols: &quot;,&quot;type&quot;:&quot;general&quot;}
{&quot;timestamp&quot;:&quot;2026-01-01T10:46:46.495Z&quot;,&quot;service&quot;:&quot;stockly-api&quot;,&quot;level&quot;:&quot;INFO&quot;,&quot;traceId&quot;:&quot;cron-news-1767264406495&quot;,&quot;userId&quot;:null,&quot;path&quot;:&quot;/cron/news-alerts&quot;,&quot;message&quot;:&quot;News alert cron job completed&quot;,&quot;type&quot;:&quot;general&quot;}

            </system-out>
        </testcase>
        <testcase classname="test/cron/news-alert-cron.spec.ts" name="News Alert Cron Job &gt; User Symbol Collection &gt; should skip users with no favorite symbols" time="0.224">
            <system-out>
{&quot;timestamp&quot;:&quot;2026-01-01T10:46:46.662Z&quot;,&quot;service&quot;:&quot;stockly-api&quot;,&quot;level&quot;:&quot;INFO&quot;,&quot;traceId&quot;:&quot;cron-news-1767264406662&quot;,&quot;userId&quot;:null,&quot;path&quot;:&quot;/cron/news-alerts&quot;,&quot;message&quot;:&quot;Starting news alert cron job&quot;,&quot;type&quot;:&quot;general&quot;}

{&quot;timestamp&quot;:&quot;2026-01-01T10:46:46.663Z&quot;,&quot;service&quot;:&quot;stockly-api&quot;,&quot;level&quot;:&quot;INFO&quot;,&quot;traceId&quot;:&quot;cron-news-1767264406662&quot;,&quot;userId&quot;:null,&quot;path&quot;:&quot;/cron/news-alerts&quot;,&quot;message&quot;:&quot;Checking news for 1 unique symbols: LXEO&quot;,&quot;type&quot;:&quot;general&quot;}
{&quot;timestamp&quot;:&quot;2026-01-01T10:46:46.663Z&quot;,&quot;service&quot;:&quot;stockly-api&quot;,&quot;level&quot;:&quot;INFO&quot;,&quot;traceId&quot;:&quot;cron-news-1767264406662&quot;,&quot;userId&quot;:null,&quot;path&quot;:&quot;/cron/news-alerts&quot;,&quot;message&quot;:&quot;Fetching news for all symbols published today (2026-01-01)&quot;,&quot;type&quot;:&quot;general&quot;}

{&quot;timestamp&quot;:&quot;2026-01-01T10:46:46.663Z&quot;,&quot;service&quot;:&quot;stockly-api&quot;,&quot;level&quot;:&quot;INFO&quot;,&quot;traceId&quot;:&quot;cron-news-1767264406662&quot;,&quot;userId&quot;:null,&quot;path&quot;:&quot;/cron/news-alerts&quot;,&quot;message&quot;:&quot;Fetched 0 news articles published today&quot;,&quot;type&quot;:&quot;general&quot;}
{&quot;timestamp&quot;:&quot;2026-01-01T10:46:46.663Z&quot;,&quot;service&quot;:&quot;stockly-api&quot;,&quot;level&quot;:&quot;INFO&quot;,&quot;traceId&quot;:&quot;cron-news-1767264406662&quot;,&quot;userId&quot;:null,&quot;path&quot;:&quot;/cron/news-alerts&quot;,&quot;message&quot;:&quot;Found news for 0 symbols: &quot;,&quot;type&quot;:&quot;general&quot;}
{&quot;timestamp&quot;:&quot;2026-01-01T10:46:46.663Z&quot;,&quot;service&quot;:&quot;stockly-api&quot;,&quot;level&quot;:&quot;INFO&quot;,&quot;traceId&quot;:&quot;cron-news-1767264406662&quot;,&quot;userId&quot;:null,&quot;path&quot;:&quot;/cron/news-alerts&quot;,&quot;message&quot;:&quot;News alert cron job completed&quot;,&quot;type&quot;:&quot;general&quot;}

            </system-out>
        </testcase>
        <testcase classname="test/cron/news-alert-cron.spec.ts" name="News Alert Cron Job &gt; News Fetching and Filtering &gt; should fetch news for all symbols in one batch call" time="0.099">
            <system-out>
{&quot;timestamp&quot;:&quot;2026-01-01T10:46:46.846Z&quot;,&quot;service&quot;:&quot;stockly-api&quot;,&quot;level&quot;:&quot;INFO&quot;,&quot;traceId&quot;:&quot;cron-news-1767264406846&quot;,&quot;userId&quot;:null,&quot;path&quot;:&quot;/cron/news-alerts&quot;,&quot;message&quot;:&quot;Starting news alert cron job&quot;,&quot;type&quot;:&quot;general&quot;}

{&quot;timestamp&quot;:&quot;2026-01-01T10:46:46.847Z&quot;,&quot;service&quot;:&quot;stockly-api&quot;,&quot;level&quot;:&quot;INFO&quot;,&quot;traceId&quot;:&quot;cron-news-1767264406846&quot;,&quot;userId&quot;:null,&quot;path&quot;:&quot;/cron/news-alerts&quot;,&quot;message&quot;:&quot;Checking news for 3 unique symbols: LXEO, AMZN, AAPL&quot;,&quot;type&quot;:&quot;general&quot;}
{&quot;timestamp&quot;:&quot;2026-01-01T10:46:46.847Z&quot;,&quot;service&quot;:&quot;stockly-api&quot;,&quot;level&quot;:&quot;INFO&quot;,&quot;traceId&quot;:&quot;cron-news-1767264406846&quot;,&quot;userId&quot;:null,&quot;path&quot;:&quot;/cron/news-alerts&quot;,&quot;message&quot;:&quot;Fetching news for all symbols published today (2026-01-01)&quot;,&quot;type&quot;:&quot;general&quot;}

{&quot;timestamp&quot;:&quot;2026-01-01T10:46:46.847Z&quot;,&quot;service&quot;:&quot;stockly-api&quot;,&quot;level&quot;:&quot;INFO&quot;,&quot;traceId&quot;:&quot;cron-news-1767264406846&quot;,&quot;userId&quot;:null,&quot;path&quot;:&quot;/cron/news-alerts&quot;,&quot;message&quot;:&quot;Fetched 2 news articles published today&quot;,&quot;type&quot;:&quot;general&quot;}
{&quot;timestamp&quot;:&quot;2026-01-01T10:46:46.847Z&quot;,&quot;service&quot;:&quot;stockly-api&quot;,&quot;level&quot;:&quot;INFO&quot;,&quot;traceId&quot;:&quot;cron-news-1767264406846&quot;,&quot;userId&quot;:null,&quot;path&quot;:&quot;/cron/news-alerts&quot;,&quot;message&quot;:&quot;Found news for 2 symbols: LXEO, AMZN&quot;,&quot;type&quot;:&quot;general&quot;}

{&quot;timestamp&quot;:&quot;2026-01-01T10:46:46.847Z&quot;,&quot;service&quot;:&quot;stockly-api&quot;,&quot;level&quot;:&quot;INFO&quot;,&quot;traceId&quot;:&quot;cron-news-1767264406846&quot;,&quot;userId&quot;:null,&quot;path&quot;:&quot;/cron/news-alerts&quot;,&quot;message&quot;:&quot;New article found (published today)&quot;,&quot;type&quot;:&quot;general&quot;,&quot;symbol&quot;:&quot;LXEO&quot;,&quot;title&quot;:&quot;LXEO News Today&quot;,&quot;publishedDate&quot;:&quot;2026-01-01T10:00:00Z&quot;}

{&quot;timestamp&quot;:&quot;2026-01-01T10:46:46.847Z&quot;,&quot;service&quot;:&quot;stockly-api&quot;,&quot;level&quot;:&quot;INFO&quot;,&quot;traceId&quot;:&quot;cron-news-1767264406846&quot;,&quot;userId&quot;:null,&quot;path&quot;:&quot;/cron/news-alerts&quot;,&quot;message&quot;:&quot;Found 1 users with LXEO in favorites: user1&quot;,&quot;type&quot;:&quot;general&quot;}

{&quot;timestamp&quot;:&quot;2026-01-01T10:46:46.847Z&quot;,&quot;service&quot;:&quot;stockly-api&quot;,&quot;level&quot;:&quot;INFO&quot;,&quot;traceId&quot;:&quot;cron-news-1767264406846&quot;,&quot;userId&quot;:null,&quot;path&quot;:&quot;/cron/news-alerts&quot;,&quot;message&quot;:&quot;Sent 2 notifications for LXEO news to 1 users&quot;,&quot;type&quot;:&quot;general&quot;}

{&quot;timestamp&quot;:&quot;2026-01-01T10:46:46.847Z&quot;,&quot;service&quot;:&quot;stockly-api&quot;,&quot;level&quot;:&quot;INFO&quot;,&quot;traceId&quot;:&quot;cron-news-1767264406846&quot;,&quot;userId&quot;:null,&quot;path&quot;:&quot;/cron/news-alerts&quot;,&quot;message&quot;:&quot;New article found (published today)&quot;,&quot;type&quot;:&quot;general&quot;,&quot;symbol&quot;:&quot;AMZN&quot;,&quot;title&quot;:&quot;AMZN News Today&quot;,&quot;publishedDate&quot;:&quot;2026-01-01T11:00:00Z&quot;}

{&quot;timestamp&quot;:&quot;2026-01-01T10:46:46.847Z&quot;,&quot;service&quot;:&quot;stockly-api&quot;,&quot;level&quot;:&quot;INFO&quot;,&quot;traceId&quot;:&quot;cron-news-1767264406846&quot;,&quot;userId&quot;:null,&quot;path&quot;:&quot;/cron/news-alerts&quot;,&quot;message&quot;:&quot;Found 1 users with AMZN in favorites: user1&quot;,&quot;type&quot;:&quot;general&quot;}

{&quot;timestamp&quot;:&quot;2026-01-01T10:46:46.848Z&quot;,&quot;service&quot;:&quot;stockly-api&quot;,&quot;level&quot;:&quot;INFO&quot;,&quot;traceId&quot;:&quot;cron-news-1767264406846&quot;,&quot;userId&quot;:null,&quot;path&quot;:&quot;/cron/news-alerts&quot;,&quot;message&quot;:&quot;Sent 2 notifications for AMZN news to 1 users&quot;,&quot;type&quot;:&quot;general&quot;}
{&quot;timestamp&quot;:&quot;2026-01-01T10:46:46.848Z&quot;,&quot;service&quot;:&quot;stockly-api&quot;,&quot;level&quot;:&quot;INFO&quot;,&quot;traceId&quot;:&quot;cron-news-1767264406846&quot;,&quot;userId&quot;:null,&quot;path&quot;:&quot;/cron/news-alerts&quot;,&quot;message&quot;:&quot;News alert cron job completed&quot;,&quot;type&quot;:&quot;general&quot;}

            </system-out>
        </testcase>
        <testcase classname="test/cron/news-alert-cron.spec.ts" name="News Alert Cron Job &gt; News Fetching and Filtering &gt; should only process news published today" time="0.413">
            <system-out>
{&quot;timestamp&quot;:&quot;2026-01-01T10:46:46.876Z&quot;,&quot;service&quot;:&quot;stockly-api&quot;,&quot;level&quot;:&quot;INFO&quot;,&quot;traceId&quot;:&quot;cron-news-1767264406876&quot;,&quot;userId&quot;:null,&quot;path&quot;:&quot;/cron/news-alerts&quot;,&quot;message&quot;:&quot;Starting news alert cron job&quot;,&quot;type&quot;:&quot;general&quot;}

{&quot;timestamp&quot;:&quot;2026-01-01T10:46:46.876Z&quot;,&quot;service&quot;:&quot;stockly-api&quot;,&quot;level&quot;:&quot;INFO&quot;,&quot;traceId&quot;:&quot;cron-news-1767264406876&quot;,&quot;userId&quot;:null,&quot;path&quot;:&quot;/cron/news-alerts&quot;,&quot;message&quot;:&quot;Checking news for 1 unique symbols: LXEO&quot;,&quot;type&quot;:&quot;general&quot;}
{&quot;timestamp&quot;:&quot;2026-01-01T10:46:46.876Z&quot;,&quot;service&quot;:&quot;stockly-api&quot;,&quot;level&quot;:&quot;INFO&quot;,&quot;traceId&quot;:&quot;cron-news-1767264406876&quot;,&quot;userId&quot;:null,&quot;path&quot;:&quot;/cron/news-alerts&quot;,&quot;message&quot;:&quot;Fetching news for all symbols published today (2026-01-01)&quot;,&quot;type&quot;:&quot;general&quot;}

{&quot;timestamp&quot;:&quot;2026-01-01T10:46:46.876Z&quot;,&quot;service&quot;:&quot;stockly-api&quot;,&quot;level&quot;:&quot;INFO&quot;,&quot;traceId&quot;:&quot;cron-news-1767264406876&quot;,&quot;userId&quot;:null,&quot;path&quot;:&quot;/cron/news-alerts&quot;,&quot;message&quot;:&quot;Fetched 2 news articles published today&quot;,&quot;type&quot;:&quot;general&quot;}
{&quot;timestamp&quot;:&quot;2026-01-01T10:46:46.877Z&quot;,&quot;service&quot;:&quot;stockly-api&quot;,&quot;level&quot;:&quot;INFO&quot;,&quot;traceId&quot;:&quot;cron-news-1767264406876&quot;,&quot;userId&quot;:null,&quot;path&quot;:&quot;/cron/news-alerts&quot;,&quot;message&quot;:&quot;Found news for 1 symbols: LXEO&quot;,&quot;type&quot;:&quot;general&quot;}

{&quot;timestamp&quot;:&quot;2026-01-01T10:46:46.877Z&quot;,&quot;service&quot;:&quot;stockly-api&quot;,&quot;level&quot;:&quot;INFO&quot;,&quot;traceId&quot;:&quot;cron-news-1767264406876&quot;,&quot;userId&quot;:null,&quot;path&quot;:&quot;/cron/news-alerts&quot;,&quot;message&quot;:&quot;New article found (published today)&quot;,&quot;type&quot;:&quot;general&quot;,&quot;symbol&quot;:&quot;LXEO&quot;,&quot;title&quot;:&quot;LXEO News Today&quot;,&quot;publishedDate&quot;:&quot;2026-01-01T10:00:00Z&quot;}

{&quot;timestamp&quot;:&quot;2026-01-01T10:46:46.877Z&quot;,&quot;service&quot;:&quot;stockly-api&quot;,&quot;level&quot;:&quot;INFO&quot;,&quot;traceId&quot;:&quot;cron-news-1767264406876&quot;,&quot;userId&quot;:null,&quot;path&quot;:&quot;/cron/news-alerts&quot;,&quot;message&quot;:&quot;Found 1 users with LXEO in favorites: user1&quot;,&quot;type&quot;:&quot;general&quot;}

{&quot;timestamp&quot;:&quot;2026-01-01T10:46:46.877Z&quot;,&quot;service&quot;:&quot;stockly-api&quot;,&quot;level&quot;:&quot;INFO&quot;,&quot;traceId&quot;:&quot;cron-news-1767264406876&quot;,&quot;userId&quot;:null,&quot;path&quot;:&quot;/cron/news-alerts&quot;,&quot;message&quot;:&quot;Sent 1 notifications for LXEO news to 1 users&quot;,&quot;type&quot;:&quot;general&quot;}
{&quot;timestamp&quot;:&quot;2026-01-01T10:46:46.877Z&quot;,&quot;service&quot;:&quot;stockly-api&quot;,&quot;level&quot;:&quot;DEBUG&quot;,&quot;traceId&quot;:&quot;cron-news-1767264406876&quot;,&quot;userId&quot;:null,&quot;path&quot;:&quot;/cron/news-alerts&quot;,&quot;message&quot;:&quot;Skipping article not published today: LXEO News Yesterday (2025-12-31T10:00:00Z)&quot;,&quot;type&quot;:&quot;general&quot;}
{&quot;timestamp&quot;:&quot;2026-01-01T10:46:46.877Z&quot;,&quot;service&quot;:&quot;stockly-api&quot;,&quot;level&quot;:&quot;INFO&quot;,&quot;traceId&quot;:&quot;cron-news-1767264406876&quot;,&quot;userId&quot;:null,&quot;path&quot;:&quot;/cron/news-alerts&quot;,&quot;message&quot;:&quot;News alert cron job completed&quot;,&quot;type&quot;:&quot;general&quot;}

            </system-out>
        </testcase>
        <testcase classname="test/cron/news-alert-cron.spec.ts" name="News Alert Cron Job &gt; News Fetching and Filtering &gt; should handle empty news response" time="0.069">
            <system-out>
{&quot;timestamp&quot;:&quot;2026-01-01T10:46:47.323Z&quot;,&quot;service&quot;:&quot;stockly-api&quot;,&quot;level&quot;:&quot;INFO&quot;,&quot;traceId&quot;:&quot;cron-news-1767264407323&quot;,&quot;userId&quot;:null,&quot;path&quot;:&quot;/cron/news-alerts&quot;,&quot;message&quot;:&quot;Starting news alert cron job&quot;,&quot;type&quot;:&quot;general&quot;}

{&quot;timestamp&quot;:&quot;2026-01-01T10:46:47.323Z&quot;,&quot;service&quot;:&quot;stockly-api&quot;,&quot;level&quot;:&quot;INFO&quot;,&quot;traceId&quot;:&quot;cron-news-1767264407323&quot;,&quot;userId&quot;:null,&quot;path&quot;:&quot;/cron/news-alerts&quot;,&quot;message&quot;:&quot;Checking news for 1 unique symbols: LXEO&quot;,&quot;type&quot;:&quot;general&quot;}
{&quot;timestamp&quot;:&quot;2026-01-01T10:46:47.323Z&quot;,&quot;service&quot;:&quot;stockly-api&quot;,&quot;level&quot;:&quot;INFO&quot;,&quot;traceId&quot;:&quot;cron-news-1767264407323&quot;,&quot;userId&quot;:null,&quot;path&quot;:&quot;/cron/news-alerts&quot;,&quot;message&quot;:&quot;Fetching news for all symbols published today (2026-01-01)&quot;,&quot;type&quot;:&quot;general&quot;}

{&quot;timestamp&quot;:&quot;2026-01-01T10:46:47.323Z&quot;,&quot;service&quot;:&quot;stockly-api&quot;,&quot;level&quot;:&quot;INFO&quot;,&quot;traceId&quot;:&quot;cron-news-1767264407323&quot;,&quot;userId&quot;:null,&quot;path&quot;:&quot;/cron/news-alerts&quot;,&quot;message&quot;:&quot;Fetched 0 news articles published today&quot;,&quot;type&quot;:&quot;general&quot;}
{&quot;timestamp&quot;:&quot;2026-01-01T10:46:47.323Z&quot;,&quot;service&quot;:&quot;stockly-api&quot;,&quot;level&quot;:&quot;INFO&quot;,&quot;traceId&quot;:&quot;cron-news-1767264407323&quot;,&quot;userId&quot;:null,&quot;path&quot;:&quot;/cron/news-alerts&quot;,&quot;message&quot;:&quot;Found news for 0 symbols: &quot;,&quot;type&quot;:&quot;general&quot;}
{&quot;timestamp&quot;:&quot;2026-01-01T10:46:47.323Z&quot;,&quot;service&quot;:&quot;stockly-api&quot;,&quot;level&quot;:&quot;INFO&quot;,&quot;traceId&quot;:&quot;cron-news-1767264407323&quot;,&quot;userId&quot;:null,&quot;path&quot;:&quot;/cron/news-alerts&quot;,&quot;message&quot;:&quot;News alert cron job completed&quot;,&quot;type&quot;:&quot;general&quot;}

            </system-out>
        </testcase>
        <testcase classname="test/cron/news-alert-cron.spec.ts" name="News Alert Cron Job &gt; Deduplication &gt; should not send duplicate notifications for the same article" time="0.064">
            <system-out>
{&quot;timestamp&quot;:&quot;2026-01-01T10:46:47.392Z&quot;,&quot;service&quot;:&quot;stockly-api&quot;,&quot;level&quot;:&quot;INFO&quot;,&quot;traceId&quot;:&quot;cron-news-1767264407392&quot;,&quot;userId&quot;:null,&quot;path&quot;:&quot;/cron/news-alerts&quot;,&quot;message&quot;:&quot;Starting news alert cron job&quot;,&quot;type&quot;:&quot;general&quot;}

{&quot;timestamp&quot;:&quot;2026-01-01T10:46:47.392Z&quot;,&quot;service&quot;:&quot;stockly-api&quot;,&quot;level&quot;:&quot;INFO&quot;,&quot;traceId&quot;:&quot;cron-news-1767264407392&quot;,&quot;userId&quot;:null,&quot;path&quot;:&quot;/cron/news-alerts&quot;,&quot;message&quot;:&quot;Checking news for 1 unique symbols: LXEO&quot;,&quot;type&quot;:&quot;general&quot;}
{&quot;timestamp&quot;:&quot;2026-01-01T10:46:47.392Z&quot;,&quot;service&quot;:&quot;stockly-api&quot;,&quot;level&quot;:&quot;INFO&quot;,&quot;traceId&quot;:&quot;cron-news-1767264407392&quot;,&quot;userId&quot;:null,&quot;path&quot;:&quot;/cron/news-alerts&quot;,&quot;message&quot;:&quot;Fetching news for all symbols published today (2026-01-01)&quot;,&quot;type&quot;:&quot;general&quot;}

{&quot;timestamp&quot;:&quot;2026-01-01T10:46:47.392Z&quot;,&quot;service&quot;:&quot;stockly-api&quot;,&quot;level&quot;:&quot;INFO&quot;,&quot;traceId&quot;:&quot;cron-news-1767264407392&quot;,&quot;userId&quot;:null,&quot;path&quot;:&quot;/cron/news-alerts&quot;,&quot;message&quot;:&quot;Fetched 1 news articles published today&quot;,&quot;type&quot;:&quot;general&quot;}
{&quot;timestamp&quot;:&quot;2026-01-01T10:46:47.392Z&quot;,&quot;service&quot;:&quot;stockly-api&quot;,&quot;level&quot;:&quot;INFO&quot;,&quot;traceId&quot;:&quot;cron-news-1767264407392&quot;,&quot;userId&quot;:null,&quot;path&quot;:&quot;/cron/news-alerts&quot;,&quot;message&quot;:&quot;Found news for 1 symbols: LXEO&quot;,&quot;type&quot;:&quot;general&quot;}

{&quot;timestamp&quot;:&quot;2026-01-01T10:46:47.392Z&quot;,&quot;service&quot;:&quot;stockly-api&quot;,&quot;level&quot;:&quot;INFO&quot;,&quot;traceId&quot;:&quot;cron-news-1767264407392&quot;,&quot;userId&quot;:null,&quot;path&quot;:&quot;/cron/news-alerts&quot;,&quot;message&quot;:&quot;New article found (published today)&quot;,&quot;type&quot;:&quot;general&quot;,&quot;symbol&quot;:&quot;LXEO&quot;,&quot;title&quot;:&quot;LXEO News Today&quot;,&quot;publishedDate&quot;:&quot;2026-01-01T10:00:00Z&quot;}

{&quot;timestamp&quot;:&quot;2026-01-01T10:46:47.392Z&quot;,&quot;service&quot;:&quot;stockly-api&quot;,&quot;level&quot;:&quot;INFO&quot;,&quot;traceId&quot;:&quot;cron-news-1767264407392&quot;,&quot;userId&quot;:null,&quot;path&quot;:&quot;/cron/news-alerts&quot;,&quot;message&quot;:&quot;Found 1 users with LXEO in favorites: user1&quot;,&quot;type&quot;:&quot;general&quot;}

{&quot;timestamp&quot;:&quot;2026-01-01T10:46:47.392Z&quot;,&quot;service&quot;:&quot;stockly-api&quot;,&quot;level&quot;:&quot;INFO&quot;,&quot;traceId&quot;:&quot;cron-news-1767264407392&quot;,&quot;userId&quot;:null,&quot;path&quot;:&quot;/cron/news-alerts&quot;,&quot;message&quot;:&quot;Sent 1 notifications for LXEO news to 1 users&quot;,&quot;type&quot;:&quot;general&quot;}
{&quot;timestamp&quot;:&quot;2026-01-01T10:46:47.392Z&quot;,&quot;service&quot;:&quot;stockly-api&quot;,&quot;level&quot;:&quot;INFO&quot;,&quot;traceId&quot;:&quot;cron-news-1767264407392&quot;,&quot;userId&quot;:null,&quot;path&quot;:&quot;/cron/news-alerts&quot;,&quot;message&quot;:&quot;News alert cron job completed&quot;,&quot;type&quot;:&quot;general&quot;}

{&quot;timestamp&quot;:&quot;2026-01-01T10:46:47.392Z&quot;,&quot;service&quot;:&quot;stockly-api&quot;,&quot;level&quot;:&quot;INFO&quot;,&quot;traceId&quot;:&quot;cron-news-1767264407392&quot;,&quot;userId&quot;:null,&quot;path&quot;:&quot;/cron/news-alerts&quot;,&quot;message&quot;:&quot;Starting news alert cron job&quot;,&quot;type&quot;:&quot;general&quot;}

{&quot;timestamp&quot;:&quot;2026-01-01T10:46:47.393Z&quot;,&quot;service&quot;:&quot;stockly-api&quot;,&quot;level&quot;:&quot;INFO&quot;,&quot;traceId&quot;:&quot;cron-news-1767264407392&quot;,&quot;userId&quot;:null,&quot;path&quot;:&quot;/cron/news-alerts&quot;,&quot;message&quot;:&quot;No favorite symbols found to check for news&quot;,&quot;type&quot;:&quot;general&quot;}

            </system-out>
            <system-err>
{&quot;timestamp&quot;:&quot;2026-01-01T10:46:47.393Z&quot;,&quot;service&quot;:&quot;stockly-api&quot;,&quot;level&quot;:&quot;WARN&quot;,&quot;traceId&quot;:&quot;cron-news-1767264407392&quot;,&quot;userId&quot;:&quot;user1&quot;,&quot;path&quot;:&quot;/cron/news-alerts&quot;,&quot;message&quot;:&quot;Failed to parse news_favorite_symbols&quot;,&quot;type&quot;:&quot;general&quot;}

            </system-err>
        </testcase>
        <testcase classname="test/cron/news-alert-cron.spec.ts" name="News Alert Cron Job &gt; Deduplication &gt; should mark articles as seen in KV after sending notification" time="0.029">
            <system-out>
{&quot;timestamp&quot;:&quot;2026-01-01T10:46:47.455Z&quot;,&quot;service&quot;:&quot;stockly-api&quot;,&quot;level&quot;:&quot;INFO&quot;,&quot;traceId&quot;:&quot;cron-news-1767264407455&quot;,&quot;userId&quot;:null,&quot;path&quot;:&quot;/cron/news-alerts&quot;,&quot;message&quot;:&quot;Starting news alert cron job&quot;,&quot;type&quot;:&quot;general&quot;}

{&quot;timestamp&quot;:&quot;2026-01-01T10:46:47.455Z&quot;,&quot;service&quot;:&quot;stockly-api&quot;,&quot;level&quot;:&quot;INFO&quot;,&quot;traceId&quot;:&quot;cron-news-1767264407455&quot;,&quot;userId&quot;:null,&quot;path&quot;:&quot;/cron/news-alerts&quot;,&quot;message&quot;:&quot;Checking news for 1 unique symbols: LXEO&quot;,&quot;type&quot;:&quot;general&quot;}
{&quot;timestamp&quot;:&quot;2026-01-01T10:46:47.455Z&quot;,&quot;service&quot;:&quot;stockly-api&quot;,&quot;level&quot;:&quot;INFO&quot;,&quot;traceId&quot;:&quot;cron-news-1767264407455&quot;,&quot;userId&quot;:null,&quot;path&quot;:&quot;/cron/news-alerts&quot;,&quot;message&quot;:&quot;Fetching news for all symbols published today (2026-01-01)&quot;,&quot;type&quot;:&quot;general&quot;}

{&quot;timestamp&quot;:&quot;2026-01-01T10:46:47.456Z&quot;,&quot;service&quot;:&quot;stockly-api&quot;,&quot;level&quot;:&quot;INFO&quot;,&quot;traceId&quot;:&quot;cron-news-1767264407455&quot;,&quot;userId&quot;:null,&quot;path&quot;:&quot;/cron/news-alerts&quot;,&quot;message&quot;:&quot;Fetched 1 news articles published today&quot;,&quot;type&quot;:&quot;general&quot;}
{&quot;timestamp&quot;:&quot;2026-01-01T10:46:47.456Z&quot;,&quot;service&quot;:&quot;stockly-api&quot;,&quot;level&quot;:&quot;INFO&quot;,&quot;traceId&quot;:&quot;cron-news-1767264407455&quot;,&quot;userId&quot;:null,&quot;path&quot;:&quot;/cron/news-alerts&quot;,&quot;message&quot;:&quot;Found news for 1 symbols: LXEO&quot;,&quot;type&quot;:&quot;general&quot;}

{&quot;timestamp&quot;:&quot;2026-01-01T10:46:47.456Z&quot;,&quot;service&quot;:&quot;stockly-api&quot;,&quot;level&quot;:&quot;INFO&quot;,&quot;traceId&quot;:&quot;cron-news-1767264407455&quot;,&quot;userId&quot;:null,&quot;path&quot;:&quot;/cron/news-alerts&quot;,&quot;message&quot;:&quot;New article found (published today)&quot;,&quot;type&quot;:&quot;general&quot;,&quot;symbol&quot;:&quot;LXEO&quot;,&quot;title&quot;:&quot;LXEO News Today&quot;,&quot;publishedDate&quot;:&quot;2026-01-01T10:00:00Z&quot;}

{&quot;timestamp&quot;:&quot;2026-01-01T10:46:47.456Z&quot;,&quot;service&quot;:&quot;stockly-api&quot;,&quot;level&quot;:&quot;INFO&quot;,&quot;traceId&quot;:&quot;cron-news-1767264407455&quot;,&quot;userId&quot;:null,&quot;path&quot;:&quot;/cron/news-alerts&quot;,&quot;message&quot;:&quot;Found 1 users with LXEO in favorites: user1&quot;,&quot;type&quot;:&quot;general&quot;}

{&quot;timestamp&quot;:&quot;2026-01-01T10:46:47.456Z&quot;,&quot;service&quot;:&quot;stockly-api&quot;,&quot;level&quot;:&quot;INFO&quot;,&quot;traceId&quot;:&quot;cron-news-1767264407455&quot;,&quot;userId&quot;:null,&quot;path&quot;:&quot;/cron/news-alerts&quot;,&quot;message&quot;:&quot;Sent 1 notifications for LXEO news to 1 users&quot;,&quot;type&quot;:&quot;general&quot;}
{&quot;timestamp&quot;:&quot;2026-01-01T10:46:47.456Z&quot;,&quot;service&quot;:&quot;stockly-api&quot;,&quot;level&quot;:&quot;INFO&quot;,&quot;traceId&quot;:&quot;cron-news-1767264407455&quot;,&quot;userId&quot;:null,&quot;path&quot;:&quot;/cron/news-alerts&quot;,&quot;message&quot;:&quot;News alert cron job completed&quot;,&quot;type&quot;:&quot;general&quot;}

            </system-out>
        </testcase>
        <testcase classname="test/cron/news-alert-cron.spec.ts" name="News Alert Cron Job &gt; Notification Sending &gt; should send notifications to all users who have the symbol in favorites" time="0.163">
            <system-out>
{&quot;timestamp&quot;:&quot;2026-01-01T10:46:47.636Z&quot;,&quot;service&quot;:&quot;stockly-api&quot;,&quot;level&quot;:&quot;INFO&quot;,&quot;traceId&quot;:&quot;cron-news-1767264407636&quot;,&quot;userId&quot;:null,&quot;path&quot;:&quot;/cron/news-alerts&quot;,&quot;message&quot;:&quot;Starting news alert cron job&quot;,&quot;type&quot;:&quot;general&quot;}

{&quot;timestamp&quot;:&quot;2026-01-01T10:46:47.637Z&quot;,&quot;service&quot;:&quot;stockly-api&quot;,&quot;level&quot;:&quot;INFO&quot;,&quot;traceId&quot;:&quot;cron-news-1767264407636&quot;,&quot;userId&quot;:null,&quot;path&quot;:&quot;/cron/news-alerts&quot;,&quot;message&quot;:&quot;Checking news for 4 unique symbols: LXEO, AMZN, AAPL, BABA&quot;,&quot;type&quot;:&quot;general&quot;}
{&quot;timestamp&quot;:&quot;2026-01-01T10:46:47.637Z&quot;,&quot;service&quot;:&quot;stockly-api&quot;,&quot;level&quot;:&quot;INFO&quot;,&quot;traceId&quot;:&quot;cron-news-1767264407636&quot;,&quot;userId&quot;:null,&quot;path&quot;:&quot;/cron/news-alerts&quot;,&quot;message&quot;:&quot;Fetching news for all symbols published today (2026-01-01)&quot;,&quot;type&quot;:&quot;general&quot;}

{&quot;timestamp&quot;:&quot;2026-01-01T10:46:47.637Z&quot;,&quot;service&quot;:&quot;stockly-api&quot;,&quot;level&quot;:&quot;INFO&quot;,&quot;traceId&quot;:&quot;cron-news-1767264407636&quot;,&quot;userId&quot;:null,&quot;path&quot;:&quot;/cron/news-alerts&quot;,&quot;message&quot;:&quot;Fetched 1 news articles published today&quot;,&quot;type&quot;:&quot;general&quot;}
{&quot;timestamp&quot;:&quot;2026-01-01T10:46:47.637Z&quot;,&quot;service&quot;:&quot;stockly-api&quot;,&quot;level&quot;:&quot;INFO&quot;,&quot;traceId&quot;:&quot;cron-news-1767264407636&quot;,&quot;userId&quot;:null,&quot;path&quot;:&quot;/cron/news-alerts&quot;,&quot;message&quot;:&quot;Found news for 1 symbols: LXEO&quot;,&quot;type&quot;:&quot;general&quot;}

{&quot;timestamp&quot;:&quot;2026-01-01T10:46:47.637Z&quot;,&quot;service&quot;:&quot;stockly-api&quot;,&quot;level&quot;:&quot;INFO&quot;,&quot;traceId&quot;:&quot;cron-news-1767264407636&quot;,&quot;userId&quot;:null,&quot;path&quot;:&quot;/cron/news-alerts&quot;,&quot;message&quot;:&quot;New article found (published today)&quot;,&quot;type&quot;:&quot;general&quot;,&quot;symbol&quot;:&quot;LXEO&quot;,&quot;title&quot;:&quot;LXEO News Today&quot;,&quot;publishedDate&quot;:&quot;2026-01-01T10:00:00Z&quot;}

{&quot;timestamp&quot;:&quot;2026-01-01T10:46:47.637Z&quot;,&quot;service&quot;:&quot;stockly-api&quot;,&quot;level&quot;:&quot;INFO&quot;,&quot;traceId&quot;:&quot;cron-news-1767264407636&quot;,&quot;userId&quot;:null,&quot;path&quot;:&quot;/cron/news-alerts&quot;,&quot;message&quot;:&quot;Found 2 users with LXEO in favorites: user1, user3&quot;,&quot;type&quot;:&quot;general&quot;}

{&quot;timestamp&quot;:&quot;2026-01-01T10:46:47.637Z&quot;,&quot;service&quot;:&quot;stockly-api&quot;,&quot;level&quot;:&quot;INFO&quot;,&quot;traceId&quot;:&quot;cron-news-1767264407636&quot;,&quot;userId&quot;:null,&quot;path&quot;:&quot;/cron/news-alerts&quot;,&quot;message&quot;:&quot;Sent 2 notifications for LXEO news to 2 users&quot;,&quot;type&quot;:&quot;general&quot;}
{&quot;timestamp&quot;:&quot;2026-01-01T10:46:47.637Z&quot;,&quot;service&quot;:&quot;stockly-api&quot;,&quot;level&quot;:&quot;INFO&quot;,&quot;traceId&quot;:&quot;cron-news-1767264407636&quot;,&quot;userId&quot;:null,&quot;path&quot;:&quot;/cron/news-alerts&quot;,&quot;message&quot;:&quot;News alert cron job completed&quot;,&quot;type&quot;:&quot;general&quot;}

            </system-out>
        </testcase>
        <testcase classname="test/cron/news-alert-cron.spec.ts" name="News Alert Cron Job &gt; Notification Sending &gt; should send separate notifications for different symbols" time="0.035">
            <system-out>
{&quot;timestamp&quot;:&quot;2026-01-01T10:46:47.673Z&quot;,&quot;service&quot;:&quot;stockly-api&quot;,&quot;level&quot;:&quot;INFO&quot;,&quot;traceId&quot;:&quot;cron-news-1767264407673&quot;,&quot;userId&quot;:null,&quot;path&quot;:&quot;/cron/news-alerts&quot;,&quot;message&quot;:&quot;Starting news alert cron job&quot;,&quot;type&quot;:&quot;general&quot;}

{&quot;timestamp&quot;:&quot;2026-01-01T10:46:47.673Z&quot;,&quot;service&quot;:&quot;stockly-api&quot;,&quot;level&quot;:&quot;INFO&quot;,&quot;traceId&quot;:&quot;cron-news-1767264407673&quot;,&quot;userId&quot;:null,&quot;path&quot;:&quot;/cron/news-alerts&quot;,&quot;message&quot;:&quot;Checking news for 2 unique symbols: LXEO, AMZN&quot;,&quot;type&quot;:&quot;general&quot;}
{&quot;timestamp&quot;:&quot;2026-01-01T10:46:47.673Z&quot;,&quot;service&quot;:&quot;stockly-api&quot;,&quot;level&quot;:&quot;INFO&quot;,&quot;traceId&quot;:&quot;cron-news-1767264407673&quot;,&quot;userId&quot;:null,&quot;path&quot;:&quot;/cron/news-alerts&quot;,&quot;message&quot;:&quot;Fetching news for all symbols published today (2026-01-01)&quot;,&quot;type&quot;:&quot;general&quot;}

{&quot;timestamp&quot;:&quot;2026-01-01T10:46:47.673Z&quot;,&quot;service&quot;:&quot;stockly-api&quot;,&quot;level&quot;:&quot;INFO&quot;,&quot;traceId&quot;:&quot;cron-news-1767264407673&quot;,&quot;userId&quot;:null,&quot;path&quot;:&quot;/cron/news-alerts&quot;,&quot;message&quot;:&quot;Fetched 2 news articles published today&quot;,&quot;type&quot;:&quot;general&quot;}
{&quot;timestamp&quot;:&quot;2026-01-01T10:46:47.673Z&quot;,&quot;service&quot;:&quot;stockly-api&quot;,&quot;level&quot;:&quot;INFO&quot;,&quot;traceId&quot;:&quot;cron-news-1767264407673&quot;,&quot;userId&quot;:null,&quot;path&quot;:&quot;/cron/news-alerts&quot;,&quot;message&quot;:&quot;Found news for 2 symbols: LXEO, AMZN&quot;,&quot;type&quot;:&quot;general&quot;}

{&quot;timestamp&quot;:&quot;2026-01-01T10:46:47.673Z&quot;,&quot;service&quot;:&quot;stockly-api&quot;,&quot;level&quot;:&quot;INFO&quot;,&quot;traceId&quot;:&quot;cron-news-1767264407673&quot;,&quot;userId&quot;:null,&quot;path&quot;:&quot;/cron/news-alerts&quot;,&quot;message&quot;:&quot;New article found (published today)&quot;,&quot;type&quot;:&quot;general&quot;,&quot;symbol&quot;:&quot;LXEO&quot;,&quot;title&quot;:&quot;LXEO News Today&quot;,&quot;publishedDate&quot;:&quot;2026-01-01T10:00:00Z&quot;}

{&quot;timestamp&quot;:&quot;2026-01-01T10:46:47.673Z&quot;,&quot;service&quot;:&quot;stockly-api&quot;,&quot;level&quot;:&quot;INFO&quot;,&quot;traceId&quot;:&quot;cron-news-1767264407673&quot;,&quot;userId&quot;:null,&quot;path&quot;:&quot;/cron/news-alerts&quot;,&quot;message&quot;:&quot;Found 1 users with LXEO in favorites: user1&quot;,&quot;type&quot;:&quot;general&quot;}

{&quot;timestamp&quot;:&quot;2026-01-01T10:46:47.673Z&quot;,&quot;service&quot;:&quot;stockly-api&quot;,&quot;level&quot;:&quot;INFO&quot;,&quot;traceId&quot;:&quot;cron-news-1767264407673&quot;,&quot;userId&quot;:null,&quot;path&quot;:&quot;/cron/news-alerts&quot;,&quot;message&quot;:&quot;Sent 2 notifications for LXEO news to 1 users&quot;,&quot;type&quot;:&quot;general&quot;}

{&quot;timestamp&quot;:&quot;2026-01-01T10:46:47.673Z&quot;,&quot;service&quot;:&quot;stockly-api&quot;,&quot;level&quot;:&quot;INFO&quot;,&quot;traceId&quot;:&quot;cron-news-1767264407673&quot;,&quot;userId&quot;:null,&quot;path&quot;:&quot;/cron/news-alerts&quot;,&quot;message&quot;:&quot;New article found (published today)&quot;,&quot;type&quot;:&quot;general&quot;,&quot;symbol&quot;:&quot;AMZN&quot;,&quot;title&quot;:&quot;AMZN News Today&quot;,&quot;publishedDate&quot;:&quot;2026-01-01T11:00:00Z&quot;}

{&quot;timestamp&quot;:&quot;2026-01-01T10:46:47.673Z&quot;,&quot;service&quot;:&quot;stockly-api&quot;,&quot;level&quot;:&quot;INFO&quot;,&quot;traceId&quot;:&quot;cron-news-1767264407673&quot;,&quot;userId&quot;:null,&quot;path&quot;:&quot;/cron/news-alerts&quot;,&quot;message&quot;:&quot;Found 2 users with AMZN in favorites: user1, user2&quot;,&quot;type&quot;:&quot;general&quot;}

{&quot;timestamp&quot;:&quot;2026-01-01T10:46:47.673Z&quot;,&quot;service&quot;:&quot;stockly-api&quot;,&quot;level&quot;:&quot;INFO&quot;,&quot;traceId&quot;:&quot;cron-news-1767264407673&quot;,&quot;userId&quot;:null,&quot;path&quot;:&quot;/cron/news-alerts&quot;,&quot;message&quot;:&quot;Sent 2 notifications for AMZN news to 2 users&quot;,&quot;type&quot;:&quot;general&quot;}
{&quot;timestamp&quot;:&quot;2026-01-01T10:46:47.673Z&quot;,&quot;service&quot;:&quot;stockly-api&quot;,&quot;level&quot;:&quot;INFO&quot;,&quot;traceId&quot;:&quot;cron-news-1767264407673&quot;,&quot;userId&quot;:null,&quot;path&quot;:&quot;/cron/news-alerts&quot;,&quot;message&quot;:&quot;News alert cron job completed&quot;,&quot;type&quot;:&quot;general&quot;}

            </system-out>
        </testcase>
        <testcase classname="test/cron/news-alert-cron.spec.ts" name="News Alert Cron Job &gt; Notification Sending &gt; should not send notifications if user has no push token" time="0.123">
            <system-out>
{&quot;timestamp&quot;:&quot;2026-01-01T10:46:47.709Z&quot;,&quot;service&quot;:&quot;stockly-api&quot;,&quot;level&quot;:&quot;INFO&quot;,&quot;traceId&quot;:&quot;cron-news-1767264407709&quot;,&quot;userId&quot;:null,&quot;path&quot;:&quot;/cron/news-alerts&quot;,&quot;message&quot;:&quot;Starting news alert cron job&quot;,&quot;type&quot;:&quot;general&quot;}

{&quot;timestamp&quot;:&quot;2026-01-01T10:46:47.710Z&quot;,&quot;service&quot;:&quot;stockly-api&quot;,&quot;level&quot;:&quot;INFO&quot;,&quot;traceId&quot;:&quot;cron-news-1767264407709&quot;,&quot;userId&quot;:null,&quot;path&quot;:&quot;/cron/news-alerts&quot;,&quot;message&quot;:&quot;Checking news for 1 unique symbols: LXEO&quot;,&quot;type&quot;:&quot;general&quot;}
{&quot;timestamp&quot;:&quot;2026-01-01T10:46:47.710Z&quot;,&quot;service&quot;:&quot;stockly-api&quot;,&quot;level&quot;:&quot;INFO&quot;,&quot;traceId&quot;:&quot;cron-news-1767264407709&quot;,&quot;userId&quot;:null,&quot;path&quot;:&quot;/cron/news-alerts&quot;,&quot;message&quot;:&quot;Fetching news for all symbols published today (2026-01-01)&quot;,&quot;type&quot;:&quot;general&quot;}

{&quot;timestamp&quot;:&quot;2026-01-01T10:46:47.710Z&quot;,&quot;service&quot;:&quot;stockly-api&quot;,&quot;level&quot;:&quot;INFO&quot;,&quot;traceId&quot;:&quot;cron-news-1767264407709&quot;,&quot;userId&quot;:null,&quot;path&quot;:&quot;/cron/news-alerts&quot;,&quot;message&quot;:&quot;Fetched 1 news articles published today&quot;,&quot;type&quot;:&quot;general&quot;}
{&quot;timestamp&quot;:&quot;2026-01-01T10:46:47.710Z&quot;,&quot;service&quot;:&quot;stockly-api&quot;,&quot;level&quot;:&quot;INFO&quot;,&quot;traceId&quot;:&quot;cron-news-1767264407709&quot;,&quot;userId&quot;:null,&quot;path&quot;:&quot;/cron/news-alerts&quot;,&quot;message&quot;:&quot;Found news for 1 symbols: LXEO&quot;,&quot;type&quot;:&quot;general&quot;}

{&quot;timestamp&quot;:&quot;2026-01-01T10:46:47.710Z&quot;,&quot;service&quot;:&quot;stockly-api&quot;,&quot;level&quot;:&quot;INFO&quot;,&quot;traceId&quot;:&quot;cron-news-1767264407709&quot;,&quot;userId&quot;:null,&quot;path&quot;:&quot;/cron/news-alerts&quot;,&quot;message&quot;:&quot;New article found (published today)&quot;,&quot;type&quot;:&quot;general&quot;,&quot;symbol&quot;:&quot;LXEO&quot;,&quot;title&quot;:&quot;LXEO News Today&quot;,&quot;publishedDate&quot;:&quot;2026-01-01T10:00:00Z&quot;}

{&quot;timestamp&quot;:&quot;2026-01-01T10:46:47.710Z&quot;,&quot;service&quot;:&quot;stockly-api&quot;,&quot;level&quot;:&quot;INFO&quot;,&quot;traceId&quot;:&quot;cron-news-1767264407709&quot;,&quot;userId&quot;:null,&quot;path&quot;:&quot;/cron/news-alerts&quot;,&quot;message&quot;:&quot;Found 1 users with LXEO in favorites: user1&quot;,&quot;type&quot;:&quot;general&quot;}

{&quot;timestamp&quot;:&quot;2026-01-01T10:46:47.710Z&quot;,&quot;service&quot;:&quot;stockly-api&quot;,&quot;level&quot;:&quot;INFO&quot;,&quot;traceId&quot;:&quot;cron-news-1767264407709&quot;,&quot;userId&quot;:null,&quot;path&quot;:&quot;/cron/news-alerts&quot;,&quot;message&quot;:&quot;Sent 0 notifications for LXEO news to 1 users&quot;,&quot;type&quot;:&quot;general&quot;}
{&quot;timestamp&quot;:&quot;2026-01-01T10:46:47.710Z&quot;,&quot;service&quot;:&quot;stockly-api&quot;,&quot;level&quot;:&quot;INFO&quot;,&quot;traceId&quot;:&quot;cron-news-1767264407709&quot;,&quot;userId&quot;:null,&quot;path&quot;:&quot;/cron/news-alerts&quot;,&quot;message&quot;:&quot;News alert cron job completed&quot;,&quot;type&quot;:&quot;general&quot;}

            </system-out>
        </testcase>
        <testcase classname="test/cron/news-alert-cron.spec.ts" name="News Alert Cron Job &gt; Error Handling &gt; should handle API fetch errors gracefully" time="0.026">
            <system-out>
{&quot;timestamp&quot;:&quot;2026-01-01T10:46:47.886Z&quot;,&quot;service&quot;:&quot;stockly-api&quot;,&quot;level&quot;:&quot;INFO&quot;,&quot;traceId&quot;:&quot;cron-news-1767264407886&quot;,&quot;userId&quot;:null,&quot;path&quot;:&quot;/cron/news-alerts&quot;,&quot;message&quot;:&quot;Starting news alert cron job&quot;,&quot;type&quot;:&quot;general&quot;}

{&quot;timestamp&quot;:&quot;2026-01-01T10:46:47.886Z&quot;,&quot;service&quot;:&quot;stockly-api&quot;,&quot;level&quot;:&quot;INFO&quot;,&quot;traceId&quot;:&quot;cron-news-1767264407886&quot;,&quot;userId&quot;:null,&quot;path&quot;:&quot;/cron/news-alerts&quot;,&quot;message&quot;:&quot;Checking news for 1 unique symbols: LXEO&quot;,&quot;type&quot;:&quot;general&quot;}
{&quot;timestamp&quot;:&quot;2026-01-01T10:46:47.886Z&quot;,&quot;service&quot;:&quot;stockly-api&quot;,&quot;level&quot;:&quot;INFO&quot;,&quot;traceId&quot;:&quot;cron-news-1767264407886&quot;,&quot;userId&quot;:null,&quot;path&quot;:&quot;/cron/news-alerts&quot;,&quot;message&quot;:&quot;Fetching news for all symbols published today (2026-01-01)&quot;,&quot;type&quot;:&quot;general&quot;}

            </system-out>
            <system-err>
{&quot;timestamp&quot;:&quot;2026-01-01T10:46:47.887Z&quot;,&quot;service&quot;:&quot;stockly-api&quot;,&quot;level&quot;:&quot;WARN&quot;,&quot;traceId&quot;:&quot;cron-news-1767264407886&quot;,&quot;userId&quot;:null,&quot;path&quot;:&quot;/cron/news-alerts&quot;,&quot;message&quot;:&quot;Failed to fetch news for symbols&quot;,&quot;type&quot;:&quot;general&quot;,&quot;status&quot;:500,&quot;symbols&quot;:&quot;LXEO&quot;}

            </system-err>
        </testcase>
        <testcase classname="test/cron/news-alert-cron.spec.ts" name="News Alert Cron Job &gt; Error Handling &gt; should handle network errors gracefully" time="0.034">
            <system-out>
{&quot;timestamp&quot;:&quot;2026-01-01T10:46:47.915Z&quot;,&quot;service&quot;:&quot;stockly-api&quot;,&quot;level&quot;:&quot;INFO&quot;,&quot;traceId&quot;:&quot;cron-news-1767264407915&quot;,&quot;userId&quot;:null,&quot;path&quot;:&quot;/cron/news-alerts&quot;,&quot;message&quot;:&quot;Starting news alert cron job&quot;,&quot;type&quot;:&quot;general&quot;}

{&quot;timestamp&quot;:&quot;2026-01-01T10:46:47.915Z&quot;,&quot;service&quot;:&quot;stockly-api&quot;,&quot;level&quot;:&quot;INFO&quot;,&quot;traceId&quot;:&quot;cron-news-1767264407915&quot;,&quot;userId&quot;:null,&quot;path&quot;:&quot;/cron/news-alerts&quot;,&quot;message&quot;:&quot;Checking news for 1 unique symbols: LXEO&quot;,&quot;type&quot;:&quot;general&quot;}
{&quot;timestamp&quot;:&quot;2026-01-01T10:46:47.915Z&quot;,&quot;service&quot;:&quot;stockly-api&quot;,&quot;level&quot;:&quot;INFO&quot;,&quot;traceId&quot;:&quot;cron-news-1767264407915&quot;,&quot;userId&quot;:null,&quot;path&quot;:&quot;/cron/news-alerts&quot;,&quot;message&quot;:&quot;Fetching news for all symbols published today (2026-01-01)&quot;,&quot;type&quot;:&quot;general&quot;}

{&quot;timestamp&quot;:&quot;2026-01-01T10:46:47.918Z&quot;,&quot;service&quot;:&quot;stockly-api&quot;,&quot;level&quot;:&quot;INFO&quot;,&quot;traceId&quot;:&quot;cron-news-1767264407915&quot;,&quot;userId&quot;:null,&quot;path&quot;:&quot;/cron/news-alerts&quot;,&quot;message&quot;:&quot;News alert cron job completed&quot;,&quot;type&quot;:&quot;general&quot;}

            </system-out>
            <system-err>
{&quot;timestamp&quot;:&quot;2026-01-01T10:46:47.915Z&quot;,&quot;service&quot;:&quot;stockly-api&quot;,&quot;level&quot;:&quot;ERROR&quot;,&quot;traceId&quot;:&quot;cron-news-1767264407915&quot;,&quot;userId&quot;:null,&quot;path&quot;:&quot;/cron/news-alerts&quot;,&quot;message&quot;:&quot;Failed to fetch news from FMP API&quot;,&quot;type&quot;:&quot;general&quot;,&quot;error&quot;:{&quot;name&quot;:&quot;Error&quot;,&quot;message&quot;:&quot;Network error&quot;,&quot;stack&quot;:&quot;Error: Network error\n    at /home/sngvahmed/workspace/stockly/api/test/cron/news-alert-cron.spec.ts:641:47\n    at home/sngvahmed/workspace/stockly/node_modules/@vitest/runner/dist/chunk-hooks.js:155:11\n    at home/sngvahmed/workspace/stockly/node_modules/@vitest/runner/dist/chunk-hooks.js:752:26\n    at home/sngvahmed/workspace/stockly/node_modules/@vitest/runner/dist/chunk-hooks.js:1897:20\n    at new Promise (&lt;anonymous&gt;)\n    at runWithTimeout (home/sngvahmed/workspace/stockly/node_modules/@vitest/runner/dist/chunk-hooks.js:1863:10)\n    at runTest (home/sngvahmed/workspace/stockly/node_modules/@vitest/runner/dist/chunk-hooks.js:1574:12)\n    at runSuite (home/sngvahmed/workspace/stockly/node_modules/@vitest/runner/dist/chunk-hooks.js:1729:8)\n    at runSuite (home/sngvahmed/workspace/stockly/node_modules/@vitest/runner/dist/chunk-hooks.js:1729:8)\n    at runSuite (home/sngvahmed/workspace/stockly/node_modules/@vitest/runner/dist/chunk-hooks.js:1729:8)&quot;}}

            </system-err>
        </testcase>
        <testcase classname="test/cron/news-alert-cron.spec.ts" name="News Alert Cron Job &gt; Error Handling &gt; should skip users with invalid favorite symbols JSON" time="0.048">
            <system-out>
{&quot;timestamp&quot;:&quot;2026-01-01T10:46:47.963Z&quot;,&quot;service&quot;:&quot;stockly-api&quot;,&quot;level&quot;:&quot;INFO&quot;,&quot;traceId&quot;:&quot;cron-news-1767264407963&quot;,&quot;userId&quot;:null,&quot;path&quot;:&quot;/cron/news-alerts&quot;,&quot;message&quot;:&quot;Starting news alert cron job&quot;,&quot;type&quot;:&quot;general&quot;}

{&quot;timestamp&quot;:&quot;2026-01-01T10:46:47.963Z&quot;,&quot;service&quot;:&quot;stockly-api&quot;,&quot;level&quot;:&quot;INFO&quot;,&quot;traceId&quot;:&quot;cron-news-1767264407963&quot;,&quot;userId&quot;:null,&quot;path&quot;:&quot;/cron/news-alerts&quot;,&quot;message&quot;:&quot;Checking news for 1 unique symbols: LXEO&quot;,&quot;type&quot;:&quot;general&quot;}
{&quot;timestamp&quot;:&quot;2026-01-01T10:46:47.963Z&quot;,&quot;service&quot;:&quot;stockly-api&quot;,&quot;level&quot;:&quot;INFO&quot;,&quot;traceId&quot;:&quot;cron-news-1767264407963&quot;,&quot;userId&quot;:null,&quot;path&quot;:&quot;/cron/news-alerts&quot;,&quot;message&quot;:&quot;Fetching news for all symbols published today (2026-01-01)&quot;,&quot;type&quot;:&quot;general&quot;}

{&quot;timestamp&quot;:&quot;2026-01-01T10:46:47.963Z&quot;,&quot;service&quot;:&quot;stockly-api&quot;,&quot;level&quot;:&quot;INFO&quot;,&quot;traceId&quot;:&quot;cron-news-1767264407963&quot;,&quot;userId&quot;:null,&quot;path&quot;:&quot;/cron/news-alerts&quot;,&quot;message&quot;:&quot;Fetched 0 news articles published today&quot;,&quot;type&quot;:&quot;general&quot;}
{&quot;timestamp&quot;:&quot;2026-01-01T10:46:47.963Z&quot;,&quot;service&quot;:&quot;stockly-api&quot;,&quot;level&quot;:&quot;INFO&quot;,&quot;traceId&quot;:&quot;cron-news-1767264407963&quot;,&quot;userId&quot;:null,&quot;path&quot;:&quot;/cron/news-alerts&quot;,&quot;message&quot;:&quot;Found news for 0 symbols: &quot;,&quot;type&quot;:&quot;general&quot;}
{&quot;timestamp&quot;:&quot;2026-01-01T10:46:47.963Z&quot;,&quot;service&quot;:&quot;stockly-api&quot;,&quot;level&quot;:&quot;INFO&quot;,&quot;traceId&quot;:&quot;cron-news-1767264407963&quot;,&quot;userId&quot;:null,&quot;path&quot;:&quot;/cron/news-alerts&quot;,&quot;message&quot;:&quot;News alert cron job completed&quot;,&quot;type&quot;:&quot;general&quot;}

            </system-out>
            <system-err>
{&quot;timestamp&quot;:&quot;2026-01-01T10:46:47.963Z&quot;,&quot;service&quot;:&quot;stockly-api&quot;,&quot;level&quot;:&quot;WARN&quot;,&quot;traceId&quot;:&quot;cron-news-1767264407963&quot;,&quot;userId&quot;:&quot;user2&quot;,&quot;path&quot;:&quot;/cron/news-alerts&quot;,&quot;message&quot;:&quot;Failed to parse news_favorite_symbols&quot;,&quot;type&quot;:&quot;general&quot;}

            </system-err>
        </testcase>
        <testcase classname="test/cron/news-alert-cron.spec.ts" name="News Alert Cron Job &gt; Edge Cases &gt; should handle no users with favorite symbols" time="0.028">
            <system-out>
{&quot;timestamp&quot;:&quot;2026-01-01T10:46:48.027Z&quot;,&quot;service&quot;:&quot;stockly-api&quot;,&quot;level&quot;:&quot;INFO&quot;,&quot;traceId&quot;:&quot;cron-news-1767264408027&quot;,&quot;userId&quot;:null,&quot;path&quot;:&quot;/cron/news-alerts&quot;,&quot;message&quot;:&quot;Starting news alert cron job&quot;,&quot;type&quot;:&quot;general&quot;}

{&quot;timestamp&quot;:&quot;2026-01-01T10:46:48.027Z&quot;,&quot;service&quot;:&quot;stockly-api&quot;,&quot;level&quot;:&quot;INFO&quot;,&quot;traceId&quot;:&quot;cron-news-1767264408027&quot;,&quot;userId&quot;:null,&quot;path&quot;:&quot;/cron/news-alerts&quot;,&quot;message&quot;:&quot;No favorite symbols found to check for news&quot;,&quot;type&quot;:&quot;general&quot;}

            </system-out>
        </testcase>
        <testcase classname="test/cron/news-alert-cron.spec.ts" name="News Alert Cron Job &gt; Edge Cases &gt; should handle missing alertsKv gracefully" time="0.026">
            <system-err>
{&quot;timestamp&quot;:&quot;2026-01-01T10:46:48.056Z&quot;,&quot;service&quot;:&quot;stockly-api&quot;,&quot;level&quot;:&quot;WARN&quot;,&quot;traceId&quot;:&quot;cron-news-1767264408056&quot;,&quot;userId&quot;:null,&quot;path&quot;:&quot;/cron/news-alerts&quot;,&quot;message&quot;:&quot;Alerts KV is not configured; skipping news alert cron&quot;,&quot;type&quot;:&quot;general&quot;}

            </system-err>
        </testcase>
        <testcase classname="test/cron/news-alert-cron.spec.ts" name="News Alert Cron Job &gt; Complete Use Case Flow &gt; should handle the complete use case: 3 PM check with multiple users and symbols" time="0.025">
            <system-out>
{&quot;timestamp&quot;:&quot;2026-01-01T10:46:48.111Z&quot;,&quot;service&quot;:&quot;stockly-api&quot;,&quot;level&quot;:&quot;INFO&quot;,&quot;traceId&quot;:&quot;cron-news-1767264408111&quot;,&quot;userId&quot;:null,&quot;path&quot;:&quot;/cron/news-alerts&quot;,&quot;message&quot;:&quot;Starting news alert cron job&quot;,&quot;type&quot;:&quot;general&quot;}

{&quot;timestamp&quot;:&quot;2026-01-01T10:46:48.111Z&quot;,&quot;service&quot;:&quot;stockly-api&quot;,&quot;level&quot;:&quot;INFO&quot;,&quot;traceId&quot;:&quot;cron-news-1767264408111&quot;,&quot;userId&quot;:null,&quot;path&quot;:&quot;/cron/news-alerts&quot;,&quot;message&quot;:&quot;Checking news for 4 unique symbols: LXEO, AMZN, AAPL, BABA&quot;,&quot;type&quot;:&quot;general&quot;}
{&quot;timestamp&quot;:&quot;2026-01-01T10:46:48.111Z&quot;,&quot;service&quot;:&quot;stockly-api&quot;,&quot;level&quot;:&quot;INFO&quot;,&quot;traceId&quot;:&quot;cron-news-1767264408111&quot;,&quot;userId&quot;:null,&quot;path&quot;:&quot;/cron/news-alerts&quot;,&quot;message&quot;:&quot;Fetching news for all symbols published today (2026-01-01)&quot;,&quot;type&quot;:&quot;general&quot;}

{&quot;timestamp&quot;:&quot;2026-01-01T10:46:48.112Z&quot;,&quot;service&quot;:&quot;stockly-api&quot;,&quot;level&quot;:&quot;INFO&quot;,&quot;traceId&quot;:&quot;cron-news-1767264408111&quot;,&quot;userId&quot;:null,&quot;path&quot;:&quot;/cron/news-alerts&quot;,&quot;message&quot;:&quot;Fetched 2 news articles published today&quot;,&quot;type&quot;:&quot;general&quot;}
{&quot;timestamp&quot;:&quot;2026-01-01T10:46:48.112Z&quot;,&quot;service&quot;:&quot;stockly-api&quot;,&quot;level&quot;:&quot;INFO&quot;,&quot;traceId&quot;:&quot;cron-news-1767264408111&quot;,&quot;userId&quot;:null,&quot;path&quot;:&quot;/cron/news-alerts&quot;,&quot;message&quot;:&quot;Found news for 2 symbols: LXEO, AMZN&quot;,&quot;type&quot;:&quot;general&quot;}

{&quot;timestamp&quot;:&quot;2026-01-01T10:46:48.112Z&quot;,&quot;service&quot;:&quot;stockly-api&quot;,&quot;level&quot;:&quot;INFO&quot;,&quot;traceId&quot;:&quot;cron-news-1767264408111&quot;,&quot;userId&quot;:null,&quot;path&quot;:&quot;/cron/news-alerts&quot;,&quot;message&quot;:&quot;New article found (published today)&quot;,&quot;type&quot;:&quot;general&quot;,&quot;symbol&quot;:&quot;LXEO&quot;,&quot;title&quot;:&quot;LXEO News Today&quot;,&quot;publishedDate&quot;:&quot;2026-01-01T10:00:00Z&quot;}

{&quot;timestamp&quot;:&quot;2026-01-01T10:46:48.112Z&quot;,&quot;service&quot;:&quot;stockly-api&quot;,&quot;level&quot;:&quot;INFO&quot;,&quot;traceId&quot;:&quot;cron-news-1767264408111&quot;,&quot;userId&quot;:null,&quot;path&quot;:&quot;/cron/news-alerts&quot;,&quot;message&quot;:&quot;Found 2 users with LXEO in favorites: user1, user3&quot;,&quot;type&quot;:&quot;general&quot;}

{&quot;timestamp&quot;:&quot;2026-01-01T10:46:48.112Z&quot;,&quot;service&quot;:&quot;stockly-api&quot;,&quot;level&quot;:&quot;INFO&quot;,&quot;traceId&quot;:&quot;cron-news-1767264408111&quot;,&quot;userId&quot;:null,&quot;path&quot;:&quot;/cron/news-alerts&quot;,&quot;message&quot;:&quot;Sent 3 notifications for LXEO news to 2 users&quot;,&quot;type&quot;:&quot;general&quot;}

{&quot;timestamp&quot;:&quot;2026-01-01T10:46:48.112Z&quot;,&quot;service&quot;:&quot;stockly-api&quot;,&quot;level&quot;:&quot;INFO&quot;,&quot;traceId&quot;:&quot;cron-news-1767264408111&quot;,&quot;userId&quot;:null,&quot;path&quot;:&quot;/cron/news-alerts&quot;,&quot;message&quot;:&quot;New article found (published today)&quot;,&quot;type&quot;:&quot;general&quot;,&quot;symbol&quot;:&quot;AMZN&quot;,&quot;title&quot;:&quot;AMZN News Today&quot;,&quot;publishedDate&quot;:&quot;2026-01-01T11:00:00Z&quot;}

{&quot;timestamp&quot;:&quot;2026-01-01T10:46:48.112Z&quot;,&quot;service&quot;:&quot;stockly-api&quot;,&quot;level&quot;:&quot;INFO&quot;,&quot;traceId&quot;:&quot;cron-news-1767264408111&quot;,&quot;userId&quot;:null,&quot;path&quot;:&quot;/cron/news-alerts&quot;,&quot;message&quot;:&quot;Found 2 users with AMZN in favorites: user1, user2&quot;,&quot;type&quot;:&quot;general&quot;}

{&quot;timestamp&quot;:&quot;2026-01-01T10:46:48.112Z&quot;,&quot;service&quot;:&quot;stockly-api&quot;,&quot;level&quot;:&quot;INFO&quot;,&quot;traceId&quot;:&quot;cron-news-1767264408111&quot;,&quot;userId&quot;:null,&quot;path&quot;:&quot;/cron/news-alerts&quot;,&quot;message&quot;:&quot;Sent 3 notifications for AMZN news to 2 users&quot;,&quot;type&quot;:&quot;general&quot;}
{&quot;timestamp&quot;:&quot;2026-01-01T10:46:48.112Z&quot;,&quot;service&quot;:&quot;stockly-api&quot;,&quot;level&quot;:&quot;INFO&quot;,&quot;traceId&quot;:&quot;cron-news-1767264408111&quot;,&quot;userId&quot;:null,&quot;path&quot;:&quot;/cron/news-alerts&quot;,&quot;message&quot;:&quot;News alert cron job completed&quot;,&quot;type&quot;:&quot;general&quot;}

            </system-out>
        </testcase>
        <testcase classname="test/cron/news-alert-cron.spec.ts" name="News Alert Cron Job &gt; Complete Use Case Flow &gt; should handle 7 PM check: no duplicate notifications for same articles" time="0.028">
            <system-out>
{&quot;timestamp&quot;:&quot;2026-01-01T10:46:48.134Z&quot;,&quot;service&quot;:&quot;stockly-api&quot;,&quot;level&quot;:&quot;INFO&quot;,&quot;traceId&quot;:&quot;cron-news-1767264408134&quot;,&quot;userId&quot;:null,&quot;path&quot;:&quot;/cron/news-alerts&quot;,&quot;message&quot;:&quot;Starting news alert cron job&quot;,&quot;type&quot;:&quot;general&quot;}

{&quot;timestamp&quot;:&quot;2026-01-01T10:46:48.134Z&quot;,&quot;service&quot;:&quot;stockly-api&quot;,&quot;level&quot;:&quot;INFO&quot;,&quot;traceId&quot;:&quot;cron-news-1767264408134&quot;,&quot;userId&quot;:null,&quot;path&quot;:&quot;/cron/news-alerts&quot;,&quot;message&quot;:&quot;Checking news for 1 unique symbols: LXEO&quot;,&quot;type&quot;:&quot;general&quot;}
{&quot;timestamp&quot;:&quot;2026-01-01T10:46:48.134Z&quot;,&quot;service&quot;:&quot;stockly-api&quot;,&quot;level&quot;:&quot;INFO&quot;,&quot;traceId&quot;:&quot;cron-news-1767264408134&quot;,&quot;userId&quot;:null,&quot;path&quot;:&quot;/cron/news-alerts&quot;,&quot;message&quot;:&quot;Fetching news for all symbols published today (2026-01-01)&quot;,&quot;type&quot;:&quot;general&quot;}

{&quot;timestamp&quot;:&quot;2026-01-01T10:46:48.134Z&quot;,&quot;service&quot;:&quot;stockly-api&quot;,&quot;level&quot;:&quot;INFO&quot;,&quot;traceId&quot;:&quot;cron-news-1767264408134&quot;,&quot;userId&quot;:null,&quot;path&quot;:&quot;/cron/news-alerts&quot;,&quot;message&quot;:&quot;Fetched 1 news articles published today&quot;,&quot;type&quot;:&quot;general&quot;}
{&quot;timestamp&quot;:&quot;2026-01-01T10:46:48.134Z&quot;,&quot;service&quot;:&quot;stockly-api&quot;,&quot;level&quot;:&quot;INFO&quot;,&quot;traceId&quot;:&quot;cron-news-1767264408134&quot;,&quot;userId&quot;:null,&quot;path&quot;:&quot;/cron/news-alerts&quot;,&quot;message&quot;:&quot;Found news for 1 symbols: LXEO&quot;,&quot;type&quot;:&quot;general&quot;}

{&quot;timestamp&quot;:&quot;2026-01-01T10:46:48.134Z&quot;,&quot;service&quot;:&quot;stockly-api&quot;,&quot;level&quot;:&quot;INFO&quot;,&quot;traceId&quot;:&quot;cron-news-1767264408134&quot;,&quot;userId&quot;:null,&quot;path&quot;:&quot;/cron/news-alerts&quot;,&quot;message&quot;:&quot;New article found (published today)&quot;,&quot;type&quot;:&quot;general&quot;,&quot;symbol&quot;:&quot;LXEO&quot;,&quot;title&quot;:&quot;LXEO News Today&quot;,&quot;publishedDate&quot;:&quot;2026-01-01T10:00:00Z&quot;}

{&quot;timestamp&quot;:&quot;2026-01-01T10:46:48.135Z&quot;,&quot;service&quot;:&quot;stockly-api&quot;,&quot;level&quot;:&quot;INFO&quot;,&quot;traceId&quot;:&quot;cron-news-1767264408134&quot;,&quot;userId&quot;:null,&quot;path&quot;:&quot;/cron/news-alerts&quot;,&quot;message&quot;:&quot;Found 1 users with LXEO in favorites: user1&quot;,&quot;type&quot;:&quot;general&quot;}

{&quot;timestamp&quot;:&quot;2026-01-01T10:46:48.135Z&quot;,&quot;service&quot;:&quot;stockly-api&quot;,&quot;level&quot;:&quot;INFO&quot;,&quot;traceId&quot;:&quot;cron-news-1767264408134&quot;,&quot;userId&quot;:null,&quot;path&quot;:&quot;/cron/news-alerts&quot;,&quot;message&quot;:&quot;Sent 1 notifications for LXEO news to 1 users&quot;,&quot;type&quot;:&quot;general&quot;}
{&quot;timestamp&quot;:&quot;2026-01-01T10:46:48.135Z&quot;,&quot;service&quot;:&quot;stockly-api&quot;,&quot;level&quot;:&quot;INFO&quot;,&quot;traceId&quot;:&quot;cron-news-1767264408134&quot;,&quot;userId&quot;:null,&quot;path&quot;:&quot;/cron/news-alerts&quot;,&quot;message&quot;:&quot;News alert cron job completed&quot;,&quot;type&quot;:&quot;general&quot;}

{&quot;timestamp&quot;:&quot;2026-01-01T10:46:48.135Z&quot;,&quot;service&quot;:&quot;stockly-api&quot;,&quot;level&quot;:&quot;INFO&quot;,&quot;traceId&quot;:&quot;cron-news-1767264408135&quot;,&quot;userId&quot;:null,&quot;path&quot;:&quot;/cron/news-alerts&quot;,&quot;message&quot;:&quot;Starting news alert cron job&quot;,&quot;type&quot;:&quot;general&quot;}

{&quot;timestamp&quot;:&quot;2026-01-01T10:46:48.135Z&quot;,&quot;service&quot;:&quot;stockly-api&quot;,&quot;level&quot;:&quot;INFO&quot;,&quot;traceId&quot;:&quot;cron-news-1767264408135&quot;,&quot;userId&quot;:null,&quot;path&quot;:&quot;/cron/news-alerts&quot;,&quot;message&quot;:&quot;No favorite symbols found to check for news&quot;,&quot;type&quot;:&quot;general&quot;}

            </system-out>
            <system-err>
{&quot;timestamp&quot;:&quot;2026-01-01T10:46:48.135Z&quot;,&quot;service&quot;:&quot;stockly-api&quot;,&quot;level&quot;:&quot;WARN&quot;,&quot;traceId&quot;:&quot;cron-news-1767264408135&quot;,&quot;userId&quot;:&quot;user1&quot;,&quot;path&quot;:&quot;/cron/news-alerts&quot;,&quot;message&quot;:&quot;Failed to parse news_favorite_symbols&quot;,&quot;type&quot;:&quot;general&quot;}

            </system-err>
        </testcase>
    </testsuite>
    <testsuite name="test/contract/openapi-validation.spec.ts" timestamp="2026-01-01T10:46:50.885Z" hostname="sngvahmed" tests="6" failures="0" errors="0" skipped="0" time="0.517">
        <testcase classname="test/contract/openapi-validation.spec.ts" name="OpenAPI Contract Validation &gt; Schema Validation &gt; should validate get-stock response matches OpenAPI schema" time="0.041">
        </testcase>
        <testcase classname="test/contract/openapi-validation.spec.ts" name="OpenAPI Contract Validation &gt; Schema Validation &gt; should validate get-stocks response matches OpenAPI schema" time="0.08">
        </testcase>
        <testcase classname="test/contract/openapi-validation.spec.ts" name="OpenAPI Contract Validation &gt; Schema Validation &gt; should validate error responses match OpenAPI schema" time="0.035">
        </testcase>
        <testcase classname="test/contract/openapi-validation.spec.ts" name="OpenAPI Contract Validation &gt; Endpoint Coverage &gt; should have all endpoints documented in OpenAPI spec" time="0.036">
        </testcase>
        <testcase classname="test/contract/openapi-validation.spec.ts" name="OpenAPI Contract Validation &gt; Request/Response Validation &gt; should validate request parameters match OpenAPI spec" time="0.03">
        </testcase>
        <testcase classname="test/contract/openapi-validation.spec.ts" name="OpenAPI Contract Validation &gt; Request/Response Validation &gt; should validate response structure matches OpenAPI spec" time="0.053">
        </testcase>
    </testsuite>
    <testsuite name="test/integration/alerts-flow.spec.ts" timestamp="2026-01-01T10:46:50.886Z" hostname="sngvahmed" tests="2" failures="0" errors="0" skipped="0" time="0.33">
        <testcase classname="test/integration/alerts-flow.spec.ts" name="Alerts Flow Integration &gt; Alert Creation to Notification Flow &gt; should complete flow: create alert -&gt; evaluate -&gt; send notification" time="0.03">
        </testcase>
        <testcase classname="test/integration/alerts-flow.spec.ts" name="Alerts Flow Integration &gt; Alert State Management &gt; should maintain alert state across evaluations" time="0.029">
        </testcase>
    </testsuite>
    <testsuite name="test/integration/auth-flow.spec.ts" timestamp="2026-01-01T10:46:50.886Z" hostname="sngvahmed" tests="2" failures="0" errors="0" skipped="0" time="0.329">
        <testcase classname="test/integration/auth-flow.spec.ts" name="Authentication Flow Integration &gt; Complete User Onboarding Flow &gt; should complete full flow: Google auth -&gt; username check -&gt; username set -&gt; get user" time="0.028">
        </testcase>
        <testcase classname="test/integration/auth-flow.spec.ts" name="Authentication Flow Integration &gt; Token Refresh Flow &gt; should refresh token and maintain session" time="0.029">
        </testcase>
    </testsuite>
    <testsuite name="test/integration/stock-flow.spec.ts" timestamp="2026-01-01T10:46:50.887Z" hostname="sngvahmed" tests="3" failures="0" errors="0" skipped="0" time="0.085">
        <testcase classname="test/integration/stock-flow.spec.ts" name="Stock Data Flow Integration &gt; Stock Search to Details Flow &gt; should complete flow: search -&gt; get stock -&gt; get details" time="0.044">
            <system-out>
{&quot;timestamp&quot;:&quot;2026-01-01T10:46:48.417Z&quot;,&quot;service&quot;:&quot;stockly-api-test&quot;,&quot;level&quot;:&quot;DEBUG&quot;,&quot;traceId&quot;:&quot;test-trace-id&quot;,&quot;userId&quot;:null,&quot;path&quot;:&quot;/test&quot;,&quot;message&quot;:&quot;D1 first: SELECT results, timestamp\n           FROM search_cache\n           WHERE query = ?\n           ORDER BY timestamp DESC\n           LIMIT 1&quot;,&quot;type&quot;:&quot;data_operation&quot;,&quot;operation&quot;:&quot;d1&quot;,&quot;query&quot;:&quot;SELECT results, timestamp\n           FROM search_cache\n           WHERE query = ?\n           ORDER BY timestamp DESC\n           LIMIT 1&quot;,&quot;latencyMs&quot;:0,&quot;cacheStatus&quot;:&quot;N/A&quot;}

{&quot;timestamp&quot;:&quot;2026-01-01T10:46:48.419Z&quot;,&quot;service&quot;:&quot;stockly-api-test&quot;,&quot;level&quot;:&quot;DEBUG&quot;,&quot;traceId&quot;:&quot;test-trace-id&quot;,&quot;userId&quot;:null,&quot;path&quot;:&quot;/test&quot;,&quot;message&quot;:&quot;D1 first: SELECT * FROM api_endpoints WHERE id = ?&quot;,&quot;type&quot;:&quot;data_operation&quot;,&quot;operation&quot;:&quot;d1&quot;,&quot;query&quot;:&quot;SELECT * FROM api_endpoints WHERE id = ?&quot;,&quot;latencyMs&quot;:0,&quot;cacheStatus&quot;:&quot;N/A&quot;}

{&quot;timestamp&quot;:&quot;2026-01-01T10:46:48.419Z&quot;,&quot;service&quot;:&quot;stockly-api-test&quot;,&quot;level&quot;:&quot;DEBUG&quot;,&quot;traceId&quot;:&quot;test-trace-id&quot;,&quot;userId&quot;:null,&quot;path&quot;:&quot;/test&quot;,&quot;message&quot;:&quot;D1 first: SELECT * FROM api_endpoints WHERE id = ?&quot;,&quot;type&quot;:&quot;data_operation&quot;,&quot;operation&quot;:&quot;d1&quot;,&quot;query&quot;:&quot;SELECT * FROM api_endpoints WHERE id = ?&quot;,&quot;latencyMs&quot;:0,&quot;cacheStatus&quot;:&quot;N/A&quot;}

{&quot;timestamp&quot;:&quot;2026-01-01T10:46:48.422Z&quot;,&quot;service&quot;:&quot;stockly-api-test&quot;,&quot;level&quot;:&quot;DEBUG&quot;,&quot;traceId&quot;:&quot;test-trace-id&quot;,&quot;userId&quot;:null,&quot;path&quot;:&quot;/test&quot;,&quot;message&quot;:&quot;D1 first: SELECT symbol, price, day_low, day_high, volume, timestamp\n       FROM stock_prices\n       WHERE symbol = ?\n       ORDER BY timestamp DESC\n       LIMIT 1&quot;,&quot;type&quot;:&quot;data_operation&quot;,&quot;operation&quot;:&quot;d1&quot;,&quot;query&quot;:&quot;SELECT symbol, price, day_low, day_high, volume, timestamp\n       FROM stock_prices\n       WHERE symbol = ?\n       ORDER BY timestamp DESC\n       LIMIT 1&quot;,&quot;latencyMs&quot;:0,&quot;cacheStatus&quot;:&quot;N/A&quot;}

{&quot;timestamp&quot;:&quot;2026-01-01T10:46:48.423Z&quot;,&quot;service&quot;:&quot;stockly-api-test&quot;,&quot;level&quot;:&quot;DEBUG&quot;,&quot;traceId&quot;:&quot;test-trace-id&quot;,&quot;userId&quot;:null,&quot;path&quot;:&quot;/test&quot;,&quot;message&quot;:&quot;D1 first: SELECT * FROM api_endpoints WHERE id = ?&quot;,&quot;type&quot;:&quot;data_operation&quot;,&quot;operation&quot;:&quot;d1&quot;,&quot;query&quot;:&quot;SELECT * FROM api_endpoints WHERE id = ?&quot;,&quot;latencyMs&quot;:0,&quot;cacheStatus&quot;:&quot;N/A&quot;}

{&quot;timestamp&quot;:&quot;2026-01-01T10:46:48.426Z&quot;,&quot;service&quot;:&quot;stockly-api-test&quot;,&quot;level&quot;:&quot;DEBUG&quot;,&quot;traceId&quot;:&quot;test-trace-id&quot;,&quot;userId&quot;:null,&quot;path&quot;:&quot;/test&quot;,&quot;message&quot;:&quot;D1 first: SELECT * FROM api_endpoints WHERE id = ?&quot;,&quot;type&quot;:&quot;data_operation&quot;,&quot;operation&quot;:&quot;d1&quot;,&quot;query&quot;:&quot;SELECT * FROM api_endpoints WHERE id = ?&quot;,&quot;latencyMs&quot;:0,&quot;cacheStatus&quot;:&quot;N/A&quot;}

{&quot;timestamp&quot;:&quot;2026-01-01T10:46:48.428Z&quot;,&quot;service&quot;:&quot;stockly-api-test&quot;,&quot;level&quot;:&quot;DEBUG&quot;,&quot;traceId&quot;:&quot;test-trace-id&quot;,&quot;userId&quot;:null,&quot;path&quot;:&quot;/test&quot;,&quot;message&quot;:&quot;D1 run: INSERT INTO stock_prices (symbol, price, day_low, day_high, volume, timestamp)\n       VALUES (?, ?, ?, ?, ?, ?)&quot;,&quot;type&quot;:&quot;data_operation&quot;,&quot;operation&quot;:&quot;d1&quot;,&quot;query&quot;:&quot;INSERT INTO stock_prices (symbol, price, day_low, day_high, volume, timestamp)\n       VALUES (?, ?, ?, ?, ?, ?)&quot;,&quot;latencyMs&quot;:0,&quot;cacheStatus&quot;:&quot;N/A&quot;}

[fetchAndSaveHistoricalPrice] Starting fetch for AAPL from FMP API
[fetchAndSaveHistoricalPrice] Fetching from: https://financialmodelingprep.com/stable/historical-chart/30min?symbol=AAPL&amp;apikey=***

[fetchAndSaveHistoricalPrice] Received 0 1-hour OHLC records from FMP API
[fetchAndSaveHistoricalPrice] FMP API returned 0 records for AAPL

{&quot;timestamp&quot;:&quot;2026-01-01T10:46:48.430Z&quot;,&quot;service&quot;:&quot;stockly-api-test&quot;,&quot;level&quot;:&quot;INFO&quot;,&quot;traceId&quot;:&quot;test-trace-id&quot;,&quot;userId&quot;:null,&quot;path&quot;:&quot;/test&quot;,&quot;message&quot;:&quot;Cache miss for stock details: AAPL, fetching...&quot;,&quot;type&quot;:&quot;general&quot;}

{&quot;timestamp&quot;:&quot;2026-01-01T10:46:48.430Z&quot;,&quot;service&quot;:&quot;stockly-api-test&quot;,&quot;level&quot;:&quot;DEBUG&quot;,&quot;traceId&quot;:&quot;test-trace-id&quot;,&quot;userId&quot;:null,&quot;path&quot;:&quot;/test&quot;,&quot;message&quot;:&quot;D1 first: SELECT * FROM api_endpoints WHERE id = ?&quot;,&quot;type&quot;:&quot;data_operation&quot;,&quot;operation&quot;:&quot;d1&quot;,&quot;query&quot;:&quot;SELECT * FROM api_endpoints WHERE id = ?&quot;,&quot;latencyMs&quot;:0,&quot;cacheStatus&quot;:&quot;N/A&quot;}
{&quot;timestamp&quot;:&quot;2026-01-01T10:46:48.430Z&quot;,&quot;service&quot;:&quot;stockly-api-test&quot;,&quot;level&quot;:&quot;DEBUG&quot;,&quot;traceId&quot;:&quot;test-trace-id&quot;,&quot;userId&quot;:null,&quot;path&quot;:&quot;/test&quot;,&quot;message&quot;:&quot;D1 first: SELECT * FROM api_endpoints WHERE id = ?&quot;,&quot;type&quot;:&quot;data_operation&quot;,&quot;operation&quot;:&quot;d1&quot;,&quot;query&quot;:&quot;SELECT * FROM api_endpoints WHERE id = ?&quot;,&quot;latencyMs&quot;:0,&quot;cacheStatus&quot;:&quot;N/A&quot;}
{&quot;timestamp&quot;:&quot;2026-01-01T10:46:48.430Z&quot;,&quot;service&quot;:&quot;stockly-api-test&quot;,&quot;level&quot;:&quot;DEBUG&quot;,&quot;traceId&quot;:&quot;test-trace-id&quot;,&quot;userId&quot;:null,&quot;path&quot;:&quot;/test&quot;,&quot;message&quot;:&quot;D1 first: SELECT * FROM api_endpoints WHERE id = ?&quot;,&quot;type&quot;:&quot;data_operation&quot;,&quot;operation&quot;:&quot;d1&quot;,&quot;query&quot;:&quot;SELECT * FROM api_endpoints WHERE id = ?&quot;,&quot;latencyMs&quot;:0,&quot;cacheStatus&quot;:&quot;N/A&quot;}
{&quot;timestamp&quot;:&quot;2026-01-01T10:46:48.430Z&quot;,&quot;service&quot;:&quot;stockly-api-test&quot;,&quot;level&quot;:&quot;DEBUG&quot;,&quot;traceId&quot;:&quot;test-trace-id&quot;,&quot;userId&quot;:null,&quot;path&quot;:&quot;/test&quot;,&quot;message&quot;:&quot;D1 first: SELECT * FROM api_endpoints WHERE id = ?&quot;,&quot;type&quot;:&quot;data_operation&quot;,&quot;operation&quot;:&quot;d1&quot;,&quot;query&quot;:&quot;SELECT * FROM api_endpoints WHERE id = ?&quot;,&quot;latencyMs&quot;:0,&quot;cacheStatus&quot;:&quot;N/A&quot;}
{&quot;timestamp&quot;:&quot;2026-01-01T10:46:48.430Z&quot;,&quot;service&quot;:&quot;stockly-api-test&quot;,&quot;level&quot;:&quot;DEBUG&quot;,&quot;traceId&quot;:&quot;test-trace-id&quot;,&quot;userId&quot;:null,&quot;path&quot;:&quot;/test&quot;,&quot;message&quot;:&quot;D1 first: SELECT * FROM api_endpoints WHERE id = ?&quot;,&quot;type&quot;:&quot;data_operation&quot;,&quot;operation&quot;:&quot;d1&quot;,&quot;query&quot;:&quot;SELECT * FROM api_endpoints WHERE id = ?&quot;,&quot;latencyMs&quot;:0,&quot;cacheStatus&quot;:&quot;N/A&quot;}
{&quot;timestamp&quot;:&quot;2026-01-01T10:46:48.430Z&quot;,&quot;service&quot;:&quot;stockly-api-test&quot;,&quot;level&quot;:&quot;DEBUG&quot;,&quot;traceId&quot;:&quot;test-trace-id&quot;,&quot;userId&quot;:null,&quot;path&quot;:&quot;/test&quot;,&quot;message&quot;:&quot;D1 first: SELECT * FROM api_endpoints WHERE id = ?&quot;,&quot;type&quot;:&quot;data_operation&quot;,&quot;operation&quot;:&quot;d1&quot;,&quot;query&quot;:&quot;SELECT * FROM api_endpoints WHERE id = ?&quot;,&quot;latencyMs&quot;:0,&quot;cacheStatus&quot;:&quot;N/A&quot;}
{&quot;timestamp&quot;:&quot;2026-01-01T10:46:48.430Z&quot;,&quot;service&quot;:&quot;stockly-api-test&quot;,&quot;level&quot;:&quot;DEBUG&quot;,&quot;traceId&quot;:&quot;test-trace-id&quot;,&quot;userId&quot;:null,&quot;path&quot;:&quot;/test&quot;,&quot;message&quot;:&quot;D1 first: SELECT * FROM api_endpoints WHERE id = ?&quot;,&quot;type&quot;:&quot;data_operation&quot;,&quot;operation&quot;:&quot;d1&quot;,&quot;query&quot;:&quot;SELECT * FROM api_endpoints WHERE id = ?&quot;,&quot;latencyMs&quot;:0,&quot;cacheStatus&quot;:&quot;N/A&quot;}

            </system-out>
            <system-err>
{&quot;timestamp&quot;:&quot;2026-01-01T10:46:48.419Z&quot;,&quot;service&quot;:&quot;stockly-api-test&quot;,&quot;level&quot;:&quot;WARN&quot;,&quot;traceId&quot;:&quot;test-trace-id&quot;,&quot;userId&quot;:null,&quot;path&quot;:&quot;/test&quot;,&quot;message&quot;:&quot;Datalake adapter not available for endpoint search-name, will fallback to direct FMP&quot;,&quot;type&quot;:&quot;general&quot;}

{&quot;timestamp&quot;:&quot;2026-01-01T10:46:48.419Z&quot;,&quot;service&quot;:&quot;stockly-api-test&quot;,&quot;level&quot;:&quot;WARN&quot;,&quot;traceId&quot;:&quot;test-trace-id&quot;,&quot;userId&quot;:null,&quot;path&quot;:&quot;/test&quot;,&quot;message&quot;:&quot;Datalake adapter not available for endpoint search-symbol, will fallback to direct FMP&quot;,&quot;type&quot;:&quot;general&quot;}

{&quot;timestamp&quot;:&quot;2026-01-01T10:46:48.419Z&quot;,&quot;service&quot;:&quot;stockly-api-test&quot;,&quot;level&quot;:&quot;WARN&quot;,&quot;traceId&quot;:&quot;test-trace-id&quot;,&quot;userId&quot;:null,&quot;path&quot;:&quot;/test&quot;,&quot;message&quot;:&quot;Datalake adapters not available for search endpoints, falling back to direct FMP&quot;,&quot;type&quot;:&quot;general&quot;}

{&quot;timestamp&quot;:&quot;2026-01-01T10:46:48.423Z&quot;,&quot;service&quot;:&quot;stockly-api-test&quot;,&quot;level&quot;:&quot;WARN&quot;,&quot;traceId&quot;:&quot;test-trace-id&quot;,&quot;userId&quot;:null,&quot;path&quot;:&quot;/test&quot;,&quot;message&quot;:&quot;Datalake adapter not available for endpoint quote, will fallback to direct FMP&quot;,&quot;type&quot;:&quot;general&quot;}

{&quot;timestamp&quot;:&quot;2026-01-01T10:46:48.426Z&quot;,&quot;service&quot;:&quot;stockly-api-test&quot;,&quot;level&quot;:&quot;WARN&quot;,&quot;traceId&quot;:&quot;test-trace-id&quot;,&quot;userId&quot;:null,&quot;path&quot;:&quot;/test&quot;,&quot;message&quot;:&quot;Datalake adapter not available for endpoint profile, will fallback to direct FMP&quot;,&quot;type&quot;:&quot;general&quot;}

[fetchAndSaveHistoricalPrice] No historical price data returned for AAPL from FMP API

{&quot;timestamp&quot;:&quot;2026-01-01T10:46:48.430Z&quot;,&quot;service&quot;:&quot;stockly-api-test&quot;,&quot;level&quot;:&quot;WARN&quot;,&quot;traceId&quot;:&quot;test-trace-id&quot;,&quot;userId&quot;:null,&quot;path&quot;:&quot;/test&quot;,&quot;message&quot;:&quot;Datalake adapter not available for endpoint profile, will fallback to direct FMP&quot;,&quot;type&quot;:&quot;general&quot;}
{&quot;timestamp&quot;:&quot;2026-01-01T10:46:48.430Z&quot;,&quot;service&quot;:&quot;stockly-api-test&quot;,&quot;level&quot;:&quot;WARN&quot;,&quot;traceId&quot;:&quot;test-trace-id&quot;,&quot;userId&quot;:null,&quot;path&quot;:&quot;/test&quot;,&quot;message&quot;:&quot;Datalake adapter not available for endpoint quote, will fallback to direct FMP&quot;,&quot;type&quot;:&quot;general&quot;}
{&quot;timestamp&quot;:&quot;2026-01-01T10:46:48.430Z&quot;,&quot;service&quot;:&quot;stockly-api-test&quot;,&quot;level&quot;:&quot;WARN&quot;,&quot;traceId&quot;:&quot;test-trace-id&quot;,&quot;userId&quot;:null,&quot;path&quot;:&quot;/test&quot;,&quot;message&quot;:&quot;Datalake adapter not available for endpoint historical-price-full, will fallback to direct FMP&quot;,&quot;type&quot;:&quot;general&quot;}
{&quot;timestamp&quot;:&quot;2026-01-01T10:46:48.431Z&quot;,&quot;service&quot;:&quot;stockly-api-test&quot;,&quot;level&quot;:&quot;WARN&quot;,&quot;traceId&quot;:&quot;test-trace-id&quot;,&quot;userId&quot;:null,&quot;path&quot;:&quot;/test&quot;,&quot;message&quot;:&quot;Datalake adapter not available for endpoint key-metrics, will fallback to direct FMP&quot;,&quot;type&quot;:&quot;general&quot;}
{&quot;timestamp&quot;:&quot;2026-01-01T10:46:48.431Z&quot;,&quot;service&quot;:&quot;stockly-api-test&quot;,&quot;level&quot;:&quot;WARN&quot;,&quot;traceId&quot;:&quot;test-trace-id&quot;,&quot;userId&quot;:null,&quot;path&quot;:&quot;/test&quot;,&quot;message&quot;:&quot;Datalake adapter not available for endpoint income-statement, will fallback to direct FMP&quot;,&quot;type&quot;:&quot;general&quot;}
{&quot;timestamp&quot;:&quot;2026-01-01T10:46:48.431Z&quot;,&quot;service&quot;:&quot;stockly-api-test&quot;,&quot;level&quot;:&quot;WARN&quot;,&quot;traceId&quot;:&quot;test-trace-id&quot;,&quot;userId&quot;:null,&quot;path&quot;:&quot;/test&quot;,&quot;message&quot;:&quot;Datalake adapter not available for endpoint stock-news, will fallback to direct FMP&quot;,&quot;type&quot;:&quot;general&quot;}
{&quot;timestamp&quot;:&quot;2026-01-01T10:46:48.431Z&quot;,&quot;service&quot;:&quot;stockly-api-test&quot;,&quot;level&quot;:&quot;WARN&quot;,&quot;traceId&quot;:&quot;test-trace-id&quot;,&quot;userId&quot;:null,&quot;path&quot;:&quot;/test&quot;,&quot;message&quot;:&quot;Datalake adapter not available for endpoint ratios, will fallback to direct FMP&quot;,&quot;type&quot;:&quot;general&quot;}

{&quot;timestamp&quot;:&quot;2026-01-01T10:46:48.437Z&quot;,&quot;service&quot;:&quot;stockly-api-test&quot;,&quot;level&quot;:&quot;WARN&quot;,&quot;traceId&quot;:&quot;test-trace-id&quot;,&quot;userId&quot;:null,&quot;path&quot;:&quot;/test&quot;,&quot;message&quot;:&quot;Failed to fetch profile for AAPL:&quot;,&quot;type&quot;:&quot;general&quot;}

            </system-err>
        </testcase>
        <testcase classname="test/integration/stock-flow.spec.ts" name="Stock Data Flow Integration &gt; Batch Stock Retrieval Flow &gt; should retrieve multiple stocks efficiently" time="0.014">
            <system-out>
{&quot;timestamp&quot;:&quot;2026-01-01T10:46:48.450Z&quot;,&quot;service&quot;:&quot;stockly-api-test&quot;,&quot;level&quot;:&quot;DEBUG&quot;,&quot;traceId&quot;:&quot;test-trace-id&quot;,&quot;userId&quot;:null,&quot;path&quot;:&quot;/test&quot;,&quot;message&quot;:&quot;D1 first: SELECT symbol, price, day_low, day_high, volume, timestamp\n       FROM stock_prices\n       WHERE symbol = ?\n       ORDER BY timestamp DESC\n       LIMIT 1&quot;,&quot;type&quot;:&quot;data_operation&quot;,&quot;operation&quot;:&quot;d1&quot;,&quot;query&quot;:&quot;SELECT symbol, price, day_low, day_high, volume, timestamp\n       FROM stock_prices\n       WHERE symbol = ?\n       ORDER BY timestamp DESC\n       LIMIT 1&quot;,&quot;latencyMs&quot;:0,&quot;cacheStatus&quot;:&quot;N/A&quot;}

{&quot;timestamp&quot;:&quot;2026-01-01T10:46:48.450Z&quot;,&quot;service&quot;:&quot;stockly-api-test&quot;,&quot;level&quot;:&quot;DEBUG&quot;,&quot;traceId&quot;:&quot;test-trace-id&quot;,&quot;userId&quot;:null,&quot;path&quot;:&quot;/test&quot;,&quot;message&quot;:&quot;D1 first: SELECT symbol, price, day_low, day_high, volume, timestamp\n       FROM stock_prices\n       WHERE symbol = ?\n       ORDER BY timestamp DESC\n       LIMIT 1&quot;,&quot;type&quot;:&quot;data_operation&quot;,&quot;operation&quot;:&quot;d1&quot;,&quot;query&quot;:&quot;SELECT symbol, price, day_low, day_high, volume, timestamp\n       FROM stock_prices\n       WHERE symbol = ?\n       ORDER BY timestamp DESC\n       LIMIT 1&quot;,&quot;latencyMs&quot;:0,&quot;cacheStatus&quot;:&quot;N/A&quot;}

{&quot;timestamp&quot;:&quot;2026-01-01T10:46:48.450Z&quot;,&quot;service&quot;:&quot;stockly-api-test&quot;,&quot;level&quot;:&quot;DEBUG&quot;,&quot;traceId&quot;:&quot;test-trace-id&quot;,&quot;userId&quot;:null,&quot;path&quot;:&quot;/test&quot;,&quot;message&quot;:&quot;D1 first: SELECT * FROM api_endpoints WHERE id = ?&quot;,&quot;type&quot;:&quot;data_operation&quot;,&quot;operation&quot;:&quot;d1&quot;,&quot;query&quot;:&quot;SELECT * FROM api_endpoints WHERE id = ?&quot;,&quot;latencyMs&quot;:0,&quot;cacheStatus&quot;:&quot;N/A&quot;}
{&quot;timestamp&quot;:&quot;2026-01-01T10:46:48.450Z&quot;,&quot;service&quot;:&quot;stockly-api-test&quot;,&quot;level&quot;:&quot;DEBUG&quot;,&quot;traceId&quot;:&quot;test-trace-id&quot;,&quot;userId&quot;:null,&quot;path&quot;:&quot;/test&quot;,&quot;message&quot;:&quot;D1 first: SELECT * FROM api_endpoints WHERE id = ?&quot;,&quot;type&quot;:&quot;data_operation&quot;,&quot;operation&quot;:&quot;d1&quot;,&quot;query&quot;:&quot;SELECT * FROM api_endpoints WHERE id = ?&quot;,&quot;latencyMs&quot;:0,&quot;cacheStatus&quot;:&quot;N/A&quot;}

{&quot;timestamp&quot;:&quot;2026-01-01T10:46:48.453Z&quot;,&quot;service&quot;:&quot;stockly-api-test&quot;,&quot;level&quot;:&quot;DEBUG&quot;,&quot;traceId&quot;:&quot;test-trace-id&quot;,&quot;userId&quot;:null,&quot;path&quot;:&quot;/test&quot;,&quot;message&quot;:&quot;D1 first: SELECT * FROM api_endpoints WHERE id = ?&quot;,&quot;type&quot;:&quot;data_operation&quot;,&quot;operation&quot;:&quot;d1&quot;,&quot;query&quot;:&quot;SELECT * FROM api_endpoints WHERE id = ?&quot;,&quot;latencyMs&quot;:0,&quot;cacheStatus&quot;:&quot;N/A&quot;}

{&quot;timestamp&quot;:&quot;2026-01-01T10:46:48.454Z&quot;,&quot;service&quot;:&quot;stockly-api-test&quot;,&quot;level&quot;:&quot;DEBUG&quot;,&quot;traceId&quot;:&quot;test-trace-id&quot;,&quot;userId&quot;:null,&quot;path&quot;:&quot;/test&quot;,&quot;message&quot;:&quot;D1 first: SELECT * FROM api_endpoints WHERE id = ?&quot;,&quot;type&quot;:&quot;data_operation&quot;,&quot;operation&quot;:&quot;d1&quot;,&quot;query&quot;:&quot;SELECT * FROM api_endpoints WHERE id = ?&quot;,&quot;latencyMs&quot;:0,&quot;cacheStatus&quot;:&quot;N/A&quot;}

{&quot;timestamp&quot;:&quot;2026-01-01T10:46:48.456Z&quot;,&quot;service&quot;:&quot;stockly-api-test&quot;,&quot;level&quot;:&quot;DEBUG&quot;,&quot;traceId&quot;:&quot;test-trace-id&quot;,&quot;userId&quot;:null,&quot;path&quot;:&quot;/test&quot;,&quot;message&quot;:&quot;D1 run: INSERT INTO stock_prices (symbol, price, day_low, day_high, volume, timestamp)\n       VALUES (?, ?, ?, ?, ?, ?)&quot;,&quot;type&quot;:&quot;data_operation&quot;,&quot;operation&quot;:&quot;d1&quot;,&quot;query&quot;:&quot;INSERT INTO stock_prices (symbol, price, day_low, day_high, volume, timestamp)\n       VALUES (?, ?, ?, ?, ?, ?)&quot;,&quot;latencyMs&quot;:0,&quot;cacheStatus&quot;:&quot;N/A&quot;}
{&quot;timestamp&quot;:&quot;2026-01-01T10:46:48.456Z&quot;,&quot;service&quot;:&quot;stockly-api-test&quot;,&quot;level&quot;:&quot;DEBUG&quot;,&quot;traceId&quot;:&quot;test-trace-id&quot;,&quot;userId&quot;:null,&quot;path&quot;:&quot;/test&quot;,&quot;message&quot;:&quot;D1 run: INSERT INTO stock_prices (symbol, price, day_low, day_high, volume, timestamp)\n       VALUES (?, ?, ?, ?, ?, ?)&quot;,&quot;type&quot;:&quot;data_operation&quot;,&quot;operation&quot;:&quot;d1&quot;,&quot;query&quot;:&quot;INSERT INTO stock_prices (symbol, price, day_low, day_high, volume, timestamp)\n       VALUES (?, ?, ?, ?, ?, ?)&quot;,&quot;latencyMs&quot;:0,&quot;cacheStatus&quot;:&quot;N/A&quot;}

            </system-out>
            <system-err>
{&quot;timestamp&quot;:&quot;2026-01-01T10:46:48.450Z&quot;,&quot;service&quot;:&quot;stockly-api-test&quot;,&quot;level&quot;:&quot;WARN&quot;,&quot;traceId&quot;:&quot;test-trace-id&quot;,&quot;userId&quot;:null,&quot;path&quot;:&quot;/test&quot;,&quot;message&quot;:&quot;Datalake adapter not available for endpoint quote, will fallback to direct FMP&quot;,&quot;type&quot;:&quot;general&quot;}
{&quot;timestamp&quot;:&quot;2026-01-01T10:46:48.450Z&quot;,&quot;service&quot;:&quot;stockly-api-test&quot;,&quot;level&quot;:&quot;WARN&quot;,&quot;traceId&quot;:&quot;test-trace-id&quot;,&quot;userId&quot;:null,&quot;path&quot;:&quot;/test&quot;,&quot;message&quot;:&quot;Datalake adapter not available for endpoint quote, will fallback to direct FMP&quot;,&quot;type&quot;:&quot;general&quot;}

{&quot;timestamp&quot;:&quot;2026-01-01T10:46:48.454Z&quot;,&quot;service&quot;:&quot;stockly-api-test&quot;,&quot;level&quot;:&quot;WARN&quot;,&quot;traceId&quot;:&quot;test-trace-id&quot;,&quot;userId&quot;:null,&quot;path&quot;:&quot;/test&quot;,&quot;message&quot;:&quot;Datalake adapter not available for endpoint profile, will fallback to direct FMP&quot;,&quot;type&quot;:&quot;general&quot;}

{&quot;timestamp&quot;:&quot;2026-01-01T10:46:48.454Z&quot;,&quot;service&quot;:&quot;stockly-api-test&quot;,&quot;level&quot;:&quot;WARN&quot;,&quot;traceId&quot;:&quot;test-trace-id&quot;,&quot;userId&quot;:null,&quot;path&quot;:&quot;/test&quot;,&quot;message&quot;:&quot;Datalake adapter not available for endpoint profile, will fallback to direct FMP&quot;,&quot;type&quot;:&quot;general&quot;}

{&quot;timestamp&quot;:&quot;2026-01-01T10:46:48.456Z&quot;,&quot;service&quot;:&quot;stockly-api-test&quot;,&quot;level&quot;:&quot;WARN&quot;,&quot;traceId&quot;:&quot;test-trace-id&quot;,&quot;userId&quot;:null,&quot;path&quot;:&quot;/test&quot;,&quot;message&quot;:&quot;Market cache refresh failed (non-blocking)&quot;,&quot;type&quot;:&quot;general&quot;}

            </system-err>
        </testcase>
        <testcase classname="test/integration/stock-flow.spec.ts" name="Stock Data Flow Integration &gt; Caching Flow &gt; should cache stock data and serve from cache on subsequent requests" time="0.006">
            <system-out>
{&quot;timestamp&quot;:&quot;2026-01-01T10:46:48.466Z&quot;,&quot;service&quot;:&quot;stockly-api-test&quot;,&quot;level&quot;:&quot;INFO&quot;,&quot;traceId&quot;:&quot;test-trace-id&quot;,&quot;userId&quot;:null,&quot;path&quot;:&quot;/test&quot;,&quot;message&quot;:&quot;Cache hit for AAPL&quot;,&quot;type&quot;:&quot;general&quot;,&quot;ageSeconds&quot;:0,&quot;pollingIntervalSec&quot;:30,&quot;cacheStatus&quot;:&quot;HIT&quot;}

{&quot;timestamp&quot;:&quot;2026-01-01T10:46:48.467Z&quot;,&quot;service&quot;:&quot;stockly-api-test&quot;,&quot;level&quot;:&quot;INFO&quot;,&quot;traceId&quot;:&quot;test-trace-id&quot;,&quot;userId&quot;:null,&quot;path&quot;:&quot;/test&quot;,&quot;message&quot;:&quot;Cache hit for AAPL&quot;,&quot;type&quot;:&quot;general&quot;,&quot;ageSeconds&quot;:0,&quot;pollingIntervalSec&quot;:30,&quot;cacheStatus&quot;:&quot;HIT&quot;}

            </system-out>
        </testcase>
    </testsuite>
    <testsuite name="test/logging/d1-wrapper.spec.ts" timestamp="2026-01-01T10:46:50.888Z" hostname="sngvahmed" tests="15" failures="0" errors="0" skipped="0" time="1.918">
        <testcase classname="test/logging/d1-wrapper.spec.ts" name="LoggedD1Database &gt; prepare &gt; should wrap prepared statement" time="0.04">
        </testcase>
        <testcase classname="test/logging/d1-wrapper.spec.ts" name="LoggedD1Database &gt; exec &gt; should log successful exec operation" time="0.105">
            <system-out>
{&quot;timestamp&quot;:&quot;2026-01-01T10:46:46.022Z&quot;,&quot;service&quot;:&quot;test&quot;,&quot;level&quot;:&quot;DEBUG&quot;,&quot;traceId&quot;:&quot;test-trace&quot;,&quot;userId&quot;:null,&quot;path&quot;:&quot;/test&quot;,&quot;message&quot;:&quot;D1 exec: SELECT * FROM alerts&quot;,&quot;type&quot;:&quot;data_operation&quot;,&quot;operation&quot;:&quot;d1&quot;,&quot;query&quot;:&quot;SELECT * FROM alerts&quot;,&quot;latencyMs&quot;:0,&quot;cacheStatus&quot;:&quot;N/A&quot;}

            </system-out>
        </testcase>
        <testcase classname="test/logging/d1-wrapper.spec.ts" name="LoggedD1Database &gt; exec &gt; should log failed exec operation" time="0.229">
            <system-out>
{&quot;timestamp&quot;:&quot;2026-01-01T10:46:46.152Z&quot;,&quot;service&quot;:&quot;test&quot;,&quot;level&quot;:&quot;DEBUG&quot;,&quot;traceId&quot;:&quot;test-trace&quot;,&quot;userId&quot;:null,&quot;path&quot;:&quot;/test&quot;,&quot;message&quot;:&quot;D1 exec failed: SELECT * FROM alerts&quot;,&quot;type&quot;:&quot;data_operation&quot;,&quot;operation&quot;:&quot;d1&quot;,&quot;query&quot;:&quot;SELECT * FROM alerts&quot;,&quot;latencyMs&quot;:1,&quot;cacheStatus&quot;:&quot;N/A&quot;,&quot;error&quot;:&quot;Database error&quot;}

            </system-out>
        </testcase>
        <testcase classname="test/logging/d1-wrapper.spec.ts" name="LoggedD1Database &gt; batch &gt; should log successful batch operation" time="0.111">
            <system-out>
{&quot;timestamp&quot;:&quot;2026-01-01T10:46:46.453Z&quot;,&quot;service&quot;:&quot;test&quot;,&quot;level&quot;:&quot;DEBUG&quot;,&quot;traceId&quot;:&quot;test-trace&quot;,&quot;userId&quot;:null,&quot;path&quot;:&quot;/test&quot;,&quot;message&quot;:&quot;D1 batch: BATCH(2 statements)&quot;,&quot;type&quot;:&quot;data_operation&quot;,&quot;operation&quot;:&quot;d1&quot;,&quot;query&quot;:&quot;BATCH(2 statements)&quot;,&quot;latencyMs&quot;:0,&quot;cacheStatus&quot;:&quot;N/A&quot;}

            </system-out>
        </testcase>
        <testcase classname="test/logging/d1-wrapper.spec.ts" name="LoggedD1Database &gt; batch &gt; should log failed batch operation" time="0.121">
            <system-out>
{&quot;timestamp&quot;:&quot;2026-01-01T10:46:46.564Z&quot;,&quot;service&quot;:&quot;test&quot;,&quot;level&quot;:&quot;DEBUG&quot;,&quot;traceId&quot;:&quot;test-trace&quot;,&quot;userId&quot;:null,&quot;path&quot;:&quot;/test&quot;,&quot;message&quot;:&quot;D1 batch failed: BATCH(2 statements)&quot;,&quot;type&quot;:&quot;data_operation&quot;,&quot;operation&quot;:&quot;d1&quot;,&quot;query&quot;:&quot;BATCH(2 statements)&quot;,&quot;latencyMs&quot;:0,&quot;cacheStatus&quot;:&quot;N/A&quot;,&quot;error&quot;:&quot;Batch failed&quot;}

            </system-out>
        </testcase>
        <testcase classname="test/logging/d1-wrapper.spec.ts" name="LoggedD1Database &gt; LoggedD1PreparedStatement &gt; bind &gt; should chain bind calls" time="0.039">
        </testcase>
        <testcase classname="test/logging/d1-wrapper.spec.ts" name="LoggedD1Database &gt; LoggedD1PreparedStatement &gt; bind &gt; should support multiple bind calls" time="0.085">
        </testcase>
        <testcase classname="test/logging/d1-wrapper.spec.ts" name="LoggedD1Database &gt; LoggedD1PreparedStatement &gt; first &gt; should log successful first operation" time="0.078">
            <system-out>
{&quot;timestamp&quot;:&quot;2026-01-01T10:46:46.982Z&quot;,&quot;service&quot;:&quot;test&quot;,&quot;level&quot;:&quot;DEBUG&quot;,&quot;traceId&quot;:&quot;test-trace&quot;,&quot;userId&quot;:null,&quot;path&quot;:&quot;/test&quot;,&quot;message&quot;:&quot;D1 first: SELECT * FROM alerts WHERE id = ?&quot;,&quot;type&quot;:&quot;data_operation&quot;,&quot;operation&quot;:&quot;d1&quot;,&quot;query&quot;:&quot;SELECT * FROM alerts WHERE id = ?&quot;,&quot;latencyMs&quot;:0,&quot;cacheStatus&quot;:&quot;N/A&quot;}

            </system-out>
        </testcase>
        <testcase classname="test/logging/d1-wrapper.spec.ts" name="LoggedD1Database &gt; LoggedD1PreparedStatement &gt; first &gt; should log failed first operation" time="0.039">
            <system-out>
{&quot;timestamp&quot;:&quot;2026-01-01T10:46:47.010Z&quot;,&quot;service&quot;:&quot;test&quot;,&quot;level&quot;:&quot;DEBUG&quot;,&quot;traceId&quot;:&quot;test-trace&quot;,&quot;userId&quot;:null,&quot;path&quot;:&quot;/test&quot;,&quot;message&quot;:&quot;D1 first failed: SELECT * FROM alerts WHERE id = ?&quot;,&quot;type&quot;:&quot;data_operation&quot;,&quot;operation&quot;:&quot;d1&quot;,&quot;query&quot;:&quot;SELECT * FROM alerts WHERE id = ?&quot;,&quot;latencyMs&quot;:1,&quot;cacheStatus&quot;:&quot;N/A&quot;,&quot;error&quot;:&quot;Query failed&quot;}

            </system-out>
        </testcase>
        <testcase classname="test/logging/d1-wrapper.spec.ts" name="LoggedD1Database &gt; LoggedD1PreparedStatement &gt; all &gt; should log successful all operation" time="0.045">
            <system-out>
{&quot;timestamp&quot;:&quot;2026-01-01T10:46:47.118Z&quot;,&quot;service&quot;:&quot;test&quot;,&quot;level&quot;:&quot;DEBUG&quot;,&quot;traceId&quot;:&quot;test-trace&quot;,&quot;userId&quot;:null,&quot;path&quot;:&quot;/test&quot;,&quot;message&quot;:&quot;D1 all: SELECT * FROM alerts WHERE id = ?&quot;,&quot;type&quot;:&quot;data_operation&quot;,&quot;operation&quot;:&quot;d1&quot;,&quot;query&quot;:&quot;SELECT * FROM alerts WHERE id = ?&quot;,&quot;latencyMs&quot;:0,&quot;cacheStatus&quot;:&quot;N/A&quot;}

            </system-out>
        </testcase>
        <testcase classname="test/logging/d1-wrapper.spec.ts" name="LoggedD1Database &gt; LoggedD1PreparedStatement &gt; all &gt; should log failed all operation" time="0.063">
            <system-out>
{&quot;timestamp&quot;:&quot;2026-01-01T10:46:47.193Z&quot;,&quot;service&quot;:&quot;test&quot;,&quot;level&quot;:&quot;DEBUG&quot;,&quot;traceId&quot;:&quot;test-trace&quot;,&quot;userId&quot;:null,&quot;path&quot;:&quot;/test&quot;,&quot;message&quot;:&quot;D1 all failed: SELECT * FROM alerts WHERE id = ?&quot;,&quot;type&quot;:&quot;data_operation&quot;,&quot;operation&quot;:&quot;d1&quot;,&quot;query&quot;:&quot;SELECT * FROM alerts WHERE id = ?&quot;,&quot;latencyMs&quot;:0,&quot;cacheStatus&quot;:&quot;N/A&quot;,&quot;error&quot;:&quot;Query failed&quot;}

            </system-out>
        </testcase>
        <testcase classname="test/logging/d1-wrapper.spec.ts" name="LoggedD1Database &gt; LoggedD1PreparedStatement &gt; run &gt; should log successful run operation" time="0.066">
            <system-out>
{&quot;timestamp&quot;:&quot;2026-01-01T10:46:47.298Z&quot;,&quot;service&quot;:&quot;test&quot;,&quot;level&quot;:&quot;DEBUG&quot;,&quot;traceId&quot;:&quot;test-trace&quot;,&quot;userId&quot;:null,&quot;path&quot;:&quot;/test&quot;,&quot;message&quot;:&quot;D1 run: SELECT * FROM alerts WHERE id = ?&quot;,&quot;type&quot;:&quot;data_operation&quot;,&quot;operation&quot;:&quot;d1&quot;,&quot;query&quot;:&quot;SELECT * FROM alerts WHERE id = ?&quot;,&quot;latencyMs&quot;:0,&quot;cacheStatus&quot;:&quot;N/A&quot;}

            </system-out>
        </testcase>
        <testcase classname="test/logging/d1-wrapper.spec.ts" name="LoggedD1Database &gt; LoggedD1PreparedStatement &gt; run &gt; should log failed run operation" time="0.039">
            <system-out>
{&quot;timestamp&quot;:&quot;2026-01-01T10:46:47.332Z&quot;,&quot;service&quot;:&quot;test&quot;,&quot;level&quot;:&quot;DEBUG&quot;,&quot;traceId&quot;:&quot;test-trace&quot;,&quot;userId&quot;:null,&quot;path&quot;:&quot;/test&quot;,&quot;message&quot;:&quot;D1 run failed: SELECT * FROM alerts WHERE id = ?&quot;,&quot;type&quot;:&quot;data_operation&quot;,&quot;operation&quot;:&quot;d1&quot;,&quot;query&quot;:&quot;SELECT * FROM alerts WHERE id = ?&quot;,&quot;latencyMs&quot;:0,&quot;cacheStatus&quot;:&quot;N/A&quot;,&quot;error&quot;:&quot;Update failed&quot;}

            </system-out>
        </testcase>
        <testcase classname="test/logging/d1-wrapper.spec.ts" name="LoggedD1Database &gt; LoggedD1PreparedStatement &gt; latency measurement &gt; should measure latency accurately" time="0.044">
            <system-out>
{&quot;timestamp&quot;:&quot;2026-01-01T10:46:47.442Z&quot;,&quot;service&quot;:&quot;test&quot;,&quot;level&quot;:&quot;DEBUG&quot;,&quot;traceId&quot;:&quot;test-trace&quot;,&quot;userId&quot;:null,&quot;path&quot;:&quot;/test&quot;,&quot;message&quot;:&quot;D1 first: SELECT * FROM alerts WHERE id = ?&quot;,&quot;type&quot;:&quot;data_operation&quot;,&quot;operation&quot;:&quot;d1&quot;,&quot;query&quot;:&quot;SELECT * FROM alerts WHERE id = ?&quot;,&quot;latencyMs&quot;:10,&quot;cacheStatus&quot;:&quot;N/A&quot;}

            </system-out>
        </testcase>
        <testcase classname="test/logging/d1-wrapper.spec.ts" name="LoggedD1Database &gt; LoggedD1PreparedStatement &gt; error propagation &gt; should re-throw errors after logging" time="0.032">
            <system-out>
{&quot;timestamp&quot;:&quot;2026-01-01T10:46:47.523Z&quot;,&quot;service&quot;:&quot;test&quot;,&quot;level&quot;:&quot;DEBUG&quot;,&quot;traceId&quot;:&quot;test-trace&quot;,&quot;userId&quot;:null,&quot;path&quot;:&quot;/test&quot;,&quot;message&quot;:&quot;D1 first failed: SELECT * FROM alerts WHERE id = ?&quot;,&quot;type&quot;:&quot;data_operation&quot;,&quot;operation&quot;:&quot;d1&quot;,&quot;query&quot;:&quot;SELECT * FROM alerts WHERE id = ?&quot;,&quot;latencyMs&quot;:0,&quot;cacheStatus&quot;:&quot;N/A&quot;,&quot;error&quot;:&quot;Database error&quot;}

            </system-out>
        </testcase>
    </testsuite>
    <testsuite name="test/logging/kv-wrapper.spec.ts" timestamp="2026-01-01T10:46:50.891Z" hostname="sngvahmed" tests="26" failures="0" errors="0" skipped="0" time="2.214">
        <testcase classname="test/logging/kv-wrapper.spec.ts" name="LoggedKVNamespace &gt; get &gt; should log HIT when value exists (text)" time="0.041">
            <system-out>
{&quot;timestamp&quot;:&quot;2026-01-01T10:46:45.797Z&quot;,&quot;service&quot;:&quot;test&quot;,&quot;level&quot;:&quot;DEBUG&quot;,&quot;traceId&quot;:&quot;test-trace&quot;,&quot;userId&quot;:null,&quot;path&quot;:&quot;/test&quot;,&quot;message&quot;:&quot;KV get: cache:key&quot;,&quot;type&quot;:&quot;data_operation&quot;,&quot;operation&quot;:&quot;kv&quot;,&quot;key&quot;:&quot;cache:key&quot;,&quot;latencyMs&quot;:0,&quot;cacheStatus&quot;:&quot;HIT&quot;}

            </system-out>
        </testcase>
        <testcase classname="test/logging/kv-wrapper.spec.ts" name="LoggedKVNamespace &gt; get &gt; should log MISS when value is null (text)" time="0.1">
            <system-out>
{&quot;timestamp&quot;:&quot;2026-01-01T10:46:45.897Z&quot;,&quot;service&quot;:&quot;test&quot;,&quot;level&quot;:&quot;DEBUG&quot;,&quot;traceId&quot;:&quot;test-trace&quot;,&quot;userId&quot;:null,&quot;path&quot;:&quot;/test&quot;,&quot;message&quot;:&quot;KV get: cache:key&quot;,&quot;type&quot;:&quot;data_operation&quot;,&quot;operation&quot;:&quot;kv&quot;,&quot;key&quot;:&quot;cache:key&quot;,&quot;latencyMs&quot;:0,&quot;cacheStatus&quot;:&quot;MISS&quot;}

            </system-out>
        </testcase>
        <testcase classname="test/logging/kv-wrapper.spec.ts" name="LoggedKVNamespace &gt; get &gt; should log HIT when value exists (json)" time="0.106">
            <system-out>
{&quot;timestamp&quot;:&quot;2026-01-01T10:46:46.006Z&quot;,&quot;service&quot;:&quot;test&quot;,&quot;level&quot;:&quot;DEBUG&quot;,&quot;traceId&quot;:&quot;test-trace&quot;,&quot;userId&quot;:null,&quot;path&quot;:&quot;/test&quot;,&quot;message&quot;:&quot;KV get: cache:key&quot;,&quot;type&quot;:&quot;data_operation&quot;,&quot;operation&quot;:&quot;kv&quot;,&quot;key&quot;:&quot;cache:key&quot;,&quot;latencyMs&quot;:0,&quot;cacheStatus&quot;:&quot;HIT&quot;}

            </system-out>
        </testcase>
        <testcase classname="test/logging/kv-wrapper.spec.ts" name="LoggedKVNamespace &gt; get &gt; should log MISS when value is null (json)" time="0.136">
            <system-out>
{&quot;timestamp&quot;:&quot;2026-01-01T10:46:46.131Z&quot;,&quot;service&quot;:&quot;test&quot;,&quot;level&quot;:&quot;DEBUG&quot;,&quot;traceId&quot;:&quot;test-trace&quot;,&quot;userId&quot;:null,&quot;path&quot;:&quot;/test&quot;,&quot;message&quot;:&quot;KV get: cache:key&quot;,&quot;type&quot;:&quot;data_operation&quot;,&quot;operation&quot;:&quot;kv&quot;,&quot;key&quot;:&quot;cache:key&quot;,&quot;latencyMs&quot;:0,&quot;cacheStatus&quot;:&quot;MISS&quot;}

            </system-out>
        </testcase>
        <testcase classname="test/logging/kv-wrapper.spec.ts" name="LoggedKVNamespace &gt; get &gt; should handle arrayBuffer type" time="0.223">
            <system-out>
{&quot;timestamp&quot;:&quot;2026-01-01T10:46:46.275Z&quot;,&quot;service&quot;:&quot;test&quot;,&quot;level&quot;:&quot;DEBUG&quot;,&quot;traceId&quot;:&quot;test-trace&quot;,&quot;userId&quot;:null,&quot;path&quot;:&quot;/test&quot;,&quot;message&quot;:&quot;KV get: cache:key&quot;,&quot;type&quot;:&quot;data_operation&quot;,&quot;operation&quot;:&quot;kv&quot;,&quot;key&quot;:&quot;cache:key&quot;,&quot;latencyMs&quot;:0,&quot;cacheStatus&quot;:&quot;HIT&quot;}

            </system-out>
        </testcase>
        <testcase classname="test/logging/kv-wrapper.spec.ts" name="LoggedKVNamespace &gt; get &gt; should handle stream type" time="0.107">
            <system-out>
{&quot;timestamp&quot;:&quot;2026-01-01T10:46:46.456Z&quot;,&quot;service&quot;:&quot;test&quot;,&quot;level&quot;:&quot;DEBUG&quot;,&quot;traceId&quot;:&quot;test-trace&quot;,&quot;userId&quot;:null,&quot;path&quot;:&quot;/test&quot;,&quot;message&quot;:&quot;KV get: cache:key&quot;,&quot;type&quot;:&quot;data_operation&quot;,&quot;operation&quot;:&quot;kv&quot;,&quot;key&quot;:&quot;cache:key&quot;,&quot;latencyMs&quot;:0,&quot;cacheStatus&quot;:&quot;HIT&quot;}

            </system-out>
        </testcase>
        <testcase classname="test/logging/kv-wrapper.spec.ts" name="LoggedKVNamespace &gt; get &gt; should log failed get operation" time="0.121">
            <system-out>
{&quot;timestamp&quot;:&quot;2026-01-01T10:46:46.582Z&quot;,&quot;service&quot;:&quot;test&quot;,&quot;level&quot;:&quot;DEBUG&quot;,&quot;traceId&quot;:&quot;test-trace&quot;,&quot;userId&quot;:null,&quot;path&quot;:&quot;/test&quot;,&quot;message&quot;:&quot;KV get failed: cache:key&quot;,&quot;type&quot;:&quot;data_operation&quot;,&quot;operation&quot;:&quot;kv&quot;,&quot;key&quot;:&quot;cache:key&quot;,&quot;latencyMs&quot;:1,&quot;cacheStatus&quot;:&quot;N/A&quot;,&quot;error&quot;:&quot;KV error&quot;}

            </system-out>
        </testcase>
        <testcase classname="test/logging/kv-wrapper.spec.ts" name="LoggedKVNamespace &gt; get &gt; should measure latency" time="0.107">
            <system-out>
{&quot;timestamp&quot;:&quot;2026-01-01T10:46:46.692Z&quot;,&quot;service&quot;:&quot;test&quot;,&quot;level&quot;:&quot;DEBUG&quot;,&quot;traceId&quot;:&quot;test-trace&quot;,&quot;userId&quot;:null,&quot;path&quot;:&quot;/test&quot;,&quot;message&quot;:&quot;KV get: cache:key&quot;,&quot;type&quot;:&quot;data_operation&quot;,&quot;operation&quot;:&quot;kv&quot;,&quot;key&quot;:&quot;cache:key&quot;,&quot;latencyMs&quot;:11,&quot;cacheStatus&quot;:&quot;HIT&quot;}

            </system-out>
        </testcase>
        <testcase classname="test/logging/kv-wrapper.spec.ts" name="LoggedKVNamespace &gt; put &gt; should log successful put operation" time="0.083">
            <system-out>
{&quot;timestamp&quot;:&quot;2026-01-01T10:46:46.828Z&quot;,&quot;service&quot;:&quot;test&quot;,&quot;level&quot;:&quot;DEBUG&quot;,&quot;traceId&quot;:&quot;test-trace&quot;,&quot;userId&quot;:null,&quot;path&quot;:&quot;/test&quot;,&quot;message&quot;:&quot;KV put: cache:key&quot;,&quot;type&quot;:&quot;data_operation&quot;,&quot;operation&quot;:&quot;kv&quot;,&quot;key&quot;:&quot;cache:key&quot;,&quot;latencyMs&quot;:0,&quot;cacheStatus&quot;:&quot;N/A&quot;}

            </system-out>
        </testcase>
        <testcase classname="test/logging/kv-wrapper.spec.ts" name="LoggedKVNamespace &gt; put &gt; should log put with expiration options" time="0.049">
            <system-out>
{&quot;timestamp&quot;:&quot;2026-01-01T10:46:46.908Z&quot;,&quot;service&quot;:&quot;test&quot;,&quot;level&quot;:&quot;DEBUG&quot;,&quot;traceId&quot;:&quot;test-trace&quot;,&quot;userId&quot;:null,&quot;path&quot;:&quot;/test&quot;,&quot;message&quot;:&quot;KV put: cache:key&quot;,&quot;type&quot;:&quot;data_operation&quot;,&quot;operation&quot;:&quot;kv&quot;,&quot;key&quot;:&quot;cache:key&quot;,&quot;latencyMs&quot;:0,&quot;cacheStatus&quot;:&quot;N/A&quot;}

            </system-out>
        </testcase>
        <testcase classname="test/logging/kv-wrapper.spec.ts" name="LoggedKVNamespace &gt; put &gt; should log failed put operation" time="0.073">
            <system-out>
{&quot;timestamp&quot;:&quot;2026-01-01T10:46:46.995Z&quot;,&quot;service&quot;:&quot;test&quot;,&quot;level&quot;:&quot;DEBUG&quot;,&quot;traceId&quot;:&quot;test-trace&quot;,&quot;userId&quot;:null,&quot;path&quot;:&quot;/test&quot;,&quot;message&quot;:&quot;KV put failed: cache:key&quot;,&quot;type&quot;:&quot;data_operation&quot;,&quot;operation&quot;:&quot;kv&quot;,&quot;key&quot;:&quot;cache:key&quot;,&quot;latencyMs&quot;:0,&quot;cacheStatus&quot;:&quot;N/A&quot;,&quot;error&quot;:&quot;Put failed&quot;}

            </system-out>
        </testcase>
        <testcase classname="test/logging/kv-wrapper.spec.ts" name="LoggedKVNamespace &gt; put &gt; should handle ArrayBuffer value" time="0.076">
            <system-out>
{&quot;timestamp&quot;:&quot;2026-01-01T10:46:47.030Z&quot;,&quot;service&quot;:&quot;test&quot;,&quot;level&quot;:&quot;DEBUG&quot;,&quot;traceId&quot;:&quot;test-trace&quot;,&quot;userId&quot;:null,&quot;path&quot;:&quot;/test&quot;,&quot;message&quot;:&quot;KV put: cache:key&quot;,&quot;type&quot;:&quot;data_operation&quot;,&quot;operation&quot;:&quot;kv&quot;,&quot;key&quot;:&quot;cache:key&quot;,&quot;latencyMs&quot;:0,&quot;cacheStatus&quot;:&quot;N/A&quot;}

            </system-out>
        </testcase>
        <testcase classname="test/logging/kv-wrapper.spec.ts" name="LoggedKVNamespace &gt; delete &gt; should log successful delete operation" time="0.082">
            <system-out>
{&quot;timestamp&quot;:&quot;2026-01-01T10:46:47.189Z&quot;,&quot;service&quot;:&quot;test&quot;,&quot;level&quot;:&quot;DEBUG&quot;,&quot;traceId&quot;:&quot;test-trace&quot;,&quot;userId&quot;:null,&quot;path&quot;:&quot;/test&quot;,&quot;message&quot;:&quot;KV delete: cache:key&quot;,&quot;type&quot;:&quot;data_operation&quot;,&quot;operation&quot;:&quot;kv&quot;,&quot;key&quot;:&quot;cache:key&quot;,&quot;latencyMs&quot;:0,&quot;cacheStatus&quot;:&quot;N/A&quot;}

            </system-out>
        </testcase>
        <testcase classname="test/logging/kv-wrapper.spec.ts" name="LoggedKVNamespace &gt; delete &gt; should log failed delete operation" time="0.038">
            <system-out>
{&quot;timestamp&quot;:&quot;2026-01-01T10:46:47.221Z&quot;,&quot;service&quot;:&quot;test&quot;,&quot;level&quot;:&quot;DEBUG&quot;,&quot;traceId&quot;:&quot;test-trace&quot;,&quot;userId&quot;:null,&quot;path&quot;:&quot;/test&quot;,&quot;message&quot;:&quot;KV delete failed: cache:key&quot;,&quot;type&quot;:&quot;data_operation&quot;,&quot;operation&quot;:&quot;kv&quot;,&quot;key&quot;:&quot;cache:key&quot;,&quot;latencyMs&quot;:0,&quot;cacheStatus&quot;:&quot;N/A&quot;,&quot;error&quot;:&quot;Delete failed&quot;}

            </system-out>
        </testcase>
        <testcase classname="test/logging/kv-wrapper.spec.ts" name="LoggedKVNamespace &gt; list &gt; should log successful list operation without options" time="0.034">
            <system-out>
{&quot;timestamp&quot;:&quot;2026-01-01T10:46:47.328Z&quot;,&quot;service&quot;:&quot;test&quot;,&quot;level&quot;:&quot;DEBUG&quot;,&quot;traceId&quot;:&quot;test-trace&quot;,&quot;userId&quot;:null,&quot;path&quot;:&quot;/test&quot;,&quot;message&quot;:&quot;KV list: prefix=all&quot;,&quot;type&quot;:&quot;data_operation&quot;,&quot;operation&quot;:&quot;kv&quot;,&quot;key&quot;:&quot;*&quot;,&quot;latencyMs&quot;:0,&quot;cacheStatus&quot;:&quot;N/A&quot;}

            </system-out>
        </testcase>
        <testcase classname="test/logging/kv-wrapper.spec.ts" name="LoggedKVNamespace &gt; list &gt; should log successful list operation with prefix" time="0.07">
            <system-out>
{&quot;timestamp&quot;:&quot;2026-01-01T10:46:47.363Z&quot;,&quot;service&quot;:&quot;test&quot;,&quot;level&quot;:&quot;DEBUG&quot;,&quot;traceId&quot;:&quot;test-trace&quot;,&quot;userId&quot;:null,&quot;path&quot;:&quot;/test&quot;,&quot;message&quot;:&quot;KV list: prefix=cache:&quot;,&quot;type&quot;:&quot;data_operation&quot;,&quot;operation&quot;:&quot;kv&quot;,&quot;key&quot;:&quot;cache:&quot;,&quot;latencyMs&quot;:0,&quot;cacheStatus&quot;:&quot;N/A&quot;}

            </system-out>
        </testcase>
        <testcase classname="test/logging/kv-wrapper.spec.ts" name="LoggedKVNamespace &gt; list &gt; should log successful list operation with limit" time="0.031">
            <system-out>
{&quot;timestamp&quot;:&quot;2026-01-01T10:46:47.431Z&quot;,&quot;service&quot;:&quot;test&quot;,&quot;level&quot;:&quot;DEBUG&quot;,&quot;traceId&quot;:&quot;test-trace&quot;,&quot;userId&quot;:null,&quot;path&quot;:&quot;/test&quot;,&quot;message&quot;:&quot;KV list: prefix=all&quot;,&quot;type&quot;:&quot;data_operation&quot;,&quot;operation&quot;:&quot;kv&quot;,&quot;key&quot;:&quot;*&quot;,&quot;latencyMs&quot;:0,&quot;cacheStatus&quot;:&quot;N/A&quot;}

            </system-out>
        </testcase>
        <testcase classname="test/logging/kv-wrapper.spec.ts" name="LoggedKVNamespace &gt; list &gt; should log successful list operation with cursor" time="0.026">
            <system-out>
{&quot;timestamp&quot;:&quot;2026-01-01T10:46:47.462Z&quot;,&quot;service&quot;:&quot;test&quot;,&quot;level&quot;:&quot;DEBUG&quot;,&quot;traceId&quot;:&quot;test-trace&quot;,&quot;userId&quot;:null,&quot;path&quot;:&quot;/test&quot;,&quot;message&quot;:&quot;KV list: prefix=all&quot;,&quot;type&quot;:&quot;data_operation&quot;,&quot;operation&quot;:&quot;kv&quot;,&quot;key&quot;:&quot;*&quot;,&quot;latencyMs&quot;:0,&quot;cacheStatus&quot;:&quot;N/A&quot;}

            </system-out>
        </testcase>
        <testcase classname="test/logging/kv-wrapper.spec.ts" name="LoggedKVNamespace &gt; list &gt; should log failed list operation" time="0.051">
            <system-out>
{&quot;timestamp&quot;:&quot;2026-01-01T10:46:47.506Z&quot;,&quot;service&quot;:&quot;test&quot;,&quot;level&quot;:&quot;DEBUG&quot;,&quot;traceId&quot;:&quot;test-trace&quot;,&quot;userId&quot;:null,&quot;path&quot;:&quot;/test&quot;,&quot;message&quot;:&quot;KV list failed: prefix=all&quot;,&quot;type&quot;:&quot;data_operation&quot;,&quot;operation&quot;:&quot;kv&quot;,&quot;key&quot;:&quot;*&quot;,&quot;latencyMs&quot;:0,&quot;cacheStatus&quot;:&quot;N/A&quot;,&quot;error&quot;:&quot;List failed&quot;}

            </system-out>
        </testcase>
        <testcase classname="test/logging/kv-wrapper.spec.ts" name="LoggedKVNamespace &gt; error propagation &gt; should re-throw errors after logging" time="0.052">
            <system-out>
{&quot;timestamp&quot;:&quot;2026-01-01T10:46:47.568Z&quot;,&quot;service&quot;:&quot;test&quot;,&quot;level&quot;:&quot;DEBUG&quot;,&quot;traceId&quot;:&quot;test-trace&quot;,&quot;userId&quot;:null,&quot;path&quot;:&quot;/test&quot;,&quot;message&quot;:&quot;KV get failed: cache:key&quot;,&quot;type&quot;:&quot;data_operation&quot;,&quot;operation&quot;:&quot;kv&quot;,&quot;key&quot;:&quot;cache:key&quot;,&quot;latencyMs&quot;:0,&quot;cacheStatus&quot;:&quot;N/A&quot;,&quot;error&quot;:&quot;KV error&quot;}

            </system-out>
        </testcase>
        <testcase classname="test/logging/kv-wrapper.spec.ts" name="LoggedKVNamespace &gt; cache status detection &gt; should detect HIT for non-null text value" time="0.04">
            <system-out>
{&quot;timestamp&quot;:&quot;2026-01-01T10:46:47.659Z&quot;,&quot;service&quot;:&quot;test&quot;,&quot;level&quot;:&quot;DEBUG&quot;,&quot;traceId&quot;:&quot;test-trace&quot;,&quot;userId&quot;:null,&quot;path&quot;:&quot;/test&quot;,&quot;message&quot;:&quot;KV get: key&quot;,&quot;type&quot;:&quot;data_operation&quot;,&quot;operation&quot;:&quot;kv&quot;,&quot;key&quot;:&quot;key&quot;,&quot;latencyMs&quot;:0,&quot;cacheStatus&quot;:&quot;HIT&quot;}

            </system-out>
        </testcase>
        <testcase classname="test/logging/kv-wrapper.spec.ts" name="LoggedKVNamespace &gt; cache status detection &gt; should detect HIT for non-null json value" time="0.037">
            <system-out>
{&quot;timestamp&quot;:&quot;2026-01-01T10:46:47.699Z&quot;,&quot;service&quot;:&quot;test&quot;,&quot;level&quot;:&quot;DEBUG&quot;,&quot;traceId&quot;:&quot;test-trace&quot;,&quot;userId&quot;:null,&quot;path&quot;:&quot;/test&quot;,&quot;message&quot;:&quot;KV get: key&quot;,&quot;type&quot;:&quot;data_operation&quot;,&quot;operation&quot;:&quot;kv&quot;,&quot;key&quot;:&quot;key&quot;,&quot;latencyMs&quot;:0,&quot;cacheStatus&quot;:&quot;HIT&quot;}

            </system-out>
        </testcase>
        <testcase classname="test/logging/kv-wrapper.spec.ts" name="LoggedKVNamespace &gt; cache status detection &gt; should detect MISS for null value" time="0.041">
            <system-out>
{&quot;timestamp&quot;:&quot;2026-01-01T10:46:47.732Z&quot;,&quot;service&quot;:&quot;test&quot;,&quot;level&quot;:&quot;DEBUG&quot;,&quot;traceId&quot;:&quot;test-trace&quot;,&quot;userId&quot;:null,&quot;path&quot;:&quot;/test&quot;,&quot;message&quot;:&quot;KV get: key&quot;,&quot;type&quot;:&quot;data_operation&quot;,&quot;operation&quot;:&quot;kv&quot;,&quot;key&quot;:&quot;key&quot;,&quot;latencyMs&quot;:0,&quot;cacheStatus&quot;:&quot;MISS&quot;}

            </system-out>
        </testcase>
        <testcase classname="test/logging/kv-wrapper.spec.ts" name="LoggedKVNamespace &gt; cache status detection &gt; should use N/A for put operations" time="0.044">
            <system-out>
{&quot;timestamp&quot;:&quot;2026-01-01T10:46:47.773Z&quot;,&quot;service&quot;:&quot;test&quot;,&quot;level&quot;:&quot;DEBUG&quot;,&quot;traceId&quot;:&quot;test-trace&quot;,&quot;userId&quot;:null,&quot;path&quot;:&quot;/test&quot;,&quot;message&quot;:&quot;KV put: key&quot;,&quot;type&quot;:&quot;data_operation&quot;,&quot;operation&quot;:&quot;kv&quot;,&quot;key&quot;:&quot;key&quot;,&quot;latencyMs&quot;:0,&quot;cacheStatus&quot;:&quot;N/A&quot;}

            </system-out>
        </testcase>
        <testcase classname="test/logging/kv-wrapper.spec.ts" name="LoggedKVNamespace &gt; cache status detection &gt; should use N/A for delete operations" time="0.026">
            <system-out>
{&quot;timestamp&quot;:&quot;2026-01-01T10:46:47.815Z&quot;,&quot;service&quot;:&quot;test&quot;,&quot;level&quot;:&quot;DEBUG&quot;,&quot;traceId&quot;:&quot;test-trace&quot;,&quot;userId&quot;:null,&quot;path&quot;:&quot;/test&quot;,&quot;message&quot;:&quot;KV delete: key&quot;,&quot;type&quot;:&quot;data_operation&quot;,&quot;operation&quot;:&quot;kv&quot;,&quot;key&quot;:&quot;key&quot;,&quot;latencyMs&quot;:0,&quot;cacheStatus&quot;:&quot;N/A&quot;}

            </system-out>
        </testcase>
        <testcase classname="test/logging/kv-wrapper.spec.ts" name="LoggedKVNamespace &gt; cache status detection &gt; should use N/A for list operations" time="0.034">
            <system-out>
{&quot;timestamp&quot;:&quot;2026-01-01T10:46:47.842Z&quot;,&quot;service&quot;:&quot;test&quot;,&quot;level&quot;:&quot;DEBUG&quot;,&quot;traceId&quot;:&quot;test-trace&quot;,&quot;userId&quot;:null,&quot;path&quot;:&quot;/test&quot;,&quot;message&quot;:&quot;KV list: prefix=all&quot;,&quot;type&quot;:&quot;data_operation&quot;,&quot;operation&quot;:&quot;kv&quot;,&quot;key&quot;:&quot;*&quot;,&quot;latencyMs&quot;:0,&quot;cacheStatus&quot;:&quot;N/A&quot;}

            </system-out>
        </testcase>
    </testsuite>
    <testsuite name="test/logging/logger.spec.ts" timestamp="2026-01-01T10:46:50.897Z" hostname="sngvahmed" tests="31" failures="0" errors="0" skipped="0" time="2.616">
        <testcase classname="test/logging/logger.spec.ts" name="Logger &gt; constructor &gt; should initialize with context" time="0.045">
        </testcase>
        <testcase classname="test/logging/logger.spec.ts" name="Logger &gt; constructor &gt; should start with empty log buffer" time="0.089">
        </testcase>
        <testcase classname="test/logging/logger.spec.ts" name="Logger &gt; debug &gt; should create debug log entry" time="0.037">
            <system-out>
{&quot;timestamp&quot;:&quot;2026-01-01T10:46:45.861Z&quot;,&quot;service&quot;:&quot;stockly-api-test&quot;,&quot;level&quot;:&quot;DEBUG&quot;,&quot;traceId&quot;:&quot;test-trace-123&quot;,&quot;userId&quot;:&quot;user-456&quot;,&quot;path&quot;:&quot;/v1/api/test&quot;,&quot;message&quot;:&quot;Debug message&quot;,&quot;type&quot;:&quot;general&quot;,&quot;extra&quot;:&quot;data&quot;}

            </system-out>
        </testcase>
        <testcase classname="test/logging/logger.spec.ts" name="Logger &gt; info &gt; should create info log entry" time="0.11">
            <system-out>
{&quot;timestamp&quot;:&quot;2026-01-01T10:46:46.075Z&quot;,&quot;service&quot;:&quot;stockly-api-test&quot;,&quot;level&quot;:&quot;INFO&quot;,&quot;traceId&quot;:&quot;test-trace-123&quot;,&quot;userId&quot;:&quot;user-456&quot;,&quot;path&quot;:&quot;/v1/api/test&quot;,&quot;message&quot;:&quot;Info message&quot;,&quot;type&quot;:&quot;general&quot;,&quot;action&quot;:&quot;test&quot;}

            </system-out>
        </testcase>
        <testcase classname="test/logging/logger.spec.ts" name="Logger &gt; warn &gt; should create warn log entry" time="0.131">
            <system-err>
{&quot;timestamp&quot;:&quot;2026-01-01T10:46:46.332Z&quot;,&quot;service&quot;:&quot;stockly-api-test&quot;,&quot;level&quot;:&quot;WARN&quot;,&quot;traceId&quot;:&quot;test-trace-123&quot;,&quot;userId&quot;:&quot;user-456&quot;,&quot;path&quot;:&quot;/v1/api/test&quot;,&quot;message&quot;:&quot;Warning message&quot;,&quot;type&quot;:&quot;general&quot;,&quot;warning&quot;:&quot;test&quot;}

            </system-err>
        </testcase>
        <testcase classname="test/logging/logger.spec.ts" name="Logger &gt; error &gt; should create error log entry with Error object" time="0.116">
            <system-err>
{&quot;timestamp&quot;:&quot;2026-01-01T10:46:46.553Z&quot;,&quot;service&quot;:&quot;stockly-api-test&quot;,&quot;level&quot;:&quot;ERROR&quot;,&quot;traceId&quot;:&quot;test-trace-123&quot;,&quot;userId&quot;:&quot;user-456&quot;,&quot;path&quot;:&quot;/v1/api/test&quot;,&quot;message&quot;:&quot;Error message&quot;,&quot;type&quot;:&quot;general&quot;,&quot;context&quot;:&quot;test&quot;,&quot;error&quot;:{&quot;name&quot;:&quot;Error&quot;,&quot;message&quot;:&quot;Test error&quot;,&quot;stack&quot;:&quot;Error stack trace&quot;}}

            </system-err>
        </testcase>
        <testcase classname="test/logging/logger.spec.ts" name="Logger &gt; error &gt; should create error log entry with string error" time="0.085">
            <system-err>
{&quot;timestamp&quot;:&quot;2026-01-01T10:46:46.666Z&quot;,&quot;service&quot;:&quot;stockly-api-test&quot;,&quot;level&quot;:&quot;ERROR&quot;,&quot;traceId&quot;:&quot;test-trace-123&quot;,&quot;userId&quot;:&quot;user-456&quot;,&quot;path&quot;:&quot;/v1/api/test&quot;,&quot;message&quot;:&quot;Error message&quot;,&quot;type&quot;:&quot;general&quot;,&quot;context&quot;:&quot;test&quot;,&quot;error&quot;:&quot;String error&quot;}

            </system-err>
        </testcase>
        <testcase classname="test/logging/logger.spec.ts" name="Logger &gt; error &gt; should create error log entry without error" time="0.083">
            <system-err>
{&quot;timestamp&quot;:&quot;2026-01-01T10:46:46.755Z&quot;,&quot;service&quot;:&quot;stockly-api-test&quot;,&quot;level&quot;:&quot;ERROR&quot;,&quot;traceId&quot;:&quot;test-trace-123&quot;,&quot;userId&quot;:&quot;user-456&quot;,&quot;path&quot;:&quot;/v1/api/test&quot;,&quot;message&quot;:&quot;Error message&quot;,&quot;type&quot;:&quot;general&quot;,&quot;context&quot;:&quot;test&quot;}

            </system-err>
        </testcase>
        <testcase classname="test/logging/logger.spec.ts" name="Logger &gt; logApiCall &gt; should create API call log entry" time="0.078">
            <system-out>
{&quot;timestamp&quot;:&quot;2026-01-01T10:46:46.878Z&quot;,&quot;service&quot;:&quot;stockly-api-test&quot;,&quot;level&quot;:&quot;DEBUG&quot;,&quot;traceId&quot;:&quot;test-trace-123&quot;,&quot;userId&quot;:&quot;user-456&quot;,&quot;path&quot;:&quot;/v1/api/test&quot;,&quot;message&quot;:&quot;API call made&quot;,&quot;type&quot;:&quot;api_call&quot;,&quot;apiProvider&quot;:&quot;FMP&quot;,&quot;endpoint&quot;:&quot;/quote&quot;,&quot;method&quot;:&quot;GET&quot;,&quot;statusCode&quot;:200,&quot;latencyMs&quot;:150}

            </system-out>
        </testcase>
        <testcase classname="test/logging/logger.spec.ts" name="Logger &gt; logApiCall &gt; should create API call log entry with partial options" time="0.051">
            <system-out>
{&quot;timestamp&quot;:&quot;2026-01-01T10:46:46.913Z&quot;,&quot;service&quot;:&quot;stockly-api-test&quot;,&quot;level&quot;:&quot;DEBUG&quot;,&quot;traceId&quot;:&quot;test-trace-123&quot;,&quot;userId&quot;:&quot;user-456&quot;,&quot;path&quot;:&quot;/v1/api/test&quot;,&quot;message&quot;:&quot;API call&quot;,&quot;type&quot;:&quot;api_call&quot;,&quot;apiProvider&quot;:&quot;FMP&quot;,&quot;latencyMs&quot;:100}

            </system-out>
        </testcase>
        <testcase classname="test/logging/logger.spec.ts" name="Logger &gt; logDataOperation &gt; should create D1 operation log entry" time="0.037">
            <system-out>
{&quot;timestamp&quot;:&quot;2026-01-01T10:46:47.037Z&quot;,&quot;service&quot;:&quot;stockly-api-test&quot;,&quot;level&quot;:&quot;DEBUG&quot;,&quot;traceId&quot;:&quot;test-trace-123&quot;,&quot;userId&quot;:&quot;user-456&quot;,&quot;path&quot;:&quot;/v1/api/test&quot;,&quot;message&quot;:&quot;D1 query executed&quot;,&quot;type&quot;:&quot;data_operation&quot;,&quot;operation&quot;:&quot;d1&quot;,&quot;query&quot;:&quot;SELECT * FROM alerts&quot;,&quot;latencyMs&quot;:25,&quot;cacheStatus&quot;:&quot;N/A&quot;}

            </system-out>
        </testcase>
        <testcase classname="test/logging/logger.spec.ts" name="Logger &gt; logDataOperation &gt; should create KV operation log entry with HIT" time="0.083">
            <system-out>
{&quot;timestamp&quot;:&quot;2026-01-01T10:46:47.113Z&quot;,&quot;service&quot;:&quot;stockly-api-test&quot;,&quot;level&quot;:&quot;DEBUG&quot;,&quot;traceId&quot;:&quot;test-trace-123&quot;,&quot;userId&quot;:&quot;user-456&quot;,&quot;path&quot;:&quot;/v1/api/test&quot;,&quot;message&quot;:&quot;KV get&quot;,&quot;type&quot;:&quot;data_operation&quot;,&quot;operation&quot;:&quot;kv&quot;,&quot;key&quot;:&quot;cache:key&quot;,&quot;latencyMs&quot;:5,&quot;cacheStatus&quot;:&quot;HIT&quot;}

            </system-out>
        </testcase>
        <testcase classname="test/logging/logger.spec.ts" name="Logger &gt; logDataOperation &gt; should create KV operation log entry with MISS" time="0.035">
            <system-out>
{&quot;timestamp&quot;:&quot;2026-01-01T10:46:47.160Z&quot;,&quot;service&quot;:&quot;stockly-api-test&quot;,&quot;level&quot;:&quot;DEBUG&quot;,&quot;traceId&quot;:&quot;test-trace-123&quot;,&quot;userId&quot;:&quot;user-456&quot;,&quot;path&quot;:&quot;/v1/api/test&quot;,&quot;message&quot;:&quot;KV get&quot;,&quot;type&quot;:&quot;data_operation&quot;,&quot;operation&quot;:&quot;kv&quot;,&quot;key&quot;:&quot;cache:key&quot;,&quot;latencyMs&quot;:5,&quot;cacheStatus&quot;:&quot;MISS&quot;}

            </system-out>
        </testcase>
        <testcase classname="test/logging/logger.spec.ts" name="Logger &gt; logDataOperation &gt; should create data operation log entry with error" time="0.076">
            <system-out>
{&quot;timestamp&quot;:&quot;2026-01-01T10:46:47.229Z&quot;,&quot;service&quot;:&quot;stockly-api-test&quot;,&quot;level&quot;:&quot;DEBUG&quot;,&quot;traceId&quot;:&quot;test-trace-123&quot;,&quot;userId&quot;:&quot;user-456&quot;,&quot;path&quot;:&quot;/v1/api/test&quot;,&quot;message&quot;:&quot;D1 query failed&quot;,&quot;type&quot;:&quot;data_operation&quot;,&quot;operation&quot;:&quot;d1&quot;,&quot;query&quot;:&quot;SELECT * FROM alerts&quot;,&quot;latencyMs&quot;:25,&quot;cacheStatus&quot;:&quot;N/A&quot;,&quot;error&quot;:&quot;Database connection failed&quot;}

            </system-out>
        </testcase>
        <testcase classname="test/logging/logger.spec.ts" name="Logger &gt; logFCMError &gt; should create FCM error log entry" time="0.037">
            <system-err>
{&quot;timestamp&quot;:&quot;2026-01-01T10:46:47.335Z&quot;,&quot;service&quot;:&quot;stockly-api-test&quot;,&quot;level&quot;:&quot;ERROR&quot;,&quot;traceId&quot;:&quot;test-trace-123&quot;,&quot;userId&quot;:&quot;user-456&quot;,&quot;path&quot;:&quot;/v1/api/test&quot;,&quot;message&quot;:&quot;FCM notification failed&quot;,&quot;type&quot;:&quot;fcm_error&quot;,&quot;fcmErrorCode&quot;:&quot;5&quot;,&quot;fcmErrorType&quot;:&quot;NOT_FOUND&quot;,&quot;isPermanent&quot;:true,&quot;shouldCleanupToken&quot;:true,&quot;requestPayload&quot;:{&quot;token&quot;:&quot;fcm-token&quot;,&quot;title&quot;:&quot;Alert&quot;,&quot;body&quot;:&quot;Price alert&quot;},&quot;errorMessage&quot;:&quot;Token not found&quot;}

            </system-err>
        </testcase>
        <testcase classname="test/logging/logger.spec.ts" name="Logger &gt; getLogs &gt; should return copy of log buffer" time="0.062">
            <system-out>
{&quot;timestamp&quot;:&quot;2026-01-01T10:46:47.435Z&quot;,&quot;service&quot;:&quot;stockly-api-test&quot;,&quot;level&quot;:&quot;INFO&quot;,&quot;traceId&quot;:&quot;test-trace-123&quot;,&quot;userId&quot;:&quot;user-456&quot;,&quot;path&quot;:&quot;/v1/api/test&quot;,&quot;message&quot;:&quot;Message 1&quot;,&quot;type&quot;:&quot;general&quot;}
{&quot;timestamp&quot;:&quot;2026-01-01T10:46:47.435Z&quot;,&quot;service&quot;:&quot;stockly-api-test&quot;,&quot;level&quot;:&quot;INFO&quot;,&quot;traceId&quot;:&quot;test-trace-123&quot;,&quot;userId&quot;:&quot;user-456&quot;,&quot;path&quot;:&quot;/v1/api/test&quot;,&quot;message&quot;:&quot;Message 2&quot;,&quot;type&quot;:&quot;general&quot;}

            </system-out>
        </testcase>
        <testcase classname="test/logging/logger.spec.ts" name="Logger &gt; clearLogs &gt; should clear log buffer" time="0.032">
            <system-out>
{&quot;timestamp&quot;:&quot;2026-01-01T10:46:47.488Z&quot;,&quot;service&quot;:&quot;stockly-api-test&quot;,&quot;level&quot;:&quot;INFO&quot;,&quot;traceId&quot;:&quot;test-trace-123&quot;,&quot;userId&quot;:&quot;user-456&quot;,&quot;path&quot;:&quot;/v1/api/test&quot;,&quot;message&quot;:&quot;Message 1&quot;,&quot;type&quot;:&quot;general&quot;}
{&quot;timestamp&quot;:&quot;2026-01-01T10:46:47.488Z&quot;,&quot;service&quot;:&quot;stockly-api-test&quot;,&quot;level&quot;:&quot;INFO&quot;,&quot;traceId&quot;:&quot;test-trace-123&quot;,&quot;userId&quot;:&quot;user-456&quot;,&quot;path&quot;:&quot;/v1/api/test&quot;,&quot;message&quot;:&quot;Message 2&quot;,&quot;type&quot;:&quot;general&quot;}

            </system-out>
        </testcase>
        <testcase classname="test/logging/logger.spec.ts" name="Logger &gt; updateContext &gt; should update context" time="0.031">
        </testcase>
        <testcase classname="test/logging/logger.spec.ts" name="Logger &gt; updateContext &gt; should update multiple context fields" time="0.034">
        </testcase>
        <testcase classname="test/logging/logger.spec.ts" name="Logger &gt; updateContext &gt; should use updated context in new logs" time="0.051">
            <system-out>
{&quot;timestamp&quot;:&quot;2026-01-01T10:46:47.647Z&quot;,&quot;service&quot;:&quot;stockly-api-test&quot;,&quot;level&quot;:&quot;INFO&quot;,&quot;traceId&quot;:&quot;test-trace-123&quot;,&quot;userId&quot;:&quot;updated-user&quot;,&quot;path&quot;:&quot;/v1/api/test&quot;,&quot;message&quot;:&quot;New message&quot;,&quot;type&quot;:&quot;general&quot;}

            </system-out>
        </testcase>
        <testcase classname="test/logging/logger.spec.ts" name="Logger &gt; getContext &gt; should return copy of context" time="0.059">
        </testcase>
        <testcase classname="test/logging/logger.spec.ts" name="Logger &gt; log entry structure &gt; should include all required fields" time="0.029">
            <system-out>
{&quot;timestamp&quot;:&quot;2026-01-01T10:46:47.803Z&quot;,&quot;service&quot;:&quot;stockly-api-test&quot;,&quot;level&quot;:&quot;INFO&quot;,&quot;traceId&quot;:&quot;test-trace-123&quot;,&quot;userId&quot;:&quot;user-456&quot;,&quot;path&quot;:&quot;/v1/api/test&quot;,&quot;message&quot;:&quot;Test message&quot;,&quot;type&quot;:&quot;general&quot;}

            </system-out>
        </testcase>
        <testcase classname="test/logging/logger.spec.ts" name="Logger &gt; log entry structure &gt; should handle null userId" time="0.045">
            <system-out>
{&quot;timestamp&quot;:&quot;2026-01-01T10:46:47.844Z&quot;,&quot;service&quot;:&quot;stockly-api-test&quot;,&quot;level&quot;:&quot;INFO&quot;,&quot;traceId&quot;:&quot;test-trace-123&quot;,&quot;userId&quot;:null,&quot;path&quot;:&quot;/v1/api/test&quot;,&quot;message&quot;:&quot;Test&quot;,&quot;type&quot;:&quot;general&quot;}

            </system-out>
        </testcase>
        <testcase classname="test/logging/logger.spec.ts" name="Logger &gt; log entry structure &gt; should handle undefined userId" time="0.025">
            <system-out>
{&quot;timestamp&quot;:&quot;2026-01-01T10:46:47.877Z&quot;,&quot;service&quot;:&quot;test&quot;,&quot;level&quot;:&quot;INFO&quot;,&quot;traceId&quot;:&quot;test&quot;,&quot;userId&quot;:null,&quot;path&quot;:&quot;/test&quot;,&quot;message&quot;:&quot;Test&quot;,&quot;type&quot;:&quot;general&quot;}

            </system-out>
        </testcase>
        <testcase classname="test/logging/logger.spec.ts" name="extractUserId &gt; should extract userId from push-token path" time="0.048">
        </testcase>
        <testcase classname="test/logging/logger.spec.ts" name="extractUserId &gt; should extract userId from preferences path" time="0.03">
        </testcase>
        <testcase classname="test/logging/logger.spec.ts" name="extractUserId &gt; should extract userId from settings path" time="0.027">
        </testcase>
        <testcase classname="test/logging/logger.spec.ts" name="extractUserId &gt; should extract userId from devices path" time="0.03">
        </testcase>
        <testcase classname="test/logging/logger.spec.ts" name="extractUserId &gt; should return null when userId not in path" time="0.028">
        </testcase>
        <testcase classname="test/logging/logger.spec.ts" name="extractUserId &gt; should return null for paths without userId pattern" time="0.022">
        </testcase>
        <testcase classname="test/logging/logger.spec.ts" name="extractUserId &gt; should extract userId from path with query params" time="0.026">
        </testcase>
    </testsuite>
    <testsuite name="test/logging/loki-shipper.spec.ts" timestamp="2026-01-01T10:46:50.904Z" hostname="sngvahmed" tests="12" failures="0" errors="0" skipped="0" time="1.396">
        <testcase classname="test/logging/loki-shipper.spec.ts" name="Loki Shipper &gt; sendLogsToLoki &gt; should ship logs successfully" time="0.054">
            <system-out>
[Loki Shipper] Successfully shipped 2 log entries

            </system-out>
        </testcase>
        <testcase classname="test/logging/loki-shipper.spec.ts" name="Loki Shipper &gt; sendLogsToLoki &gt; should format timestamps as nanoseconds" time="0.098">
            <system-out>
[Loki Shipper] Successfully shipped 2 log entries

            </system-out>
        </testcase>
        <testcase classname="test/logging/loki-shipper.spec.ts" name="Loki Shipper &gt; sendLogsToLoki &gt; should handle URL with trailing slash" time="0.093">
            <system-out>
[Loki Shipper] Successfully shipped 2 log entries

            </system-out>
        </testcase>
        <testcase classname="test/logging/loki-shipper.spec.ts" name="Loki Shipper &gt; sendLogsToLoki &gt; should include Basic Auth when credentials provided" time="0.042">
            <system-out>
[Loki Shipper] Successfully shipped 2 log entries

            </system-out>
        </testcase>
        <testcase classname="test/logging/loki-shipper.spec.ts" name="Loki Shipper &gt; sendLogsToLoki &gt; should not include Auth when credentials not provided" time="0.178">
            <system-out>
[Loki Shipper] Successfully shipped 2 log entries

            </system-out>
        </testcase>
        <testcase classname="test/logging/loki-shipper.spec.ts" name="Loki Shipper &gt; sendLogsToLoki &gt; should include custom labels" time="0.134">
            <system-out>
[Loki Shipper] Successfully shipped 2 log entries

            </system-out>
        </testcase>
        <testcase classname="test/logging/loki-shipper.spec.ts" name="Loki Shipper &gt; sendLogsToLoki &gt; should return early if no logs" time="0.099">
        </testcase>
        <testcase classname="test/logging/loki-shipper.spec.ts" name="Loki Shipper &gt; sendLogsToLoki &gt; should return early if URL not configured" time="0.119">
        </testcase>
        <testcase classname="test/logging/loki-shipper.spec.ts" name="Loki Shipper &gt; sendLogsToLoki &gt; should handle non-200 response" time="0.089">
        </testcase>
        <testcase classname="test/logging/loki-shipper.spec.ts" name="Loki Shipper &gt; sendLogsToLoki &gt; should handle network errors gracefully" time="0.114">
        </testcase>
        <testcase classname="test/logging/loki-shipper.spec.ts" name="Loki Shipper &gt; sendLogsToLoki &gt; should handle fetch text() error" time="0.095">
        </testcase>
        <testcase classname="test/logging/loki-shipper.spec.ts" name="Loki Shipper &gt; sendLogsToLoki &gt; should format logs correctly with all log types" time="0.102">
            <system-out>
[Loki Shipper] Successfully shipped 3 log entries

            </system-out>
        </testcase>
    </testsuite>
    <testsuite name="test/senate-trading/evaluate-senator-alerts.spec.ts" timestamp="2026-01-01T10:46:50.906Z" hostname="sngvahmed" tests="1" failures="0" errors="0" skipped="0" time="0.113">
        <testcase classname="test/senate-trading/evaluate-senator-alerts.spec.ts" name="Evaluate Senator Alerts &gt; should evaluate alerts for matching trades" time="0.053">
            <system-out>
{&quot;timestamp&quot;:&quot;2026-01-01T10:46:47.710Z&quot;,&quot;service&quot;:&quot;stockly-api-test&quot;,&quot;level&quot;:&quot;INFO&quot;,&quot;traceId&quot;:&quot;test-trace-id&quot;,&quot;userId&quot;:null,&quot;path&quot;:&quot;/test&quot;,&quot;message&quot;:&quot;Starting senator alert evaluation&quot;,&quot;type&quot;:&quot;general&quot;}

{&quot;timestamp&quot;:&quot;2026-01-01T10:46:47.711Z&quot;,&quot;service&quot;:&quot;stockly-api-test&quot;,&quot;level&quot;:&quot;INFO&quot;,&quot;traceId&quot;:&quot;test-trace-id&quot;,&quot;userId&quot;:null,&quot;path&quot;:&quot;/test&quot;,&quot;message&quot;:&quot;Found 1 recent trades to evaluate&quot;,&quot;type&quot;:&quot;general&quot;}

{&quot;timestamp&quot;:&quot;2026-01-01T10:46:47.712Z&quot;,&quot;service&quot;:&quot;stockly-api-test&quot;,&quot;level&quot;:&quot;INFO&quot;,&quot;traceId&quot;:&quot;test-trace-id&quot;,&quot;userId&quot;:null,&quot;path&quot;:&quot;/test&quot;,&quot;message&quot;:&quot;Evaluating alerts for 1 users&quot;,&quot;type&quot;:&quot;general&quot;}

{&quot;timestamp&quot;:&quot;2026-01-01T10:46:47.719Z&quot;,&quot;service&quot;:&quot;stockly-api-test&quot;,&quot;level&quot;:&quot;INFO&quot;,&quot;traceId&quot;:&quot;test-trace-id&quot;,&quot;userId&quot;:null,&quot;path&quot;:&quot;/test&quot;,&quot;message&quot;:&quot;Senator alert evaluation completed&quot;,&quot;type&quot;:&quot;general&quot;,&quot;tradesProcessed&quot;:1,&quot;alertsSent&quot;:0,&quot;alertsSkipped&quot;:1,&quot;errors&quot;:0}

            </system-out>
            <system-err>
{&quot;timestamp&quot;:&quot;2026-01-01T10:46:47.715Z&quot;,&quot;service&quot;:&quot;stockly-api-test&quot;,&quot;level&quot;:&quot;ERROR&quot;,&quot;traceId&quot;:&quot;test-trace-id&quot;,&quot;userId&quot;:&quot;user-123&quot;,&quot;path&quot;:&quot;/test&quot;,&quot;message&quot;:&quot;Error in sendSenatorTradeNotification&quot;,&quot;type&quot;:&quot;general&quot;,&quot;username&quot;:&quot;testuser&quot;,&quot;tradeId&quot;:&quot;1&quot;,&quot;error&quot;:{&quot;name&quot;:&quot;TypeError&quot;,&quot;message&quot;:&quot;Cannot read properties of undefined (reading &apos;results&apos;)&quot;,&quot;stack&quot;:&quot;TypeError: Cannot read properties of undefined (reading &apos;results&apos;)\n    at sendSenatorTradeNotification (/home/sngvahmed/workspace/stockly/api/src/alerts/evaluate-senator-alerts.ts:186:21)\n    at evaluateSenatorAlerts (/home/sngvahmed/workspace/stockly/api/src/alerts/evaluate-senator-alerts.ts:351:28)\n    at /home/sngvahmed/workspace/stockly/api/test/senate-trading/evaluate-senator-alerts.spec.ts:85:20\n    at home/sngvahmed/workspace/stockly/node_modules/@vitest/runner/dist/chunk-hooks.js:752:20&quot;}}

{&quot;timestamp&quot;:&quot;2026-01-01T10:46:47.719Z&quot;,&quot;service&quot;:&quot;stockly-api-test&quot;,&quot;level&quot;:&quot;WARN&quot;,&quot;traceId&quot;:&quot;test-trace-id&quot;,&quot;userId&quot;:&quot;user-123&quot;,&quot;path&quot;:&quot;/test&quot;,&quot;message&quot;:&quot;Senator trade alert skipped&quot;,&quot;type&quot;:&quot;general&quot;,&quot;username&quot;:&quot;testuser&quot;,&quot;tradeId&quot;:&quot;1&quot;,&quot;reason&quot;:&quot;notification send failed&quot;}

            </system-err>
        </testcase>
    </testsuite>
    <testsuite name="test/senate-trading/senate-trading-api.spec.ts" timestamp="2026-01-01T10:46:50.907Z" hostname="sngvahmed" tests="3" failures="0" errors="0" skipped="0" time="0.702">
        <testcase classname="test/senate-trading/senate-trading-api.spec.ts" name="Senate Trading API &gt; fetchSenateTradingFromFmp &gt; should fetch and parse senate trading data" time="0.141">
            <system-out>
[fetchSenateTradingFromFmp] Fetching from: https://financialmodelingprep.com/stable/senate-latest?page=0&amp;limit=100&amp;apikey=***

[fetchSenateTradingFromFmp] Received 1 trades from FMP API
[fetchSenateTradingFromFmp] Successfully mapped 1 trades

            </system-out>
        </testcase>
        <testcase classname="test/senate-trading/senate-trading-api.spec.ts" name="Senate Trading API &gt; fetchSenateTradingFromFmp &gt; should handle API errors gracefully" time="0.136">
            <system-out>
[fetchSenateTradingFromFmp] Fetching from: https://financialmodelingprep.com/stable/senate-latest?page=0&amp;limit=100&amp;apikey=***

            </system-out>
            <system-err>
[fetchSenateTradingFromFmp] FMP API server error: HTTP 500

            </system-err>
        </testcase>
        <testcase classname="test/senate-trading/senate-trading-api.spec.ts" name="Senate Trading API &gt; fetchSenateTradingFromFmp &gt; should filter by symbol when provided" time="0.226">
            <system-out>
[fetchSenateTradingFromFmp] Fetching from: https://financialmodelingprep.com/stable/senate-trades?symbol=AAPL&amp;apikey=***

[fetchSenateTradingFromFmp] Received 0 trades from FMP API
[fetchSenateTradingFromFmp] Successfully mapped 0 trades

            </system-out>
        </testcase>
    </testsuite>
    <testsuite name="test/senate-trading/senate-trading-controller.spec.ts" timestamp="2026-01-01T10:46:50.908Z" hostname="sngvahmed" tests="5" failures="0" errors="0" skipped="0" time="0.249">
        <testcase classname="test/senate-trading/senate-trading-controller.spec.ts" name="Senate Trading Controller &gt; should handle GET /v1/api/senate-trading/feed" time="0.044">
        </testcase>
        <testcase classname="test/senate-trading/senate-trading-controller.spec.ts" name="Senate Trading Controller &gt; should handle GET /v1/api/senate-trading/senators" time="0.046">
        </testcase>
        <testcase classname="test/senate-trading/senate-trading-controller.spec.ts" name="Senate Trading Controller &gt; should handle GET /v1/api/senate-trading/senators/popular" time="0.047">
        </testcase>
        <testcase classname="test/senate-trading/senate-trading-controller.spec.ts" name="Senate Trading Controller &gt; should handle GET /v1/api/senate-trading/senators/autocomplete" time="0.036">
        </testcase>
        <testcase classname="test/senate-trading/senate-trading-controller.spec.ts" name="Senate Trading Controller &gt; should return 404 for unknown routes" time="0.031">
        </testcase>
    </testsuite>
    <testsuite name="test/senate-trading/senate-trading-cron.spec.ts" timestamp="2026-01-01T10:46:50.909Z" hostname="sngvahmed" tests="2" failures="0" errors="0" skipped="0" time="0.294">
        <testcase classname="test/senate-trading/senate-trading-cron.spec.ts" name="Senate Trading Cron &gt; should run cron job successfully" time="0.044">
            <system-out>
{&quot;timestamp&quot;:&quot;2026-01-01T10:46:47.313Z&quot;,&quot;service&quot;:&quot;stockly-api&quot;,&quot;level&quot;:&quot;INFO&quot;,&quot;traceId&quot;:&quot;senate-cron-1767264407312&quot;,&quot;userId&quot;:null,&quot;path&quot;:&quot;/cron/senate-trading&quot;,&quot;message&quot;:&quot;Starting senate trading cron job&quot;,&quot;type&quot;:&quot;general&quot;}
{&quot;timestamp&quot;:&quot;2026-01-01T10:46:47.314Z&quot;,&quot;service&quot;:&quot;stockly-api&quot;,&quot;level&quot;:&quot;INFO&quot;,&quot;traceId&quot;:&quot;senate-cron-1767264407312&quot;,&quot;userId&quot;:null,&quot;path&quot;:&quot;/cron/senate-trading&quot;,&quot;message&quot;:&quot;Starting senate trades sync from FMP API&quot;,&quot;type&quot;:&quot;general&quot;}
[fetchSenateTradingFromFmp] Fetching from: https://financialmodelingprep.com/stable/senate-latest?page=0&amp;limit=100&amp;apikey=***

[fetchSenateTradingFromFmp] Received 1 trades from FMP API
[fetchSenateTradingFromFmp] Successfully mapped 1 trades

{&quot;timestamp&quot;:&quot;2026-01-01T10:46:47.315Z&quot;,&quot;service&quot;:&quot;stockly-api&quot;,&quot;level&quot;:&quot;INFO&quot;,&quot;traceId&quot;:&quot;senate-cron-1767264407312&quot;,&quot;userId&quot;:null,&quot;path&quot;:&quot;/cron/senate-trading&quot;,&quot;message&quot;:&quot;Fetched page 0: 1 trades from FMP API&quot;,&quot;type&quot;:&quot;general&quot;}
{&quot;timestamp&quot;:&quot;2026-01-01T10:46:47.315Z&quot;,&quot;service&quot;:&quot;stockly-api&quot;,&quot;level&quot;:&quot;INFO&quot;,&quot;traceId&quot;:&quot;senate-cron-1767264407312&quot;,&quot;userId&quot;:null,&quot;path&quot;:&quot;/cron/senate-trading&quot;,&quot;message&quot;:&quot;Fetched total 1 trades from FMP API across 1 page(s)&quot;,&quot;type&quot;:&quot;general&quot;}

{&quot;timestamp&quot;:&quot;2026-01-01T10:46:47.316Z&quot;,&quot;service&quot;:&quot;stockly-api&quot;,&quot;level&quot;:&quot;INFO&quot;,&quot;traceId&quot;:&quot;senate-cron-1767264407312&quot;,&quot;userId&quot;:null,&quot;path&quot;:&quot;/cron/senate-trading&quot;,&quot;message&quot;:&quot;Senate trades sync completed&quot;,&quot;type&quot;:&quot;general&quot;,&quot;added&quot;:1,&quot;updated&quot;:0,&quot;errors&quot;:0,&quot;total&quot;:1}

{&quot;timestamp&quot;:&quot;2026-01-01T10:46:47.316Z&quot;,&quot;service&quot;:&quot;stockly-api&quot;,&quot;level&quot;:&quot;INFO&quot;,&quot;traceId&quot;:&quot;senate-cron-1767264407312&quot;,&quot;userId&quot;:null,&quot;path&quot;:&quot;/cron/senate-trading&quot;,&quot;message&quot;:&quot;Senate trades sync completed&quot;,&quot;type&quot;:&quot;general&quot;,&quot;added&quot;:1,&quot;updated&quot;:0,&quot;errors&quot;:0}
{&quot;timestamp&quot;:&quot;2026-01-01T10:46:47.316Z&quot;,&quot;service&quot;:&quot;stockly-api&quot;,&quot;level&quot;:&quot;INFO&quot;,&quot;traceId&quot;:&quot;senate-cron-1767264407312&quot;,&quot;userId&quot;:null,&quot;path&quot;:&quot;/cron/senate-trading&quot;,&quot;message&quot;:&quot;Evaluating senator alerts for new/updated trades&quot;,&quot;type&quot;:&quot;general&quot;}
{&quot;timestamp&quot;:&quot;2026-01-01T10:46:47.316Z&quot;,&quot;service&quot;:&quot;stockly-api&quot;,&quot;level&quot;:&quot;INFO&quot;,&quot;traceId&quot;:&quot;senate-cron-1767264407312&quot;,&quot;userId&quot;:null,&quot;path&quot;:&quot;/cron/senate-trading&quot;,&quot;message&quot;:&quot;Starting senator alert evaluation&quot;,&quot;type&quot;:&quot;general&quot;}

{&quot;timestamp&quot;:&quot;2026-01-01T10:46:47.317Z&quot;,&quot;service&quot;:&quot;stockly-api&quot;,&quot;level&quot;:&quot;INFO&quot;,&quot;traceId&quot;:&quot;senate-cron-1767264407312&quot;,&quot;userId&quot;:null,&quot;path&quot;:&quot;/cron/senate-trading&quot;,&quot;message&quot;:&quot;Found 0 recent trades to evaluate&quot;,&quot;type&quot;:&quot;general&quot;}

{&quot;timestamp&quot;:&quot;2026-01-01T10:46:47.317Z&quot;,&quot;service&quot;:&quot;stockly-api&quot;,&quot;level&quot;:&quot;INFO&quot;,&quot;traceId&quot;:&quot;senate-cron-1767264407312&quot;,&quot;userId&quot;:null,&quot;path&quot;:&quot;/cron/senate-trading&quot;,&quot;message&quot;:&quot;Evaluating alerts for 0 users&quot;,&quot;type&quot;:&quot;general&quot;}
{&quot;timestamp&quot;:&quot;2026-01-01T10:46:47.317Z&quot;,&quot;service&quot;:&quot;stockly-api&quot;,&quot;level&quot;:&quot;INFO&quot;,&quot;traceId&quot;:&quot;senate-cron-1767264407312&quot;,&quot;userId&quot;:null,&quot;path&quot;:&quot;/cron/senate-trading&quot;,&quot;message&quot;:&quot;Senator alert evaluation completed&quot;,&quot;type&quot;:&quot;general&quot;,&quot;tradesProcessed&quot;:0,&quot;alertsSent&quot;:0,&quot;alertsSkipped&quot;:0,&quot;errors&quot;:0}

{&quot;timestamp&quot;:&quot;2026-01-01T10:46:47.317Z&quot;,&quot;service&quot;:&quot;stockly-api&quot;,&quot;level&quot;:&quot;INFO&quot;,&quot;traceId&quot;:&quot;senate-cron-1767264407312&quot;,&quot;userId&quot;:null,&quot;path&quot;:&quot;/cron/senate-trading&quot;,&quot;message&quot;:&quot;Senator alert evaluation completed&quot;,&quot;type&quot;:&quot;general&quot;,&quot;tradesProcessed&quot;:0,&quot;alertsSent&quot;:0,&quot;alertsSkipped&quot;:0,&quot;errors&quot;:0}
{&quot;timestamp&quot;:&quot;2026-01-01T10:46:47.317Z&quot;,&quot;service&quot;:&quot;stockly-api&quot;,&quot;level&quot;:&quot;INFO&quot;,&quot;traceId&quot;:&quot;senate-cron-1767264407312&quot;,&quot;userId&quot;:null,&quot;path&quot;:&quot;/cron/senate-trading&quot;,&quot;message&quot;:&quot;Senate trading cron job completed successfully&quot;,&quot;type&quot;:&quot;general&quot;}

            </system-out>
        </testcase>
        <testcase classname="test/senate-trading/senate-trading-cron.spec.ts" name="Senate Trading Cron &gt; should handle errors gracefully" time="0.035">
            <system-out>
{&quot;timestamp&quot;:&quot;2026-01-01T10:46:47.354Z&quot;,&quot;service&quot;:&quot;stockly-api&quot;,&quot;level&quot;:&quot;INFO&quot;,&quot;traceId&quot;:&quot;senate-cron-1767264407354&quot;,&quot;userId&quot;:null,&quot;path&quot;:&quot;/cron/senate-trading&quot;,&quot;message&quot;:&quot;Starting senate trading cron job&quot;,&quot;type&quot;:&quot;general&quot;}
{&quot;timestamp&quot;:&quot;2026-01-01T10:46:47.354Z&quot;,&quot;service&quot;:&quot;stockly-api&quot;,&quot;level&quot;:&quot;INFO&quot;,&quot;traceId&quot;:&quot;senate-cron-1767264407354&quot;,&quot;userId&quot;:null,&quot;path&quot;:&quot;/cron/senate-trading&quot;,&quot;message&quot;:&quot;Starting senate trades sync from FMP API&quot;,&quot;type&quot;:&quot;general&quot;}
[fetchSenateTradingFromFmp] Fetching from: https://financialmodelingprep.com/stable/senate-latest?page=0&amp;limit=100&amp;apikey=***

            </system-out>
            <system-err>
[fetchSenateTradingFromFmp] Unexpected error fetching senate trading data: Error: API Error
    at /home/sngvahmed/workspace/stockly/api/test/senate-trading/senate-trading-cron.spec.ts:60:46
    at home/sngvahmed/workspace/stockly/node_modules/@vitest/runner/dist/chunk-hooks.js:155:11
    at home/sngvahmed/workspace/stockly/node_modules/@vitest/runner/dist/chunk-hooks.js:752:26
    at home/sngvahmed/workspace/stockly/node_modules/@vitest/runner/dist/chunk-hooks.js:1897:20
    at new Promise (&lt;anonymous&gt;)
    at runWithTimeout (home/sngvahmed/workspace/stockly/node_modules/@vitest/runner/dist/chunk-hooks.js:1863:10)
    at runTest (home/sngvahmed/workspace/stockly/node_modules/@vitest/runner/dist/chunk-hooks.js:1574:12)
    at runSuite (home/sngvahmed/workspace/stockly/node_modules/@vitest/runner/dist/chunk-hooks.js:1729:8)
    at runSuite (home/sngvahmed/workspace/stockly/node_modules/@vitest/runner/dist/chunk-hooks.js:1729:8)
    at runFiles (home/sngvahmed/workspace/stockly/node_modules/@vitest/runner/dist/chunk-hooks.js:1787:3)

{&quot;timestamp&quot;:&quot;2026-01-01T10:46:47.358Z&quot;,&quot;service&quot;:&quot;stockly-api&quot;,&quot;level&quot;:&quot;ERROR&quot;,&quot;traceId&quot;:&quot;senate-cron-1767264407354&quot;,&quot;userId&quot;:null,&quot;path&quot;:&quot;/cron/senate-trading&quot;,&quot;message&quot;:&quot;Error syncing senate trades&quot;,&quot;type&quot;:&quot;general&quot;,&quot;error&quot;:{&quot;name&quot;:&quot;Error&quot;,&quot;message&quot;:&quot;Failed to fetch senate trading data. Please try again later.&quot;,&quot;stack&quot;:&quot;Error: Failed to fetch senate trading data. Please try again later.\n    at fetchSenateTradingFromFmp (/home/sngvahmed/workspace/stockly/api/src/api/senate-trading.ts:131:11)\n    at SenateTradingService.syncSenateTrades (/home/sngvahmed/workspace/stockly/api/src/services/senate-trading.service.ts:47:27)\n    at runSenateTradingCron (/home/sngvahmed/workspace/stockly/api/src/cron/senate-trading-cron.ts:36:24)&quot;}}

{&quot;timestamp&quot;:&quot;2026-01-01T10:46:47.359Z&quot;,&quot;service&quot;:&quot;stockly-api&quot;,&quot;level&quot;:&quot;ERROR&quot;,&quot;traceId&quot;:&quot;senate-cron-1767264407354&quot;,&quot;userId&quot;:null,&quot;path&quot;:&quot;/cron/senate-trading&quot;,&quot;message&quot;:&quot;Error in senate trading cron job&quot;,&quot;type&quot;:&quot;general&quot;,&quot;error&quot;:{&quot;name&quot;:&quot;Error&quot;,&quot;message&quot;:&quot;Failed to fetch senate trading data. Please try again later.&quot;,&quot;stack&quot;:&quot;Error: Failed to fetch senate trading data. Please try again later.\n    at fetchSenateTradingFromFmp (/home/sngvahmed/workspace/stockly/api/src/api/senate-trading.ts:131:11)\n    at SenateTradingService.syncSenateTrades (/home/sngvahmed/workspace/stockly/api/src/services/senate-trading.service.ts:47:27)\n    at runSenateTradingCron (/home/sngvahmed/workspace/stockly/api/src/cron/senate-trading-cron.ts:36:24)&quot;}}

            </system-err>
        </testcase>
    </testsuite>
    <testsuite name="test/senate-trading/senate-trading-integration.spec.ts" timestamp="2026-01-01T10:46:50.910Z" hostname="sngvahmed" tests="3" failures="0" errors="0" skipped="0" time="0.221">
        <testcase classname="test/senate-trading/senate-trading-integration.spec.ts" name="Senate Trading Integration &gt; End-to-end flow &gt; should sync trades and evaluate alerts" time="0.033">
            <system-out>
{&quot;timestamp&quot;:&quot;2026-01-01T10:46:47.825Z&quot;,&quot;service&quot;:&quot;stockly-api-test&quot;,&quot;level&quot;:&quot;INFO&quot;,&quot;traceId&quot;:&quot;test-trace-id&quot;,&quot;userId&quot;:null,&quot;path&quot;:&quot;/test&quot;,&quot;message&quot;:&quot;Starting senate trades sync from FMP API&quot;,&quot;type&quot;:&quot;general&quot;}
[fetchSenateTradingFromFmp] Fetching from: https://financialmodelingprep.com/stable/senate-latest?page=0&amp;limit=100&amp;apikey=***

[fetchSenateTradingFromFmp] Received 1 trades from FMP API
[fetchSenateTradingFromFmp] Successfully mapped 1 trades

{&quot;timestamp&quot;:&quot;2026-01-01T10:46:47.827Z&quot;,&quot;service&quot;:&quot;stockly-api-test&quot;,&quot;level&quot;:&quot;INFO&quot;,&quot;traceId&quot;:&quot;test-trace-id&quot;,&quot;userId&quot;:null,&quot;path&quot;:&quot;/test&quot;,&quot;message&quot;:&quot;Fetched page 0: 1 trades from FMP API&quot;,&quot;type&quot;:&quot;general&quot;}
{&quot;timestamp&quot;:&quot;2026-01-01T10:46:47.827Z&quot;,&quot;service&quot;:&quot;stockly-api-test&quot;,&quot;level&quot;:&quot;INFO&quot;,&quot;traceId&quot;:&quot;test-trace-id&quot;,&quot;userId&quot;:null,&quot;path&quot;:&quot;/test&quot;,&quot;message&quot;:&quot;Fetched total 1 trades from FMP API across 1 page(s)&quot;,&quot;type&quot;:&quot;general&quot;}

{&quot;timestamp&quot;:&quot;2026-01-01T10:46:47.828Z&quot;,&quot;service&quot;:&quot;stockly-api-test&quot;,&quot;level&quot;:&quot;INFO&quot;,&quot;traceId&quot;:&quot;test-trace-id&quot;,&quot;userId&quot;:null,&quot;path&quot;:&quot;/test&quot;,&quot;message&quot;:&quot;Senate trades sync completed&quot;,&quot;type&quot;:&quot;general&quot;,&quot;added&quot;:1,&quot;updated&quot;:0,&quot;errors&quot;:0,&quot;total&quot;:1}

            </system-out>
        </testcase>
        <testcase classname="test/senate-trading/senate-trading-integration.spec.ts" name="Senate Trading Integration &gt; End-to-end flow &gt; should trigger alerts for matching users" time="0.034">
            <system-out>
{&quot;timestamp&quot;:&quot;2026-01-01T10:46:47.861Z&quot;,&quot;service&quot;:&quot;stockly-api-test&quot;,&quot;level&quot;:&quot;INFO&quot;,&quot;traceId&quot;:&quot;test-trace-id&quot;,&quot;userId&quot;:null,&quot;path&quot;:&quot;/test&quot;,&quot;message&quot;:&quot;Starting senator alert evaluation&quot;,&quot;type&quot;:&quot;general&quot;}

{&quot;timestamp&quot;:&quot;2026-01-01T10:46:47.861Z&quot;,&quot;service&quot;:&quot;stockly-api-test&quot;,&quot;level&quot;:&quot;INFO&quot;,&quot;traceId&quot;:&quot;test-trace-id&quot;,&quot;userId&quot;:null,&quot;path&quot;:&quot;/test&quot;,&quot;message&quot;:&quot;Found 1 recent trades to evaluate&quot;,&quot;type&quot;:&quot;general&quot;}

{&quot;timestamp&quot;:&quot;2026-01-01T10:46:47.861Z&quot;,&quot;service&quot;:&quot;stockly-api-test&quot;,&quot;level&quot;:&quot;INFO&quot;,&quot;traceId&quot;:&quot;test-trace-id&quot;,&quot;userId&quot;:null,&quot;path&quot;:&quot;/test&quot;,&quot;message&quot;:&quot;Evaluating alerts for 1 users&quot;,&quot;type&quot;:&quot;general&quot;}

{&quot;timestamp&quot;:&quot;2026-01-01T10:46:47.863Z&quot;,&quot;service&quot;:&quot;stockly-api-test&quot;,&quot;level&quot;:&quot;INFO&quot;,&quot;traceId&quot;:&quot;test-trace-id&quot;,&quot;userId&quot;:null,&quot;path&quot;:&quot;/test&quot;,&quot;message&quot;:&quot;Senator alert evaluation completed&quot;,&quot;type&quot;:&quot;general&quot;,&quot;tradesProcessed&quot;:1,&quot;alertsSent&quot;:0,&quot;alertsSkipped&quot;:1,&quot;errors&quot;:0}

            </system-out>
            <system-err>
{&quot;timestamp&quot;:&quot;2026-01-01T10:46:47.862Z&quot;,&quot;service&quot;:&quot;stockly-api-test&quot;,&quot;level&quot;:&quot;WARN&quot;,&quot;traceId&quot;:&quot;test-trace-id&quot;,&quot;userId&quot;:&quot;user-123&quot;,&quot;path&quot;:&quot;/test&quot;,&quot;message&quot;:&quot;No push tokens found for senator trade alert&quot;,&quot;type&quot;:&quot;general&quot;,&quot;username&quot;:&quot;testuser&quot;,&quot;tradeId&quot;:&quot;1&quot;}

{&quot;timestamp&quot;:&quot;2026-01-01T10:46:47.862Z&quot;,&quot;service&quot;:&quot;stockly-api-test&quot;,&quot;level&quot;:&quot;WARN&quot;,&quot;traceId&quot;:&quot;test-trace-id&quot;,&quot;userId&quot;:&quot;user-123&quot;,&quot;path&quot;:&quot;/test&quot;,&quot;message&quot;:&quot;Senator trade alert skipped&quot;,&quot;type&quot;:&quot;general&quot;,&quot;username&quot;:&quot;testuser&quot;,&quot;tradeId&quot;:&quot;1&quot;,&quot;reason&quot;:&quot;notification send failed&quot;}

            </system-err>
        </testcase>
        <testcase classname="test/senate-trading/senate-trading-integration.spec.ts" name="Senate Trading Integration &gt; Cron job flow &gt; should complete full cron job cycle" time="0.044">
            <system-out>
{&quot;timestamp&quot;:&quot;2026-01-01T10:46:47.928Z&quot;,&quot;service&quot;:&quot;stockly-api&quot;,&quot;level&quot;:&quot;INFO&quot;,&quot;traceId&quot;:&quot;senate-cron-1767264407928&quot;,&quot;userId&quot;:null,&quot;path&quot;:&quot;/cron/senate-trading&quot;,&quot;message&quot;:&quot;Starting senate trading cron job&quot;,&quot;type&quot;:&quot;general&quot;}
{&quot;timestamp&quot;:&quot;2026-01-01T10:46:47.928Z&quot;,&quot;service&quot;:&quot;stockly-api&quot;,&quot;level&quot;:&quot;INFO&quot;,&quot;traceId&quot;:&quot;senate-cron-1767264407928&quot;,&quot;userId&quot;:null,&quot;path&quot;:&quot;/cron/senate-trading&quot;,&quot;message&quot;:&quot;Starting senate trades sync from FMP API&quot;,&quot;type&quot;:&quot;general&quot;}
[fetchSenateTradingFromFmp] Fetching from: https://financialmodelingprep.com/stable/senate-latest?page=0&amp;limit=100&amp;apikey=***

[fetchSenateTradingFromFmp] Received 0 trades from FMP API
[fetchSenateTradingFromFmp] Successfully mapped 0 trades

{&quot;timestamp&quot;:&quot;2026-01-01T10:46:47.929Z&quot;,&quot;service&quot;:&quot;stockly-api&quot;,&quot;level&quot;:&quot;INFO&quot;,&quot;traceId&quot;:&quot;senate-cron-1767264407928&quot;,&quot;userId&quot;:null,&quot;path&quot;:&quot;/cron/senate-trading&quot;,&quot;message&quot;:&quot;Fetched page 0: 0 trades from FMP API&quot;,&quot;type&quot;:&quot;general&quot;}
{&quot;timestamp&quot;:&quot;2026-01-01T10:46:47.929Z&quot;,&quot;service&quot;:&quot;stockly-api&quot;,&quot;level&quot;:&quot;INFO&quot;,&quot;traceId&quot;:&quot;senate-cron-1767264407928&quot;,&quot;userId&quot;:null,&quot;path&quot;:&quot;/cron/senate-trading&quot;,&quot;message&quot;:&quot;Fetched total 0 trades from FMP API across 1 page(s)&quot;,&quot;type&quot;:&quot;general&quot;}
{&quot;timestamp&quot;:&quot;2026-01-01T10:46:47.929Z&quot;,&quot;service&quot;:&quot;stockly-api&quot;,&quot;level&quot;:&quot;INFO&quot;,&quot;traceId&quot;:&quot;senate-cron-1767264407928&quot;,&quot;userId&quot;:null,&quot;path&quot;:&quot;/cron/senate-trading&quot;,&quot;message&quot;:&quot;Senate trades sync completed&quot;,&quot;type&quot;:&quot;general&quot;,&quot;added&quot;:0,&quot;updated&quot;:0,&quot;errors&quot;:0,&quot;total&quot;:0}

{&quot;timestamp&quot;:&quot;2026-01-01T10:46:47.929Z&quot;,&quot;service&quot;:&quot;stockly-api&quot;,&quot;level&quot;:&quot;INFO&quot;,&quot;traceId&quot;:&quot;senate-cron-1767264407928&quot;,&quot;userId&quot;:null,&quot;path&quot;:&quot;/cron/senate-trading&quot;,&quot;message&quot;:&quot;Senate trades sync completed&quot;,&quot;type&quot;:&quot;general&quot;,&quot;added&quot;:0,&quot;updated&quot;:0,&quot;errors&quot;:0}
{&quot;timestamp&quot;:&quot;2026-01-01T10:46:47.929Z&quot;,&quot;service&quot;:&quot;stockly-api&quot;,&quot;level&quot;:&quot;INFO&quot;,&quot;traceId&quot;:&quot;senate-cron-1767264407928&quot;,&quot;userId&quot;:null,&quot;path&quot;:&quot;/cron/senate-trading&quot;,&quot;message&quot;:&quot;No new trades, skipping alert evaluation&quot;,&quot;type&quot;:&quot;general&quot;}
{&quot;timestamp&quot;:&quot;2026-01-01T10:46:47.929Z&quot;,&quot;service&quot;:&quot;stockly-api&quot;,&quot;level&quot;:&quot;INFO&quot;,&quot;traceId&quot;:&quot;senate-cron-1767264407928&quot;,&quot;userId&quot;:null,&quot;path&quot;:&quot;/cron/senate-trading&quot;,&quot;message&quot;:&quot;Senate trading cron job completed successfully&quot;,&quot;type&quot;:&quot;general&quot;}

            </system-out>
        </testcase>
    </testsuite>
    <testsuite name="test/senate-trading/senate-trading-popular-autocomplete.spec.ts" timestamp="2026-01-01T10:46:50.911Z" hostname="sngvahmed" tests="8" failures="0" errors="0" skipped="0" time="1.138">
        <testcase classname="test/senate-trading/senate-trading-popular-autocomplete.spec.ts" name="Popular Senators API &gt; getPopularSenators &gt; should return popular senators by trades" time="0.028">
        </testcase>
        <testcase classname="test/senate-trading/senate-trading-popular-autocomplete.spec.ts" name="Popular Senators API &gt; getPopularSenators &gt; should return popular senators by followers" time="0.032">
        </testcase>
        <testcase classname="test/senate-trading/senate-trading-popular-autocomplete.spec.ts" name="Popular Senators API &gt; getPopularSenators &gt; should validate limit parameter" time="0.034">
        </testcase>
        <testcase classname="test/senate-trading/senate-trading-popular-autocomplete.spec.ts" name="Popular Senators API &gt; getPopularSenators &gt; should validate type parameter" time="0.042">
        </testcase>
        <testcase classname="test/senate-trading/senate-trading-popular-autocomplete.spec.ts" name="Popular Senators API &gt; searchSenatorsAutocomplete &gt; should return matching senators" time="0.807">
            <system-out>
[fetchSenateTradesByName] Fetching from: https://financialmodelingprep.com/stable/senate-trades-by-name?name=John&amp;apikey=***

[fetchSenateTradesByName] Received 1230 trades from FMP API
[fetchSenateTradesByName] Successfully mapped 1229 trades

{&quot;timestamp&quot;:&quot;2026-01-01T10:46:48.848Z&quot;,&quot;service&quot;:&quot;stockly-api-test&quot;,&quot;level&quot;:&quot;INFO&quot;,&quot;traceId&quot;:&quot;test-trace-id&quot;,&quot;userId&quot;:null,&quot;path&quot;:&quot;/test&quot;,&quot;message&quot;:&quot;Found 1229 trades from FMP API for query \&quot;John\&quot;&quot;,&quot;type&quot;:&quot;general&quot;}

{&quot;timestamp&quot;:&quot;2026-01-01T10:46:48.848Z&quot;,&quot;service&quot;:&quot;stockly-api-test&quot;,&quot;level&quot;:&quot;INFO&quot;,&quot;traceId&quot;:&quot;test-trace-id&quot;,&quot;userId&quot;:null,&quot;path&quot;:&quot;/test&quot;,&quot;message&quot;:&quot;Returning 11 unique senators for query \&quot;John\&quot;&quot;,&quot;type&quot;:&quot;general&quot;}

            </system-out>
        </testcase>
        <testcase classname="test/senate-trading/senate-trading-popular-autocomplete.spec.ts" name="Popular Senators API &gt; searchSenatorsAutocomplete &gt; should return empty array for empty query" time="0.003">
        </testcase>
        <testcase classname="test/senate-trading/senate-trading-popular-autocomplete.spec.ts" name="Popular Senators API &gt; searchSenatorsAutocomplete &gt; should validate limit parameter" time="0.002">
        </testcase>
        <testcase classname="test/senate-trading/senate-trading-popular-autocomplete.spec.ts" name="Popular Senators API &gt; searchSenatorsAutocomplete &gt; should handle no results gracefully" time="0.126">
            <system-out>
[fetchSenateTradesByName] Fetching from: https://financialmodelingprep.com/stable/senate-trades-by-name?name=NonExistent&amp;apikey=***

[fetchSenateTradesByName] Received 0 trades from FMP API
[fetchSenateTradesByName] Successfully mapped 0 trades

{&quot;timestamp&quot;:&quot;2026-01-01T10:46:48.978Z&quot;,&quot;service&quot;:&quot;stockly-api-test&quot;,&quot;level&quot;:&quot;INFO&quot;,&quot;traceId&quot;:&quot;test-trace-id&quot;,&quot;userId&quot;:null,&quot;path&quot;:&quot;/test&quot;,&quot;message&quot;:&quot;Found 0 trades from FMP API for query \&quot;NonExistent\&quot;&quot;,&quot;type&quot;:&quot;general&quot;}

{&quot;timestamp&quot;:&quot;2026-01-01T10:46:48.978Z&quot;,&quot;service&quot;:&quot;stockly-api-test&quot;,&quot;level&quot;:&quot;INFO&quot;,&quot;traceId&quot;:&quot;test-trace-id&quot;,&quot;userId&quot;:null,&quot;path&quot;:&quot;/test&quot;,&quot;message&quot;:&quot;Returning 0 unique senators for query \&quot;NonExistent\&quot;&quot;,&quot;type&quot;:&quot;general&quot;}

            </system-out>
        </testcase>
    </testsuite>
    <testsuite name="test/senate-trading/senate-trading-repository.spec.ts" timestamp="2026-01-01T10:46:50.913Z" hostname="sngvahmed" tests="5" failures="0" errors="0" skipped="0" time="0.996">
        <testcase classname="test/senate-trading/senate-trading-repository.spec.ts" name="Senate Trading Repository &gt; upsertTrade &gt; should insert a new trade when fmp_id doesn&apos;t exist" time="0.038">
        </testcase>
        <testcase classname="test/senate-trading/senate-trading-repository.spec.ts" name="Senate Trading Repository &gt; upsertTrade &gt; should update existing trade when fmp_id exists" time="0.109">
        </testcase>
        <testcase classname="test/senate-trading/senate-trading-repository.spec.ts" name="Senate Trading Repository &gt; getTradesBySymbol &gt; should return trades for a symbol" time="0.142">
        </testcase>
        <testcase classname="test/senate-trading/senate-trading-repository.spec.ts" name="Senate Trading Repository &gt; getRecentTrades &gt; should return recent trades" time="0.115">
        </testcase>
        <testcase classname="test/senate-trading/senate-trading-repository.spec.ts" name="Senate Trading Repository &gt; getAllSenators &gt; should return unique senator names" time="0.111">
        </testcase>
    </testsuite>
    <testsuite name="test/senate-trading/user-senator-follows.spec.ts" timestamp="2026-01-01T10:46:50.913Z" hostname="sngvahmed" tests="5" failures="0" errors="0" skipped="0" time="1.171">
        <testcase classname="test/senate-trading/user-senator-follows.spec.ts" name="User Senator Follows Repository &gt; followSenator &gt; should create a follow relationship" time="0.044">
        </testcase>
        <testcase classname="test/senate-trading/user-senator-follows.spec.ts" name="User Senator Follows Repository &gt; unfollowSenator &gt; should remove a follow relationship" time="0.1">
        </testcase>
        <testcase classname="test/senate-trading/user-senator-follows.spec.ts" name="User Senator Follows Repository &gt; getUserFollows &gt; should return user&apos;s followed senators" time="0.13">
        </testcase>
        <testcase classname="test/senate-trading/user-senator-follows.spec.ts" name="User Senator Follows Repository &gt; getFollowersOfSenator &gt; should return all users following a senator" time="0.103">
        </testcase>
        <testcase classname="test/senate-trading/user-senator-follows.spec.ts" name="User Senator Follows Repository &gt; updateFollowPreferences &gt; should update follow preferences" time="0.093">
        </testcase>
    </testsuite>
    <testsuite name="test/notifications/expo-sender.spec.ts" timestamp="2026-01-01T10:46:50.914Z" hostname="sngvahmed" tests="17" failures="0" errors="0" skipped="0" time="4.38">
        <testcase classname="test/notifications/expo-sender.spec.ts" name="Expo Sender &gt; sendExpoPush &gt; should return false for invalid token" time="0.046">
        </testcase>
        <testcase classname="test/notifications/expo-sender.spec.ts" name="Expo Sender &gt; sendExpoPush &gt; should return true on successful send" time="0.093">
            <system-out>
✅ Expo Push notification sent successfully (attempt 1/3): ticket-id

            </system-out>
        </testcase>
        <testcase classname="test/notifications/expo-sender.spec.ts" name="Expo Sender &gt; sendExpoPush &gt; should retry on temporary error" time="0.237">
            <system-out>
⏳ Retrying in 200ms...

✅ Expo Push notification sent successfully (attempt 2/3): ticket-id

            </system-out>
            <system-err>
❌ Expo Push notification failed (attempt 1/3): HTTP 503: Service Unavailable

            </system-err>
        </testcase>
        <testcase classname="test/notifications/expo-sender.spec.ts" name="Expo Sender &gt; sendExpoPush &gt; should return false if all retries fail" time="0.815">
            <system-out>
⏳ Retrying in 200ms...

⏳ Retrying in 500ms...

            </system-out>
            <system-err>
❌ Expo Push notification failed (attempt 1/3): HTTP 500: Internal Server Error

❌ Expo Push notification failed (attempt 2/3): HTTP 500: Internal Server Error

❌ Expo Push notification failed (attempt 3/3): HTTP 500: Internal Server Error
🚫 Expo Push notification failed after 3 attempts. Giving up.

            </system-err>
        </testcase>
        <testcase classname="test/notifications/expo-sender.spec.ts" name="Expo Sender &gt; should handle network exception and retry" time="0.244">
            <system-out>
⏳ Retrying in 200ms...

✅ Expo Push notification sent successfully (attempt 2/3): ticket-id

            </system-out>
            <system-err>
❌ Expo Push notification failed (attempt 1/3): Network error

            </system-err>
        </testcase>
        <testcase classname="test/notifications/expo-sender.spec.ts" name="Expo Sender &gt; should handle malformed JSON response and retry" time="0.279">
            <system-out>
⏳ Retrying in 200ms...

✅ Expo Push notification sent successfully (attempt 2/3): ticket-id

            </system-out>
            <system-err>
❌ Expo Push notification failed (attempt 1/3): Invalid JSON

            </system-err>
        </testcase>
        <testcase classname="test/notifications/expo-sender.spec.ts" name="Expo Sender &gt; should retry on 429 Too Many Requests" time="0.265">
            <system-out>
⏳ Retrying in 200ms...

✅ Expo Push notification sent successfully (attempt 2/3): ticket-id

            </system-out>
            <system-err>
❌ Expo Push notification failed (attempt 1/3): HTTP 429: Too Many Requests

            </system-err>
        </testcase>
        <testcase classname="test/notifications/expo-sender.spec.ts" name="Expo Sender &gt; sendExpoPushWithLogs &gt; should return Detailed logs on success" time="0.038">
        </testcase>
        <testcase classname="test/notifications/expo-sender.spec.ts" name="Expo Sender &gt; sendExpoPushWithLogs &gt; should return error info on permanent error (DeviceNotRegistered)" time="0.035">
        </testcase>
        <testcase classname="test/notifications/expo-sender.spec.ts" name="Expo Sender &gt; sendExpoPushWithLogs &gt; should handle &quot;Message Too Big&quot; error" time="0.041">
        </testcase>
        <testcase classname="test/notifications/expo-sender.spec.ts" name="Expo Sender &gt; sendExpoPushWithLogs &gt; should handle &quot;Invalid Token&quot; error" time="0.031">
        </testcase>
        <testcase classname="test/notifications/expo-sender.spec.ts" name="Expo Sender &gt; sendExpoPushWithLogs &gt; should handle &quot;Rate Limit&quot; error from body" time="0.232">
        </testcase>
        <testcase classname="test/notifications/expo-sender.spec.ts" name="Expo Sender &gt; sendExpoPushWithLogs &gt; should handle HTTP error response parsing" time="0.229">
        </testcase>
        <testcase classname="test/notifications/expo-sender.spec.ts" name="Expo Sender &gt; sendExpoPushWithLogs &gt; should handle permanent HTTP error (401/403 implicit?) actually logic only checks message for permanent" time="0.707">
        </testcase>
        <testcase classname="test/notifications/expo-sender.spec.ts" name="Expo Sender &gt; sendExpoPushWithLogs &gt; should handle JSON parsing error" time="0.205">
        </testcase>
        <testcase classname="test/notifications/expo-sender.spec.ts" name="Expo Sender &gt; sendExpoPushWithLogs &gt; should handle missing ticket in response" time="0.703">
        </testcase>
        <testcase classname="test/notifications/expo-sender.spec.ts" name="Expo Sender &gt; sendExpoPushBatch &gt; should send multiple messages and assume optimistic success counting based on mock" time="0.003">
            <system-out>
✅ Expo Push notification sent successfully (attempt 1/3): ticket-id
✅ Expo Push notification sent successfully (attempt 1/3): ticket-id

            </system-out>
        </testcase>
    </testsuite>
    <testsuite name="test/notifications/fcm-sender.spec.ts" timestamp="2026-01-01T10:46:50.917Z" hostname="sngvahmed" tests="16" failures="0" errors="0" skipped="0" time="2.227">
        <testcase classname="test/notifications/fcm-sender.spec.ts" name="FCM Sender &gt; sendFCMNotificationWithLogs &gt; should reject invalid token format" time="0.032">
        </testcase>
        <testcase classname="test/notifications/fcm-sender.spec.ts" name="FCM Sender &gt; sendFCMNotificationWithLogs &gt; should reject null token" time="0.081">
        </testcase>
        <testcase classname="test/notifications/fcm-sender.spec.ts" name="FCM Sender &gt; sendFCMNotificationWithLogs &gt; should handle missing FCM_SERVICE_ACCOUNT" time="0.036">
        </testcase>
        <testcase classname="test/notifications/fcm-sender.spec.ts" name="FCM Sender &gt; sendFCMNotificationWithLogs &gt; should handle invalid service account JSON" time="0.076">
        </testcase>
        <testcase classname="test/notifications/fcm-sender.spec.ts" name="FCM Sender &gt; sendFCMNotificationWithLogs &gt; should handle JWT generation failure" time="0.038">
            <system-err>
Failed to get Google access token: Error: JWT generation failed
    at /home/sngvahmed/workspace/stockly/api/test/notifications/fcm-sender.spec.ts:116:54
    at home/sngvahmed/workspace/stockly/node_modules/@vitest/runner/dist/chunk-hooks.js:155:11
    at home/sngvahmed/workspace/stockly/node_modules/@vitest/runner/dist/chunk-hooks.js:752:26
    at home/sngvahmed/workspace/stockly/node_modules/@vitest/runner/dist/chunk-hooks.js:1897:20
    at new Promise (&lt;anonymous&gt;)
    at runWithTimeout (home/sngvahmed/workspace/stockly/node_modules/@vitest/runner/dist/chunk-hooks.js:1863:10)
    at runTest (home/sngvahmed/workspace/stockly/node_modules/@vitest/runner/dist/chunk-hooks.js:1574:12)
    at runSuite (home/sngvahmed/workspace/stockly/node_modules/@vitest/runner/dist/chunk-hooks.js:1729:8)
    at runSuite (home/sngvahmed/workspace/stockly/node_modules/@vitest/runner/dist/chunk-hooks.js:1729:8)
    at runSuite (home/sngvahmed/workspace/stockly/node_modules/@vitest/runner/dist/chunk-hooks.js:1729:8)

            </system-err>
        </testcase>
        <testcase classname="test/notifications/fcm-sender.spec.ts" name="FCM Sender &gt; sendFCMNotificationWithLogs &gt; should handle access token exchange failure" time="0.06">
            <system-err>
Failed to get Google access token: Error: Token exchange failed
    at /home/sngvahmed/workspace/stockly/api/test/notifications/fcm-sender.spec.ts:133:9
    at home/sngvahmed/workspace/stockly/node_modules/@vitest/runner/dist/chunk-hooks.js:155:11
    at home/sngvahmed/workspace/stockly/node_modules/@vitest/runner/dist/chunk-hooks.js:752:26
    at home/sngvahmed/workspace/stockly/node_modules/@vitest/runner/dist/chunk-hooks.js:1897:20
    at new Promise (&lt;anonymous&gt;)
    at runWithTimeout (home/sngvahmed/workspace/stockly/node_modules/@vitest/runner/dist/chunk-hooks.js:1863:10)
    at runTest (home/sngvahmed/workspace/stockly/node_modules/@vitest/runner/dist/chunk-hooks.js:1574:12)
    at runSuite (home/sngvahmed/workspace/stockly/node_modules/@vitest/runner/dist/chunk-hooks.js:1729:8)
    at runSuite (home/sngvahmed/workspace/stockly/node_modules/@vitest/runner/dist/chunk-hooks.js:1729:8)
    at runSuite (home/sngvahmed/workspace/stockly/node_modules/@vitest/runner/dist/chunk-hooks.js:1729:8)

            </system-err>
        </testcase>
        <testcase classname="test/notifications/fcm-sender.spec.ts" name="FCM Sender &gt; sendFCMNotificationWithLogs &gt; should send notification successfully" time="0.031">
        </testcase>
        <testcase classname="test/notifications/fcm-sender.spec.ts" name="FCM Sender &gt; sendFCMNotificationWithLogs &gt; should retry on temporary errors" time="0.262">
            <system-err>
{&quot;timestamp&quot;:&quot;2026-01-01T10:46:47.475Z&quot;,&quot;service&quot;:&quot;stockly-api-test&quot;,&quot;level&quot;:&quot;ERROR&quot;,&quot;traceId&quot;:&quot;test-trace-id&quot;,&quot;userId&quot;:null,&quot;path&quot;:&quot;/test&quot;,&quot;message&quot;:&quot;FCM push notification failed&quot;,&quot;type&quot;:&quot;fcm_error&quot;,&quot;fcmErrorCode&quot;:&quot;14&quot;,&quot;fcmErrorType&quot;:&quot;UNAVAILABLE&quot;,&quot;isPermanent&quot;:false,&quot;shouldCleanupToken&quot;:false,&quot;requestPayload&quot;:{&quot;token&quot;:&quot;dXXXXXXXXXXXXXXXXXXXXXXXXXXXXX...&quot;,&quot;title&quot;:&quot;Test Title&quot;,&quot;body&quot;:&quot;Test Body&quot;,&quot;dataKeys&quot;:[&quot;alertId&quot;]},&quot;errorMessage&quot;:&quot;Service unavailable&quot;}

            </system-err>
        </testcase>
        <testcase classname="test/notifications/fcm-sender.spec.ts" name="FCM Sender &gt; sendFCMNotificationWithLogs &gt; should not retry on permanent errors" time="0.058">
            <system-err>
{&quot;timestamp&quot;:&quot;2026-01-01T10:46:47.731Z&quot;,&quot;service&quot;:&quot;stockly-api-test&quot;,&quot;level&quot;:&quot;ERROR&quot;,&quot;traceId&quot;:&quot;test-trace-id&quot;,&quot;userId&quot;:null,&quot;path&quot;:&quot;/test&quot;,&quot;message&quot;:&quot;FCM push notification failed&quot;,&quot;type&quot;:&quot;fcm_error&quot;,&quot;fcmErrorCode&quot;:&quot;5&quot;,&quot;fcmErrorType&quot;:&quot;NOT_FOUND&quot;,&quot;isPermanent&quot;:true,&quot;shouldCleanupToken&quot;:true,&quot;requestPayload&quot;:{&quot;token&quot;:&quot;dXXXXXXXXXXXXXXXXXXXXXXXXXXXXX...&quot;,&quot;title&quot;:&quot;Test Title&quot;,&quot;body&quot;:&quot;Test Body&quot;,&quot;dataKeys&quot;:[&quot;alertId&quot;]},&quot;errorMessage&quot;:&quot;Token not found&quot;}

            </system-err>
        </testcase>
        <testcase classname="test/notifications/fcm-sender.spec.ts" name="FCM Sender &gt; sendFCMNotificationWithLogs &gt; should log FCM errors" time="0.032">
            <system-err>
{&quot;timestamp&quot;:&quot;2026-01-01T10:46:47.771Z&quot;,&quot;service&quot;:&quot;stockly-api-test&quot;,&quot;level&quot;:&quot;ERROR&quot;,&quot;traceId&quot;:&quot;test-trace-id&quot;,&quot;userId&quot;:null,&quot;path&quot;:&quot;/test&quot;,&quot;message&quot;:&quot;FCM push notification failed&quot;,&quot;type&quot;:&quot;fcm_error&quot;,&quot;fcmErrorCode&quot;:&quot;3&quot;,&quot;fcmErrorType&quot;:&quot;INVALID_ARGUMENT&quot;,&quot;isPermanent&quot;:true,&quot;shouldCleanupToken&quot;:true,&quot;requestPayload&quot;:{&quot;token&quot;:&quot;dXXXXXXXXXXXXXXXXXXXXXXXXXXXXX...&quot;,&quot;title&quot;:&quot;Test Title&quot;,&quot;body&quot;:&quot;Test Body&quot;,&quot;dataKeys&quot;:[&quot;alertId&quot;]},&quot;errorMessage&quot;:&quot;Invalid token&quot;}

            </system-err>
        </testcase>
        <testcase classname="test/notifications/fcm-sender.spec.ts" name="FCM Sender &gt; sendFCMNotificationWithLogs &gt; should handle &quot;Permission Denied&quot; error" time="0.027">
            <system-err>
{&quot;timestamp&quot;:&quot;2026-01-01T10:46:47.799Z&quot;,&quot;service&quot;:&quot;stockly-api-test&quot;,&quot;level&quot;:&quot;ERROR&quot;,&quot;traceId&quot;:&quot;test-trace-id&quot;,&quot;userId&quot;:null,&quot;path&quot;:&quot;/test&quot;,&quot;message&quot;:&quot;FCM push notification failed&quot;,&quot;type&quot;:&quot;fcm_error&quot;,&quot;fcmErrorCode&quot;:&quot;7&quot;,&quot;fcmErrorType&quot;:&quot;PERMISSION_DENIED&quot;,&quot;isPermanent&quot;:true,&quot;shouldCleanupToken&quot;:false,&quot;requestPayload&quot;:{&quot;token&quot;:&quot;dXXXXXXXXXXXXXXXXXXXXXXXXXXXXX...&quot;,&quot;title&quot;:&quot;Test Title&quot;,&quot;body&quot;:&quot;Test Body&quot;,&quot;dataKeys&quot;:[&quot;alertId&quot;]},&quot;errorMessage&quot;:&quot;Permission denied&quot;}

            </system-err>
        </testcase>
        <testcase classname="test/notifications/fcm-sender.spec.ts" name="FCM Sender &gt; sendFCMNotificationWithLogs &gt; should handle &quot;Resource Exhausted&quot; error" time="0.712">
            <system-err>
{&quot;timestamp&quot;:&quot;2026-01-01T10:46:47.828Z&quot;,&quot;service&quot;:&quot;stockly-api-test&quot;,&quot;level&quot;:&quot;ERROR&quot;,&quot;traceId&quot;:&quot;test-trace-id&quot;,&quot;userId&quot;:null,&quot;path&quot;:&quot;/test&quot;,&quot;message&quot;:&quot;FCM push notification failed&quot;,&quot;type&quot;:&quot;fcm_error&quot;,&quot;fcmErrorCode&quot;:&quot;8&quot;,&quot;fcmErrorType&quot;:&quot;RESOURCE_EXHAUSTED&quot;,&quot;isPermanent&quot;:false,&quot;shouldCleanupToken&quot;:false,&quot;requestPayload&quot;:{&quot;token&quot;:&quot;dXXXXXXXXXXXXXXXXXXXXXXXXXXXXX...&quot;,&quot;title&quot;:&quot;Test Title&quot;,&quot;body&quot;:&quot;Test Body&quot;,&quot;dataKeys&quot;:[&quot;alertId&quot;]},&quot;errorMessage&quot;:&quot;Quota exceeded&quot;}

{&quot;timestamp&quot;:&quot;2026-01-01T10:46:48.029Z&quot;,&quot;service&quot;:&quot;stockly-api-test&quot;,&quot;level&quot;:&quot;ERROR&quot;,&quot;traceId&quot;:&quot;test-trace-id&quot;,&quot;userId&quot;:null,&quot;path&quot;:&quot;/test&quot;,&quot;message&quot;:&quot;FCM push notification failed&quot;,&quot;type&quot;:&quot;fcm_error&quot;,&quot;fcmErrorCode&quot;:&quot;8&quot;,&quot;fcmErrorType&quot;:&quot;RESOURCE_EXHAUSTED&quot;,&quot;isPermanent&quot;:false,&quot;shouldCleanupToken&quot;:false,&quot;requestPayload&quot;:{&quot;token&quot;:&quot;dXXXXXXXXXXXXXXXXXXXXXXXXXXXXX...&quot;,&quot;title&quot;:&quot;Test Title&quot;,&quot;body&quot;:&quot;Test Body&quot;,&quot;dataKeys&quot;:[&quot;alertId&quot;]},&quot;errorMessage&quot;:&quot;Quota exceeded&quot;}

{&quot;timestamp&quot;:&quot;2026-01-01T10:46:48.529Z&quot;,&quot;service&quot;:&quot;stockly-api-test&quot;,&quot;level&quot;:&quot;ERROR&quot;,&quot;traceId&quot;:&quot;test-trace-id&quot;,&quot;userId&quot;:null,&quot;path&quot;:&quot;/test&quot;,&quot;message&quot;:&quot;FCM push notification failed&quot;,&quot;type&quot;:&quot;fcm_error&quot;,&quot;fcmErrorCode&quot;:&quot;8&quot;,&quot;fcmErrorType&quot;:&quot;RESOURCE_EXHAUSTED&quot;,&quot;isPermanent&quot;:false,&quot;shouldCleanupToken&quot;:false,&quot;requestPayload&quot;:{&quot;token&quot;:&quot;dXXXXXXXXXXXXXXXXXXXXXXXXXXXXX...&quot;,&quot;title&quot;:&quot;Test Title&quot;,&quot;body&quot;:&quot;Test Body&quot;,&quot;dataKeys&quot;:[&quot;alertId&quot;]},&quot;errorMessage&quot;:&quot;Quota exceeded&quot;}

            </system-err>
        </testcase>
        <testcase classname="test/notifications/fcm-sender.spec.ts" name="FCM Sender &gt; sendFCMNotificationWithLogs &gt; should handle invalid JSON response from FCM" time="0.705">
            <system-err>
{&quot;timestamp&quot;:&quot;2026-01-01T10:46:48.535Z&quot;,&quot;service&quot;:&quot;stockly-api-test&quot;,&quot;level&quot;:&quot;ERROR&quot;,&quot;traceId&quot;:&quot;test-trace-id&quot;,&quot;userId&quot;:null,&quot;path&quot;:&quot;/test&quot;,&quot;message&quot;:&quot;FCM push notification failed&quot;,&quot;type&quot;:&quot;fcm_error&quot;,&quot;fcmErrorCode&quot;:&quot;500&quot;,&quot;fcmErrorType&quot;:&quot;UNKNOWN_ERROR&quot;,&quot;isPermanent&quot;:false,&quot;shouldCleanupToken&quot;:false,&quot;requestPayload&quot;:{&quot;token&quot;:&quot;dXXXXXXXXXXXXXXXXXXXXXXXXXXXXX...&quot;,&quot;title&quot;:&quot;Test Title&quot;,&quot;body&quot;:&quot;Test Body&quot;,&quot;dataKeys&quot;:[&quot;alertId&quot;]},&quot;errorMessage&quot;:&quot;Internal Server Error&quot;}

{&quot;timestamp&quot;:&quot;2026-01-01T10:46:48.736Z&quot;,&quot;service&quot;:&quot;stockly-api-test&quot;,&quot;level&quot;:&quot;ERROR&quot;,&quot;traceId&quot;:&quot;test-trace-id&quot;,&quot;userId&quot;:null,&quot;path&quot;:&quot;/test&quot;,&quot;message&quot;:&quot;FCM push notification failed&quot;,&quot;type&quot;:&quot;fcm_error&quot;,&quot;fcmErrorCode&quot;:&quot;500&quot;,&quot;fcmErrorType&quot;:&quot;UNKNOWN_ERROR&quot;,&quot;isPermanent&quot;:false,&quot;shouldCleanupToken&quot;:false,&quot;requestPayload&quot;:{&quot;token&quot;:&quot;dXXXXXXXXXXXXXXXXXXXXXXXXXXXXX...&quot;,&quot;title&quot;:&quot;Test Title&quot;,&quot;body&quot;:&quot;Test Body&quot;,&quot;dataKeys&quot;:[&quot;alertId&quot;]},&quot;errorMessage&quot;:&quot;Internal Server Error&quot;}

{&quot;timestamp&quot;:&quot;2026-01-01T10:46:49.236Z&quot;,&quot;service&quot;:&quot;stockly-api-test&quot;,&quot;level&quot;:&quot;ERROR&quot;,&quot;traceId&quot;:&quot;test-trace-id&quot;,&quot;userId&quot;:null,&quot;path&quot;:&quot;/test&quot;,&quot;message&quot;:&quot;FCM push notification failed&quot;,&quot;type&quot;:&quot;fcm_error&quot;,&quot;fcmErrorCode&quot;:&quot;500&quot;,&quot;fcmErrorType&quot;:&quot;UNKNOWN_ERROR&quot;,&quot;isPermanent&quot;:false,&quot;shouldCleanupToken&quot;:false,&quot;requestPayload&quot;:{&quot;token&quot;:&quot;dXXXXXXXXXXXXXXXXXXXXXXXXXXXXX...&quot;,&quot;title&quot;:&quot;Test Title&quot;,&quot;body&quot;:&quot;Test Body&quot;,&quot;dataKeys&quot;:[&quot;alertId&quot;]},&quot;errorMessage&quot;:&quot;Internal Server Error&quot;}

            </system-err>
        </testcase>
        <testcase classname="test/notifications/fcm-sender.spec.ts" name="FCM Sender &gt; sendFCMNotificationWithLogs &gt; should convert data values to strings" time="0.003">
        </testcase>
        <testcase classname="test/notifications/fcm-sender.spec.ts" name="FCM Sender &gt; sendFCMNotification &gt; should return true on success" time="0.002">
        </testcase>
        <testcase classname="test/notifications/fcm-sender.spec.ts" name="FCM Sender &gt; sendFCMNotification &gt; should return false on failure" time="0.002">
            <system-err>
{&quot;timestamp&quot;:&quot;2026-01-01T10:46:49.246Z&quot;,&quot;service&quot;:&quot;stockly-api-test&quot;,&quot;level&quot;:&quot;ERROR&quot;,&quot;traceId&quot;:&quot;test-trace-id&quot;,&quot;userId&quot;:null,&quot;path&quot;:&quot;/test&quot;,&quot;message&quot;:&quot;FCM push notification failed&quot;,&quot;type&quot;:&quot;fcm_error&quot;,&quot;fcmErrorCode&quot;:&quot;3&quot;,&quot;fcmErrorType&quot;:&quot;INVALID_ARGUMENT&quot;,&quot;isPermanent&quot;:true,&quot;shouldCleanupToken&quot;:true,&quot;requestPayload&quot;:{&quot;token&quot;:&quot;dXXXXXXXXXXXXXXXXXXXXXXXXXXXXX...&quot;,&quot;title&quot;:&quot;Title&quot;,&quot;body&quot;:&quot;Body&quot;,&quot;dataKeys&quot;:[]},&quot;errorMessage&quot;:&quot;Invalid token&quot;}

            </system-err>
        </testcase>
    </testsuite>
    <testsuite name="test/notifications/jwt-helper.spec.ts" timestamp="2026-01-01T10:46:50.922Z" hostname="sngvahmed" tests="10" failures="0" errors="0" skipped="0" time="1.318">
        <testcase classname="test/notifications/jwt-helper.spec.ts" name="JWT Helper &gt; generateGoogleJWT &gt; should generate JWT with correct structure" time="0.028">
        </testcase>
        <testcase classname="test/notifications/jwt-helper.spec.ts" name="JWT Helper &gt; generateGoogleJWT &gt; should include correct header" time="0.109">
        </testcase>
        <testcase classname="test/notifications/jwt-helper.spec.ts" name="JWT Helper &gt; generateGoogleJWT &gt; should include correct payload" time="0.1">
        </testcase>
        <testcase classname="test/notifications/jwt-helper.spec.ts" name="JWT Helper &gt; generateGoogleJWT &gt; should use custom scope" time="0.1">
        </testcase>
        <testcase classname="test/notifications/jwt-helper.spec.ts" name="JWT Helper &gt; generateGoogleJWT &gt; should handle PEM key parsing" time="0.131">
        </testcase>
        <testcase classname="test/notifications/jwt-helper.spec.ts" name="JWT Helper &gt; generateGoogleJWT &gt; should sign with RSASSA-PKCS1-v1_5" time="0.114">
        </testcase>
        <testcase classname="test/notifications/jwt-helper.spec.ts" name="JWT Helper &gt; getGoogleAccessTokenFromJWT &gt; should exchange JWT for access token" time="0.052">
        </testcase>
        <testcase classname="test/notifications/jwt-helper.spec.ts" name="JWT Helper &gt; getGoogleAccessTokenFromJWT &gt; should handle non-ok response" time="0.122">
        </testcase>
        <testcase classname="test/notifications/jwt-helper.spec.ts" name="JWT Helper &gt; getGoogleAccessTokenFromJWT &gt; should handle missing access_token in response" time="0.097">
        </testcase>
        <testcase classname="test/notifications/jwt-helper.spec.ts" name="JWT Helper &gt; getGoogleAccessTokenFromJWT &gt; should handle network errors" time="0.094">
        </testcase>
    </testsuite>
    <testsuite name="src/__tests__/integration/dividend.integration.test.ts" timestamp="2026-01-01T10:46:50.924Z" hostname="sngvahmed" tests="5" failures="0" errors="0" skipped="5" time="0">
        <testcase classname="src/__tests__/integration/dividend.integration.test.ts" name="Dividend Integration Tests &gt; Real FMP API Calls &gt; should fetch dividend data for KO (high dividend stock)" time="0">
            <skipped/>
        </testcase>
        <testcase classname="src/__tests__/integration/dividend.integration.test.ts" name="Dividend Integration Tests &gt; Real FMP API Calls &gt; should calculate DGR for KO" time="0">
            <skipped/>
        </testcase>
        <testcase classname="src/__tests__/integration/dividend.integration.test.ts" name="Dividend Integration Tests &gt; Real FMP API Calls &gt; should calculate projection for KO" time="0">
            <skipped/>
        </testcase>
        <testcase classname="src/__tests__/integration/dividend.integration.test.ts" name="Dividend Integration Tests &gt; Real FMP API Calls &gt; should handle stock with no dividends (BRK.A)" time="0">
            <skipped/>
        </testcase>
        <testcase classname="src/__tests__/integration/dividend.integration.test.ts" name="Dividend Integration Tests &gt; Real FMP API Calls &gt; should handle stock with low dividends (AAPL)" time="0">
            <skipped/>
        </testcase>
    </testsuite>
    <testsuite name="src/api/__tests__/config.test.ts" timestamp="2026-01-01T10:46:50.925Z" hostname="sngvahmed" tests="9" failures="0" errors="0" skipped="0" time="1.064">
        <testcase classname="src/api/__tests__/config.test.ts" name="Config &gt; getConfig &gt; should return default config with newsTtlSec and prefetchCronInterval" time="0.046">
        </testcase>
        <testcase classname="src/api/__tests__/config.test.ts" name="Config &gt; getConfig &gt; should merge partial marketCache updates with defaults" time="0.143">
        </testcase>
        <testcase classname="src/api/__tests__/config.test.ts" name="Config &gt; getConfig &gt; should preserve all marketCache fields when fully specified" time="0.131">
        </testcase>
        <testcase classname="src/api/__tests__/config.test.ts" name="Config &gt; getConfig &gt; should handle missing marketCache in stored config" time="0.081">
        </testcase>
        <testcase classname="src/api/__tests__/config.test.ts" name="Config &gt; updateConfig &gt; should update only newsTtlSec in marketCache" time="0.048">
        </testcase>
        <testcase classname="src/api/__tests__/config.test.ts" name="Config &gt; updateConfig &gt; should update only prefetchCronInterval in marketCache" time="0.079">
        </testcase>
        <testcase classname="src/api/__tests__/config.test.ts" name="Config &gt; updateConfig &gt; should update all marketCache fields" time="0.049">
        </testcase>
        <testcase classname="src/api/__tests__/config.test.ts" name="Config &gt; updateConfig &gt; should merge marketCache with existing values" time="0.077">
        </testcase>
        <testcase classname="src/api/__tests__/config.test.ts" name="Config &gt; updateConfig &gt; should work without KV (fallback mode)" time="0.051">
            <system-err>
alertsKv not available, cannot update config

            </system-err>
        </testcase>
    </testsuite>
    <testsuite name="src/api/__tests__/market-cache.test.ts" timestamp="2026-01-01T10:46:50.926Z" hostname="sngvahmed" tests="9" failures="0" errors="0" skipped="0" time="1.174">
        <testcase classname="src/api/__tests__/market-cache.test.ts" name="Market Cache Helper &gt; getMarketDataFromKV &gt; should return cached data when cache is valid" time="0.044">
        </testcase>
        <testcase classname="src/api/__tests__/market-cache.test.ts" name="Market Cache Helper &gt; getMarketDataFromKV &gt; should return null when cache is expired" time="0.11">
        </testcase>
        <testcase classname="src/api/__tests__/market-cache.test.ts" name="Market Cache Helper &gt; getMarketDataFromKV &gt; should return null when cache does not exist" time="0.139">
        </testcase>
        <testcase classname="src/api/__tests__/market-cache.test.ts" name="Market Cache Helper &gt; getMarketDataFromKV &gt; should return null when cache entry is invalid JSON" time="0.138">
            <system-err>
[Market Cache] Failed to read cache for key market:gainers: TypeError: Cannot read properties of undefined (reading &apos;workingHours&apos;)
    at shouldSkipKvOperations (/home/sngvahmed/workspace/stockly/api/src/utils/kv-working-hours.ts:16:31)
    at kvGetWithWorkingHours (/home/sngvahmed/workspace/stockly/api/src/utils/kv-working-hours.ts:44:7)
    at getMarketDataFromKV (/home/sngvahmed/workspace/stockly/api/src/api/market-cache.ts:30:23)
    at /home/sngvahmed/workspace/stockly/api/src/api/__tests__/market-cache.test.ts:116:28
    at home/sngvahmed/workspace/stockly/node_modules/@vitest/runner/dist/chunk-hooks.js:155:11
    at home/sngvahmed/workspace/stockly/node_modules/@vitest/runner/dist/chunk-hooks.js:752:26
    at home/sngvahmed/workspace/stockly/node_modules/@vitest/runner/dist/chunk-hooks.js:1897:20
    at new Promise (&lt;anonymous&gt;)
    at runWithTimeout (home/sngvahmed/workspace/stockly/node_modules/@vitest/runner/dist/chunk-hooks.js:1863:10)
    at runTest (home/sngvahmed/workspace/stockly/node_modules/@vitest/runner/dist/chunk-hooks.js:1574:12)

            </system-err>
        </testcase>
        <testcase classname="src/api/__tests__/market-cache.test.ts" name="Market Cache Helper &gt; getMarketDataFromKV &gt; should return null when cache entry is missing required fields" time="0.114">
            <system-err>
[Market Cache] Failed to read cache for key market:gainers: TypeError: Cannot read properties of undefined (reading &apos;workingHours&apos;)
    at shouldSkipKvOperations (/home/sngvahmed/workspace/stockly/api/src/utils/kv-working-hours.ts:16:31)
    at kvGetWithWorkingHours (/home/sngvahmed/workspace/stockly/api/src/utils/kv-working-hours.ts:44:7)
    at getMarketDataFromKV (/home/sngvahmed/workspace/stockly/api/src/api/market-cache.ts:30:23)
    at /home/sngvahmed/workspace/stockly/api/src/api/__tests__/market-cache.test.ts:132:28
    at home/sngvahmed/workspace/stockly/node_modules/@vitest/runner/dist/chunk-hooks.js:155:11
    at home/sngvahmed/workspace/stockly/node_modules/@vitest/runner/dist/chunk-hooks.js:752:26
    at home/sngvahmed/workspace/stockly/node_modules/@vitest/runner/dist/chunk-hooks.js:1897:20
    at new Promise (&lt;anonymous&gt;)
    at runWithTimeout (home/sngvahmed/workspace/stockly/node_modules/@vitest/runner/dist/chunk-hooks.js:1863:10)
    at runTest (home/sngvahmed/workspace/stockly/node_modules/@vitest/runner/dist/chunk-hooks.js:1574:12)

            </system-err>
        </testcase>
        <testcase classname="src/api/__tests__/market-cache.test.ts" name="Market Cache Helper &gt; setMarketDataToKV &gt; should store data in KV with correct TTL metadata" time="0.091">
        </testcase>
        <testcase classname="src/api/__tests__/market-cache.test.ts" name="Market Cache Helper &gt; setMarketDataToKV &gt; should handle different TTL values" time="0.09">
        </testcase>
        <testcase classname="src/api/__tests__/market-cache.test.ts" name="Market Cache Helper &gt; setMarketDataToKV &gt; should handle empty array data" time="0.045">
        </testcase>
        <testcase classname="src/api/__tests__/market-cache.test.ts" name="Market Cache Helper &gt; setMarketDataToKV &gt; should handle large arrays of data" time="0.094">
        </testcase>
    </testsuite>
    <testsuite name="src/api/__tests__/news-cache.test.ts" timestamp="2026-01-01T10:46:50.927Z" hostname="sngvahmed" tests="11" failures="0" errors="0" skipped="0" time="1.218">
        <testcase classname="src/api/__tests__/news-cache.test.ts" name="News Cache Helper &gt; getNewsDataFromKV &gt; should return cached data when cache is valid" time="0.056">
        </testcase>
        <testcase classname="src/api/__tests__/news-cache.test.ts" name="News Cache Helper &gt; getNewsDataFromKV &gt; should return null when cache is expired" time="0.137">
        </testcase>
        <testcase classname="src/api/__tests__/news-cache.test.ts" name="News Cache Helper &gt; getNewsDataFromKV &gt; should return null when cache does not exist" time="0.125">
        </testcase>
        <testcase classname="src/api/__tests__/news-cache.test.ts" name="News Cache Helper &gt; getNewsDataFromKV &gt; should return null when cache entry is invalid JSON" time="0.109">
            <system-err>
[News Cache] Failed to read cache for key news:general:latest: SyntaxError: Unexpected token &apos;i&apos;, &quot;invalid json&quot; is not valid JSON
    at JSON.parse (&lt;anonymous&gt;)
    at getNewsDataFromKV (/home/sngvahmed/workspace/stockly/api/src/api/news-cache.ts:39:24)
    at /home/sngvahmed/workspace/stockly/api/src/api/__tests__/news-cache.test.ts:129:22
    at home/sngvahmed/workspace/stockly/node_modules/@vitest/runner/dist/chunk-hooks.js:752:20

            </system-err>
        </testcase>
        <testcase classname="src/api/__tests__/news-cache.test.ts" name="News Cache Helper &gt; getNewsDataFromKV &gt; should return null when cache entry is missing required fields" time="0.171">
        </testcase>
        <testcase classname="src/api/__tests__/news-cache.test.ts" name="News Cache Helper &gt; getNewsDataFromKV &gt; should return null when cache entry is missing news array" time="0.046">
        </testcase>
        <testcase classname="src/api/__tests__/news-cache.test.ts" name="News Cache Helper &gt; setNewsDataToKV &gt; should store data in KV with correct TTL metadata" time="0.05">
        </testcase>
        <testcase classname="src/api/__tests__/news-cache.test.ts" name="News Cache Helper &gt; setNewsDataToKV &gt; should handle different TTL values" time="0.071">
        </testcase>
        <testcase classname="src/api/__tests__/news-cache.test.ts" name="News Cache Helper &gt; setNewsDataToKV &gt; should handle empty array data" time="0.082">
        </testcase>
        <testcase classname="src/api/__tests__/news-cache.test.ts" name="News Cache Helper &gt; setNewsDataToKV &gt; should handle large arrays of news" time="0.041">
        </testcase>
        <testcase classname="src/api/__tests__/news-cache.test.ts" name="News Cache Helper &gt; setNewsDataToKV &gt; should not throw when KV write fails" time="0.075">
            <system-err>
[News Cache] Failed to write cache for key news:general:latest: Error: KV write failed
    at /home/sngvahmed/workspace/stockly/api/src/api/__tests__/news-cache.test.ts:290:47
    at home/sngvahmed/workspace/stockly/node_modules/@vitest/runner/dist/chunk-hooks.js:155:11
    at home/sngvahmed/workspace/stockly/node_modules/@vitest/runner/dist/chunk-hooks.js:752:26
    at home/sngvahmed/workspace/stockly/node_modules/@vitest/runner/dist/chunk-hooks.js:1897:20
    at new Promise (&lt;anonymous&gt;)
    at runWithTimeout (home/sngvahmed/workspace/stockly/node_modules/@vitest/runner/dist/chunk-hooks.js:1863:10)
    at runTest (home/sngvahmed/workspace/stockly/node_modules/@vitest/runner/dist/chunk-hooks.js:1574:12)
    at runSuite (home/sngvahmed/workspace/stockly/node_modules/@vitest/runner/dist/chunk-hooks.js:1729:8)
    at runSuite (home/sngvahmed/workspace/stockly/node_modules/@vitest/runner/dist/chunk-hooks.js:1729:8)
    at runSuite (home/sngvahmed/workspace/stockly/node_modules/@vitest/runner/dist/chunk-hooks.js:1729:8)

            </system-err>
        </testcase>
    </testsuite>
    <testsuite name="src/cron/__tests__/market-prefetch-cron.test.ts" timestamp="2026-01-01T10:46:50.929Z" hostname="sngvahmed" tests="7" failures="0" errors="0" skipped="0" time="0.426">
        <testcase classname="src/cron/__tests__/market-prefetch-cron.test.ts" name="Market Prefetch Cron &gt; should prefetch all market data and news successfully" time="0.048">
        </testcase>
        <testcase classname="src/cron/__tests__/market-prefetch-cron.test.ts" name="Market Prefetch Cron &gt; should log configured cron interval" time="0.076">
        </testcase>
        <testcase classname="src/cron/__tests__/market-prefetch-cron.test.ts" name="Market Prefetch Cron &gt; should handle individual failures gracefully" time="0.039">
        </testcase>
        <testcase classname="src/cron/__tests__/market-prefetch-cron.test.ts" name="Market Prefetch Cron &gt; should log success/failure counts" time="0.067">
        </testcase>
        <testcase classname="src/cron/__tests__/market-prefetch-cron.test.ts" name="Market Prefetch Cron &gt; should use default cron interval when not configured" time="0.035">
        </testcase>
        <testcase classname="src/cron/__tests__/market-prefetch-cron.test.ts" name="Market Prefetch Cron &gt; should handle all failures and still complete" time="0.064">
        </testcase>
        <testcase classname="src/cron/__tests__/market-prefetch-cron.test.ts" name="Market Prefetch Cron &gt; should work without ExecutionContext" time="0.03">
        </testcase>
    </testsuite>
    <testsuite name="src/controllers/__tests__/alerts.controller.test.ts" timestamp="2026-01-01T10:46:50.930Z" hostname="sngvahmed" tests="10" failures="0" errors="0" skipped="0" time="0.356">
        <testcase classname="src/controllers/__tests__/alerts.controller.test.ts" name="AlertController &gt; listAlerts &gt; should return list of alerts for authenticated user" time="0.04">
        </testcase>
        <testcase classname="src/controllers/__tests__/alerts.controller.test.ts" name="AlertController &gt; listAlerts &gt; should return empty list when no alerts found" time="0.03">
        </testcase>
        <testcase classname="src/controllers/__tests__/alerts.controller.test.ts" name="AlertController &gt; getAlert &gt; should return alert when found" time="0.031">
        </testcase>
        <testcase classname="src/controllers/__tests__/alerts.controller.test.ts" name="AlertController &gt; getAlert &gt; should return 404 when alert not found" time="0.026">
        </testcase>
        <testcase classname="src/controllers/__tests__/alerts.controller.test.ts" name="AlertController &gt; createAlert &gt; should create alert and return it" time="0.033">
        </testcase>
        <testcase classname="src/controllers/__tests__/alerts.controller.test.ts" name="AlertController &gt; createAlert &gt; should return 400 for invalid request data" time="0.02">
        </testcase>
        <testcase classname="src/controllers/__tests__/alerts.controller.test.ts" name="AlertController &gt; updateAlert &gt; should update alert and return it" time="0.014">
        </testcase>
        <testcase classname="src/controllers/__tests__/alerts.controller.test.ts" name="AlertController &gt; updateAlert &gt; should return 404 when alert not found" time="0.013">
        </testcase>
        <testcase classname="src/controllers/__tests__/alerts.controller.test.ts" name="AlertController &gt; deleteAlert &gt; should delete alert and return success" time="0.012">
        </testcase>
        <testcase classname="src/controllers/__tests__/alerts.controller.test.ts" name="AlertController &gt; deleteAlert &gt; should return 404 when alert not found" time="0.009">
        </testcase>
    </testsuite>
    <testsuite name="src/controllers/__tests__/common-stocks.controller.test.ts" timestamp="2026-01-01T10:46:50.932Z" hostname="sngvahmed" tests="14" failures="0" errors="0" skipped="0" time="0.67">
        <testcase classname="src/controllers/__tests__/common-stocks.controller.test.ts" name="CommonStocksController &gt; getCommonStocks &gt; should return common stocks list successfully (active only)" time="0.036">
        </testcase>
        <testcase classname="src/controllers/__tests__/common-stocks.controller.test.ts" name="CommonStocksController &gt; getCommonStocks &gt; should return all stocks (including inactive) when activeOnly=false" time="0.038">
        </testcase>
        <testcase classname="src/controllers/__tests__/common-stocks.controller.test.ts" name="CommonStocksController &gt; getCommonStocks &gt; should return 401 when not authenticated as admin" time="0.053">
        </testcase>
        <testcase classname="src/controllers/__tests__/common-stocks.controller.test.ts" name="CommonStocksController &gt; getCommonStocks &gt; should return 500 when service throws error" time="0.039">
        </testcase>
        <testcase classname="src/controllers/__tests__/common-stocks.controller.test.ts" name="CommonStocksController &gt; addCommonStock &gt; should add a new stock successfully" time="0.03">
        </testcase>
        <testcase classname="src/controllers/__tests__/common-stocks.controller.test.ts" name="CommonStocksController &gt; addCommonStock &gt; should return 400 for invalid request body" time="0.027">
        </testcase>
        <testcase classname="src/controllers/__tests__/common-stocks.controller.test.ts" name="CommonStocksController &gt; addCommonStock &gt; should return 401 when not authenticated as admin" time="0.034">
        </testcase>
        <testcase classname="src/controllers/__tests__/common-stocks.controller.test.ts" name="CommonStocksController &gt; updateCommonStock &gt; should update a stock successfully" time="0.032">
        </testcase>
        <testcase classname="src/controllers/__tests__/common-stocks.controller.test.ts" name="CommonStocksController &gt; updateCommonStock &gt; should return 404 when stock not found" time="0.035">
        </testcase>
        <testcase classname="src/controllers/__tests__/common-stocks.controller.test.ts" name="CommonStocksController &gt; deleteCommonStock &gt; should delete (deactivate) a stock successfully" time="0.027">
        </testcase>
        <testcase classname="src/controllers/__tests__/common-stocks.controller.test.ts" name="CommonStocksController &gt; deleteCommonStock &gt; should return 404 when stock not found" time="0.024">
        </testcase>
        <testcase classname="src/controllers/__tests__/common-stocks.controller.test.ts" name="CommonStocksController &gt; bulkAddCommonStocks &gt; should bulk add stocks successfully" time="0.032">
        </testcase>
        <testcase classname="src/controllers/__tests__/common-stocks.controller.test.ts" name="CommonStocksController &gt; bulkAddCommonStocks &gt; should handle partial success with errors" time="0.026">
        </testcase>
        <testcase classname="src/controllers/__tests__/common-stocks.controller.test.ts" name="CommonStocksController &gt; bulkAddCommonStocks &gt; should return 400 for invalid request body" time="0.026">
        </testcase>
    </testsuite>
    <testsuite name="src/controllers/__tests__/dividend.controller.test.ts" timestamp="2026-01-01T10:46:50.933Z" hostname="sngvahmed" tests="9" failures="0" errors="0" skipped="0" time="1.116">
        <testcase classname="src/controllers/__tests__/dividend.controller.test.ts" name="DividendController &gt; getDividendData &gt; should return dividend data successfully" time="0.045">
        </testcase>
        <testcase classname="src/controllers/__tests__/dividend.controller.test.ts" name="DividendController &gt; getDividendData &gt; should return 400 if symbol is missing" time="0.109">
        </testcase>
        <testcase classname="src/controllers/__tests__/dividend.controller.test.ts" name="DividendController &gt; getDividendData &gt; should return 400 if symbol is too long" time="0.131">
        </testcase>
        <testcase classname="src/controllers/__tests__/dividend.controller.test.ts" name="DividendController &gt; getDividendData &gt; should handle service errors" time="0.133">
        </testcase>
        <testcase classname="src/controllers/__tests__/dividend.controller.test.ts" name="DividendController &gt; calculateProjection &gt; should return projection result successfully" time="0.126">
        </testcase>
        <testcase classname="src/controllers/__tests__/dividend.controller.test.ts" name="DividendController &gt; calculateProjection &gt; should return 400 if symbol is missing" time="0.083">
        </testcase>
        <testcase classname="src/controllers/__tests__/dividend.controller.test.ts" name="DividendController &gt; calculateProjection &gt; should return 400 if initialInvestment is below minimum" time="0.089">
        </testcase>
        <testcase classname="src/controllers/__tests__/dividend.controller.test.ts" name="DividendController &gt; calculateProjection &gt; should return 404 if stock has no dividends" time="0.03">
        </testcase>
        <testcase classname="src/controllers/__tests__/dividend.controller.test.ts" name="DividendController &gt; calculateProjection &gt; should return 400 if insufficient data" time="0.093">
        </testcase>
    </testsuite>
    <testsuite name="src/controllers/__tests__/market.controller.test.ts" timestamp="2026-01-01T10:46:50.935Z" hostname="sngvahmed" tests="16" failures="0" errors="0" skipped="0" time="0.723">
        <testcase classname="src/controllers/__tests__/market.controller.test.ts" name="MarketController &gt; getGainers &gt; should return paginated gainers data successfully" time="0.04">
        </testcase>
        <testcase classname="src/controllers/__tests__/market.controller.test.ts" name="MarketController &gt; getGainers &gt; should respect limit and offset parameters" time="0.036">
        </testcase>
        <testcase classname="src/controllers/__tests__/market.controller.test.ts" name="MarketController &gt; getGainers &gt; should use default limit when not provided" time="0.058">
        </testcase>
        <testcase classname="src/controllers/__tests__/market.controller.test.ts" name="MarketController &gt; getGainers &gt; should return 400 for invalid limit (too low)" time="0.036">
        </testcase>
        <testcase classname="src/controllers/__tests__/market.controller.test.ts" name="MarketController &gt; getGainers &gt; should return 400 for invalid limit (too high)" time="0.06">
        </testcase>
        <testcase classname="src/controllers/__tests__/market.controller.test.ts" name="MarketController &gt; getGainers &gt; should return 500 when service throws error" time="0.028">
        </testcase>
        <testcase classname="src/controllers/__tests__/market.controller.test.ts" name="MarketController &gt; getLosers &gt; should return losers data successfully" time="0.046">
        </testcase>
        <testcase classname="src/controllers/__tests__/market.controller.test.ts" name="MarketController &gt; getLosers &gt; should return 400 for invalid limit" time="0.028">
        </testcase>
        <testcase classname="src/controllers/__tests__/market.controller.test.ts" name="MarketController &gt; getActives &gt; should return actives data successfully" time="0.046">
        </testcase>
        <testcase classname="src/controllers/__tests__/market.controller.test.ts" name="MarketController &gt; getActives &gt; should return 400 for invalid limit" time="0.031">
        </testcase>
        <testcase classname="src/controllers/__tests__/market.controller.test.ts" name="MarketController &gt; getSectorsPerformance &gt; should return sectors performance data successfully" time="0.036">
        </testcase>
        <testcase classname="src/controllers/__tests__/market.controller.test.ts" name="MarketController &gt; getSectorsPerformance &gt; should return 500 when service fails" time="0.028">
        </testcase>
        <testcase classname="src/controllers/__tests__/market.controller.test.ts" name="MarketController &gt; getSectorsPerformance &gt; should handle empty sectors array" time="0.027">
        </testcase>
        <testcase classname="src/controllers/__tests__/market.controller.test.ts" name="MarketController &gt; getMarketStatus &gt; should return market status data successfully" time="0.025">
        </testcase>
        <testcase classname="src/controllers/__tests__/market.controller.test.ts" name="MarketController &gt; getMarketStatus &gt; should return 500 when service fails" time="0.017">
        </testcase>
        <testcase classname="src/controllers/__tests__/market.controller.test.ts" name="MarketController &gt; getMarketStatus &gt; should handle market closed status" time="0.013">
        </testcase>
    </testsuite>
    <testsuite name="src/controllers/__tests__/stocks.controller.test.ts" timestamp="2026-01-01T10:46:50.937Z" hostname="sngvahmed" tests="4" failures="0" errors="0" skipped="0" time="0.259">
        <testcase classname="src/controllers/__tests__/stocks.controller.test.ts" name="StockController &gt; getStockDetails &gt; should return stock details for valid symbol" time="0.036">
        </testcase>
        <testcase classname="src/controllers/__tests__/stocks.controller.test.ts" name="StockController &gt; getStockDetails &gt; should return 400 for invalid symbol format" time="0.041">
        </testcase>
        <testcase classname="src/controllers/__tests__/stocks.controller.test.ts" name="StockController &gt; getStockDetails &gt; should return 500 for service errors" time="0.055">
        </testcase>
        <testcase classname="src/controllers/__tests__/stocks.controller.test.ts" name="StockController &gt; getStockDetails &gt; should normalize symbol to uppercase" time="0.037">
        </testcase>
    </testsuite>
    <testsuite name="src/controllers/__tests__/users.controller.test.ts" timestamp="2026-01-01T10:46:50.938Z" hostname="sngvahmed" tests="5" failures="0" errors="0" skipped="0" time="0.272">
        <testcase classname="src/controllers/__tests__/users.controller.test.ts" name="UserController &gt; getProfile &gt; should return user profile when authenticated" time="0.037">
        </testcase>
        <testcase classname="src/controllers/__tests__/users.controller.test.ts" name="UserController &gt; getProfile &gt; should return 401 when not authenticated" time="0.031">
        </testcase>
        <testcase classname="src/controllers/__tests__/users.controller.test.ts" name="UserController &gt; updateProfile &gt; should update profile with valid data" time="0.029">
        </testcase>
        <testcase classname="src/controllers/__tests__/users.controller.test.ts" name="UserController &gt; updateProfile &gt; should return 400 for invalid request data" time="0.033">
        </testcase>
        <testcase classname="src/controllers/__tests__/users.controller.test.ts" name="UserController &gt; updateProfile &gt; should return 409 when username is already taken" time="0.035">
        </testcase>
    </testsuite>
    <testsuite name="src/services/__tests__/alerts.service.test.ts" timestamp="2026-01-01T10:46:50.938Z" hostname="sngvahmed" tests="12" failures="0" errors="0" skipped="0" time="1.635">
        <testcase classname="src/services/__tests__/alerts.service.test.ts" name="AlertService &gt; listAlerts &gt; should return list of alerts from repository" time="0.037">
        </testcase>
        <testcase classname="src/services/__tests__/alerts.service.test.ts" name="AlertService &gt; listAlerts &gt; should support admin access with null username" time="0.105">
        </testcase>
        <testcase classname="src/services/__tests__/alerts.service.test.ts" name="AlertService &gt; listActiveAlerts &gt; should return only active alerts" time="0.097">
        </testcase>
        <testcase classname="src/services/__tests__/alerts.service.test.ts" name="AlertService &gt; getAlert &gt; should return alert when found" time="0.135">
        </testcase>
        <testcase classname="src/services/__tests__/alerts.service.test.ts" name="AlertService &gt; getAlert &gt; should return null when alert not found" time="0.123">
        </testcase>
        <testcase classname="src/services/__tests__/alerts.service.test.ts" name="AlertService &gt; createAlert &gt; should create alert with valid data" time="0.081">
        </testcase>
        <testcase classname="src/services/__tests__/alerts.service.test.ts" name="AlertService &gt; createAlert &gt; should throw error when username is empty" time="0.047">
        </testcase>
        <testcase classname="src/services/__tests__/alerts.service.test.ts" name="AlertService &gt; createAlert &gt; should throw error when username is null" time="0.095">
        </testcase>
        <testcase classname="src/services/__tests__/alerts.service.test.ts" name="AlertService &gt; updateAlert &gt; should update alert when found" time="0.046">
        </testcase>
        <testcase classname="src/services/__tests__/alerts.service.test.ts" name="AlertService &gt; updateAlert &gt; should throw error when alert not found" time="0.078">
        </testcase>
        <testcase classname="src/services/__tests__/alerts.service.test.ts" name="AlertService &gt; deleteAlert &gt; should delete alert when found" time="0.037">
        </testcase>
        <testcase classname="src/services/__tests__/alerts.service.test.ts" name="AlertService &gt; deleteAlert &gt; should throw error when alert not found" time="0.045">
        </testcase>
    </testsuite>
    <testsuite name="src/services/__tests__/dividend-edge-cases.test.ts" timestamp="2026-01-01T10:46:50.940Z" hostname="sngvahmed" tests="12" failures="0" errors="0" skipped="0" time="1.274">
        <testcase classname="src/services/__tests__/dividend-edge-cases.test.ts" name="DividendService - Edge Cases &gt; calculateDGR - Edge Cases &gt; should handle zero DGR (no growth)" time="0.134">
        </testcase>
        <testcase classname="src/services/__tests__/dividend-edge-cases.test.ts" name="DividendService - Edge Cases &gt; calculateDGR - Edge Cases &gt; should handle negative DGR (dividend cuts)" time="0.1">
        </testcase>
        <testcase classname="src/services/__tests__/dividend-edge-cases.test.ts" name="DividendService - Edge Cases &gt; calculateDGR - Edge Cases &gt; should handle very high DGR (&gt;50%)" time="0.115">
        </testcase>
        <testcase classname="src/services/__tests__/dividend-edge-cases.test.ts" name="DividendService - Edge Cases &gt; calculateDGR - Edge Cases &gt; should handle zero yield" time="0.121">
        </testcase>
        <testcase classname="src/services/__tests__/dividend-edge-cases.test.ts" name="DividendService - Edge Cases &gt; calculateDGR - Edge Cases &gt; should handle very large initial investment" time="0.104">
        </testcase>
        <testcase classname="src/services/__tests__/dividend-edge-cases.test.ts" name="DividendService - Edge Cases &gt; calculateDGR - Edge Cases &gt; should handle very small initial investment" time="0.096">
        </testcase>
        <testcase classname="src/services/__tests__/dividend-edge-cases.test.ts" name="DividendService - Edge Cases &gt; calculateDGR - Edge Cases &gt; should handle single year of data" time="0.081">
        </testcase>
        <testcase classname="src/services/__tests__/dividend-edge-cases.test.ts" name="DividendService - Edge Cases &gt; calculateDGR - Edge Cases &gt; should handle missing dividend data in some years" time="0.051">
        </testcase>
        <testcase classname="src/services/__tests__/dividend-edge-cases.test.ts" name="DividendService - Edge Cases &gt; calculateDGR - Edge Cases &gt; should handle projection with zero DGR" time="0.06">
        </testcase>
        <testcase classname="src/services/__tests__/dividend-edge-cases.test.ts" name="DividendService - Edge Cases &gt; calculateDGR - Edge Cases &gt; should handle projection with negative DGR" time="0.041">
        </testcase>
        <testcase classname="src/services/__tests__/dividend-edge-cases.test.ts" name="DividendService - Edge Cases &gt; generateInsight - Edge Cases &gt; should generate insight for very small dividend" time="0.041">
        </testcase>
        <testcase classname="src/services/__tests__/dividend-edge-cases.test.ts" name="DividendService - Edge Cases &gt; generateInsight - Edge Cases &gt; should generate insight for very large dividend" time="0.057">
        </testcase>
    </testsuite>
    <testsuite name="src/services/__tests__/dividend.service.test.ts" timestamp="2026-01-01T10:46:50.941Z" hostname="sngvahmed" tests="6" failures="0" errors="0" skipped="0" time="0.807">
        <testcase classname="src/services/__tests__/dividend.service.test.ts" name="DividendService &gt; calculateDGR &gt; should calculate DGR from 5 years of data" time="0.116">
        </testcase>
        <testcase classname="src/services/__tests__/dividend.service.test.ts" name="DividendService &gt; calculateDGR &gt; should return null for insufficient data" time="0.124">
        </testcase>
        <testcase classname="src/services/__tests__/dividend.service.test.ts" name="DividendService &gt; calculateDGR &gt; should handle negative DGR (dividend cuts)" time="0.089">
        </testcase>
        <testcase classname="src/services/__tests__/dividend.service.test.ts" name="DividendService &gt; calculateProjection &gt; should calculate projection with reinvestment correctly" time="0.054">
        </testcase>
        <testcase classname="src/services/__tests__/dividend.service.test.ts" name="DividendService &gt; calculateProjection &gt; should generate insight message" time="0.063">
        </testcase>
        <testcase classname="src/services/__tests__/dividend.service.test.ts" name="DividendService &gt; calculateProjection &gt; should throw error for invalid parameters" time="0.098">
        </testcase>
    </testsuite>
    <testsuite name="src/services/__tests__/market.service.test.ts" timestamp="2026-01-01T10:46:50.942Z" hostname="sngvahmed" tests="17" failures="0" errors="0" skipped="0" time="1.144">
        <testcase classname="src/services/__tests__/market.service.test.ts" name="MarketService &gt; getGainers &gt; should return cached data when KV cache hit" time="0.046">
        </testcase>
        <testcase classname="src/services/__tests__/market.service.test.ts" name="MarketService &gt; getGainers &gt; should fetch from FMP and cache when KV cache miss" time="0.09">
        </testcase>
        <testcase classname="src/services/__tests__/market.service.test.ts" name="MarketService &gt; getGainers &gt; should fetch from FMP and cache when KV cache expired" time="0.08">
        </testcase>
        <testcase classname="src/services/__tests__/market.service.test.ts" name="MarketService &gt; getGainers &gt; should return stale cache when FMP API fails" time="0.04">
        </testcase>
        <testcase classname="src/services/__tests__/market.service.test.ts" name="MarketService &gt; getGainers &gt; should return empty array when FMP fails and no stale cache available" time="0.083">
        </testcase>
        <testcase classname="src/services/__tests__/market.service.test.ts" name="MarketService &gt; getGainers &gt; should return stale cache when outside working hours and no fresh cache" time="0.035">
        </testcase>
        <testcase classname="src/services/__tests__/market.service.test.ts" name="MarketService &gt; getGainers &gt; should return empty array when outside working hours and no cache available" time="0.086">
        </testcase>
        <testcase classname="src/services/__tests__/market.service.test.ts" name="MarketService &gt; getLosers &gt; should return cached data when KV cache hit" time="0.067">
        </testcase>
        <testcase classname="src/services/__tests__/market.service.test.ts" name="MarketService &gt; getLosers &gt; should fetch from FMP and cache when KV cache miss" time="0.04">
        </testcase>
        <testcase classname="src/services/__tests__/market.service.test.ts" name="MarketService &gt; getActives &gt; should return cached data when KV cache hit" time="0.025">
        </testcase>
        <testcase classname="src/services/__tests__/market.service.test.ts" name="MarketService &gt; getActives &gt; should fetch from FMP and cache when KV cache miss" time="0.03">
        </testcase>
        <testcase classname="src/services/__tests__/market.service.test.ts" name="MarketService &gt; getSectorsPerformance &gt; should return cached data when KV cache hit" time="0.03">
        </testcase>
        <testcase classname="src/services/__tests__/market.service.test.ts" name="MarketService &gt; getSectorsPerformance &gt; should fetch from FMP and cache when KV cache miss" time="0.036">
        </testcase>
        <testcase classname="src/services/__tests__/market.service.test.ts" name="MarketService &gt; getSectorsPerformance &gt; should return stale cache when FMP API fails" time="0.038">
        </testcase>
        <testcase classname="src/services/__tests__/market.service.test.ts" name="MarketService &gt; getMarketStatus &gt; should return cached data when KV cache hit" time="0.038">
        </testcase>
        <testcase classname="src/services/__tests__/market.service.test.ts" name="MarketService &gt; getMarketStatus &gt; should fetch from FMP and cache when KV cache miss" time="0.048">
        </testcase>
        <testcase classname="src/services/__tests__/market.service.test.ts" name="MarketService &gt; getMarketStatus &gt; should return stale cache when FMP API fails" time="0.027">
        </testcase>
    </testsuite>
    <testsuite name="src/services/__tests__/news.service.test.ts" timestamp="2026-01-01T10:46:50.945Z" hostname="sngvahmed" tests="10" failures="0" errors="0" skipped="0" time="1.083">
        <testcase classname="src/services/__tests__/news.service.test.ts" name="NewsService &gt; getGeneralNews &gt; should return cached data when KV cache hit (first page)" time="0.135">
        </testcase>
        <testcase classname="src/services/__tests__/news.service.test.ts" name="NewsService &gt; getGeneralNews &gt; should fetch from repository and cache when KV cache miss (first page)" time="0.097">
        </testcase>
        <testcase classname="src/services/__tests__/news.service.test.ts" name="NewsService &gt; getGeneralNews &gt; should use configurable TTL from AdminConfig" time="0.112">
        </testcase>
        <testcase classname="src/services/__tests__/news.service.test.ts" name="NewsService &gt; getGeneralNews &gt; should return stale cache when FMP API fails" time="0.12">
        </testcase>
        <testcase classname="src/services/__tests__/news.service.test.ts" name="NewsService &gt; getGeneralNews &gt; should not cache when fetching non-first page" time="0.098">
        </testcase>
        <testcase classname="src/services/__tests__/news.service.test.ts" name="NewsService &gt; getGeneralNews &gt; should rethrow error when both FMP and cache fail" time="0.085">
        </testcase>
        <testcase classname="src/services/__tests__/news.service.test.ts" name="NewsService &gt; getGeneralNews &gt; should work without Env (no caching)" time="0.044">
        </testcase>
        <testcase classname="src/services/__tests__/news.service.test.ts" name="NewsService &gt; getGeneralNews &gt; should handle cache write failures gracefully" time="0.067">
        </testcase>
        <testcase classname="src/services/__tests__/news.service.test.ts" name="NewsService &gt; getGeneralNews &gt; should return stale cache when outside working hours" time="0.08">
        </testcase>
        <testcase classname="src/services/__tests__/news.service.test.ts" name="NewsService &gt; getGeneralNews &gt; should return empty result when outside working hours and no cache" time="0.04">
        </testcase>
    </testsuite>
    <testsuite name="src/services/__tests__/quotes.service.test.ts" timestamp="2026-01-01T10:46:50.946Z" hostname="sngvahmed" tests="10" failures="0" errors="0" skipped="0" time="1.103">
        <testcase classname="src/services/__tests__/quotes.service.test.ts" name="QuotesService &gt; getQuote &gt; should return quote from repository during working hours" time="0.121">
        </testcase>
        <testcase classname="src/services/__tests__/quotes.service.test.ts" name="QuotesService &gt; getQuote &gt; should return stale cache when outside working hours" time="0.124">
        </testcase>
        <testcase classname="src/services/__tests__/quotes.service.test.ts" name="QuotesService &gt; getQuote &gt; should throw error when outside working hours and no cache" time="0.093">
        </testcase>
        <testcase classname="src/services/__tests__/quotes.service.test.ts" name="QuotesService &gt; getQuote &gt; should throw error for empty symbol" time="0.085">
        </testcase>
        <testcase classname="src/services/__tests__/quotes.service.test.ts" name="QuotesService &gt; getQuotes &gt; should return quotes from repository during working hours" time="0.035">
        </testcase>
        <testcase classname="src/services/__tests__/quotes.service.test.ts" name="QuotesService &gt; getQuotes &gt; should return stale cache when outside working hours" time="0.049">
        </testcase>
        <testcase classname="src/services/__tests__/quotes.service.test.ts" name="QuotesService &gt; getQuotes &gt; should return empty array when outside working hours and no cache" time="0.079">
        </testcase>
        <testcase classname="src/services/__tests__/quotes.service.test.ts" name="QuotesService &gt; getQuotes &gt; should remove duplicates from symbols" time="0.037">
        </testcase>
        <testcase classname="src/services/__tests__/quotes.service.test.ts" name="QuotesService &gt; getQuotes &gt; should throw error for empty symbols array" time="0.086">
        </testcase>
        <testcase classname="src/services/__tests__/quotes.service.test.ts" name="QuotesService &gt; getQuotes &gt; should work without Env (no working hours check)" time="0.031">
        </testcase>
    </testsuite>
    <testsuite name="src/services/__tests__/search.service.test.ts" timestamp="2026-01-01T10:46:50.947Z" hostname="sngvahmed" tests="6" failures="0" errors="0" skipped="0" time="0.807">
        <testcase classname="src/services/__tests__/search.service.test.ts" name="SearchService &gt; searchStocks &gt; should return search results from repository during working hours" time="0.045">
        </testcase>
        <testcase classname="src/services/__tests__/search.service.test.ts" name="SearchService &gt; searchStocks &gt; should return empty array when outside working hours" time="0.129">
        </testcase>
        <testcase classname="src/services/__tests__/search.service.test.ts" name="SearchService &gt; searchStocks &gt; should return empty array for query shorter than 2 characters" time="0.14">
        </testcase>
        <testcase classname="src/services/__tests__/search.service.test.ts" name="SearchService &gt; searchStocks &gt; should return empty array for empty query" time="0.114">
        </testcase>
        <testcase classname="src/services/__tests__/search.service.test.ts" name="SearchService &gt; searchStocks &gt; should trim query before searching" time="0.125">
        </testcase>
        <testcase classname="src/services/__tests__/search.service.test.ts" name="SearchService &gt; searchStocks &gt; should work without Env (no working hours check)" time="0.072">
        </testcase>
    </testsuite>
    <testsuite name="src/services/__tests__/stocks.service.test.ts" timestamp="2026-01-01T10:46:50.948Z" hostname="sngvahmed" tests="10" failures="0" errors="0" skipped="0" time="1.207">
        <testcase classname="src/services/__tests__/stocks.service.test.ts" name="StockService &gt; getStockDetails &gt; should return stock details for valid symbol" time="0.224">
        </testcase>
        <testcase classname="src/services/__tests__/stocks.service.test.ts" name="StockService &gt; getStockDetails &gt; should normalize symbol to uppercase" time="0.113">
        </testcase>
        <testcase classname="src/services/__tests__/stocks.service.test.ts" name="StockService &gt; getStockDetails &gt; should throw error for empty symbol" time="0.122">
        </testcase>
        <testcase classname="src/services/__tests__/stocks.service.test.ts" name="StockService &gt; getStockDetails &gt; should throw error for symbol longer than 10 characters" time="0.095">
        </testcase>
        <testcase classname="src/services/__tests__/stocks.service.test.ts" name="StockService &gt; getStockDetails &gt; should throw error when repository throws" time="0.094">
        </testcase>
        <testcase classname="src/services/__tests__/stocks.service.test.ts" name="StockService &gt; getStockDetails &gt; should return stale cache when outside working hours" time="0.044">
        </testcase>
        <testcase classname="src/services/__tests__/stocks.service.test.ts" name="StockService &gt; getStockDetails &gt; should throw error when outside working hours and no cache" time="0.094">
        </testcase>
        <testcase classname="src/services/__tests__/stocks.service.test.ts" name="StockService &gt; watchStockDetails &gt; should return async iterable for valid symbol" time="0.043">
        </testcase>
        <testcase classname="src/services/__tests__/stocks.service.test.ts" name="StockService &gt; watchStockDetails &gt; should normalize symbol to uppercase" time="0.074">
        </testcase>
        <testcase classname="src/services/__tests__/stocks.service.test.ts" name="StockService &gt; watchStockDetails &gt; should throw error for invalid symbol" time="0.045">
        </testcase>
    </testsuite>
    <testsuite name="src/services/__tests__/users.service.test.ts" timestamp="2026-01-01T10:46:50.949Z" hostname="sngvahmed" tests="7" failures="0" errors="0" skipped="0" time="1.037">
        <testcase classname="src/services/__tests__/users.service.test.ts" name="UserService &gt; updateProfile &gt; should successfully update profile when username is available" time="0.041">
        </testcase>
        <testcase classname="src/services/__tests__/users.service.test.ts" name="UserService &gt; updateProfile &gt; should throw error when username is already taken by another user" time="0.095">
        </testcase>
        <testcase classname="src/services/__tests__/users.service.test.ts" name="UserService &gt; updateProfile &gt; should allow updating username to same username (no-op)" time="0.102">
        </testcase>
        <testcase classname="src/services/__tests__/users.service.test.ts" name="UserService &gt; updateProfile &gt; should update name without username validation" time="0.032">
        </testcase>
        <testcase classname="src/services/__tests__/users.service.test.ts" name="UserService &gt; getProfile &gt; should return user profile by ID" time="0.042">
        </testcase>
        <testcase classname="src/services/__tests__/users.service.test.ts" name="UserService &gt; getProfile &gt; should return null when user not found" time="0.129">
        </testcase>
        <testcase classname="src/services/__tests__/users.service.test.ts" name="UserService &gt; getProfileByUsername &gt; should return user profile by username" time="0.118">
        </testcase>
    </testsuite>
    <testsuite name="src/utils/__tests__/working-hours.test.ts" timestamp="2026-01-01T10:46:50.950Z" hostname="sngvahmed" tests="12" failures="0" errors="0" skipped="0" time="1.407">
        <testcase classname="src/utils/__tests__/working-hours.test.ts" name="working-hours &gt; isWithinWorkingHours &gt; should return true when working hours feature is disabled" time="0.037">
        </testcase>
        <testcase classname="src/utils/__tests__/working-hours.test.ts" name="working-hours &gt; isWithinWorkingHours &gt; should return true when workingHours is undefined" time="0.096">
        </testcase>
        <testcase classname="src/utils/__tests__/working-hours.test.ts" name="working-hours &gt; isWithinWorkingHours &gt; should return true when current hour is within working hours (normal case)" time="0.103">
        </testcase>
        <testcase classname="src/utils/__tests__/working-hours.test.ts" name="working-hours &gt; isWithinWorkingHours &gt; should return false when current hour is before start hour" time="0.099">
        </testcase>
        <testcase classname="src/utils/__tests__/working-hours.test.ts" name="working-hours &gt; isWithinWorkingHours &gt; should return false when current hour is after end hour" time="0.04">
        </testcase>
        <testcase classname="src/utils/__tests__/working-hours.test.ts" name="working-hours &gt; isWithinWorkingHours &gt; should handle overnight working hours (startHour &gt; endHour)" time="0.078">
        </testcase>
        <testcase classname="src/utils/__tests__/working-hours.test.ts" name="working-hours &gt; isWithinWorkingHours &gt; should handle overnight working hours - early morning" time="0.126">
        </testcase>
        <testcase classname="src/utils/__tests__/working-hours.test.ts" name="working-hours &gt; isWithinWorkingHours &gt; should handle overnight working hours - outside range" time="0.199">
        </testcase>
        <testcase classname="src/utils/__tests__/working-hours.test.ts" name="working-hours &gt; isWithinWorkingHours &gt; should return true for invalid hours (fallback)" time="0.115">
            <system-err>
Invalid working hours configuration, allowing all hours

            </system-err>
        </testcase>
        <testcase classname="src/utils/__tests__/working-hours.test.ts" name="working-hours &gt; isWithinWorkingHours &gt; should work with different timezones" time="0.121">
        </testcase>
        <testcase classname="src/utils/__tests__/working-hours.test.ts" name="working-hours &gt; getWorkingHoursInfo &gt; should return correct info when within working hours" time="0.094">
        </testcase>
        <testcase classname="src/utils/__tests__/working-hours.test.ts" name="working-hours &gt; getWorkingHoursInfo &gt; should return correct info when working hours disabled" time="0.04">
        </testcase>
    </testsuite>
    <testsuite name="src/repositories/__tests__/d1/AlertRepository.test.ts" timestamp="2026-01-01T10:46:50.952Z" hostname="sngvahmed" tests="7" failures="0" errors="0" skipped="0" time="1.228">
        <testcase classname="src/repositories/__tests__/d1/AlertRepository.test.ts" name="AlertRepository &gt; list &gt; should return all alerts for admin (username null)" time="0.047">
        </testcase>
        <testcase classname="src/repositories/__tests__/d1/AlertRepository.test.ts" name="AlertRepository &gt; list &gt; should return alerts filtered by username" time="0.095">
        </testcase>
        <testcase classname="src/repositories/__tests__/d1/AlertRepository.test.ts" name="AlertRepository &gt; create &gt; should create alert and return it" time="0.104">
        </testcase>
        <testcase classname="src/repositories/__tests__/d1/AlertRepository.test.ts" name="AlertRepository &gt; create &gt; should throw error when username is empty" time="0.102">
        </testcase>
        <testcase classname="src/repositories/__tests__/d1/AlertRepository.test.ts" name="AlertRepository &gt; update &gt; should update alert and return updated version" time="0.132">
        </testcase>
        <testcase classname="src/repositories/__tests__/d1/AlertRepository.test.ts" name="AlertRepository &gt; delete &gt; should delete alert for user" time="0.053">
        </testcase>
        <testcase classname="src/repositories/__tests__/d1/AlertRepository.test.ts" name="AlertRepository &gt; delete &gt; should delete alert for admin (username null)" time="0.098">
        </testcase>
    </testsuite>
    <testsuite name="src/repositories/__tests__/d1/UserRepository.test.ts" timestamp="2026-01-01T10:46:50.953Z" hostname="sngvahmed" tests="5" failures="0" errors="0" skipped="0" time="0.959">
        <testcase classname="src/repositories/__tests__/d1/UserRepository.test.ts" name="UserRepository &gt; findById &gt; should return user when found" time="0.039">
        </testcase>
        <testcase classname="src/repositories/__tests__/d1/UserRepository.test.ts" name="UserRepository &gt; findById &gt; should return null when user not found" time="0.103">
        </testcase>
        <testcase classname="src/repositories/__tests__/d1/UserRepository.test.ts" name="UserRepository &gt; findByUsername &gt; should return user when found by username" time="0.108">
        </testcase>
        <testcase classname="src/repositories/__tests__/d1/UserRepository.test.ts" name="UserRepository &gt; update &gt; should update user profile" time="0.139">
        </testcase>
        <testcase classname="src/repositories/__tests__/d1/UserRepository.test.ts" name="UserRepository &gt; update &gt; should handle partial updates" time="0.133">
        </testcase>
    </testsuite>
    <testsuite name="src/repositories/__tests__/external/CalendarRepository.test.ts" timestamp="2026-01-01T10:46:50.954Z" hostname="sngvahmed" tests="5" failures="0" errors="0" skipped="0" time="1.316">
        <testcase classname="src/repositories/__tests__/external/CalendarRepository.test.ts" name="CalendarRepository &gt; getEarningsCalendar &gt; should fetch earnings calendar from FMP API" time="0.101">
        </testcase>
        <testcase classname="src/repositories/__tests__/external/CalendarRepository.test.ts" name="CalendarRepository &gt; getEarningsCalendar &gt; should handle date range parameters" time="0.216">
        </testcase>
        <testcase classname="src/repositories/__tests__/external/CalendarRepository.test.ts" name="CalendarRepository &gt; getDividendCalendar &gt; should fetch dividend calendar from FMP API" time="0.22">
        </testcase>
        <testcase classname="src/repositories/__tests__/external/CalendarRepository.test.ts" name="CalendarRepository &gt; getIPOCalendar &gt; should fetch IPO calendar from FMP API" time="0.191">
        </testcase>
        <testcase classname="src/repositories/__tests__/external/CalendarRepository.test.ts" name="CalendarRepository &gt; getStockSplitCalendar &gt; should fetch stock split calendar from FMP API" time="0.133">
        </testcase>
    </testsuite>
    <testsuite name="src/repositories/__tests__/external/DividendRepository.test.ts" timestamp="2026-01-01T10:46:50.955Z" hostname="sngvahmed" tests="9" failures="0" errors="0" skipped="0" time="1.65">
        <testcase classname="src/repositories/__tests__/external/DividendRepository.test.ts" name="DividendRepository &gt; getHistoricalDividends &gt; should fetch historical dividends successfully" time="0.104">
        </testcase>
        <testcase classname="src/repositories/__tests__/external/DividendRepository.test.ts" name="DividendRepository &gt; getHistoricalDividends &gt; should handle empty dividend history" time="0.214">
        </testcase>
        <testcase classname="src/repositories/__tests__/external/DividendRepository.test.ts" name="DividendRepository &gt; getHistoricalDividends &gt; should handle 404 response (no data)" time="0.215">
        </testcase>
        <testcase classname="src/repositories/__tests__/external/DividendRepository.test.ts" name="DividendRepository &gt; getHistoricalDividends &gt; should handle API errors" time="0.228">
        </testcase>
        <testcase classname="src/repositories/__tests__/external/DividendRepository.test.ts" name="DividendRepository &gt; getHistoricalDividends &gt; should handle rate limiting by throwing error" time="0.154">
        </testcase>
        <testcase classname="src/repositories/__tests__/external/DividendRepository.test.ts" name="DividendRepository &gt; getCurrentYield &gt; should extract yield directly from profile" time="0.166">
        </testcase>
        <testcase classname="src/repositories/__tests__/external/DividendRepository.test.ts" name="DividendRepository &gt; getCurrentYield &gt; should calculate yield from lastDiv and price" time="0.079">
        </testcase>
        <testcase classname="src/repositories/__tests__/external/DividendRepository.test.ts" name="DividendRepository &gt; getCurrentYield &gt; should return null if no dividend data" time="0.121">
        </testcase>
        <testcase classname="src/repositories/__tests__/external/DividendRepository.test.ts" name="DividendRepository &gt; getCurrentYield &gt; should handle 404 response" time="0.093">
        </testcase>
    </testsuite>
    <testsuite name="src/repositories/__tests__/external/MarketRepository.test.ts" timestamp="2026-01-01T10:46:50.956Z" hostname="sngvahmed" tests="16" failures="0" errors="0" skipped="0" time="3.424">
        <testcase classname="src/repositories/__tests__/external/MarketRepository.test.ts" name="MarketRepository &gt; getGainers &gt; should fetch gainers from FMP dedicated endpoint" time="0.105">
        </testcase>
        <testcase classname="src/repositories/__tests__/external/MarketRepository.test.ts" name="MarketRepository &gt; getGainers &gt; should handle empty array when FMP returns no gainers" time="2.038">
        </testcase>
        <testcase classname="src/repositories/__tests__/external/MarketRepository.test.ts" name="MarketRepository &gt; getGainers &gt; should normalize gainers response fields correctly" time="0.055">
        </testcase>
        <testcase classname="src/repositories/__tests__/external/MarketRepository.test.ts" name="MarketRepository &gt; getGainers &gt; should handle missing optional fields" time="0.034">
        </testcase>
        <testcase classname="src/repositories/__tests__/external/MarketRepository.test.ts" name="MarketRepository &gt; getGainers &gt; should retry on rate limit (429)" time="1.022">
        </testcase>
        <testcase classname="src/repositories/__tests__/external/MarketRepository.test.ts" name="MarketRepository &gt; getGainers &gt; should handle errors gracefully when quote fetching fails" time="0.007">
        </testcase>
        <testcase classname="src/repositories/__tests__/external/MarketRepository.test.ts" name="MarketRepository &gt; getLosers &gt; should fetch losers from FMP dedicated endpoint" time="0.007">
        </testcase>
        <testcase classname="src/repositories/__tests__/external/MarketRepository.test.ts" name="MarketRepository &gt; getActives &gt; should fetch actives from FMP dedicated endpoint" time="0.006">
        </testcase>
        <testcase classname="src/repositories/__tests__/external/MarketRepository.test.ts" name="MarketRepository &gt; getSectorsPerformance &gt; should fetch and normalize sectors performance from FMP API" time="0.006">
        </testcase>
        <testcase classname="src/repositories/__tests__/external/MarketRepository.test.ts" name="MarketRepository &gt; getSectorsPerformance &gt; should handle empty array response" time="0.004">
        </testcase>
        <testcase classname="src/repositories/__tests__/external/MarketRepository.test.ts" name="MarketRepository &gt; getSectorsPerformance &gt; should handle alternative field names in FMP response" time="0.005">
        </testcase>
        <testcase classname="src/repositories/__tests__/external/MarketRepository.test.ts" name="MarketRepository &gt; getSectorsPerformance &gt; should handle null changesPercentage" time="0.004">
        </testcase>
        <testcase classname="src/repositories/__tests__/external/MarketRepository.test.ts" name="MarketRepository &gt; getMarketStatus &gt; should fetch market status from FMP API" time="0.007">
        </testcase>
        <testcase classname="src/repositories/__tests__/external/MarketRepository.test.ts" name="MarketRepository &gt; getMarketStatus &gt; should handle array response from FMP" time="0.007">
        </testcase>
        <testcase classname="src/repositories/__tests__/external/MarketRepository.test.ts" name="MarketRepository &gt; getMarketStatus &gt; should default to false if response is missing field" time="0.005">
        </testcase>
        <testcase classname="src/repositories/__tests__/external/MarketRepository.test.ts" name="MarketRepository &gt; getMarketStatus &gt; should handle API errors" time="0.007">
        </testcase>
    </testsuite>
    <testsuite name="src/repositories/__tests__/external/StockRepository.test.ts" timestamp="2026-01-01T10:46:50.958Z" hostname="sngvahmed" tests="5" failures="0" errors="0" skipped="1" time="1.086">
        <testcase classname="src/repositories/__tests__/external/StockRepository.test.ts" name="StockRepository &gt; getStockDetails &gt; should return stock details from API when cache miss" time="0.425">
        </testcase>
        <testcase classname="src/repositories/__tests__/external/StockRepository.test.ts" name="StockRepository &gt; getStockDetails &gt; should return cached stock details when cache hit" time="0.084">
        </testcase>
        <testcase classname="src/repositories/__tests__/external/StockRepository.test.ts" name="StockRepository &gt; getStockDetails &gt; should throw error when API fails" time="0">
            <skipped/>
        </testcase>
        <testcase classname="src/repositories/__tests__/external/StockRepository.test.ts" name="StockRepository &gt; watchStockDetails &gt; should return async iterable that yields stock details" time="0.079">
        </testcase>
        <testcase classname="src/repositories/__tests__/external/StockRepository.test.ts" name="StockRepository &gt; watchStockDetails &gt; should handle errors in stream gracefully" time="0.251">
        </testcase>
    </testsuite>
</testsuites>
