<?xml version="1.0" encoding="UTF-8" ?>
<testsuites name="vitest tests" tests="506" failures="0" errors="0" time="46.604">
    <testsuite name="test/alerts-evaluate.spec.ts" timestamp="2025-12-14T20:04:38.169Z" hostname="sngvahmed" tests="3" failures="0" errors="0" skipped="0" time="0.204">
        <testcase classname="test/alerts-evaluate.spec.ts" name="evaluateAlerts &gt; notifies only when direction condition transitions from false to true" time="0.035">
        </testcase>
        <testcase classname="test/alerts-evaluate.spec.ts" name="evaluateAlerts &gt; resets state when price falls back below threshold" time="0.034">
        </testcase>
        <testcase classname="test/alerts-evaluate.spec.ts" name="evaluateAlerts &gt; skips alerts that lack a price" time="0.06">
        </testcase>
    </testsuite>
    <testsuite name="test/alerts-handler.spec.ts" timestamp="2025-12-14T20:04:38.171Z" hostname="sngvahmed" tests="5" failures="0" errors="0" skipped="0" time="0.406">
        <testcase classname="test/alerts-handler.spec.ts" name="alerts handler &gt; lists alerts" time="0.065">
            <system-out>
{&quot;timestamp&quot;:&quot;2025-12-14T20:04:25.415Z&quot;,&quot;service&quot;:&quot;stockly-api-test&quot;,&quot;level&quot;:&quot;INFO&quot;,&quot;traceId&quot;:&quot;test-trace-id&quot;,&quot;userId&quot;:null,&quot;path&quot;:&quot;/test&quot;,&quot;message&quot;:&quot;Alerts request authenticated&quot;,&quot;type&quot;:&quot;general&quot;,&quot;username&quot;:&quot;testuser&quot;,&quot;isAdmin&quot;:false,&quot;requestUsername&quot;:&quot;testuser&quot;,&quot;method&quot;:&quot;GET&quot;}

{&quot;timestamp&quot;:&quot;2025-12-14T20:04:25.416Z&quot;,&quot;service&quot;:&quot;stockly-api-test&quot;,&quot;level&quot;:&quot;INFO&quot;,&quot;traceId&quot;:&quot;test-trace-id&quot;,&quot;userId&quot;:null,&quot;path&quot;:&quot;/test&quot;,&quot;message&quot;:&quot;Fetched alerts from D1&quot;,&quot;type&quot;:&quot;general&quot;,&quot;username&quot;:&quot;testuser&quot;,&quot;alertCount&quot;:1,&quot;alertIds&quot;:[&quot;1&quot;]}

            </system-out>
        </testcase>
        <testcase classname="test/alerts-handler.spec.ts" name="alerts handler &gt; creates an alert when payload is valid" time="0.095">
            <system-out>
{&quot;timestamp&quot;:&quot;2025-12-14T20:04:25.517Z&quot;,&quot;service&quot;:&quot;stockly-api-test&quot;,&quot;level&quot;:&quot;INFO&quot;,&quot;traceId&quot;:&quot;test-trace-id&quot;,&quot;userId&quot;:null,&quot;path&quot;:&quot;/test&quot;,&quot;message&quot;:&quot;Alerts request authenticated&quot;,&quot;type&quot;:&quot;general&quot;,&quot;username&quot;:&quot;testuser&quot;,&quot;isAdmin&quot;:false,&quot;requestUsername&quot;:&quot;testuser&quot;,&quot;method&quot;:&quot;POST&quot;}

{&quot;timestamp&quot;:&quot;2025-12-14T20:04:25.518Z&quot;,&quot;service&quot;:&quot;stockly-api-test&quot;,&quot;level&quot;:&quot;INFO&quot;,&quot;traceId&quot;:&quot;test-trace-id&quot;,&quot;userId&quot;:null,&quot;path&quot;:&quot;/test&quot;,&quot;message&quot;:&quot;Creating alert&quot;,&quot;type&quot;:&quot;general&quot;,&quot;username&quot;:&quot;testuser&quot;,&quot;symbol&quot;:&quot;AAPL&quot;,&quot;direction&quot;:&quot;above&quot;,&quot;threshold&quot;:200}

{&quot;timestamp&quot;:&quot;2025-12-14T20:04:25.518Z&quot;,&quot;service&quot;:&quot;stockly-api-test&quot;,&quot;level&quot;:&quot;INFO&quot;,&quot;traceId&quot;:&quot;test-trace-id&quot;,&quot;userId&quot;:null,&quot;path&quot;:&quot;/test&quot;,&quot;message&quot;:&quot;Created alert successfully&quot;,&quot;type&quot;:&quot;general&quot;,&quot;alertId&quot;:&quot;2&quot;,&quot;username&quot;:&quot;testuser&quot;,&quot;alertUsername&quot;:&quot;testuser&quot;,&quot;isAdmin&quot;:false}

            </system-out>
        </testcase>
        <testcase classname="test/alerts-handler.spec.ts" name="alerts handler &gt; returns 404 when an alert is missing" time="0.073">
            <system-out>
{&quot;timestamp&quot;:&quot;2025-12-14T20:04:25.575Z&quot;,&quot;service&quot;:&quot;stockly-api-test&quot;,&quot;level&quot;:&quot;INFO&quot;,&quot;traceId&quot;:&quot;test-trace-id&quot;,&quot;userId&quot;:null,&quot;path&quot;:&quot;/test&quot;,&quot;message&quot;:&quot;Alerts request authenticated&quot;,&quot;type&quot;:&quot;general&quot;,&quot;username&quot;:&quot;testuser&quot;,&quot;isAdmin&quot;:false,&quot;requestUsername&quot;:&quot;testuser&quot;,&quot;method&quot;:&quot;GET&quot;}

            </system-out>
        </testcase>
        <testcase classname="test/alerts-handler.spec.ts" name="alerts handler &gt; updates alerts via PUT" time="0.046">
            <system-out>
{&quot;timestamp&quot;:&quot;2025-12-14T20:04:25.648Z&quot;,&quot;service&quot;:&quot;stockly-api-test&quot;,&quot;level&quot;:&quot;INFO&quot;,&quot;traceId&quot;:&quot;test-trace-id&quot;,&quot;userId&quot;:null,&quot;path&quot;:&quot;/test&quot;,&quot;message&quot;:&quot;Alerts request authenticated&quot;,&quot;type&quot;:&quot;general&quot;,&quot;username&quot;:&quot;testuser&quot;,&quot;isAdmin&quot;:false,&quot;requestUsername&quot;:&quot;testuser&quot;,&quot;method&quot;:&quot;PUT&quot;}

{&quot;timestamp&quot;:&quot;2025-12-14T20:04:25.648Z&quot;,&quot;service&quot;:&quot;stockly-api-test&quot;,&quot;level&quot;:&quot;INFO&quot;,&quot;traceId&quot;:&quot;test-trace-id&quot;,&quot;userId&quot;:null,&quot;path&quot;:&quot;/test&quot;,&quot;message&quot;:&quot;Updated alert&quot;,&quot;type&quot;:&quot;general&quot;,&quot;alertId&quot;:&quot;3&quot;,&quot;username&quot;:&quot;testuser&quot;}

            </system-out>
        </testcase>
        <testcase classname="test/alerts-handler.spec.ts" name="alerts handler &gt; deletes alerts and clears KV state" time="0.05">
            <system-out>
{&quot;timestamp&quot;:&quot;2025-12-14T20:04:25.701Z&quot;,&quot;service&quot;:&quot;stockly-api-test&quot;,&quot;level&quot;:&quot;INFO&quot;,&quot;traceId&quot;:&quot;test-trace-id&quot;,&quot;userId&quot;:null,&quot;path&quot;:&quot;/test&quot;,&quot;message&quot;:&quot;Alerts request authenticated&quot;,&quot;type&quot;:&quot;general&quot;,&quot;username&quot;:&quot;testuser&quot;,&quot;isAdmin&quot;:false,&quot;requestUsername&quot;:&quot;testuser&quot;,&quot;method&quot;:&quot;DELETE&quot;}

{&quot;timestamp&quot;:&quot;2025-12-14T20:04:25.702Z&quot;,&quot;service&quot;:&quot;stockly-api-test&quot;,&quot;level&quot;:&quot;INFO&quot;,&quot;traceId&quot;:&quot;test-trace-id&quot;,&quot;userId&quot;:null,&quot;path&quot;:&quot;/test&quot;,&quot;message&quot;:&quot;Deleted alert&quot;,&quot;type&quot;:&quot;general&quot;,&quot;alertId&quot;:&quot;123&quot;,&quot;username&quot;:&quot;testuser&quot;}

            </system-out>
        </testcase>
    </testsuite>
    <testsuite name="test/alerts-storage.spec.ts" timestamp="2025-12-14T20:04:38.177Z" hostname="sngvahmed" tests="7" failures="0" errors="0" skipped="0" time="0.324">
        <testcase classname="test/alerts-storage.spec.ts" name="alerts storage queries &gt; lists alerts" time="0.026">
        </testcase>
        <testcase classname="test/alerts-storage.spec.ts" name="alerts storage queries &gt; creates and returns an alert" time="0.028">
            <system-out>
Creating alert with username: testuser, symbol: AAPL

Alert created successfully: id=generated-id, username=testuser, symbol=AAPL

            </system-out>
        </testcase>
        <testcase classname="test/alerts-storage.spec.ts" name="alerts storage queries &gt; updates alerts with provided fields" time="0.026">
        </testcase>
        <testcase classname="test/alerts-storage.spec.ts" name="alerts storage queries &gt; deletes alerts" time="0.061">
        </testcase>
        <testcase classname="test/alerts-storage.spec.ts" name="alerts storage queries &gt; lists active alerts" time="0.028">
        </testcase>
        <testcase classname="test/alerts-storage.spec.ts" name="alerts state KV &gt; reads and writes state snapshots" time="0.025">
            <system-out>
[KV Cache] Queued state update for alert 1 (1 pending writes)

            </system-out>
        </testcase>
        <testcase classname="test/alerts-storage.spec.ts" name="alerts state KV &gt; deletes state" time="0.028">
            <system-out>
[KV Cache] Queued state update for alert 1 (1 pending writes)

            </system-out>
        </testcase>
    </testsuite>
    <testsuite name="test/alerts-validation.spec.ts" timestamp="2025-12-14T20:04:38.179Z" hostname="sngvahmed" tests="4" failures="0" errors="0" skipped="0" time="0.222">
        <testcase classname="test/alerts-validation.spec.ts" name="alert validation &gt; validates creation payloads" time="0.036">
        </testcase>
        <testcase classname="test/alerts-validation.spec.ts" name="alert validation &gt; rejects invalid creation payloads" time="0.031">
        </testcase>
        <testcase classname="test/alerts-validation.spec.ts" name="alert validation &gt; validates updates" time="0.063">
        </testcase>
        <testcase classname="test/alerts-validation.spec.ts" name="alert validation &gt; requires at least one field on update" time="0.03">
        </testcase>
    </testsuite>
    <testsuite name="test/api-comprehensive.spec.ts" timestamp="2025-12-14T20:04:38.179Z" hostname="sngvahmed" tests="35" failures="0" errors="0" skipped="0" time="1.454">
        <testcase classname="test/api-comprehensive.spec.ts" name="API - Health Check &gt; GET /v1/api/health returns OK status" time="0.012">
        </testcase>
        <testcase classname="test/api-comprehensive.spec.ts" name="API - Get Single Stock &gt; GET /v1/api/get-stock returns stock data with all required fields" time="0.795">
            <system-out>
{&quot;timestamp&quot;:&quot;2025-12-14T20:04:26.156Z&quot;,&quot;service&quot;:&quot;stockly-api-test&quot;,&quot;level&quot;:&quot;INFO&quot;,&quot;traceId&quot;:&quot;test-trace-id&quot;,&quot;userId&quot;:null,&quot;path&quot;:&quot;/test&quot;,&quot;message&quot;:&quot;No cache for AAPL&quot;,&quot;type&quot;:&quot;general&quot;,&quot;cacheStatus&quot;:&quot;MISS&quot;}

{&quot;timestamp&quot;:&quot;2025-12-14T20:04:26.157Z&quot;,&quot;service&quot;:&quot;stockly-api-test&quot;,&quot;level&quot;:&quot;DEBUG&quot;,&quot;traceId&quot;:&quot;test-trace-id&quot;,&quot;userId&quot;:null,&quot;path&quot;:&quot;/test&quot;,&quot;message&quot;:&quot;FMP API: GET /quote&quot;,&quot;type&quot;:&quot;api_call&quot;,&quot;apiProvider&quot;:&quot;FMP&quot;,&quot;endpoint&quot;:&quot;/quote&quot;,&quot;method&quot;:&quot;GET&quot;,&quot;latencyMs&quot;:0}

{&quot;timestamp&quot;:&quot;2025-12-14T20:04:26.157Z&quot;,&quot;service&quot;:&quot;stockly-api-test&quot;,&quot;level&quot;:&quot;DEBUG&quot;,&quot;traceId&quot;:&quot;test-trace-id&quot;,&quot;userId&quot;:null,&quot;path&quot;:&quot;/test&quot;,&quot;message&quot;:&quot;FMP API: GET /profile&quot;,&quot;type&quot;:&quot;api_call&quot;,&quot;apiProvider&quot;:&quot;FMP&quot;,&quot;endpoint&quot;:&quot;/profile&quot;,&quot;method&quot;:&quot;GET&quot;,&quot;statusCode&quot;:404,&quot;latencyMs&quot;:0}

{&quot;timestamp&quot;:&quot;2025-12-14T20:04:26.511Z&quot;,&quot;service&quot;:&quot;stockly-api-test&quot;,&quot;level&quot;:&quot;DEBUG&quot;,&quot;traceId&quot;:&quot;test-trace-id&quot;,&quot;userId&quot;:null,&quot;path&quot;:&quot;/test&quot;,&quot;message&quot;:&quot;FMP API: GET /profile&quot;,&quot;type&quot;:&quot;api_call&quot;,&quot;apiProvider&quot;:&quot;FMP&quot;,&quot;endpoint&quot;:&quot;/profile&quot;,&quot;method&quot;:&quot;GET&quot;,&quot;statusCode&quot;:404,&quot;latencyMs&quot;:353}

{&quot;timestamp&quot;:&quot;2025-12-14T20:04:26.852Z&quot;,&quot;service&quot;:&quot;stockly-api-test&quot;,&quot;level&quot;:&quot;DEBUG&quot;,&quot;traceId&quot;:&quot;test-trace-id&quot;,&quot;userId&quot;:null,&quot;path&quot;:&quot;/test&quot;,&quot;message&quot;:&quot;FMP API: GET /profile&quot;,&quot;type&quot;:&quot;api_call&quot;,&quot;apiProvider&quot;:&quot;FMP&quot;,&quot;endpoint&quot;:&quot;/profile&quot;,&quot;method&quot;:&quot;GET&quot;,&quot;statusCode&quot;:404,&quot;latencyMs&quot;:340}

{&quot;timestamp&quot;:&quot;2025-12-14T20:04:26.945Z&quot;,&quot;service&quot;:&quot;stockly-api-test&quot;,&quot;level&quot;:&quot;DEBUG&quot;,&quot;traceId&quot;:&quot;test-trace-id&quot;,&quot;userId&quot;:null,&quot;path&quot;:&quot;/test&quot;,&quot;message&quot;:&quot;FMP API: GET /profile&quot;,&quot;type&quot;:&quot;api_call&quot;,&quot;apiProvider&quot;:&quot;FMP&quot;,&quot;endpoint&quot;:&quot;/profile&quot;,&quot;method&quot;:&quot;GET&quot;,&quot;statusCode&quot;:403,&quot;latencyMs&quot;:93}

{&quot;timestamp&quot;:&quot;2025-12-14T20:04:26.946Z&quot;,&quot;service&quot;:&quot;stockly-api-test&quot;,&quot;level&quot;:&quot;DEBUG&quot;,&quot;traceId&quot;:&quot;test-trace-id&quot;,&quot;userId&quot;:null,&quot;path&quot;:&quot;/test&quot;,&quot;message&quot;:&quot;Final description resolved&quot;,&quot;type&quot;:&quot;general&quot;,&quot;hasDescription&quot;:true,&quot;descriptionLength&quot;:38,&quot;source&quot;:&quot;quote&quot;}

            </system-out>
            <system-err>
{&quot;timestamp&quot;:&quot;2025-12-14T20:04:26.158Z&quot;,&quot;service&quot;:&quot;stockly-api-test&quot;,&quot;level&quot;:&quot;WARN&quot;,&quot;traceId&quot;:&quot;test-trace-id&quot;,&quot;userId&quot;:null,&quot;path&quot;:&quot;/test&quot;,&quot;message&quot;:&quot;Failed to fetch profile&quot;,&quot;type&quot;:&quot;general&quot;,&quot;endpoint&quot;:&quot;https://financialmodelingprep.com/stable/profile?symbol=AAPL&amp;apikey=z5xjUUlsab7zBKntL5QnMzWyPuq2iWsM&quot;,&quot;error&quot;:&quot;profileRes.text is not a function&quot;}

{&quot;timestamp&quot;:&quot;2025-12-14T20:04:26.512Z&quot;,&quot;service&quot;:&quot;stockly-api-test&quot;,&quot;level&quot;:&quot;WARN&quot;,&quot;traceId&quot;:&quot;test-trace-id&quot;,&quot;userId&quot;:null,&quot;path&quot;:&quot;/test&quot;,&quot;message&quot;:&quot;Profile API returned non-ok status&quot;,&quot;type&quot;:&quot;general&quot;,&quot;endpoint&quot;:&quot;https://financialmodelingprep.com/stable/profile/AAPL?apikey=z5xjUUlsab7zBKntL5QnMzWyPuq2iWsM&quot;,&quot;statusCode&quot;:404,&quot;errorText&quot;:&quot;[]&quot;}

{&quot;timestamp&quot;:&quot;2025-12-14T20:04:26.852Z&quot;,&quot;service&quot;:&quot;stockly-api-test&quot;,&quot;level&quot;:&quot;WARN&quot;,&quot;traceId&quot;:&quot;test-trace-id&quot;,&quot;userId&quot;:null,&quot;path&quot;:&quot;/test&quot;,&quot;message&quot;:&quot;Profile API returned non-ok status&quot;,&quot;type&quot;:&quot;general&quot;,&quot;endpoint&quot;:&quot;https://financialmodelingprep.com/stable/company/profile/AAPL?apikey=z5xjUUlsab7zBKntL5QnMzWyPuq2iWsM&quot;,&quot;statusCode&quot;:404,&quot;errorText&quot;:&quot;[]&quot;}

{&quot;timestamp&quot;:&quot;2025-12-14T20:04:26.946Z&quot;,&quot;service&quot;:&quot;stockly-api-test&quot;,&quot;level&quot;:&quot;WARN&quot;,&quot;traceId&quot;:&quot;test-trace-id&quot;,&quot;userId&quot;:null,&quot;path&quot;:&quot;/test&quot;,&quot;message&quot;:&quot;Profile API returned non-ok status&quot;,&quot;type&quot;:&quot;general&quot;,&quot;endpoint&quot;:&quot;https://financialmodelingprep.com/api/v3/profile/AAPL?apikey=z5xjUUlsab7zBKntL5QnMzWyPuq2iWsM&quot;,&quot;statusCode&quot;:403,&quot;errorText&quot;:&quot;{\n  \&quot;Error Message\&quot;: \&quot;Legacy Endpoint : Due to Legacy endpoints being no longer supported - This endpoint is only available for legacy users who have valid subscriptions prior August 31, 2025. Please &quot;}

            </system-err>
        </testcase>
        <testcase classname="test/api-comprehensive.spec.ts" name="API - Get Single Stock &gt; GET /v1/api/get-stock returns 400 when symbol is missing" time="0.004">
        </testcase>
        <testcase classname="test/api-comprehensive.spec.ts" name="API - Get Multiple Stocks &gt; GET /v1/api/get-stocks returns array of stocks with all fields" time="0.003">
        </testcase>
        <testcase classname="test/api-comprehensive.spec.ts" name="API - Get Multiple Stocks &gt; GET /v1/api/get-stocks returns 400 when symbols parameter is missing" time="0.002">
        </testcase>
        <testcase classname="test/api-comprehensive.spec.ts" name="API - Search Stocks &gt; GET /v1/api/search-stock returns matching stocks" time="0.003">
        </testcase>
        <testcase classname="test/api-comprehensive.spec.ts" name="API - Search Stocks &gt; GET /v1/api/search-stock returns empty array when query is missing" time="0.003">
        </testcase>
        <testcase classname="test/api-comprehensive.spec.ts" name="API - Get Historical &gt; GET /v1/api/get-historical returns historical data" time="0.507">
            <system-out>
[getHistoricalPricesByDateRange] Querying database for AAPL from 2025-06-17 to 2025-12-14

[getHistoricalPricesByDateRange] Found 2 records for AAPL in date range 2025-06-17 to 2025-12-14

[get-historical] Query result for AAPL (2025-06-17 to 2025-12-14): 2 records found in database
{&quot;timestamp&quot;:&quot;2025-12-14T20:04:26.970Z&quot;,&quot;service&quot;:&quot;stockly-api-test&quot;,&quot;level&quot;:&quot;INFO&quot;,&quot;traceId&quot;:&quot;test-trace-id&quot;,&quot;userId&quot;:null,&quot;path&quot;:&quot;/test&quot;,&quot;message&quot;:&quot;No historical data in database for AAPL&quot;,&quot;type&quot;:&quot;general&quot;,&quot;dateRange&quot;:&quot;2025-06-17 to 2025-12-14&quot;,&quot;action&quot;:&quot;fetching from FMP API&quot;}
[fetchAndSaveHistoricalPrice] Starting fetch for AAPL from FMP API
[fetchAndSaveHistoricalPrice] Fetching from: https://financialmodelingprep.com/stable/historical-chart/30min?symbol=AAPL&amp;apikey=***&amp;from=2025-06-17&amp;to=2025-12-14

[fetchAndSaveHistoricalPrice] Received 2 1-hour OHLC records from FMP API
[fetchAndSaveHistoricalPrice] FMP API returned 2 records for AAPL
[fetchAndSaveHistoricalPrice] Sample record structure: {
  date: undefined,
  hasOpen: false,
  hasHigh: false,
  hasLow: false,
  hasClose: false,
  hasPrice: false,
  keys: [ &apos;symbol&apos;, &apos;name&apos;, &apos;currency&apos;, &apos;stockExchange&apos; ]
}
Saved 0 daily candles (aggregated from 2 1-hour records) for AAPL with OHLC data

[getHistoricalPricesByDateRange] Querying database for AAPL from 2025-06-17 to 2025-12-14

[getHistoricalPricesByDateRange] Found 2 records for AAPL in date range 2025-06-17 to 2025-12-14

{&quot;timestamp&quot;:&quot;2025-12-14T20:04:27.474Z&quot;,&quot;service&quot;:&quot;stockly-api-test&quot;,&quot;level&quot;:&quot;DEBUG&quot;,&quot;traceId&quot;:&quot;test-trace-id&quot;,&quot;userId&quot;:null,&quot;path&quot;:&quot;/test&quot;,&quot;message&quot;:&quot;After FMP fetch, query result for AAPL&quot;,&quot;type&quot;:&quot;general&quot;,&quot;dateRange&quot;:&quot;2025-06-17 to 2025-12-14&quot;,&quot;recordCount&quot;:2}
[get-historical] Successfully fetched 2 historical records for AAPL from FMP API

            </system-out>
            <system-err>
{&quot;timestamp&quot;:&quot;2025-12-14T20:04:26.970Z&quot;,&quot;service&quot;:&quot;stockly-api-test&quot;,&quot;level&quot;:&quot;WARN&quot;,&quot;traceId&quot;:&quot;test-trace-id&quot;,&quot;userId&quot;:null,&quot;path&quot;:&quot;/test&quot;,&quot;message&quot;:&quot;Found 2 records with missing OHLC data&quot;,&quot;type&quot;:&quot;general&quot;,&quot;symbol&quot;:&quot;AAPL&quot;,&quot;recordsWithMissingOHLC&quot;:2,&quot;totalRecords&quot;:2}

[fetchAndSaveHistoricalPrice] Failed to parse date from timestamp undefined, skipping record
[fetchAndSaveHistoricalPrice] Failed to parse date from timestamp undefined, skipping record

            </system-err>
        </testcase>
        <testcase classname="test/api-comprehensive.spec.ts" name="API - Get Historical &gt; GET /v1/api/get-historical returns 400 when symbol is missing" time="0.004">
        </testcase>
        <testcase classname="test/api-comprehensive.spec.ts" name="API - Alerts &gt; GET /v1/api/alerts lists all alerts" time="0.005">
            <system-out>
{&quot;timestamp&quot;:&quot;2025-12-14T20:04:27.485Z&quot;,&quot;service&quot;:&quot;stockly-api-test&quot;,&quot;level&quot;:&quot;INFO&quot;,&quot;traceId&quot;:&quot;test-trace-id&quot;,&quot;userId&quot;:null,&quot;path&quot;:&quot;/test&quot;,&quot;message&quot;:&quot;Alerts request authenticated&quot;,&quot;type&quot;:&quot;general&quot;,&quot;username&quot;:&quot;testuser&quot;,&quot;isAdmin&quot;:false,&quot;requestUsername&quot;:&quot;testuser&quot;,&quot;method&quot;:&quot;GET&quot;}

{&quot;timestamp&quot;:&quot;2025-12-14T20:04:27.485Z&quot;,&quot;service&quot;:&quot;stockly-api-test&quot;,&quot;level&quot;:&quot;INFO&quot;,&quot;traceId&quot;:&quot;test-trace-id&quot;,&quot;userId&quot;:null,&quot;path&quot;:&quot;/test&quot;,&quot;message&quot;:&quot;Fetched alerts from D1&quot;,&quot;type&quot;:&quot;general&quot;,&quot;username&quot;:&quot;testuser&quot;,&quot;alertCount&quot;:1,&quot;alertIds&quot;:[&quot;alert-123&quot;]}

            </system-out>
        </testcase>
        <testcase classname="test/api-comprehensive.spec.ts" name="API - Alerts &gt; POST /v1/api/alerts creates a new alert" time="0.006">
            <system-out>
{&quot;timestamp&quot;:&quot;2025-12-14T20:04:27.490Z&quot;,&quot;service&quot;:&quot;stockly-api-test&quot;,&quot;level&quot;:&quot;INFO&quot;,&quot;traceId&quot;:&quot;test-trace-id&quot;,&quot;userId&quot;:null,&quot;path&quot;:&quot;/test&quot;,&quot;message&quot;:&quot;Alerts request authenticated&quot;,&quot;type&quot;:&quot;general&quot;,&quot;username&quot;:&quot;testuser&quot;,&quot;isAdmin&quot;:false,&quot;requestUsername&quot;:&quot;testuser&quot;,&quot;method&quot;:&quot;POST&quot;}

{&quot;timestamp&quot;:&quot;2025-12-14T20:04:27.491Z&quot;,&quot;service&quot;:&quot;stockly-api-test&quot;,&quot;level&quot;:&quot;INFO&quot;,&quot;traceId&quot;:&quot;test-trace-id&quot;,&quot;userId&quot;:null,&quot;path&quot;:&quot;/test&quot;,&quot;message&quot;:&quot;Creating alert&quot;,&quot;type&quot;:&quot;general&quot;,&quot;username&quot;:&quot;testuser&quot;,&quot;symbol&quot;:&quot;AAPL&quot;,&quot;direction&quot;:&quot;above&quot;,&quot;threshold&quot;:200}

{&quot;timestamp&quot;:&quot;2025-12-14T20:04:27.491Z&quot;,&quot;service&quot;:&quot;stockly-api-test&quot;,&quot;level&quot;:&quot;INFO&quot;,&quot;traceId&quot;:&quot;test-trace-id&quot;,&quot;userId&quot;:null,&quot;path&quot;:&quot;/test&quot;,&quot;message&quot;:&quot;Created alert successfully&quot;,&quot;type&quot;:&quot;general&quot;,&quot;alertId&quot;:&quot;alert-123&quot;,&quot;username&quot;:&quot;testuser&quot;,&quot;alertUsername&quot;:&quot;testuser&quot;,&quot;isAdmin&quot;:false}

            </system-out>
        </testcase>
        <testcase classname="test/api-comprehensive.spec.ts" name="API - Alerts &gt; GET /v1/api/alerts/:id gets a specific alert" time="0.003">
            <system-out>
{&quot;timestamp&quot;:&quot;2025-12-14T20:04:27.495Z&quot;,&quot;service&quot;:&quot;stockly-api-test&quot;,&quot;level&quot;:&quot;INFO&quot;,&quot;traceId&quot;:&quot;test-trace-id&quot;,&quot;userId&quot;:null,&quot;path&quot;:&quot;/test&quot;,&quot;message&quot;:&quot;Alerts request authenticated&quot;,&quot;type&quot;:&quot;general&quot;,&quot;username&quot;:&quot;testuser&quot;,&quot;isAdmin&quot;:false,&quot;requestUsername&quot;:&quot;testuser&quot;,&quot;method&quot;:&quot;GET&quot;}

            </system-out>
        </testcase>
        <testcase classname="test/api-comprehensive.spec.ts" name="API - Alerts &gt; PUT /v1/api/alerts/:id updates an alert" time="0.003">
            <system-out>
{&quot;timestamp&quot;:&quot;2025-12-14T20:04:27.499Z&quot;,&quot;service&quot;:&quot;stockly-api-test&quot;,&quot;level&quot;:&quot;INFO&quot;,&quot;traceId&quot;:&quot;test-trace-id&quot;,&quot;userId&quot;:null,&quot;path&quot;:&quot;/test&quot;,&quot;message&quot;:&quot;Alerts request authenticated&quot;,&quot;type&quot;:&quot;general&quot;,&quot;username&quot;:&quot;testuser&quot;,&quot;isAdmin&quot;:false,&quot;requestUsername&quot;:&quot;testuser&quot;,&quot;method&quot;:&quot;PUT&quot;}

{&quot;timestamp&quot;:&quot;2025-12-14T20:04:27.499Z&quot;,&quot;service&quot;:&quot;stockly-api-test&quot;,&quot;level&quot;:&quot;INFO&quot;,&quot;traceId&quot;:&quot;test-trace-id&quot;,&quot;userId&quot;:null,&quot;path&quot;:&quot;/test&quot;,&quot;message&quot;:&quot;Updated alert&quot;,&quot;type&quot;:&quot;general&quot;,&quot;alertId&quot;:&quot;alert-123&quot;,&quot;username&quot;:&quot;testuser&quot;}

            </system-out>
        </testcase>
        <testcase classname="test/api-comprehensive.spec.ts" name="API - Alerts &gt; DELETE /v1/api/alerts/:id deletes an alert" time="0.002">
            <system-out>
{&quot;timestamp&quot;:&quot;2025-12-14T20:04:27.502Z&quot;,&quot;service&quot;:&quot;stockly-api-test&quot;,&quot;level&quot;:&quot;INFO&quot;,&quot;traceId&quot;:&quot;test-trace-id&quot;,&quot;userId&quot;:null,&quot;path&quot;:&quot;/test&quot;,&quot;message&quot;:&quot;Alerts request authenticated&quot;,&quot;type&quot;:&quot;general&quot;,&quot;username&quot;:&quot;testuser&quot;,&quot;isAdmin&quot;:false,&quot;requestUsername&quot;:&quot;testuser&quot;,&quot;method&quot;:&quot;DELETE&quot;}

{&quot;timestamp&quot;:&quot;2025-12-14T20:04:27.502Z&quot;,&quot;service&quot;:&quot;stockly-api-test&quot;,&quot;level&quot;:&quot;INFO&quot;,&quot;traceId&quot;:&quot;test-trace-id&quot;,&quot;userId&quot;:null,&quot;path&quot;:&quot;/test&quot;,&quot;message&quot;:&quot;Deleted alert&quot;,&quot;type&quot;:&quot;general&quot;,&quot;alertId&quot;:&quot;alert-123&quot;,&quot;username&quot;:&quot;testuser&quot;}

            </system-out>
        </testcase>
        <testcase classname="test/api-comprehensive.spec.ts" name="API - Push Token &gt; POST /v1/api/push-token registers a new push token" time="0.004">
            <system-out>
✅ FCM token validation passed: length=30, format valid

{&quot;timestamp&quot;:&quot;2025-12-14T20:04:27.507Z&quot;,&quot;service&quot;:&quot;stockly-api-test&quot;,&quot;level&quot;:&quot;INFO&quot;,&quot;traceId&quot;:&quot;test-trace-id&quot;,&quot;userId&quot;:&quot;user-123&quot;,&quot;path&quot;:&quot;/test&quot;,&quot;message&quot;:&quot;Registering new push token&quot;,&quot;type&quot;:&quot;general&quot;,&quot;username&quot;:&quot;testuser&quot;,&quot;deviceType&quot;:&quot;ios&quot;,&quot;tokenPreview&quot;:&quot;fcm-token-1234567890...&quot;}

{&quot;timestamp&quot;:&quot;2025-12-14T20:04:27.507Z&quot;,&quot;service&quot;:&quot;stockly-api-test&quot;,&quot;level&quot;:&quot;INFO&quot;,&quot;traceId&quot;:&quot;test-trace-id&quot;,&quot;userId&quot;:&quot;user-123&quot;,&quot;path&quot;:&quot;/test&quot;,&quot;message&quot;:&quot;Push token registered successfully&quot;,&quot;type&quot;:&quot;general&quot;,&quot;username&quot;:&quot;testuser&quot;,&quot;deviceType&quot;:&quot;ios&quot;,&quot;deviceId&quot;:&quot;fcm-token-1234567890...&quot;}

            </system-out>
        </testcase>
        <testcase classname="test/api-comprehensive.spec.ts" name="API - Push Token &gt; POST /v1/api/push-token updates existing push token" time="0.003">
            <system-out>
✅ FCM token validation passed: length=30, format valid

{&quot;timestamp&quot;:&quot;2025-12-14T20:04:27.511Z&quot;,&quot;service&quot;:&quot;stockly-api-test&quot;,&quot;level&quot;:&quot;INFO&quot;,&quot;traceId&quot;:&quot;test-trace-id&quot;,&quot;userId&quot;:&quot;user-123&quot;,&quot;path&quot;:&quot;/test&quot;,&quot;message&quot;:&quot;Updating existing push token&quot;,&quot;type&quot;:&quot;general&quot;,&quot;username&quot;:&quot;testuser&quot;,&quot;deviceType&quot;:&quot;ios&quot;}

{&quot;timestamp&quot;:&quot;2025-12-14T20:04:27.511Z&quot;,&quot;service&quot;:&quot;stockly-api-test&quot;,&quot;level&quot;:&quot;INFO&quot;,&quot;traceId&quot;:&quot;test-trace-id&quot;,&quot;userId&quot;:&quot;user-123&quot;,&quot;path&quot;:&quot;/test&quot;,&quot;message&quot;:&quot;Push token updated successfully&quot;,&quot;type&quot;:&quot;general&quot;,&quot;username&quot;:&quot;testuser&quot;,&quot;deviceType&quot;:&quot;ios&quot;}

            </system-out>
        </testcase>
        <testcase classname="test/api-comprehensive.spec.ts" name="API - Push Token &gt; POST /v1/api/push-token returns 400 for invalid token format" time="0.004">
        </testcase>
        <testcase classname="test/api-comprehensive.spec.ts" name="API - Push Token &gt; GET /v1/api/push-token gets a user&apos;s push token" time="0.002">
        </testcase>
        <testcase classname="test/api-comprehensive.spec.ts" name="API - Push Token &gt; GET /v1/api/push-token returns 404 when token not found" time="0.003">
        </testcase>
        <testcase classname="test/api-comprehensive.spec.ts" name="API - Preferences &gt; GET /v1/api/preferences gets user preferences" time="0.002">
        </testcase>
        <testcase classname="test/api-comprehensive.spec.ts" name="API - Preferences &gt; GET /v1/api/preferences returns default preferences when not found" time="0.003">
        </testcase>
        <testcase classname="test/api-comprehensive.spec.ts" name="API - Preferences &gt; PUT /v1/api/preferences updates user preferences" time="0.003">
        </testcase>
        <testcase classname="test/api-comprehensive.spec.ts" name="API - Settings &gt; GET /v1/api/settings gets user settings" time="0.003">
        </testcase>
        <testcase classname="test/api-comprehensive.spec.ts" name="API - Settings &gt; GET /v1/api/settings returns default settings when not found" time="0.002">
        </testcase>
        <testcase classname="test/api-comprehensive.spec.ts" name="API - Settings &gt; PUT /v1/api/settings updates user settings" time="0.003">
        </testcase>
        <testcase classname="test/api-comprehensive.spec.ts" name="API - Notifications &gt; GET /v1/api/notifications/recent returns recent notifications" time="0.002">
        </testcase>
        <testcase classname="test/api-comprehensive.spec.ts" name="API - Notifications &gt; GET /v1/api/notifications/failed returns failed notifications" time="0.003">
        </testcase>
        <testcase classname="test/api-comprehensive.spec.ts" name="API - Notifications &gt; POST /v1/api/notifications/retry/:logId retries a failed notification" time="0.003">
        </testcase>
        <testcase classname="test/api-comprehensive.spec.ts" name="API - Devices &gt; GET /v1/api/devices returns all devices" time="0.004">
            <system-err>
{&quot;timestamp&quot;:&quot;2025-12-14T20:04:27.557Z&quot;,&quot;service&quot;:&quot;stockly-api-test&quot;,&quot;level&quot;:&quot;WARN&quot;,&quot;traceId&quot;:&quot;test-trace-id&quot;,&quot;userId&quot;:null,&quot;path&quot;:&quot;/test&quot;,&quot;message&quot;:&quot;Found devices with null username&quot;,&quot;type&quot;:&quot;general&quot;,&quot;count&quot;:1,&quot;deviceIds&quot;:[&quot;fcm-token-123...&quot;]}

            </system-err>
        </testcase>
        <testcase classname="test/api-comprehensive.spec.ts" name="API - Devices &gt; DELETE /v1/api/devices deletes a device" time="0.003">
            <system-out>
{&quot;timestamp&quot;:&quot;2025-12-14T20:04:27.561Z&quot;,&quot;service&quot;:&quot;stockly-api-test&quot;,&quot;level&quot;:&quot;INFO&quot;,&quot;traceId&quot;:&quot;test-trace-id&quot;,&quot;userId&quot;:null,&quot;path&quot;:&quot;/test&quot;,&quot;message&quot;:&quot;Device deleted successfully&quot;,&quot;type&quot;:&quot;general&quot;,&quot;deletedPushToken&quot;:&quot;fcm-token-1234567890...&quot;,&quot;deletedUserId&quot;:&quot;user-123&quot;,&quot;deletedBy&quot;:&quot;testuser&quot;,&quot;isAdmin&quot;:true}

            </system-out>
        </testcase>
        <testcase classname="test/api-comprehensive.spec.ts" name="API - Admin Config &gt; GET /config/get returns admin configuration" time="0.002">
        </testcase>
        <testcase classname="test/api-comprehensive.spec.ts" name="API - Admin Config &gt; POST /config/update updates admin configuration" time="0.003">
        </testcase>
        <testcase classname="test/api-comprehensive.spec.ts" name="API - Admin Config &gt; POST /v1/api/simulate-provider-failure enables simulation mode" time="0.002">
        </testcase>
        <testcase classname="test/api-comprehensive.spec.ts" name="API - Admin Config &gt; POST /v1/api/disable-provider-failure disables simulation mode" time="0.002">
        </testcase>
        <testcase classname="test/api-comprehensive.spec.ts" name="API - OpenAPI &gt; GET /openapi.json returns OpenAPI specification" time="0.003">
        </testcase>
    </testsuite>
    <testsuite name="test/api-integration.spec.ts" timestamp="2025-12-14T20:04:38.184Z" hostname="sngvahmed" tests="17" failures="0" errors="0" skipped="0" time="1.396">
        <testcase classname="test/api-integration.spec.ts" name="API Integration - Health Check &gt; health endpoint returns OK status" time="0.029">
        </testcase>
        <testcase classname="test/api-integration.spec.ts" name="API Integration - Get Stock &gt; successfully fetches and returns stock data with all required fields" time="0.023">
            <system-out>
{&quot;timestamp&quot;:&quot;2025-12-14T20:04:26.014Z&quot;,&quot;service&quot;:&quot;stockly-api-test&quot;,&quot;level&quot;:&quot;INFO&quot;,&quot;traceId&quot;:&quot;test-trace-id&quot;,&quot;userId&quot;:null,&quot;path&quot;:&quot;/test&quot;,&quot;message&quot;:&quot;No cache for AAPL&quot;,&quot;type&quot;:&quot;general&quot;,&quot;cacheStatus&quot;:&quot;MISS&quot;}

{&quot;timestamp&quot;:&quot;2025-12-14T20:04:26.015Z&quot;,&quot;service&quot;:&quot;stockly-api-test&quot;,&quot;level&quot;:&quot;DEBUG&quot;,&quot;traceId&quot;:&quot;test-trace-id&quot;,&quot;userId&quot;:null,&quot;path&quot;:&quot;/test&quot;,&quot;message&quot;:&quot;FMP API: GET /quote&quot;,&quot;type&quot;:&quot;api_call&quot;,&quot;apiProvider&quot;:&quot;FMP&quot;,&quot;endpoint&quot;:&quot;/quote&quot;,&quot;method&quot;:&quot;GET&quot;,&quot;latencyMs&quot;:0}

{&quot;timestamp&quot;:&quot;2025-12-14T20:04:26.015Z&quot;,&quot;service&quot;:&quot;stockly-api-test&quot;,&quot;level&quot;:&quot;DEBUG&quot;,&quot;traceId&quot;:&quot;test-trace-id&quot;,&quot;userId&quot;:null,&quot;path&quot;:&quot;/test&quot;,&quot;message&quot;:&quot;FMP API: GET /profile&quot;,&quot;type&quot;:&quot;api_call&quot;,&quot;apiProvider&quot;:&quot;FMP&quot;,&quot;endpoint&quot;:&quot;/profile&quot;,&quot;method&quot;:&quot;GET&quot;,&quot;latencyMs&quot;:0}

{&quot;timestamp&quot;:&quot;2025-12-14T20:04:26.016Z&quot;,&quot;service&quot;:&quot;stockly-api-test&quot;,&quot;level&quot;:&quot;DEBUG&quot;,&quot;traceId&quot;:&quot;test-trace-id&quot;,&quot;userId&quot;:null,&quot;path&quot;:&quot;/test&quot;,&quot;message&quot;:&quot;Profile API response&quot;,&quot;type&quot;:&quot;general&quot;,&quot;endpoint&quot;:&quot;https://financialmodelingprep.com/stable/profile?symbol=AAPL&amp;apikey=z5xjUUlsab7zBKntL5QnMzWyPuq2iWsM&quot;,&quot;responseType&quot;:&quot;array&quot;,&quot;responseLength&quot;:1}
{&quot;timestamp&quot;:&quot;2025-12-14T20:04:26.016Z&quot;,&quot;service&quot;:&quot;stockly-api-test&quot;,&quot;level&quot;:&quot;DEBUG&quot;,&quot;traceId&quot;:&quot;test-trace-id&quot;,&quot;userId&quot;:null,&quot;path&quot;:&quot;/test&quot;,&quot;message&quot;:&quot;Found description from profile&quot;,&quot;type&quot;:&quot;general&quot;,&quot;descriptionLength&quot;:38}
{&quot;timestamp&quot;:&quot;2025-12-14T20:04:26.016Z&quot;,&quot;service&quot;:&quot;stockly-api-test&quot;,&quot;level&quot;:&quot;DEBUG&quot;,&quot;traceId&quot;:&quot;test-trace-id&quot;,&quot;userId&quot;:null,&quot;path&quot;:&quot;/test&quot;,&quot;message&quot;:&quot;Final description resolved&quot;,&quot;type&quot;:&quot;general&quot;,&quot;hasDescription&quot;:true,&quot;descriptionLength&quot;:38,&quot;source&quot;:&quot;profile&quot;}

            </system-out>
        </testcase>
        <testcase classname="test/api-integration.spec.ts" name="API Integration - Get Stock &gt; returns error when symbol is missing" time="0.017">
        </testcase>
        <testcase classname="test/api-integration.spec.ts" name="API Integration - Get Stock &gt; uses cache when available" time="0.02">
            <system-out>
{&quot;timestamp&quot;:&quot;2025-12-14T20:04:26.057Z&quot;,&quot;service&quot;:&quot;stockly-api-test&quot;,&quot;level&quot;:&quot;INFO&quot;,&quot;traceId&quot;:&quot;test-trace-id&quot;,&quot;userId&quot;:null,&quot;path&quot;:&quot;/test&quot;,&quot;message&quot;:&quot;Cache hit for MSFT&quot;,&quot;type&quot;:&quot;general&quot;,&quot;ageSeconds&quot;:0,&quot;pollingIntervalSec&quot;:30,&quot;cacheStatus&quot;:&quot;HIT&quot;}

            </system-out>
        </testcase>
        <testcase classname="test/api-integration.spec.ts" name="API Integration - Get Stocks &gt; successfully fetches multiple stocks with all required fields" time="0.015">
        </testcase>
        <testcase classname="test/api-integration.spec.ts" name="API Integration - Get Stocks &gt; returns error when symbols parameter is missing" time="0.016">
        </testcase>
        <testcase classname="test/api-integration.spec.ts" name="API Integration - Get Stocks &gt; handles empty symbols list" time="0.01">
        </testcase>
        <testcase classname="test/api-integration.spec.ts" name="API Integration - Search Stock &gt; successfully searches and returns matching stocks" time="0.012">
        </testcase>
        <testcase classname="test/api-integration.spec.ts" name="API Integration - Search Stock &gt; returns empty array when query parameter is missing" time="0.007">
        </testcase>
        <testcase classname="test/api-integration.spec.ts" name="API Integration - Get Historical &gt; successfully fetches historical price data" time="1.159">
            <system-out>
[getHistoricalPricesByDateRange] Querying database for AAPL from 2025-06-17 to 2025-12-14

[getHistoricalPricesByDateRange] Found 3 records for AAPL in date range 2025-06-17 to 2025-12-14

[get-historical] Query result for AAPL (2025-06-17 to 2025-12-14): 3 records found in database
{&quot;timestamp&quot;:&quot;2025-12-14T20:04:26.161Z&quot;,&quot;service&quot;:&quot;stockly-api-test&quot;,&quot;level&quot;:&quot;INFO&quot;,&quot;traceId&quot;:&quot;test-trace-id&quot;,&quot;userId&quot;:null,&quot;path&quot;:&quot;/test&quot;,&quot;message&quot;:&quot;No historical data in database for AAPL&quot;,&quot;type&quot;:&quot;general&quot;,&quot;dateRange&quot;:&quot;2025-06-17 to 2025-12-14&quot;,&quot;action&quot;:&quot;fetching from FMP API&quot;}
[fetchAndSaveHistoricalPrice] Starting fetch for AAPL from FMP API
[fetchAndSaveHistoricalPrice] Fetching from: https://financialmodelingprep.com/stable/historical-chart/30min?symbol=AAPL&amp;apikey=***&amp;from=2025-06-17&amp;to=2025-12-14

[fetchAndSaveHistoricalPrice] Received 241 1-hour OHLC records from FMP API
[fetchAndSaveHistoricalPrice] FMP API returned 241 records for AAPL
[fetchAndSaveHistoricalPrice] Sample record structure: {
  date: &apos;2025-12-12 15:30:00&apos;,
  hasOpen: true,
  hasHigh: true,
  hasLow: true,
  hasClose: true,
  hasPrice: false,
  keys: [ &apos;date&apos;, &apos;open&apos;, &apos;low&apos;, &apos;high&apos;, &apos;close&apos;, &apos;volume&apos; ]
}
Saved 19 daily candles (aggregated from 241 1-hour records) for AAPL with OHLC data

[getHistoricalPricesByDateRange] Querying database for AAPL from 2025-06-17 to 2025-12-14

[getHistoricalPricesByDateRange] Found 3 records for AAPL in date range 2025-06-17 to 2025-12-14

{&quot;timestamp&quot;:&quot;2025-12-14T20:04:27.313Z&quot;,&quot;service&quot;:&quot;stockly-api-test&quot;,&quot;level&quot;:&quot;DEBUG&quot;,&quot;traceId&quot;:&quot;test-trace-id&quot;,&quot;userId&quot;:null,&quot;path&quot;:&quot;/test&quot;,&quot;message&quot;:&quot;After FMP fetch, query result for AAPL&quot;,&quot;type&quot;:&quot;general&quot;,&quot;dateRange&quot;:&quot;2025-06-17 to 2025-12-14&quot;,&quot;recordCount&quot;:3}
[get-historical] Successfully fetched 3 historical records for AAPL from FMP API

            </system-out>
            <system-err>
{&quot;timestamp&quot;:&quot;2025-12-14T20:04:26.161Z&quot;,&quot;service&quot;:&quot;stockly-api-test&quot;,&quot;level&quot;:&quot;WARN&quot;,&quot;traceId&quot;:&quot;test-trace-id&quot;,&quot;userId&quot;:null,&quot;path&quot;:&quot;/test&quot;,&quot;message&quot;:&quot;Found 3 records with missing OHLC data&quot;,&quot;type&quot;:&quot;general&quot;,&quot;symbol&quot;:&quot;AAPL&quot;,&quot;recordsWithMissingOHLC&quot;:3,&quot;totalRecords&quot;:3}

[fetchAndSaveHistoricalPrice] Insert with OHLC failed for AAPL on 2025-11-17, trying fallback without OHLC: env.stockly.prepare(...).bind(...).run is not a function
[fetchAndSaveHistoricalPrice] Failed to insert historical record for AAPL on 2025-11-17: env.stockly.prepare(...).bind(...).run is not a function
[fetchAndSaveHistoricalPrice] Insert with OHLC failed for AAPL on 2025-11-18, trying fallback without OHLC: env.stockly.prepare(...).bind(...).run is not a function
[fetchAndSaveHistoricalPrice] Failed to insert historical record for AAPL on 2025-11-18: env.stockly.prepare(...).bind(...).run is not a function
[fetchAndSaveHistoricalPrice] Insert with OHLC failed for AAPL on 2025-11-19, trying fallback without OHLC: env.stockly.prepare(...).bind(...).run is not a function
[fetchAndSaveHistoricalPrice] Failed to insert historical record for AAPL on 2025-11-19: env.stockly.prepare(...).bind(...).run is not a function
[fetchAndSaveHistoricalPrice] Insert with OHLC failed for AAPL on 2025-11-20, trying fallback without OHLC: env.stockly.prepare(...).bind(...).run is not a function
[fetchAndSaveHistoricalPrice] Failed to insert historical record for AAPL on 2025-11-20: env.stockly.prepare(...).bind(...).run is not a function
[fetchAndSaveHistoricalPrice] Insert with OHLC failed for AAPL on 2025-11-21, trying fallback without OHLC: env.stockly.prepare(...).bind(...).run is not a function
[fetchAndSaveHistoricalPrice] Failed to insert historical record for AAPL on 2025-11-21: env.stockly.prepare(...).bind(...).run is not a function
[fetchAndSaveHistoricalPrice] Insert with OHLC failed for AAPL on 2025-11-24, trying fallback without OHLC: env.stockly.prepare(...).bind(...).run is not a function
[fetchAndSaveHistoricalPrice] Failed to insert historical record for AAPL on 2025-11-24: env.stockly.prepare(...).bind(...).run is not a function
[fetchAndSaveHistoricalPrice] Insert with OHLC failed for AAPL on 2025-11-25, trying fallback without OHLC: env.stockly.prepare(...).bind(...).run is not a function
[fetchAndSaveHistoricalPrice] Failed to insert historical record for AAPL on 2025-11-25: env.stockly.prepare(...).bind(...).run is not a function
[fetchAndSaveHistoricalPrice] Insert with OHLC failed for AAPL on 2025-11-26, trying fallback without OHLC: env.stockly.prepare(...).bind(...).run is not a function
[fetchAndSaveHistoricalPrice] Failed to insert historical record for AAPL on 2025-11-26: env.stockly.prepare(...).bind(...).run is not a function
[fetchAndSaveHistoricalPrice] Insert with OHLC failed for AAPL on 2025-11-28, trying fallback without OHLC: env.stockly.prepare(...).bind(...).run is not a function
[fetchAndSaveHistoricalPrice] Failed to insert historical record for AAPL on 2025-11-28: env.stockly.prepare(...).bind(...).run is not a function
[fetchAndSaveHistoricalPrice] Insert with OHLC failed for AAPL on 2025-12-01, trying fallback without OHLC: env.stockly.prepare(...).bind(...).run is not a function
[fetchAndSaveHistoricalPrice] Failed to insert historical record for AAPL on 2025-12-01: env.stockly.prepare(...).bind(...).run is not a function
[fetchAndSaveHistoricalPrice] Insert with OHLC failed for AAPL on 2025-12-02, trying fallback without OHLC: env.stockly.prepare(...).bind(...).run is not a function
[fetchAndSaveHistoricalPrice] Failed to insert historical record for AAPL on 2025-12-02: env.stockly.prepare(...).bind(...).run is not a function
[fetchAndSaveHistoricalPrice] Insert with OHLC failed for AAPL on 2025-12-03, trying fallback without OHLC: env.stockly.prepare(...).bind(...).run is not a function
[fetchAndSaveHistoricalPrice] Failed to insert historical record for AAPL on 2025-12-03: env.stockly.prepare(...).bind(...).run is not a function
[fetchAndSaveHistoricalPrice] Insert with OHLC failed for AAPL on 2025-12-04, trying fallback without OHLC: env.stockly.prepare(...).bind(...).run is not a function
[fetchAndSaveHistoricalPrice] Failed to insert historical record for AAPL on 2025-12-04: env.stockly.prepare(...).bind(...).run is not a function
[fetchAndSaveHistoricalPrice] Insert with OHLC failed for AAPL on 2025-12-05, trying fallback without OHLC: env.stockly.prepare(...).bind(...).run is not a function
[fetchAndSaveHistoricalPrice] Failed to insert historical record for AAPL on 2025-12-05: env.stockly.prepare(...).bind(...).run is not a function
[fetchAndSaveHistoricalPrice] Insert with OHLC failed for AAPL on 2025-12-08, trying fallback without OHLC: env.stockly.prepare(...).bind(...).run is not a function
[fetchAndSaveHistoricalPrice] Failed to insert historical record for AAPL on 2025-12-08: env.stockly.prepare(...).bind(...).run is not a function
[fetchAndSaveHistoricalPrice] Insert with OHLC failed for AAPL on 2025-12-09, trying fallback without OHLC: env.stockly.prepare(...).bind(...).run is not a function
[fetchAndSaveHistoricalPrice] Failed to insert historical record for AAPL on 2025-12-09: env.stockly.prepare(...).bind(...).run is not a function
[fetchAndSaveHistoricalPrice] Insert with OHLC failed for AAPL on 2025-12-10, trying fallback without OHLC: env.stockly.prepare(...).bind(...).run is not a function
[fetchAndSaveHistoricalPrice] Failed to insert historical record for AAPL on 2025-12-10: env.stockly.prepare(...).bind(...).run is not a function
[fetchAndSaveHistoricalPrice] Insert with OHLC failed for AAPL on 2025-12-11, trying fallback without OHLC: env.stockly.prepare(...).bind(...).run is not a function
[fetchAndSaveHistoricalPrice] Failed to insert historical record for AAPL on 2025-12-11: env.stockly.prepare(...).bind(...).run is not a function
[fetchAndSaveHistoricalPrice] Insert with OHLC failed for AAPL on 2025-12-12, trying fallback without OHLC: env.stockly.prepare(...).bind(...).run is not a function
[fetchAndSaveHistoricalPrice] Failed to insert historical record for AAPL on 2025-12-12: env.stockly.prepare(...).bind(...).run is not a function

            </system-err>
        </testcase>
        <testcase classname="test/api-integration.spec.ts" name="API Integration - Get Historical &gt; returns error when symbol is missing" time="0.003">
        </testcase>
        <testcase classname="test/api-integration.spec.ts" name="API Integration - Get Historical &gt; validates days parameter" time="0.003">
        </testcase>
        <testcase classname="test/api-integration.spec.ts" name="API Integration - Alerts &gt; successfully lists all alerts" time="0.004">
            <system-out>
{&quot;timestamp&quot;:&quot;2025-12-14T20:04:27.324Z&quot;,&quot;service&quot;:&quot;stockly-api-test&quot;,&quot;level&quot;:&quot;INFO&quot;,&quot;traceId&quot;:&quot;test-trace-id&quot;,&quot;userId&quot;:null,&quot;path&quot;:&quot;/test&quot;,&quot;message&quot;:&quot;Alerts request authenticated&quot;,&quot;type&quot;:&quot;general&quot;,&quot;username&quot;:&quot;testuser&quot;,&quot;isAdmin&quot;:false,&quot;requestUsername&quot;:&quot;testuser&quot;,&quot;method&quot;:&quot;GET&quot;}

{&quot;timestamp&quot;:&quot;2025-12-14T20:04:27.325Z&quot;,&quot;service&quot;:&quot;stockly-api-test&quot;,&quot;level&quot;:&quot;INFO&quot;,&quot;traceId&quot;:&quot;test-trace-id&quot;,&quot;userId&quot;:null,&quot;path&quot;:&quot;/test&quot;,&quot;message&quot;:&quot;Fetched alerts from D1&quot;,&quot;type&quot;:&quot;general&quot;,&quot;username&quot;:&quot;testuser&quot;,&quot;alertCount&quot;:1,&quot;alertIds&quot;:[&quot;123e4567-e89b-12d3-a456-426614174000&quot;]}

            </system-out>
        </testcase>
        <testcase classname="test/api-integration.spec.ts" name="API Integration - Alerts &gt; successfully creates an alert" time="0.003">
            <system-out>
{&quot;timestamp&quot;:&quot;2025-12-14T20:04:27.328Z&quot;,&quot;service&quot;:&quot;stockly-api-test&quot;,&quot;level&quot;:&quot;INFO&quot;,&quot;traceId&quot;:&quot;test-trace-id&quot;,&quot;userId&quot;:null,&quot;path&quot;:&quot;/test&quot;,&quot;message&quot;:&quot;Alerts request authenticated&quot;,&quot;type&quot;:&quot;general&quot;,&quot;username&quot;:&quot;testuser&quot;,&quot;isAdmin&quot;:false,&quot;requestUsername&quot;:&quot;testuser&quot;,&quot;method&quot;:&quot;POST&quot;}

{&quot;timestamp&quot;:&quot;2025-12-14T20:04:27.328Z&quot;,&quot;service&quot;:&quot;stockly-api-test&quot;,&quot;level&quot;:&quot;INFO&quot;,&quot;traceId&quot;:&quot;test-trace-id&quot;,&quot;userId&quot;:null,&quot;path&quot;:&quot;/test&quot;,&quot;message&quot;:&quot;Creating alert&quot;,&quot;type&quot;:&quot;general&quot;,&quot;username&quot;:&quot;testuser&quot;,&quot;symbol&quot;:&quot;AAPL&quot;,&quot;direction&quot;:&quot;above&quot;,&quot;threshold&quot;:200}

{&quot;timestamp&quot;:&quot;2025-12-14T20:04:27.328Z&quot;,&quot;service&quot;:&quot;stockly-api-test&quot;,&quot;level&quot;:&quot;INFO&quot;,&quot;traceId&quot;:&quot;test-trace-id&quot;,&quot;userId&quot;:null,&quot;path&quot;:&quot;/test&quot;,&quot;message&quot;:&quot;Created alert successfully&quot;,&quot;type&quot;:&quot;general&quot;,&quot;alertId&quot;:&quot;123e4567-e89b-12d3-a456-426614174000&quot;,&quot;username&quot;:&quot;testuser&quot;,&quot;isAdmin&quot;:false}

            </system-out>
            <system-err>
{&quot;timestamp&quot;:&quot;2025-12-14T20:04:27.329Z&quot;,&quot;service&quot;:&quot;stockly-api-test&quot;,&quot;level&quot;:&quot;ERROR&quot;,&quot;traceId&quot;:&quot;test-trace-id&quot;,&quot;userId&quot;:null,&quot;path&quot;:&quot;/test&quot;,&quot;message&quot;:&quot;Alert created with mismatched username&quot;,&quot;type&quot;:&quot;general&quot;,&quot;error&quot;:&quot;[object Object]&quot;}

            </system-err>
        </testcase>
        <testcase classname="test/api-integration.spec.ts" name="API Integration - Alerts &gt; successfully updates an alert" time="0.003">
            <system-out>
{&quot;timestamp&quot;:&quot;2025-12-14T20:04:27.331Z&quot;,&quot;service&quot;:&quot;stockly-api-test&quot;,&quot;level&quot;:&quot;INFO&quot;,&quot;traceId&quot;:&quot;test-trace-id&quot;,&quot;userId&quot;:null,&quot;path&quot;:&quot;/test&quot;,&quot;message&quot;:&quot;Alerts request authenticated&quot;,&quot;type&quot;:&quot;general&quot;,&quot;username&quot;:&quot;testuser&quot;,&quot;isAdmin&quot;:false,&quot;requestUsername&quot;:&quot;testuser&quot;,&quot;method&quot;:&quot;PUT&quot;}

{&quot;timestamp&quot;:&quot;2025-12-14T20:04:27.331Z&quot;,&quot;service&quot;:&quot;stockly-api-test&quot;,&quot;level&quot;:&quot;INFO&quot;,&quot;traceId&quot;:&quot;test-trace-id&quot;,&quot;userId&quot;:null,&quot;path&quot;:&quot;/test&quot;,&quot;message&quot;:&quot;Updated alert&quot;,&quot;type&quot;:&quot;general&quot;,&quot;alertId&quot;:&quot;123e4567-e89b-12d3-a456-426614174000&quot;,&quot;username&quot;:&quot;testuser&quot;}

            </system-out>
        </testcase>
        <testcase classname="test/api-integration.spec.ts" name="API Integration - Alerts &gt; successfully deletes an alert" time="0.002">
            <system-out>
{&quot;timestamp&quot;:&quot;2025-12-14T20:04:27.333Z&quot;,&quot;service&quot;:&quot;stockly-api-test&quot;,&quot;level&quot;:&quot;INFO&quot;,&quot;traceId&quot;:&quot;test-trace-id&quot;,&quot;userId&quot;:null,&quot;path&quot;:&quot;/test&quot;,&quot;message&quot;:&quot;Alerts request authenticated&quot;,&quot;type&quot;:&quot;general&quot;,&quot;username&quot;:&quot;testuser&quot;,&quot;isAdmin&quot;:false,&quot;requestUsername&quot;:&quot;testuser&quot;,&quot;method&quot;:&quot;DELETE&quot;}

{&quot;timestamp&quot;:&quot;2025-12-14T20:04:27.334Z&quot;,&quot;service&quot;:&quot;stockly-api-test&quot;,&quot;level&quot;:&quot;INFO&quot;,&quot;traceId&quot;:&quot;test-trace-id&quot;,&quot;userId&quot;:null,&quot;path&quot;:&quot;/test&quot;,&quot;message&quot;:&quot;Deleted alert&quot;,&quot;type&quot;:&quot;general&quot;,&quot;alertId&quot;:&quot;123e4567-e89b-12d3-a456-426614174000&quot;,&quot;username&quot;:&quot;testuser&quot;}

            </system-out>
        </testcase>
        <testcase classname="test/api-integration.spec.ts" name="API Integration - Alerts &gt; returns 404 when alert not found" time="0.002">
            <system-out>
{&quot;timestamp&quot;:&quot;2025-12-14T20:04:27.336Z&quot;,&quot;service&quot;:&quot;stockly-api-test&quot;,&quot;level&quot;:&quot;INFO&quot;,&quot;traceId&quot;:&quot;test-trace-id&quot;,&quot;userId&quot;:null,&quot;path&quot;:&quot;/test&quot;,&quot;message&quot;:&quot;Alerts request authenticated&quot;,&quot;type&quot;:&quot;general&quot;,&quot;username&quot;:&quot;testuser&quot;,&quot;isAdmin&quot;:false,&quot;requestUsername&quot;:&quot;testuser&quot;,&quot;method&quot;:&quot;GET&quot;}

            </system-out>
        </testcase>
    </testsuite>
    <testsuite name="test/api-schema-validation.spec.ts" timestamp="2025-12-14T20:04:38.187Z" hostname="sngvahmed" tests="16" failures="0" errors="0" skipped="0" time="1.375">
        <testcase classname="test/api-schema-validation.spec.ts" name="API Schema Validation - Health Check &gt; health endpoint returns valid HealthCheckResponse schema" time="0.022">
        </testcase>
        <testcase classname="test/api-schema-validation.spec.ts" name="API Schema Validation - Get Stock &gt; getStock returns valid StockQuoteResponse schema on success" time="0.023">
            <system-out>
{&quot;timestamp&quot;:&quot;2025-12-14T20:04:26.008Z&quot;,&quot;service&quot;:&quot;stockly-api-test&quot;,&quot;level&quot;:&quot;INFO&quot;,&quot;traceId&quot;:&quot;test-trace-id&quot;,&quot;userId&quot;:null,&quot;path&quot;:&quot;/test&quot;,&quot;message&quot;:&quot;No cache for AAPL&quot;,&quot;type&quot;:&quot;general&quot;,&quot;cacheStatus&quot;:&quot;MISS&quot;}

{&quot;timestamp&quot;:&quot;2025-12-14T20:04:26.010Z&quot;,&quot;service&quot;:&quot;stockly-api-test&quot;,&quot;level&quot;:&quot;DEBUG&quot;,&quot;traceId&quot;:&quot;test-trace-id&quot;,&quot;userId&quot;:null,&quot;path&quot;:&quot;/test&quot;,&quot;message&quot;:&quot;FMP API: GET /quote&quot;,&quot;type&quot;:&quot;api_call&quot;,&quot;apiProvider&quot;:&quot;FMP&quot;,&quot;endpoint&quot;:&quot;/quote&quot;,&quot;method&quot;:&quot;GET&quot;,&quot;latencyMs&quot;:1}

{&quot;timestamp&quot;:&quot;2025-12-14T20:04:26.010Z&quot;,&quot;service&quot;:&quot;stockly-api-test&quot;,&quot;level&quot;:&quot;DEBUG&quot;,&quot;traceId&quot;:&quot;test-trace-id&quot;,&quot;userId&quot;:null,&quot;path&quot;:&quot;/test&quot;,&quot;message&quot;:&quot;FMP API: GET /profile&quot;,&quot;type&quot;:&quot;api_call&quot;,&quot;apiProvider&quot;:&quot;FMP&quot;,&quot;endpoint&quot;:&quot;/profile&quot;,&quot;method&quot;:&quot;GET&quot;,&quot;latencyMs&quot;:0}

{&quot;timestamp&quot;:&quot;2025-12-14T20:04:26.010Z&quot;,&quot;service&quot;:&quot;stockly-api-test&quot;,&quot;level&quot;:&quot;DEBUG&quot;,&quot;traceId&quot;:&quot;test-trace-id&quot;,&quot;userId&quot;:null,&quot;path&quot;:&quot;/test&quot;,&quot;message&quot;:&quot;Profile API response&quot;,&quot;type&quot;:&quot;general&quot;,&quot;endpoint&quot;:&quot;https://financialmodelingprep.com/stable/profile?symbol=AAPL&amp;apikey=z5xjUUlsab7zBKntL5QnMzWyPuq2iWsM&quot;,&quot;responseType&quot;:&quot;array&quot;,&quot;responseLength&quot;:1}
{&quot;timestamp&quot;:&quot;2025-12-14T20:04:26.010Z&quot;,&quot;service&quot;:&quot;stockly-api-test&quot;,&quot;level&quot;:&quot;DEBUG&quot;,&quot;traceId&quot;:&quot;test-trace-id&quot;,&quot;userId&quot;:null,&quot;path&quot;:&quot;/test&quot;,&quot;message&quot;:&quot;Found description from profile&quot;,&quot;type&quot;:&quot;general&quot;,&quot;descriptionLength&quot;:38}
{&quot;timestamp&quot;:&quot;2025-12-14T20:04:26.010Z&quot;,&quot;service&quot;:&quot;stockly-api-test&quot;,&quot;level&quot;:&quot;DEBUG&quot;,&quot;traceId&quot;:&quot;test-trace-id&quot;,&quot;userId&quot;:null,&quot;path&quot;:&quot;/test&quot;,&quot;message&quot;:&quot;Final description resolved&quot;,&quot;type&quot;:&quot;general&quot;,&quot;hasDescription&quot;:true,&quot;descriptionLength&quot;:38,&quot;source&quot;:&quot;profile&quot;}

            </system-out>
        </testcase>
        <testcase classname="test/api-schema-validation.spec.ts" name="API Schema Validation - Get Stock &gt; getStock returns valid ErrorResponse schema on error" time="0.019">
        </testcase>
        <testcase classname="test/api-schema-validation.spec.ts" name="API Schema Validation - Get Stocks &gt; getStocks returns valid StockQuotesResponse schema on success" time="0.015">
        </testcase>
        <testcase classname="test/api-schema-validation.spec.ts" name="API Schema Validation - Get Stocks &gt; getStocks returns valid ErrorResponse schema on error" time="0.016">
        </testcase>
        <testcase classname="test/api-schema-validation.spec.ts" name="API Schema Validation - Search Stock &gt; searchStock returns valid SearchStockResponse schema" time="0.013">
        </testcase>
        <testcase classname="test/api-schema-validation.spec.ts" name="API Schema Validation - Get Historical &gt; getHistorical returns valid HistoricalPricesResponse schema" time="1.151">
            <system-out>
[getHistoricalPricesByDateRange] Querying database for AAPL from 2025-06-17 to 2025-12-14

[getHistoricalPricesByDateRange] Found 2 records for AAPL in date range 2025-06-17 to 2025-12-14

[get-historical] Query result for AAPL (2025-06-17 to 2025-12-14): 2 records found in database
{&quot;timestamp&quot;:&quot;2025-12-14T20:04:26.134Z&quot;,&quot;service&quot;:&quot;stockly-api-test&quot;,&quot;level&quot;:&quot;INFO&quot;,&quot;traceId&quot;:&quot;test-trace-id&quot;,&quot;userId&quot;:null,&quot;path&quot;:&quot;/test&quot;,&quot;message&quot;:&quot;No historical data in database for AAPL&quot;,&quot;type&quot;:&quot;general&quot;,&quot;dateRange&quot;:&quot;2025-06-17 to 2025-12-14&quot;,&quot;action&quot;:&quot;fetching from FMP API&quot;}
[fetchAndSaveHistoricalPrice] Starting fetch for AAPL from FMP API
[fetchAndSaveHistoricalPrice] Fetching from: https://financialmodelingprep.com/stable/historical-chart/30min?symbol=AAPL&amp;apikey=***&amp;from=2025-06-17&amp;to=2025-12-14

[fetchAndSaveHistoricalPrice] Received 241 1-hour OHLC records from FMP API
[fetchAndSaveHistoricalPrice] FMP API returned 241 records for AAPL
[fetchAndSaveHistoricalPrice] Sample record structure: {
  date: &apos;2025-12-12 15:30:00&apos;,
  hasOpen: true,
  hasHigh: true,
  hasLow: true,
  hasClose: true,
  hasPrice: false,
  keys: [ &apos;date&apos;, &apos;open&apos;, &apos;low&apos;, &apos;high&apos;, &apos;close&apos;, &apos;volume&apos; ]
}
Saved 19 daily candles (aggregated from 241 1-hour records) for AAPL with OHLC data

[getHistoricalPricesByDateRange] Querying database for AAPL from 2025-06-17 to 2025-12-14

[getHistoricalPricesByDateRange] Found 2 records for AAPL in date range 2025-06-17 to 2025-12-14

{&quot;timestamp&quot;:&quot;2025-12-14T20:04:27.278Z&quot;,&quot;service&quot;:&quot;stockly-api-test&quot;,&quot;level&quot;:&quot;DEBUG&quot;,&quot;traceId&quot;:&quot;test-trace-id&quot;,&quot;userId&quot;:null,&quot;path&quot;:&quot;/test&quot;,&quot;message&quot;:&quot;After FMP fetch, query result for AAPL&quot;,&quot;type&quot;:&quot;general&quot;,&quot;dateRange&quot;:&quot;2025-06-17 to 2025-12-14&quot;,&quot;recordCount&quot;:2}
[get-historical] Successfully fetched 2 historical records for AAPL from FMP API

            </system-out>
            <system-err>
{&quot;timestamp&quot;:&quot;2025-12-14T20:04:26.134Z&quot;,&quot;service&quot;:&quot;stockly-api-test&quot;,&quot;level&quot;:&quot;WARN&quot;,&quot;traceId&quot;:&quot;test-trace-id&quot;,&quot;userId&quot;:null,&quot;path&quot;:&quot;/test&quot;,&quot;message&quot;:&quot;Found 2 records with missing OHLC data&quot;,&quot;type&quot;:&quot;general&quot;,&quot;symbol&quot;:&quot;AAPL&quot;,&quot;recordsWithMissingOHLC&quot;:2,&quot;totalRecords&quot;:2}

[fetchAndSaveHistoricalPrice] Insert with OHLC failed for AAPL on 2025-11-17, trying fallback without OHLC: env.stockly.prepare(...).bind(...).run is not a function
[fetchAndSaveHistoricalPrice] Failed to insert historical record for AAPL on 2025-11-17: env.stockly.prepare(...).bind(...).run is not a function
[fetchAndSaveHistoricalPrice] Insert with OHLC failed for AAPL on 2025-11-18, trying fallback without OHLC: env.stockly.prepare(...).bind(...).run is not a function
[fetchAndSaveHistoricalPrice] Failed to insert historical record for AAPL on 2025-11-18: env.stockly.prepare(...).bind(...).run is not a function
[fetchAndSaveHistoricalPrice] Insert with OHLC failed for AAPL on 2025-11-19, trying fallback without OHLC: env.stockly.prepare(...).bind(...).run is not a function
[fetchAndSaveHistoricalPrice] Failed to insert historical record for AAPL on 2025-11-19: env.stockly.prepare(...).bind(...).run is not a function
[fetchAndSaveHistoricalPrice] Insert with OHLC failed for AAPL on 2025-11-20, trying fallback without OHLC: env.stockly.prepare(...).bind(...).run is not a function
[fetchAndSaveHistoricalPrice] Failed to insert historical record for AAPL on 2025-11-20: env.stockly.prepare(...).bind(...).run is not a function
[fetchAndSaveHistoricalPrice] Insert with OHLC failed for AAPL on 2025-11-21, trying fallback without OHLC: env.stockly.prepare(...).bind(...).run is not a function
[fetchAndSaveHistoricalPrice] Failed to insert historical record for AAPL on 2025-11-21: env.stockly.prepare(...).bind(...).run is not a function
[fetchAndSaveHistoricalPrice] Insert with OHLC failed for AAPL on 2025-11-24, trying fallback without OHLC: env.stockly.prepare(...).bind(...).run is not a function
[fetchAndSaveHistoricalPrice] Failed to insert historical record for AAPL on 2025-11-24: env.stockly.prepare(...).bind(...).run is not a function
[fetchAndSaveHistoricalPrice] Insert with OHLC failed for AAPL on 2025-11-25, trying fallback without OHLC: env.stockly.prepare(...).bind(...).run is not a function
[fetchAndSaveHistoricalPrice] Failed to insert historical record for AAPL on 2025-11-25: env.stockly.prepare(...).bind(...).run is not a function
[fetchAndSaveHistoricalPrice] Insert with OHLC failed for AAPL on 2025-11-26, trying fallback without OHLC: env.stockly.prepare(...).bind(...).run is not a function
[fetchAndSaveHistoricalPrice] Failed to insert historical record for AAPL on 2025-11-26: env.stockly.prepare(...).bind(...).run is not a function
[fetchAndSaveHistoricalPrice] Insert with OHLC failed for AAPL on 2025-11-28, trying fallback without OHLC: env.stockly.prepare(...).bind(...).run is not a function
[fetchAndSaveHistoricalPrice] Failed to insert historical record for AAPL on 2025-11-28: env.stockly.prepare(...).bind(...).run is not a function
[fetchAndSaveHistoricalPrice] Insert with OHLC failed for AAPL on 2025-12-01, trying fallback without OHLC: env.stockly.prepare(...).bind(...).run is not a function
[fetchAndSaveHistoricalPrice] Failed to insert historical record for AAPL on 2025-12-01: env.stockly.prepare(...).bind(...).run is not a function
[fetchAndSaveHistoricalPrice] Insert with OHLC failed for AAPL on 2025-12-02, trying fallback without OHLC: env.stockly.prepare(...).bind(...).run is not a function
[fetchAndSaveHistoricalPrice] Failed to insert historical record for AAPL on 2025-12-02: env.stockly.prepare(...).bind(...).run is not a function
[fetchAndSaveHistoricalPrice] Insert with OHLC failed for AAPL on 2025-12-03, trying fallback without OHLC: env.stockly.prepare(...).bind(...).run is not a function
[fetchAndSaveHistoricalPrice] Failed to insert historical record for AAPL on 2025-12-03: env.stockly.prepare(...).bind(...).run is not a function
[fetchAndSaveHistoricalPrice] Insert with OHLC failed for AAPL on 2025-12-04, trying fallback without OHLC: env.stockly.prepare(...).bind(...).run is not a function
[fetchAndSaveHistoricalPrice] Failed to insert historical record for AAPL on 2025-12-04: env.stockly.prepare(...).bind(...).run is not a function
[fetchAndSaveHistoricalPrice] Insert with OHLC failed for AAPL on 2025-12-05, trying fallback without OHLC: env.stockly.prepare(...).bind(...).run is not a function
[fetchAndSaveHistoricalPrice] Failed to insert historical record for AAPL on 2025-12-05: env.stockly.prepare(...).bind(...).run is not a function
[fetchAndSaveHistoricalPrice] Insert with OHLC failed for AAPL on 2025-12-08, trying fallback without OHLC: env.stockly.prepare(...).bind(...).run is not a function
[fetchAndSaveHistoricalPrice] Failed to insert historical record for AAPL on 2025-12-08: env.stockly.prepare(...).bind(...).run is not a function
[fetchAndSaveHistoricalPrice] Insert with OHLC failed for AAPL on 2025-12-09, trying fallback without OHLC: env.stockly.prepare(...).bind(...).run is not a function
[fetchAndSaveHistoricalPrice] Failed to insert historical record for AAPL on 2025-12-09: env.stockly.prepare(...).bind(...).run is not a function
[fetchAndSaveHistoricalPrice] Insert with OHLC failed for AAPL on 2025-12-10, trying fallback without OHLC: env.stockly.prepare(...).bind(...).run is not a function
[fetchAndSaveHistoricalPrice] Failed to insert historical record for AAPL on 2025-12-10: env.stockly.prepare(...).bind(...).run is not a function
[fetchAndSaveHistoricalPrice] Insert with OHLC failed for AAPL on 2025-12-11, trying fallback without OHLC: env.stockly.prepare(...).bind(...).run is not a function
[fetchAndSaveHistoricalPrice] Failed to insert historical record for AAPL on 2025-12-11: env.stockly.prepare(...).bind(...).run is not a function
[fetchAndSaveHistoricalPrice] Insert with OHLC failed for AAPL on 2025-12-12, trying fallback without OHLC: env.stockly.prepare(...).bind(...).run is not a function
[fetchAndSaveHistoricalPrice] Failed to insert historical record for AAPL on 2025-12-12: env.stockly.prepare(...).bind(...).run is not a function

            </system-err>
        </testcase>
        <testcase classname="test/api-schema-validation.spec.ts" name="API Schema Validation - Get Historical &gt; getHistorical returns valid ErrorResponse schema on error" time="0.004">
        </testcase>
        <testcase classname="test/api-schema-validation.spec.ts" name="API Schema Validation - Alerts &gt; listAlerts returns valid AlertsListResponse schema" time="0.004">
            <system-out>
{&quot;timestamp&quot;:&quot;2025-12-14T20:04:27.287Z&quot;,&quot;service&quot;:&quot;stockly-api-test&quot;,&quot;level&quot;:&quot;INFO&quot;,&quot;traceId&quot;:&quot;test-trace-id&quot;,&quot;userId&quot;:null,&quot;path&quot;:&quot;/test&quot;,&quot;message&quot;:&quot;Alerts request authenticated&quot;,&quot;type&quot;:&quot;general&quot;,&quot;username&quot;:&quot;testuser&quot;,&quot;isAdmin&quot;:false,&quot;requestUsername&quot;:&quot;testuser&quot;,&quot;method&quot;:&quot;GET&quot;}

{&quot;timestamp&quot;:&quot;2025-12-14T20:04:27.287Z&quot;,&quot;service&quot;:&quot;stockly-api-test&quot;,&quot;level&quot;:&quot;INFO&quot;,&quot;traceId&quot;:&quot;test-trace-id&quot;,&quot;userId&quot;:null,&quot;path&quot;:&quot;/test&quot;,&quot;message&quot;:&quot;Fetched alerts from D1&quot;,&quot;type&quot;:&quot;general&quot;,&quot;username&quot;:&quot;testuser&quot;,&quot;alertCount&quot;:1,&quot;alertIds&quot;:[&quot;123e4567-e89b-12d3-a456-426614174000&quot;]}

            </system-out>
        </testcase>
        <testcase classname="test/api-schema-validation.spec.ts" name="API Schema Validation - Alerts &gt; createAlert accepts valid CreateAlertRequest schema" time="0.005">
            <system-out>
{&quot;timestamp&quot;:&quot;2025-12-14T20:04:27.290Z&quot;,&quot;service&quot;:&quot;stockly-api-test&quot;,&quot;level&quot;:&quot;INFO&quot;,&quot;traceId&quot;:&quot;test-trace-id&quot;,&quot;userId&quot;:null,&quot;path&quot;:&quot;/test&quot;,&quot;message&quot;:&quot;Alerts request authenticated&quot;,&quot;type&quot;:&quot;general&quot;,&quot;username&quot;:&quot;testuser&quot;,&quot;isAdmin&quot;:false,&quot;requestUsername&quot;:&quot;testuser&quot;,&quot;method&quot;:&quot;POST&quot;}

{&quot;timestamp&quot;:&quot;2025-12-14T20:04:27.290Z&quot;,&quot;service&quot;:&quot;stockly-api-test&quot;,&quot;level&quot;:&quot;INFO&quot;,&quot;traceId&quot;:&quot;test-trace-id&quot;,&quot;userId&quot;:null,&quot;path&quot;:&quot;/test&quot;,&quot;message&quot;:&quot;Creating alert&quot;,&quot;type&quot;:&quot;general&quot;,&quot;username&quot;:&quot;testuser&quot;,&quot;symbol&quot;:&quot;AAPL&quot;,&quot;direction&quot;:&quot;above&quot;,&quot;threshold&quot;:200}

{&quot;timestamp&quot;:&quot;2025-12-14T20:04:27.291Z&quot;,&quot;service&quot;:&quot;stockly-api-test&quot;,&quot;level&quot;:&quot;INFO&quot;,&quot;traceId&quot;:&quot;test-trace-id&quot;,&quot;userId&quot;:null,&quot;path&quot;:&quot;/test&quot;,&quot;message&quot;:&quot;Created alert successfully&quot;,&quot;type&quot;:&quot;general&quot;,&quot;alertId&quot;:&quot;123e4567-e89b-12d3-a456-426614174000&quot;,&quot;username&quot;:&quot;testuser&quot;,&quot;isAdmin&quot;:false}

            </system-out>
            <system-err>
{&quot;timestamp&quot;:&quot;2025-12-14T20:04:27.291Z&quot;,&quot;service&quot;:&quot;stockly-api-test&quot;,&quot;level&quot;:&quot;ERROR&quot;,&quot;traceId&quot;:&quot;test-trace-id&quot;,&quot;userId&quot;:null,&quot;path&quot;:&quot;/test&quot;,&quot;message&quot;:&quot;Alert created with mismatched username&quot;,&quot;type&quot;:&quot;general&quot;,&quot;error&quot;:&quot;[object Object]&quot;}

            </system-err>
        </testcase>
        <testcase classname="test/api-schema-validation.spec.ts" name="API Schema Validation - Alerts &gt; updateAlert accepts valid UpdateAlertRequest schema" time="0.003">
            <system-out>
{&quot;timestamp&quot;:&quot;2025-12-14T20:04:27.295Z&quot;,&quot;service&quot;:&quot;stockly-api-test&quot;,&quot;level&quot;:&quot;INFO&quot;,&quot;traceId&quot;:&quot;test-trace-id&quot;,&quot;userId&quot;:null,&quot;path&quot;:&quot;/test&quot;,&quot;message&quot;:&quot;Alerts request authenticated&quot;,&quot;type&quot;:&quot;general&quot;,&quot;username&quot;:&quot;testuser&quot;,&quot;isAdmin&quot;:false,&quot;requestUsername&quot;:&quot;testuser&quot;,&quot;method&quot;:&quot;PUT&quot;}

{&quot;timestamp&quot;:&quot;2025-12-14T20:04:27.295Z&quot;,&quot;service&quot;:&quot;stockly-api-test&quot;,&quot;level&quot;:&quot;INFO&quot;,&quot;traceId&quot;:&quot;test-trace-id&quot;,&quot;userId&quot;:null,&quot;path&quot;:&quot;/test&quot;,&quot;message&quot;:&quot;Updated alert&quot;,&quot;type&quot;:&quot;general&quot;,&quot;alertId&quot;:&quot;123&quot;,&quot;username&quot;:&quot;testuser&quot;}

            </system-out>
        </testcase>
        <testcase classname="test/api-schema-validation.spec.ts" name="API Schema Validation - Alerts &gt; getAlert returns valid Alert schema" time="0.003">
            <system-out>
{&quot;timestamp&quot;:&quot;2025-12-14T20:04:27.298Z&quot;,&quot;service&quot;:&quot;stockly-api-test&quot;,&quot;level&quot;:&quot;INFO&quot;,&quot;traceId&quot;:&quot;test-trace-id&quot;,&quot;userId&quot;:null,&quot;path&quot;:&quot;/test&quot;,&quot;message&quot;:&quot;Alerts request authenticated&quot;,&quot;type&quot;:&quot;general&quot;,&quot;username&quot;:&quot;testuser&quot;,&quot;isAdmin&quot;:false,&quot;requestUsername&quot;:&quot;testuser&quot;,&quot;method&quot;:&quot;GET&quot;}

            </system-out>
        </testcase>
        <testcase classname="test/api-schema-validation.spec.ts" name="API Schema Validation - Input Validation &gt; rejects invalid CreateAlertRequest" time="0.002">
        </testcase>
        <testcase classname="test/api-schema-validation.spec.ts" name="API Schema Validation - Input Validation &gt; accepts valid CreateAlertRequest with optional fields" time="0.002">
        </testcase>
        <testcase classname="test/api-schema-validation.spec.ts" name="API Schema Validation - Input Validation &gt; rejects invalid UpdateAlertRequest" time="0.001">
        </testcase>
        <testcase classname="test/api-schema-validation.spec.ts" name="API Schema Validation - Input Validation &gt; accepts partial UpdateAlertRequest" time="0.003">
        </testcase>
    </testsuite>
    <testsuite name="test/cache.spec.ts" timestamp="2025-12-14T20:04:38.190Z" hostname="sngvahmed" tests="2" failures="0" errors="0" skipped="0" time="0.168">
        <testcase classname="test/cache.spec.ts" name="cache helpers &gt; returns cached entries while TTL is valid" time="0.038">
        </testcase>
        <testcase classname="test/cache.spec.ts" name="cache helpers &gt; expires entries once TTL elapses" time="0.029">
        </testcase>
    </testsuite>
    <testsuite name="test/config.spec.ts" timestamp="2025-12-14T20:04:38.191Z" hostname="sngvahmed" tests="10" failures="0" errors="0" skipped="0" time="0.526">
        <testcase classname="test/config.spec.ts" name="Config System &gt; getConfig &gt; returns default config when KV is not available" time="0.041">
            <system-err>
alertsKv not available, using default config

            </system-err>
        </testcase>
        <testcase classname="test/config.spec.ts" name="Config System &gt; getConfig &gt; returns default config when no stored config exists" time="0.026">
        </testcase>
        <testcase classname="test/config.spec.ts" name="Config System &gt; getConfig &gt; returns stored config when available" time="0.05">
        </testcase>
        <testcase classname="test/config.spec.ts" name="Config System &gt; getConfig &gt; merges partial stored config with defaults" time="0.028">
        </testcase>
        <testcase classname="test/config.spec.ts" name="Config System &gt; updateConfig &gt; updates config with new values" time="0.054">
        </testcase>
        <testcase classname="test/config.spec.ts" name="Config System &gt; updateConfig &gt; merges nested objects correctly" time="0.027">
        </testcase>
        <testcase classname="test/config.spec.ts" name="Config System &gt; simulateProviderFailureEndpoint &gt; enables simulation mode" time="0.049">
        </testcase>
        <testcase classname="test/config.spec.ts" name="Config System &gt; simulateProviderFailureEndpoint &gt; persists the config change" time="0.026">
        </testcase>
        <testcase classname="test/config.spec.ts" name="Config System &gt; disableProviderFailureEndpoint &gt; disables simulation mode" time="0.048">
        </testcase>
        <testcase classname="test/config.spec.ts" name="Config System &gt; disableProviderFailureEndpoint &gt; persists the config change" time="0.021">
        </testcase>
    </testsuite>
    <testsuite name="test/devices.spec.ts" timestamp="2025-12-14T20:04:38.192Z" hostname="sngvahmed" tests="9" failures="0" errors="0" skipped="0" time="0.647">
        <testcase classname="test/devices.spec.ts" name="Devices API &gt; getAllDevices &gt; should return list of devices" time="0.056">
            <system-err>
{&quot;timestamp&quot;:&quot;2025-12-14T20:04:25.330Z&quot;,&quot;service&quot;:&quot;stockly-api-test&quot;,&quot;level&quot;:&quot;WARN&quot;,&quot;traceId&quot;:&quot;test-trace-id&quot;,&quot;userId&quot;:null,&quot;path&quot;:&quot;/test&quot;,&quot;message&quot;:&quot;Found devices with null username&quot;,&quot;type&quot;:&quot;general&quot;,&quot;count&quot;:2,&quot;deviceIds&quot;:[&quot;dXXXXXXXXXXXXXXXXXXX...&quot;,&quot;eYYYYYYYYYYYYYYYYYYY...&quot;]}

            </system-err>
        </testcase>
        <testcase classname="test/devices.spec.ts" name="Devices API &gt; getAllDevices &gt; should return empty array when no devices" time="0.091">
        </testcase>
        <testcase classname="test/devices.spec.ts" name="Devices API &gt; getAllDevices &gt; should handle database errors" time="0.096">
            <system-err>
{&quot;timestamp&quot;:&quot;2025-12-14T20:04:25.481Z&quot;,&quot;service&quot;:&quot;stockly-api-test&quot;,&quot;level&quot;:&quot;ERROR&quot;,&quot;traceId&quot;:&quot;test-trace-id&quot;,&quot;userId&quot;:null,&quot;path&quot;:&quot;/test&quot;,&quot;message&quot;:&quot;Failed to get devices&quot;,&quot;type&quot;:&quot;general&quot;,&quot;username&quot;:null,&quot;error&quot;:{&quot;name&quot;:&quot;Error&quot;,&quot;message&quot;:&quot;Database error&quot;,&quot;stack&quot;:&quot;Error: Database error\n    at Object.&lt;anonymous&gt; (/home/sngvahmed/workspace/stockly/api/test/devices.spec.ts:136:42)\n    at Object.mockCall (home/sngvahmed/workspace/stockly/api/node_modules/@vitest/spy/dist/index.js:96:15)\n    at Object.spy [as prepare] (home/sngvahmed/workspace/stockly/api/node_modules/tinyspy/dist/index.js:47:80)\n    at Module.getAllDevices (/home/sngvahmed/workspace/stockly/api/src/api/devices.ts:69:12)\n    at /home/sngvahmed/workspace/stockly/api/test/devices.spec.ts:141:24\n    at home/sngvahmed/workspace/stockly/api/node_modules/@vitest/runner/dist/chunk-hooks.js:752:20&quot;}}

            </system-err>
        </testcase>
        <testcase classname="test/devices.spec.ts" name="Devices API &gt; sendTestNotification &gt; should send test notification successfully" time="0.045">
            <system-out>
{&quot;timestamp&quot;:&quot;2025-12-14T20:04:25.628Z&quot;,&quot;service&quot;:&quot;stockly-api-test&quot;,&quot;level&quot;:&quot;INFO&quot;,&quot;traceId&quot;:&quot;test-trace-id&quot;,&quot;userId&quot;:&quot;user-1&quot;,&quot;path&quot;:&quot;/test&quot;,&quot;message&quot;:&quot;Test notification sent successfully&quot;,&quot;type&quot;:&quot;general&quot;}

            </system-out>
        </testcase>
        <testcase classname="test/devices.spec.ts" name="Devices API &gt; sendTestNotification &gt; should use default message when no custom message provided" time="0.035">
            <system-out>
{&quot;timestamp&quot;:&quot;2025-12-14T20:04:25.673Z&quot;,&quot;service&quot;:&quot;stockly-api-test&quot;,&quot;level&quot;:&quot;INFO&quot;,&quot;traceId&quot;:&quot;test-trace-id&quot;,&quot;userId&quot;:&quot;user-1&quot;,&quot;path&quot;:&quot;/test&quot;,&quot;message&quot;:&quot;Test notification sent successfully&quot;,&quot;type&quot;:&quot;general&quot;}

            </system-out>
        </testcase>
        <testcase classname="test/devices.spec.ts" name="Devices API &gt; sendTestNotification &gt; should return 404 when device not found" time="0.059">
        </testcase>
        <testcase classname="test/devices.spec.ts" name="Devices API &gt; sendTestNotification &gt; should return 400 when userId is missing" time="0.04">
        </testcase>
        <testcase classname="test/devices.spec.ts" name="Devices API &gt; sendTestNotification &gt; should return 405 for non-POST methods" time="0.047">
        </testcase>
        <testcase classname="test/devices.spec.ts" name="Devices API &gt; sendTestNotification &gt; should handle FCM send failures" time="0.036">
            <system-err>
Failed to get Google access token: TypeError: response.text is not a function
    at getGoogleAccessTokenFromJWT (/home/sngvahmed/workspace/stockly/api/src/notifications/jwt-helper.ts:118:38)
    at getGoogleAccessToken (/home/sngvahmed/workspace/stockly/api/src/notifications/fcm-sender.ts:192:25)
    at sendFCMNotificationWithLogs (/home/sngvahmed/workspace/stockly/api/src/notifications/fcm-sender.ts:269:19)
    at sendFCMNotification (/home/sngvahmed/workspace/stockly/api/src/notifications/fcm-sender.ts:474:18)
    at Module.sendTestNotification (/home/sngvahmed/workspace/stockly/api/src/api/devices.ts:497:21)
    at /home/sngvahmed/workspace/stockly/api/test/devices.spec.ts:429:24
    at home/sngvahmed/workspace/stockly/api/node_modules/@vitest/runner/dist/chunk-hooks.js:752:20

            </system-err>
        </testcase>
    </testsuite>
    <testsuite name="test/get-historical.spec.ts" timestamp="2025-12-14T20:04:38.193Z" hostname="sngvahmed" tests="28" failures="0" errors="0" skipped="0" time="4.773">
        <testcase classname="test/get-historical.spec.ts" name="getHistorical handler &gt; Parameter validation &gt; requires a symbol parameter" time="0.05">
        </testcase>
        <testcase classname="test/get-historical.spec.ts" name="getHistorical handler &gt; Parameter validation &gt; accepts symbol parameter" time="0.533">
            <system-out>
[get-historical] Query result for AAPL (2025-06-17 to 2025-12-14): 0 records found in database
{&quot;timestamp&quot;:&quot;2025-12-14T20:04:25.341Z&quot;,&quot;service&quot;:&quot;stockly-api-test&quot;,&quot;level&quot;:&quot;INFO&quot;,&quot;traceId&quot;:&quot;test-trace-id&quot;,&quot;userId&quot;:null,&quot;path&quot;:&quot;/test&quot;,&quot;message&quot;:&quot;No historical data in database for AAPL&quot;,&quot;type&quot;:&quot;general&quot;,&quot;dateRange&quot;:&quot;2025-06-17 to 2025-12-14&quot;,&quot;action&quot;:&quot;fetching from FMP API&quot;}

{&quot;timestamp&quot;:&quot;2025-12-14T20:04:25.841Z&quot;,&quot;service&quot;:&quot;stockly-api-test&quot;,&quot;level&quot;:&quot;DEBUG&quot;,&quot;traceId&quot;:&quot;test-trace-id&quot;,&quot;userId&quot;:null,&quot;path&quot;:&quot;/test&quot;,&quot;message&quot;:&quot;After FMP fetch, query result for AAPL&quot;,&quot;type&quot;:&quot;general&quot;,&quot;dateRange&quot;:&quot;2025-06-17 to 2025-12-14&quot;,&quot;recordCount&quot;:0}

            </system-out>
            <system-err>
{&quot;timestamp&quot;:&quot;2025-12-14T20:04:25.842Z&quot;,&quot;service&quot;:&quot;stockly-api-test&quot;,&quot;level&quot;:&quot;WARN&quot;,&quot;traceId&quot;:&quot;test-trace-id&quot;,&quot;userId&quot;:null,&quot;path&quot;:&quot;/test&quot;,&quot;message&quot;:&quot;Still no data after fetching from FMP API for AAPL&quot;,&quot;type&quot;:&quot;general&quot;,&quot;dateRange&quot;:&quot;2025-06-17 to 2025-12-14&quot;,&quot;possibleReasons&quot;:[&quot;FMP API returned empty data&quot;,&quot;FMP API returned data outside the requested date range&quot;,&quot;Date range is in the future or has no trading days&quot;,&quot;Database schema missing OHLC columns (check migration 009)&quot;]}

            </system-err>
        </testcase>
        <testcase classname="test/get-historical.spec.ts" name="getHistorical handler &gt; Parameter validation &gt; normalizes symbol to uppercase" time="0.526">
            <system-out>
[get-historical] Query result for AAPL (2025-06-17 to 2025-12-14): 0 records found in database
{&quot;timestamp&quot;:&quot;2025-12-14T20:04:25.885Z&quot;,&quot;service&quot;:&quot;stockly-api-test&quot;,&quot;level&quot;:&quot;INFO&quot;,&quot;traceId&quot;:&quot;test-trace-id&quot;,&quot;userId&quot;:null,&quot;path&quot;:&quot;/test&quot;,&quot;message&quot;:&quot;No historical data in database for AAPL&quot;,&quot;type&quot;:&quot;general&quot;,&quot;dateRange&quot;:&quot;2025-06-17 to 2025-12-14&quot;,&quot;action&quot;:&quot;fetching from FMP API&quot;}

{&quot;timestamp&quot;:&quot;2025-12-14T20:04:26.386Z&quot;,&quot;service&quot;:&quot;stockly-api-test&quot;,&quot;level&quot;:&quot;DEBUG&quot;,&quot;traceId&quot;:&quot;test-trace-id&quot;,&quot;userId&quot;:null,&quot;path&quot;:&quot;/test&quot;,&quot;message&quot;:&quot;After FMP fetch, query result for AAPL&quot;,&quot;type&quot;:&quot;general&quot;,&quot;dateRange&quot;:&quot;2025-06-17 to 2025-12-14&quot;,&quot;recordCount&quot;:0}

            </system-out>
            <system-err>
{&quot;timestamp&quot;:&quot;2025-12-14T20:04:26.386Z&quot;,&quot;service&quot;:&quot;stockly-api-test&quot;,&quot;level&quot;:&quot;WARN&quot;,&quot;traceId&quot;:&quot;test-trace-id&quot;,&quot;userId&quot;:null,&quot;path&quot;:&quot;/test&quot;,&quot;message&quot;:&quot;Still no data after fetching from FMP API for AAPL&quot;,&quot;type&quot;:&quot;general&quot;,&quot;dateRange&quot;:&quot;2025-06-17 to 2025-12-14&quot;,&quot;possibleReasons&quot;:[&quot;FMP API returned empty data&quot;,&quot;FMP API returned data outside the requested date range&quot;,&quot;Date range is in the future or has no trading days&quot;,&quot;Database schema missing OHLC columns (check migration 009)&quot;]}

            </system-err>
        </testcase>
        <testcase classname="test/get-historical.spec.ts" name="getHistorical handler &gt; Date range parameters (from/to) &gt; accepts from and to parameters" time="0.004">
            <system-out>
[get-historical] Query result for AAPL (2025-01-01 to 2025-01-31): 3 records found in database

            </system-out>
        </testcase>
        <testcase classname="test/get-historical.spec.ts" name="getHistorical handler &gt; Date range parameters (from/to) &gt; validates from date format" time="0.003">
        </testcase>
        <testcase classname="test/get-historical.spec.ts" name="getHistorical handler &gt; Date range parameters (from/to) &gt; validates to date format" time="0.002">
        </testcase>
        <testcase classname="test/get-historical.spec.ts" name="getHistorical handler &gt; Date range parameters (from/to) &gt; validates that from date is before to date" time="0.002">
        </testcase>
        <testcase classname="test/get-historical.spec.ts" name="getHistorical handler &gt; Date range parameters (from/to) &gt; allows from and to to be the same date" time="0.004">
            <system-out>
[get-historical] Query result for AAPL (2025-01-01 to 2025-01-01): 1 records found in database

            </system-out>
        </testcase>
        <testcase classname="test/get-historical.spec.ts" name="getHistorical handler &gt; Date range parameters (from/to) &gt; defaults to today when only &apos;to&apos; is provided" time="0.504">
            <system-out>
[get-historical] Query result for AAPL (2024-08-03 to 2025-01-31): 0 records found in database
{&quot;timestamp&quot;:&quot;2025-12-14T20:04:26.409Z&quot;,&quot;service&quot;:&quot;stockly-api-test&quot;,&quot;level&quot;:&quot;INFO&quot;,&quot;traceId&quot;:&quot;test-trace-id&quot;,&quot;userId&quot;:null,&quot;path&quot;:&quot;/test&quot;,&quot;message&quot;:&quot;No historical data in database for AAPL&quot;,&quot;type&quot;:&quot;general&quot;,&quot;dateRange&quot;:&quot;2024-08-03 to 2025-01-31&quot;,&quot;action&quot;:&quot;fetching from FMP API&quot;}

{&quot;timestamp&quot;:&quot;2025-12-14T20:04:26.909Z&quot;,&quot;service&quot;:&quot;stockly-api-test&quot;,&quot;level&quot;:&quot;DEBUG&quot;,&quot;traceId&quot;:&quot;test-trace-id&quot;,&quot;userId&quot;:null,&quot;path&quot;:&quot;/test&quot;,&quot;message&quot;:&quot;After FMP fetch, query result for AAPL&quot;,&quot;type&quot;:&quot;general&quot;,&quot;dateRange&quot;:&quot;2024-08-03 to 2025-01-31&quot;,&quot;recordCount&quot;:0}

            </system-out>
            <system-err>
{&quot;timestamp&quot;:&quot;2025-12-14T20:04:26.910Z&quot;,&quot;service&quot;:&quot;stockly-api-test&quot;,&quot;level&quot;:&quot;WARN&quot;,&quot;traceId&quot;:&quot;test-trace-id&quot;,&quot;userId&quot;:null,&quot;path&quot;:&quot;/test&quot;,&quot;message&quot;:&quot;Still no data after fetching from FMP API for AAPL&quot;,&quot;type&quot;:&quot;general&quot;,&quot;dateRange&quot;:&quot;2024-08-03 to 2025-01-31&quot;,&quot;possibleReasons&quot;:[&quot;FMP API returned empty data&quot;,&quot;FMP API returned data outside the requested date range&quot;,&quot;Date range is in the future or has no trading days&quot;,&quot;Database schema missing OHLC columns (check migration 009)&quot;]}

            </system-err>
        </testcase>
        <testcase classname="test/get-historical.spec.ts" name="getHistorical handler &gt; Date range parameters (from/to) &gt; defaults to today when only &apos;from&apos; is provided" time="0.505">
            <system-out>
[get-historical] Query result for AAPL (2025-01-01 to 2025-12-14): 0 records found in database
{&quot;timestamp&quot;:&quot;2025-12-14T20:04:26.914Z&quot;,&quot;service&quot;:&quot;stockly-api-test&quot;,&quot;level&quot;:&quot;INFO&quot;,&quot;traceId&quot;:&quot;test-trace-id&quot;,&quot;userId&quot;:null,&quot;path&quot;:&quot;/test&quot;,&quot;message&quot;:&quot;No historical data in database for AAPL&quot;,&quot;type&quot;:&quot;general&quot;,&quot;dateRange&quot;:&quot;2025-01-01 to 2025-12-14&quot;,&quot;action&quot;:&quot;fetching from FMP API&quot;}

{&quot;timestamp&quot;:&quot;2025-12-14T20:04:27.414Z&quot;,&quot;service&quot;:&quot;stockly-api-test&quot;,&quot;level&quot;:&quot;DEBUG&quot;,&quot;traceId&quot;:&quot;test-trace-id&quot;,&quot;userId&quot;:null,&quot;path&quot;:&quot;/test&quot;,&quot;message&quot;:&quot;After FMP fetch, query result for AAPL&quot;,&quot;type&quot;:&quot;general&quot;,&quot;dateRange&quot;:&quot;2025-01-01 to 2025-12-14&quot;,&quot;recordCount&quot;:0}

            </system-out>
            <system-err>
{&quot;timestamp&quot;:&quot;2025-12-14T20:04:27.415Z&quot;,&quot;service&quot;:&quot;stockly-api-test&quot;,&quot;level&quot;:&quot;WARN&quot;,&quot;traceId&quot;:&quot;test-trace-id&quot;,&quot;userId&quot;:null,&quot;path&quot;:&quot;/test&quot;,&quot;message&quot;:&quot;Still no data after fetching from FMP API for AAPL&quot;,&quot;type&quot;:&quot;general&quot;,&quot;dateRange&quot;:&quot;2025-01-01 to 2025-12-14&quot;,&quot;possibleReasons&quot;:[&quot;FMP API returned empty data&quot;,&quot;FMP API returned data outside the requested date range&quot;,&quot;Date range is in the future or has no trading days&quot;,&quot;Database schema missing OHLC columns (check migration 009)&quot;]}

            </system-err>
        </testcase>
        <testcase classname="test/get-historical.spec.ts" name="getHistorical handler &gt; Days parameter (backward compatibility) &gt; accepts days parameter" time="0.004">
            <system-out>
[get-historical] Query result for AAPL (2025-11-14 to 2025-12-14): 2 records found in database

            </system-out>
        </testcase>
        <testcase classname="test/get-historical.spec.ts" name="getHistorical handler &gt; Days parameter (backward compatibility) &gt; defaults to 180 days when no parameters provided" time="0.504">
            <system-out>
[get-historical] Query result for AAPL (2025-06-17 to 2025-12-14): 0 records found in database
{&quot;timestamp&quot;:&quot;2025-12-14T20:04:27.426Z&quot;,&quot;service&quot;:&quot;stockly-api-test&quot;,&quot;level&quot;:&quot;INFO&quot;,&quot;traceId&quot;:&quot;test-trace-id&quot;,&quot;userId&quot;:null,&quot;path&quot;:&quot;/test&quot;,&quot;message&quot;:&quot;No historical data in database for AAPL&quot;,&quot;type&quot;:&quot;general&quot;,&quot;dateRange&quot;:&quot;2025-06-17 to 2025-12-14&quot;,&quot;action&quot;:&quot;fetching from FMP API&quot;}

{&quot;timestamp&quot;:&quot;2025-12-14T20:04:27.926Z&quot;,&quot;service&quot;:&quot;stockly-api-test&quot;,&quot;level&quot;:&quot;DEBUG&quot;,&quot;traceId&quot;:&quot;test-trace-id&quot;,&quot;userId&quot;:null,&quot;path&quot;:&quot;/test&quot;,&quot;message&quot;:&quot;After FMP fetch, query result for AAPL&quot;,&quot;type&quot;:&quot;general&quot;,&quot;dateRange&quot;:&quot;2025-06-17 to 2025-12-14&quot;,&quot;recordCount&quot;:0}

            </system-out>
            <system-err>
{&quot;timestamp&quot;:&quot;2025-12-14T20:04:27.926Z&quot;,&quot;service&quot;:&quot;stockly-api-test&quot;,&quot;level&quot;:&quot;WARN&quot;,&quot;traceId&quot;:&quot;test-trace-id&quot;,&quot;userId&quot;:null,&quot;path&quot;:&quot;/test&quot;,&quot;message&quot;:&quot;Still no data after fetching from FMP API for AAPL&quot;,&quot;type&quot;:&quot;general&quot;,&quot;dateRange&quot;:&quot;2025-06-17 to 2025-12-14&quot;,&quot;possibleReasons&quot;:[&quot;FMP API returned empty data&quot;,&quot;FMP API returned data outside the requested date range&quot;,&quot;Date range is in the future or has no trading days&quot;,&quot;Database schema missing OHLC columns (check migration 009)&quot;]}

            </system-err>
        </testcase>
        <testcase classname="test/get-historical.spec.ts" name="getHistorical handler &gt; Days parameter (backward compatibility) &gt; validates days parameter minimum value" time="0.002">
        </testcase>
        <testcase classname="test/get-historical.spec.ts" name="getHistorical handler &gt; Days parameter (backward compatibility) &gt; validates days parameter maximum value" time="0.002">
        </testcase>
        <testcase classname="test/get-historical.spec.ts" name="getHistorical handler &gt; Days parameter (backward compatibility) &gt; validates days parameter is a number" time="0.002">
        </testcase>
        <testcase classname="test/get-historical.spec.ts" name="getHistorical handler &gt; Parameter priority &gt; prioritizes from/to parameters over days parameter" time="0.002">
            <system-out>
[get-historical] Query result for AAPL (2025-01-01 to 2025-01-31): 1 records found in database

            </system-out>
        </testcase>
        <testcase classname="test/get-historical.spec.ts" name="getHistorical handler &gt; Database query &gt; queries database with correct date range" time="0.004">
            <system-out>
[get-historical] Query result for AAPL (2025-01-01 to 2025-01-31): 2 records found in database

            </system-out>
        </testcase>
        <testcase classname="test/get-historical.spec.ts" name="getHistorical handler &gt; Database query &gt; returns data from database when available" time="0.002">
            <system-out>
[get-historical] Query result for AAPL (2025-01-01 to 2025-01-31): 3 records found in database

            </system-out>
        </testcase>
        <testcase classname="test/get-historical.spec.ts" name="getHistorical handler &gt; Database query &gt; returns empty array when database has no data" time="0.506">
            <system-out>
[get-historical] Query result for AAPL (2025-01-01 to 2025-01-31): 0 records found in database
{&quot;timestamp&quot;:&quot;2025-12-14T20:04:27.948Z&quot;,&quot;service&quot;:&quot;stockly-api-test&quot;,&quot;level&quot;:&quot;INFO&quot;,&quot;traceId&quot;:&quot;test-trace-id&quot;,&quot;userId&quot;:null,&quot;path&quot;:&quot;/test&quot;,&quot;message&quot;:&quot;No historical data in database for AAPL&quot;,&quot;type&quot;:&quot;general&quot;,&quot;dateRange&quot;:&quot;2025-01-01 to 2025-01-31&quot;,&quot;action&quot;:&quot;fetching from FMP API&quot;}

{&quot;timestamp&quot;:&quot;2025-12-14T20:04:28.449Z&quot;,&quot;service&quot;:&quot;stockly-api-test&quot;,&quot;level&quot;:&quot;DEBUG&quot;,&quot;traceId&quot;:&quot;test-trace-id&quot;,&quot;userId&quot;:null,&quot;path&quot;:&quot;/test&quot;,&quot;message&quot;:&quot;After FMP fetch, query result for AAPL&quot;,&quot;type&quot;:&quot;general&quot;,&quot;dateRange&quot;:&quot;2025-01-01 to 2025-01-31&quot;,&quot;recordCount&quot;:0}

            </system-out>
            <system-err>
{&quot;timestamp&quot;:&quot;2025-12-14T20:04:28.449Z&quot;,&quot;service&quot;:&quot;stockly-api-test&quot;,&quot;level&quot;:&quot;WARN&quot;,&quot;traceId&quot;:&quot;test-trace-id&quot;,&quot;userId&quot;:null,&quot;path&quot;:&quot;/test&quot;,&quot;message&quot;:&quot;Still no data after fetching from FMP API for AAPL&quot;,&quot;type&quot;:&quot;general&quot;,&quot;dateRange&quot;:&quot;2025-01-01 to 2025-01-31&quot;,&quot;possibleReasons&quot;:[&quot;FMP API returned empty data&quot;,&quot;FMP API returned data outside the requested date range&quot;,&quot;Date range is in the future or has no trading days&quot;,&quot;Database schema missing OHLC columns (check migration 009)&quot;]}

            </system-err>
        </testcase>
        <testcase classname="test/get-historical.spec.ts" name="getHistorical handler &gt; FMP API fallback &gt; fetches from FMP API when database is empty and ctx is available" time="0.505">
            <system-out>
[get-historical] Query result for AAPL (2025-01-01 to 2025-01-31): 0 records found in database
{&quot;timestamp&quot;:&quot;2025-12-14T20:04:28.457Z&quot;,&quot;service&quot;:&quot;stockly-api-test&quot;,&quot;level&quot;:&quot;INFO&quot;,&quot;traceId&quot;:&quot;test-trace-id&quot;,&quot;userId&quot;:null,&quot;path&quot;:&quot;/test&quot;,&quot;message&quot;:&quot;No historical data in database for AAPL&quot;,&quot;type&quot;:&quot;general&quot;,&quot;dateRange&quot;:&quot;2025-01-01 to 2025-01-31&quot;,&quot;action&quot;:&quot;fetching from FMP API&quot;}

{&quot;timestamp&quot;:&quot;2025-12-14T20:04:28.958Z&quot;,&quot;service&quot;:&quot;stockly-api-test&quot;,&quot;level&quot;:&quot;DEBUG&quot;,&quot;traceId&quot;:&quot;test-trace-id&quot;,&quot;userId&quot;:null,&quot;path&quot;:&quot;/test&quot;,&quot;message&quot;:&quot;After FMP fetch, query result for AAPL&quot;,&quot;type&quot;:&quot;general&quot;,&quot;dateRange&quot;:&quot;2025-01-01 to 2025-01-31&quot;,&quot;recordCount&quot;:1}
[get-historical] Successfully fetched 1 historical records for AAPL from FMP API

            </system-out>
        </testcase>
        <testcase classname="test/get-historical.spec.ts" name="getHistorical handler &gt; FMP API fallback &gt; creates fallback ExecutionContext when ctx is not available and fetches from FMP API" time="0.507">
            <system-out>
[get-historical] Query result for AAPL (2025-01-01 to 2025-01-31): 0 records found in database
{&quot;timestamp&quot;:&quot;2025-12-14T20:04:28.963Z&quot;,&quot;service&quot;:&quot;stockly-api-test&quot;,&quot;level&quot;:&quot;INFO&quot;,&quot;traceId&quot;:&quot;test-trace-id&quot;,&quot;userId&quot;:null,&quot;path&quot;:&quot;/test&quot;,&quot;message&quot;:&quot;No historical data in database for AAPL&quot;,&quot;type&quot;:&quot;general&quot;,&quot;dateRange&quot;:&quot;2025-01-01 to 2025-01-31&quot;,&quot;action&quot;:&quot;fetching from FMP API&quot;}

{&quot;timestamp&quot;:&quot;2025-12-14T20:04:29.464Z&quot;,&quot;service&quot;:&quot;stockly-api-test&quot;,&quot;level&quot;:&quot;DEBUG&quot;,&quot;traceId&quot;:&quot;test-trace-id&quot;,&quot;userId&quot;:null,&quot;path&quot;:&quot;/test&quot;,&quot;message&quot;:&quot;After FMP fetch, query result for AAPL&quot;,&quot;type&quot;:&quot;general&quot;,&quot;dateRange&quot;:&quot;2025-01-01 to 2025-01-31&quot;,&quot;recordCount&quot;:1}
[get-historical] Successfully fetched 1 historical records for AAPL from FMP API

            </system-out>
        </testcase>
        <testcase classname="test/get-historical.spec.ts" name="getHistorical handler &gt; FMP API fallback &gt; handles FMP API fetch errors gracefully" time="0.005">
            <system-out>
[get-historical] Query result for AAPL (2025-01-01 to 2025-01-31): 0 records found in database
{&quot;timestamp&quot;:&quot;2025-12-14T20:04:29.471Z&quot;,&quot;service&quot;:&quot;stockly-api-test&quot;,&quot;level&quot;:&quot;INFO&quot;,&quot;traceId&quot;:&quot;test-trace-id&quot;,&quot;userId&quot;:null,&quot;path&quot;:&quot;/test&quot;,&quot;message&quot;:&quot;No historical data in database for AAPL&quot;,&quot;type&quot;:&quot;general&quot;,&quot;dateRange&quot;:&quot;2025-01-01 to 2025-01-31&quot;,&quot;action&quot;:&quot;fetching from FMP API&quot;}

            </system-out>
            <system-err>
[get-historical] Error fetching historical data from FMP API for AAPL: FMP API error

            </system-err>
        </testcase>
        <testcase classname="test/get-historical.spec.ts" name="getHistorical handler &gt; Response format &gt; returns correct response format with from/to parameters" time="0.003">
            <system-out>
[get-historical] Query result for AAPL (2025-01-01 to 2025-01-31): 1 records found in database

            </system-out>
        </testcase>
        <testcase classname="test/get-historical.spec.ts" name="getHistorical handler &gt; Response format &gt; returns correct response format with days parameter" time="0.002">
            <system-out>
[get-historical] Query result for AAPL (2025-11-14 to 2025-12-14): 1 records found in database

            </system-out>
        </testcase>
        <testcase classname="test/get-historical.spec.ts" name="getHistorical handler &gt; Response format &gt; includes all required fields in data items" time="0.001">
            <system-out>
[get-historical] Query result for AAPL (2025-01-01 to 2025-01-31): 1 records found in database

            </system-out>
        </testcase>
        <testcase classname="test/get-historical.spec.ts" name="getHistorical handler &gt; Missing OHLC data handling &gt; re-fetches from FMP API when OHLC data is missing (null)" time="0.506">
            <system-out>
[get-historical] Query result for AAPL (2025-01-01 to 2025-01-31): 1 records found in database
{&quot;timestamp&quot;:&quot;2025-12-14T20:04:29.485Z&quot;,&quot;service&quot;:&quot;stockly-api-test&quot;,&quot;level&quot;:&quot;INFO&quot;,&quot;traceId&quot;:&quot;test-trace-id&quot;,&quot;userId&quot;:null,&quot;path&quot;:&quot;/test&quot;,&quot;message&quot;:&quot;No historical data in database for AAPL&quot;,&quot;type&quot;:&quot;general&quot;,&quot;dateRange&quot;:&quot;2025-01-01 to 2025-01-31&quot;,&quot;action&quot;:&quot;fetching from FMP API&quot;}

{&quot;timestamp&quot;:&quot;2025-12-14T20:04:29.988Z&quot;,&quot;service&quot;:&quot;stockly-api-test&quot;,&quot;level&quot;:&quot;DEBUG&quot;,&quot;traceId&quot;:&quot;test-trace-id&quot;,&quot;userId&quot;:null,&quot;path&quot;:&quot;/test&quot;,&quot;message&quot;:&quot;After FMP fetch, query result for AAPL&quot;,&quot;type&quot;:&quot;general&quot;,&quot;dateRange&quot;:&quot;2025-01-01 to 2025-01-31&quot;,&quot;recordCount&quot;:1}
[get-historical] Successfully fetched 1 historical records for AAPL from FMP API

            </system-out>
            <system-err>
{&quot;timestamp&quot;:&quot;2025-12-14T20:04:29.485Z&quot;,&quot;service&quot;:&quot;stockly-api-test&quot;,&quot;level&quot;:&quot;WARN&quot;,&quot;traceId&quot;:&quot;test-trace-id&quot;,&quot;userId&quot;:null,&quot;path&quot;:&quot;/test&quot;,&quot;message&quot;:&quot;Found 1 records with missing OHLC data&quot;,&quot;type&quot;:&quot;general&quot;,&quot;symbol&quot;:&quot;AAPL&quot;,&quot;recordsWithMissingOHLC&quot;:1,&quot;totalRecords&quot;:1}

            </system-err>
        </testcase>
        <testcase classname="test/get-historical.spec.ts" name="getHistorical handler &gt; Missing OHLC data handling &gt; does not re-fetch when OHLC data is present" time="0.003">
            <system-out>
[get-historical] Query result for AAPL (2025-01-01 to 2025-01-31): 1 records found in database

            </system-out>
        </testcase>
        <testcase classname="test/get-historical.spec.ts" name="getHistorical handler &gt; Error handling &gt; handles database query errors gracefully" time="0.007">
            <system-err>
ERROR in getHistorical for AAPL: Error: Database error
    at /home/sngvahmed/workspace/stockly/api/test/get-historical.spec.ts:816:67
    at home/sngvahmed/workspace/stockly/api/node_modules/@vitest/runner/dist/chunk-hooks.js:155:11
    at home/sngvahmed/workspace/stockly/api/node_modules/@vitest/runner/dist/chunk-hooks.js:752:26
    at home/sngvahmed/workspace/stockly/api/node_modules/@vitest/runner/dist/chunk-hooks.js:1897:20
    at new Promise (&lt;anonymous&gt;)
    at runWithTimeout (home/sngvahmed/workspace/stockly/api/node_modules/@vitest/runner/dist/chunk-hooks.js:1863:10)
    at runTest (home/sngvahmed/workspace/stockly/api/node_modules/@vitest/runner/dist/chunk-hooks.js:1574:12)
    at runSuite (home/sngvahmed/workspace/stockly/api/node_modules/@vitest/runner/dist/chunk-hooks.js:1729:8)
    at runSuite (home/sngvahmed/workspace/stockly/api/node_modules/@vitest/runner/dist/chunk-hooks.js:1729:8)
    at runSuite (home/sngvahmed/workspace/stockly/api/node_modules/@vitest/runner/dist/chunk-hooks.js:1729:8)

            </system-err>
        </testcase>
    </testsuite>
    <testsuite name="test/get-news.spec.ts" timestamp="2025-12-14T20:04:38.198Z" hostname="sngvahmed" tests="7" failures="0" errors="0" skipped="0" time="0.419">
        <testcase classname="test/get-news.spec.ts" name="News API &gt; getGeneralNews &gt; should return general news from FMP API" time="0.039">
            <system-out>
[News Cache] Queued news update for news:general (1 pending writes)
[News Cache] Flushing 1 pending writes to KV...

[News Cache] Flushed 1/1 writes to KV

            </system-out>
        </testcase>
        <testcase classname="test/get-news.spec.ts" name="News API &gt; getGeneralNews &gt; should handle API errors gracefully" time="0.046">
            <system-err>
Failed to fetch general news from FMP API: Error: API error
    at /home/sngvahmed/workspace/stockly/api/test/get-news.spec.ts:73:45
    at home/sngvahmed/workspace/stockly/api/node_modules/@vitest/runner/dist/chunk-hooks.js:155:11
    at home/sngvahmed/workspace/stockly/api/node_modules/@vitest/runner/dist/chunk-hooks.js:752:26
    at home/sngvahmed/workspace/stockly/api/node_modules/@vitest/runner/dist/chunk-hooks.js:1897:20
    at new Promise (&lt;anonymous&gt;)
    at runWithTimeout (home/sngvahmed/workspace/stockly/api/node_modules/@vitest/runner/dist/chunk-hooks.js:1863:10)
    at runTest (home/sngvahmed/workspace/stockly/api/node_modules/@vitest/runner/dist/chunk-hooks.js:1574:12)
    at runSuite (home/sngvahmed/workspace/stockly/api/node_modules/@vitest/runner/dist/chunk-hooks.js:1729:8)
    at runSuite (home/sngvahmed/workspace/stockly/api/node_modules/@vitest/runner/dist/chunk-hooks.js:1729:8)
    at runSuite (home/sngvahmed/workspace/stockly/api/node_modules/@vitest/runner/dist/chunk-hooks.js:1729:8)

{&quot;timestamp&quot;:&quot;2025-12-14T20:04:25.716Z&quot;,&quot;service&quot;:&quot;stockly-api-test&quot;,&quot;level&quot;:&quot;ERROR&quot;,&quot;traceId&quot;:&quot;test-trace-id&quot;,&quot;userId&quot;:null,&quot;path&quot;:&quot;/test&quot;,&quot;message&quot;:&quot;Failed to fetch general news&quot;,&quot;type&quot;:&quot;general&quot;,&quot;error&quot;:{&quot;name&quot;:&quot;Error&quot;,&quot;message&quot;:&quot;API error&quot;,&quot;stack&quot;:&quot;Error: API error\n    at /home/sngvahmed/workspace/stockly/api/test/get-news.spec.ts:73:45\n    at home/sngvahmed/workspace/stockly/api/node_modules/@vitest/runner/dist/chunk-hooks.js:155:11\n    at home/sngvahmed/workspace/stockly/api/node_modules/@vitest/runner/dist/chunk-hooks.js:752:26\n    at home/sngvahmed/workspace/stockly/api/node_modules/@vitest/runner/dist/chunk-hooks.js:1897:20\n    at new Promise (&lt;anonymous&gt;)\n    at runWithTimeout (home/sngvahmed/workspace/stockly/api/node_modules/@vitest/runner/dist/chunk-hooks.js:1863:10)\n    at runTest (home/sngvahmed/workspace/stockly/api/node_modules/@vitest/runner/dist/chunk-hooks.js:1574:12)\n    at runSuite (home/sngvahmed/workspace/stockly/api/node_modules/@vitest/runner/dist/chunk-hooks.js:1729:8)\n    at runSuite (home/sngvahmed/workspace/stockly/api/node_modules/@vitest/runner/dist/chunk-hooks.js:1729:8)\n    at runSuite (home/sngvahmed/workspace/stockly/api/node_modules/@vitest/runner/dist/chunk-hooks.js:1729:8)&quot;}}

            </system-err>
        </testcase>
        <testcase classname="test/get-news.spec.ts" name="News API &gt; getFavoriteNews &gt; should return news for favorite symbols" time="0.036">
            <system-out>
{&quot;timestamp&quot;:&quot;2025-12-14T20:04:25.811Z&quot;,&quot;service&quot;:&quot;stockly-api-test&quot;,&quot;level&quot;:&quot;INFO&quot;,&quot;traceId&quot;:&quot;test-trace-id&quot;,&quot;userId&quot;:null,&quot;path&quot;:&quot;/test&quot;,&quot;message&quot;:&quot;Fetching favorite news&quot;,&quot;type&quot;:&quot;general&quot;,&quot;username&quot;:&quot;testuser&quot;}

{&quot;timestamp&quot;:&quot;2025-12-14T20:04:25.812Z&quot;,&quot;service&quot;:&quot;stockly-api-test&quot;,&quot;level&quot;:&quot;INFO&quot;,&quot;traceId&quot;:&quot;test-trace-id&quot;,&quot;userId&quot;:null,&quot;path&quot;:&quot;/test&quot;,&quot;message&quot;:&quot;Favorite symbols found&quot;,&quot;type&quot;:&quot;general&quot;,&quot;username&quot;:&quot;testuser&quot;,&quot;symbolCount&quot;:2,&quot;symbols&quot;:[&quot;AAPL&quot;,&quot;TSLA&quot;]}

News cache miss for AAPL,TSLA, fetching from API...

[News Cache] Queued news update for news:AAPL,TSLA (1 pending writes)
[News Cache] Skipping KV write - only 0s since last write (interval: 3600s)

            </system-out>
        </testcase>
        <testcase classname="test/get-news.spec.ts" name="News API &gt; getFavoriteNews &gt; should return empty list if no favorites" time="0.03">
            <system-out>
{&quot;timestamp&quot;:&quot;2025-12-14T20:04:25.847Z&quot;,&quot;service&quot;:&quot;stockly-api-test&quot;,&quot;level&quot;:&quot;INFO&quot;,&quot;traceId&quot;:&quot;test-trace-id&quot;,&quot;userId&quot;:null,&quot;path&quot;:&quot;/test&quot;,&quot;message&quot;:&quot;Fetching favorite news&quot;,&quot;type&quot;:&quot;general&quot;,&quot;username&quot;:&quot;testuser&quot;}

{&quot;timestamp&quot;:&quot;2025-12-14T20:04:25.848Z&quot;,&quot;service&quot;:&quot;stockly-api-test&quot;,&quot;level&quot;:&quot;INFO&quot;,&quot;traceId&quot;:&quot;test-trace-id&quot;,&quot;userId&quot;:null,&quot;path&quot;:&quot;/test&quot;,&quot;message&quot;:&quot;No favorite symbols selected&quot;,&quot;type&quot;:&quot;general&quot;,&quot;username&quot;:&quot;testuser&quot;}

            </system-out>
        </testcase>
        <testcase classname="test/get-news.spec.ts" name="News API &gt; News Archive &gt; should toggle archived news" time="0.03">
            <system-out>
{&quot;timestamp&quot;:&quot;2025-12-14T20:04:25.915Z&quot;,&quot;service&quot;:&quot;stockly-api-test&quot;,&quot;level&quot;:&quot;INFO&quot;,&quot;traceId&quot;:&quot;test-trace-id&quot;,&quot;userId&quot;:null,&quot;path&quot;:&quot;/test&quot;,&quot;message&quot;:&quot;Article saved successfully&quot;,&quot;type&quot;:&quot;general&quot;,&quot;username&quot;:&quot;testuser&quot;,&quot;articleId&quot;:&quot;test-article-id&quot;,&quot;symbol&quot;:&quot;&quot;}

            </system-out>
        </testcase>
        <testcase classname="test/get-news.spec.ts" name="News API &gt; News Archive &gt; should retrieve archived news" time="0.024">
            <system-out>
{&quot;timestamp&quot;:&quot;2025-12-14T20:04:25.942Z&quot;,&quot;service&quot;:&quot;stockly-api-test&quot;,&quot;level&quot;:&quot;INFO&quot;,&quot;traceId&quot;:&quot;test-trace-id&quot;,&quot;userId&quot;:&quot;user-123&quot;,&quot;path&quot;:&quot;/test&quot;,&quot;message&quot;:&quot;Fetching archived news&quot;,&quot;type&quot;:&quot;general&quot;,&quot;username&quot;:&quot;testuser&quot;,&quot;page&quot;:0,&quot;limit&quot;:20}

{&quot;timestamp&quot;:&quot;2025-12-14T20:04:25.943Z&quot;,&quot;service&quot;:&quot;stockly-api-test&quot;,&quot;level&quot;:&quot;INFO&quot;,&quot;traceId&quot;:&quot;test-trace-id&quot;,&quot;userId&quot;:&quot;user-123&quot;,&quot;path&quot;:&quot;/test&quot;,&quot;message&quot;:&quot;Archived news fetched successfully&quot;,&quot;type&quot;:&quot;general&quot;,&quot;username&quot;:&quot;testuser&quot;,&quot;page&quot;:0,&quot;limit&quot;:20,&quot;total&quot;:1,&quot;returned&quot;:1,&quot;hasMore&quot;:false}

            </system-out>
        </testcase>
        <testcase classname="test/get-news.spec.ts" name="News API &gt; User Preferences &gt; should update news favorite symbols" time="0.021">
        </testcase>
    </testsuite>
    <testsuite name="test/get-stock-details.spec.ts" timestamp="2025-12-14T20:04:38.200Z" hostname="sngvahmed" tests="7" failures="0" errors="0" skipped="0" time="13.168">
        <testcase classname="test/get-stock-details.spec.ts" name="getStockDetails service &gt; returns cached data when available and valid" time="0.033">
            <system-out>
Cache hit for stock details: AAPL

            </system-out>
        </testcase>
        <testcase classname="test/get-stock-details.spec.ts" name="getStockDetails service &gt; fetches all data from FMP API when cache misses" time="0.035">
            <system-out>
Cache miss for stock details: AAPL, fetching...

            </system-out>
        </testcase>
        <testcase classname="test/get-stock-details.spec.ts" name="getStockDetails service &gt; handles partial data failures gracefully" time="3.041">
            <system-out>
Cache miss for stock details: AAPL, fetching...

            </system-out>
            <system-err>
Failed to fetch historical for AAPL: Error: Endpoint failed
    at /home/sngvahmed/workspace/stockly/api/test/get-stock-details.spec.ts:139:31
    at mockCall (home/sngvahmed/workspace/stockly/api/node_modules/@vitest/spy/dist/index.js:96:15)
    at spy (home/sngvahmed/workspace/stockly/api/node_modules/tinyspy/dist/index.js:47:80)
    at fetchWithRetry (/home/sngvahmed/workspace/stockly/api/src/services/get-stock-details.ts:61:25)
    at async Promise.allSettled (index 2)
    at getStockDetails (/home/sngvahmed/workspace/stockly/api/src/services/get-stock-details.ts:400:9)
    at /home/sngvahmed/workspace/stockly/api/test/get-stock-details.spec.ts:142:20
    at home/sngvahmed/workspace/stockly/api/node_modules/@vitest/runner/dist/chunk-hooks.js:752:20
Failed to fetch news for AAPL: Error: Endpoint failed
    at /home/sngvahmed/workspace/stockly/api/test/get-stock-details.spec.ts:139:31
    at mockCall (home/sngvahmed/workspace/stockly/api/node_modules/@vitest/spy/dist/index.js:96:15)
    at spy (home/sngvahmed/workspace/stockly/api/node_modules/tinyspy/dist/index.js:47:80)
    at fetchWithRetry (/home/sngvahmed/workspace/stockly/api/src/services/get-stock-details.ts:61:25)
    at async Promise.allSettled (index 5)
    at getStockDetails (/home/sngvahmed/workspace/stockly/api/src/services/get-stock-details.ts:400:9)
    at /home/sngvahmed/workspace/stockly/api/test/get-stock-details.spec.ts:142:20
    at home/sngvahmed/workspace/stockly/api/node_modules/@vitest/runner/dist/chunk-hooks.js:752:20

            </system-err>
        </testcase>
        <testcase classname="test/get-stock-details.spec.ts" name="getStockDetails service &gt; returns error when all critical endpoints fail" time="9.009">
            <system-out>
Cache miss for stock details: AAPL, fetching...

            </system-out>
            <system-err>
Failed to fetch profile for AAPL: Error: All profile endpoints failed
    at fetchProfile (/home/sngvahmed/workspace/stockly/api/src/services/get-stock-details.ts:134:9)
    at async Promise.allSettled (index 0)
    at getStockDetails (/home/sngvahmed/workspace/stockly/api/src/services/get-stock-details.ts:400:9)
    at /home/sngvahmed/workspace/stockly/api/test/get-stock-details.spec.ts:162:20
    at home/sngvahmed/workspace/stockly/api/node_modules/@vitest/runner/dist/chunk-hooks.js:752:20
Failed to fetch quote for AAPL: Error: All endpoints failed
    at /home/sngvahmed/workspace/stockly/api/test/get-stock-details.spec.ts:159:31
    at mockCall (home/sngvahmed/workspace/stockly/api/node_modules/@vitest/spy/dist/index.js:96:15)
    at spy (home/sngvahmed/workspace/stockly/api/node_modules/tinyspy/dist/index.js:47:80)
    at fetchWithRetry (/home/sngvahmed/workspace/stockly/api/src/services/get-stock-details.ts:61:25)
    at async Promise.allSettled (index 1)
    at getStockDetails (/home/sngvahmed/workspace/stockly/api/src/services/get-stock-details.ts:400:9)
    at /home/sngvahmed/workspace/stockly/api/test/get-stock-details.spec.ts:162:20
    at home/sngvahmed/workspace/stockly/api/node_modules/@vitest/runner/dist/chunk-hooks.js:752:20
Failed to fetch historical for AAPL: Error: All endpoints failed
    at /home/sngvahmed/workspace/stockly/api/test/get-stock-details.spec.ts:159:31
    at mockCall (home/sngvahmed/workspace/stockly/api/node_modules/@vitest/spy/dist/index.js:96:15)
    at spy (home/sngvahmed/workspace/stockly/api/node_modules/tinyspy/dist/index.js:47:80)
    at fetchWithRetry (/home/sngvahmed/workspace/stockly/api/src/services/get-stock-details.ts:61:25)
    at async Promise.allSettled (index 2)
    at getStockDetails (/home/sngvahmed/workspace/stockly/api/src/services/get-stock-details.ts:400:9)
    at /home/sngvahmed/workspace/stockly/api/test/get-stock-details.spec.ts:162:20
    at home/sngvahmed/workspace/stockly/api/node_modules/@vitest/runner/dist/chunk-hooks.js:752:20
Failed to fetch news for AAPL: Error: All endpoints failed
    at /home/sngvahmed/workspace/stockly/api/test/get-stock-details.spec.ts:159:31
    at mockCall (home/sngvahmed/workspace/stockly/api/node_modules/@vitest/spy/dist/index.js:96:15)
    at spy (home/sngvahmed/workspace/stockly/api/node_modules/tinyspy/dist/index.js:47:80)
    at fetchWithRetry (/home/sngvahmed/workspace/stockly/api/src/services/get-stock-details.ts:61:25)
    at async Promise.allSettled (index 5)
    at getStockDetails (/home/sngvahmed/workspace/stockly/api/src/services/get-stock-details.ts:400:9)
    at /home/sngvahmed/workspace/stockly/api/test/get-stock-details.spec.ts:162:20
    at home/sngvahmed/workspace/stockly/api/node_modules/@vitest/runner/dist/chunk-hooks.js:752:20

            </system-err>
        </testcase>
        <testcase classname="test/get-stock-details.spec.ts" name="getStockDetails service &gt; normalizes chart data correctly by time periods" time="0.004">
            <system-out>
Cache miss for stock details: AAPL, fetching...

            </system-out>
        </testcase>
        <testcase classname="test/get-stock-details.spec.ts" name="getStockDetails service &gt; handles rate limiting with retry" time="1.006">
            <system-out>
Cache miss for stock details: AAPL, fetching...

            </system-out>
            <system-err>
Rate limited, retrying in 1000ms...
Rate limited, retrying in 1000ms...

            </system-err>
        </testcase>
        <testcase classname="test/get-stock-details.spec.ts" name="getStockDetails service &gt; normalizes financial data correctly" time="0.004">
            <system-out>
Cache miss for stock details: AAPL, fetching...

            </system-out>
        </testcase>
    </testsuite>
    <testsuite name="test/get-stock-news.spec.ts" timestamp="2025-12-14T20:04:38.201Z" hostname="sngvahmed" tests="8" failures="0" errors="0" skipped="0" time="0.556">
        <testcase classname="test/get-stock-news.spec.ts" name="getStockNews handler &gt; requires a symbol" time="0.049">
        </testcase>
        <testcase classname="test/get-stock-news.spec.ts" name="getStockNews handler &gt; returns cached data without calling the upstream API" time="0.052">
            <system-out>
Cache hit for news AAPL: age=0s &lt; interval=30s

            </system-out>
        </testcase>
        <testcase classname="test/get-stock-news.spec.ts" name="getStockNews handler &gt; fetches news from FMP API when cache misses" time="0.089">
            <system-out>
No cache for news AAPL, fetching fresh data

            </system-out>
        </testcase>
        <testcase classname="test/get-stock-news.spec.ts" name="getStockNews handler &gt; returns empty array when FMP API returns empty array" time="0.086">
            <system-out>
No cache for news XYZ, fetching fresh data

            </system-out>
        </testcase>
        <testcase classname="test/get-stock-news.spec.ts" name="getStockNews handler &gt; handles API errors gracefully" time="0.056">
            <system-out>
No cache for news AAPL, fetching fresh data

            </system-out>
            <system-err>
Provider API failed for news AAPL: HTTP 500

            </system-err>
        </testcase>
        <testcase classname="test/get-stock-news.spec.ts" name="getStockNews handler &gt; handles network errors gracefully" time="0.062">
            <system-out>
No cache for news AAPL, fetching fresh data

            </system-out>
            <system-err>
Error fetching news for AAPL: Error: Failed to fetch
    at /home/sngvahmed/workspace/stockly/api/test/get-stock-news.spec.ts:185:60
    at home/sngvahmed/workspace/stockly/api/node_modules/@vitest/runner/dist/chunk-hooks.js:155:11
    at home/sngvahmed/workspace/stockly/api/node_modules/@vitest/runner/dist/chunk-hooks.js:752:26
    at home/sngvahmed/workspace/stockly/api/node_modules/@vitest/runner/dist/chunk-hooks.js:1897:20
    at new Promise (&lt;anonymous&gt;)
    at runWithTimeout (home/sngvahmed/workspace/stockly/api/node_modules/@vitest/runner/dist/chunk-hooks.js:1863:10)
    at runTest (home/sngvahmed/workspace/stockly/api/node_modules/@vitest/runner/dist/chunk-hooks.js:1574:12)
    at runSuite (home/sngvahmed/workspace/stockly/api/node_modules/@vitest/runner/dist/chunk-hooks.js:1729:8)
    at runSuite (home/sngvahmed/workspace/stockly/api/node_modules/@vitest/runner/dist/chunk-hooks.js:1729:8)
    at runFiles (home/sngvahmed/workspace/stockly/api/node_modules/@vitest/runner/dist/chunk-hooks.js:1787:3)
Provider network error for news AAPL: Failed to fetch

            </system-err>
        </testcase>
        <testcase classname="test/get-stock-news.spec.ts" name="getStockNews handler &gt; handles simulation mode" time="0.032">
            <system-out>
No cache for news AAPL, fetching fresh data

            </system-out>
        </testcase>
        <testcase classname="test/get-stock-news.spec.ts" name="getStockNews handler &gt; normalizes news data correctly" time="0.059">
            <system-out>
No cache for news AAPL, fetching fresh data

            </system-out>
        </testcase>
    </testsuite>
    <testsuite name="test/get-stock.spec.ts" timestamp="2025-12-14T20:04:38.203Z" hostname="sngvahmed" tests="10" failures="0" errors="0" skipped="0" time="0.665">
        <testcase classname="test/get-stock.spec.ts" name="getStock handler &gt; requires a symbol" time="0.062">
        </testcase>
        <testcase classname="test/get-stock.spec.ts" name="getStock handler &gt; returns cached data without calling the upstream API" time="0.091">
            <system-out>
{&quot;timestamp&quot;:&quot;2025-12-14T20:04:25.522Z&quot;,&quot;service&quot;:&quot;stockly-api-test&quot;,&quot;level&quot;:&quot;INFO&quot;,&quot;traceId&quot;:&quot;test-trace-id&quot;,&quot;userId&quot;:null,&quot;path&quot;:&quot;/test&quot;,&quot;message&quot;:&quot;Cache hit for MSFT&quot;,&quot;type&quot;:&quot;general&quot;,&quot;ageSeconds&quot;:0,&quot;pollingIntervalSec&quot;:30,&quot;cacheStatus&quot;:&quot;HIT&quot;}

            </system-out>
            <system-err>
alertsKv not available, using default config

            </system-err>
        </testcase>
        <testcase classname="test/get-stock.spec.ts" name="getStock handler &gt; fetches the quote and caches the parsed response" time="0.066">
            <system-out>
{&quot;timestamp&quot;:&quot;2025-12-14T20:04:25.575Z&quot;,&quot;service&quot;:&quot;stockly-api-test&quot;,&quot;level&quot;:&quot;INFO&quot;,&quot;traceId&quot;:&quot;test-trace-id&quot;,&quot;userId&quot;:null,&quot;path&quot;:&quot;/test&quot;,&quot;message&quot;:&quot;No cache for AAPL&quot;,&quot;type&quot;:&quot;general&quot;,&quot;cacheStatus&quot;:&quot;MISS&quot;}

{&quot;timestamp&quot;:&quot;2025-12-14T20:04:25.576Z&quot;,&quot;service&quot;:&quot;stockly-api-test&quot;,&quot;level&quot;:&quot;DEBUG&quot;,&quot;traceId&quot;:&quot;test-trace-id&quot;,&quot;userId&quot;:null,&quot;path&quot;:&quot;/test&quot;,&quot;message&quot;:&quot;FMP API: GET /quote&quot;,&quot;type&quot;:&quot;api_call&quot;,&quot;apiProvider&quot;:&quot;FMP&quot;,&quot;endpoint&quot;:&quot;/quote&quot;,&quot;method&quot;:&quot;GET&quot;,&quot;latencyMs&quot;:1}

{&quot;timestamp&quot;:&quot;2025-12-14T20:04:25.576Z&quot;,&quot;service&quot;:&quot;stockly-api-test&quot;,&quot;level&quot;:&quot;DEBUG&quot;,&quot;traceId&quot;:&quot;test-trace-id&quot;,&quot;userId&quot;:null,&quot;path&quot;:&quot;/test&quot;,&quot;message&quot;:&quot;FMP API: GET /profile&quot;,&quot;type&quot;:&quot;api_call&quot;,&quot;apiProvider&quot;:&quot;FMP&quot;,&quot;endpoint&quot;:&quot;/profile&quot;,&quot;method&quot;:&quot;GET&quot;,&quot;latencyMs&quot;:0}

{&quot;timestamp&quot;:&quot;2025-12-14T20:04:25.576Z&quot;,&quot;service&quot;:&quot;stockly-api-test&quot;,&quot;level&quot;:&quot;DEBUG&quot;,&quot;traceId&quot;:&quot;test-trace-id&quot;,&quot;userId&quot;:null,&quot;path&quot;:&quot;/test&quot;,&quot;message&quot;:&quot;Profile API response&quot;,&quot;type&quot;:&quot;general&quot;,&quot;endpoint&quot;:&quot;https://financialmodelingprep.com/stable/profile?symbol=AAPL&amp;apikey=z5xjUUlsab7zBKntL5QnMzWyPuq2iWsM&quot;,&quot;responseType&quot;:&quot;array&quot;,&quot;responseLength&quot;:0}
{&quot;timestamp&quot;:&quot;2025-12-14T20:04:25.576Z&quot;,&quot;service&quot;:&quot;stockly-api-test&quot;,&quot;level&quot;:&quot;DEBUG&quot;,&quot;traceId&quot;:&quot;test-trace-id&quot;,&quot;userId&quot;:null,&quot;path&quot;:&quot;/test&quot;,&quot;message&quot;:&quot;Profile API returned empty array&quot;,&quot;type&quot;:&quot;general&quot;,&quot;endpoint&quot;:&quot;https://financialmodelingprep.com/stable/profile?symbol=AAPL&amp;apikey=z5xjUUlsab7zBKntL5QnMzWyPuq2iWsM&quot;}

{&quot;timestamp&quot;:&quot;2025-12-14T20:04:25.576Z&quot;,&quot;service&quot;:&quot;stockly-api-test&quot;,&quot;level&quot;:&quot;DEBUG&quot;,&quot;traceId&quot;:&quot;test-trace-id&quot;,&quot;userId&quot;:null,&quot;path&quot;:&quot;/test&quot;,&quot;message&quot;:&quot;FMP API: GET /profile&quot;,&quot;type&quot;:&quot;api_call&quot;,&quot;apiProvider&quot;:&quot;FMP&quot;,&quot;endpoint&quot;:&quot;/profile&quot;,&quot;method&quot;:&quot;GET&quot;,&quot;latencyMs&quot;:0}

{&quot;timestamp&quot;:&quot;2025-12-14T20:04:25.576Z&quot;,&quot;service&quot;:&quot;stockly-api-test&quot;,&quot;level&quot;:&quot;DEBUG&quot;,&quot;traceId&quot;:&quot;test-trace-id&quot;,&quot;userId&quot;:null,&quot;path&quot;:&quot;/test&quot;,&quot;message&quot;:&quot;Profile API response&quot;,&quot;type&quot;:&quot;general&quot;,&quot;endpoint&quot;:&quot;https://financialmodelingprep.com/stable/profile/AAPL?apikey=z5xjUUlsab7zBKntL5QnMzWyPuq2iWsM&quot;,&quot;responseType&quot;:&quot;array&quot;,&quot;responseLength&quot;:0}
{&quot;timestamp&quot;:&quot;2025-12-14T20:04:25.576Z&quot;,&quot;service&quot;:&quot;stockly-api-test&quot;,&quot;level&quot;:&quot;DEBUG&quot;,&quot;traceId&quot;:&quot;test-trace-id&quot;,&quot;userId&quot;:null,&quot;path&quot;:&quot;/test&quot;,&quot;message&quot;:&quot;Profile API returned empty array&quot;,&quot;type&quot;:&quot;general&quot;,&quot;endpoint&quot;:&quot;https://financialmodelingprep.com/stable/profile/AAPL?apikey=z5xjUUlsab7zBKntL5QnMzWyPuq2iWsM&quot;}

{&quot;timestamp&quot;:&quot;2025-12-14T20:04:25.577Z&quot;,&quot;service&quot;:&quot;stockly-api-test&quot;,&quot;level&quot;:&quot;DEBUG&quot;,&quot;traceId&quot;:&quot;test-trace-id&quot;,&quot;userId&quot;:null,&quot;path&quot;:&quot;/test&quot;,&quot;message&quot;:&quot;FMP API: GET /profile&quot;,&quot;type&quot;:&quot;api_call&quot;,&quot;apiProvider&quot;:&quot;FMP&quot;,&quot;endpoint&quot;:&quot;/profile&quot;,&quot;method&quot;:&quot;GET&quot;,&quot;latencyMs&quot;:0}

{&quot;timestamp&quot;:&quot;2025-12-14T20:04:25.577Z&quot;,&quot;service&quot;:&quot;stockly-api-test&quot;,&quot;level&quot;:&quot;DEBUG&quot;,&quot;traceId&quot;:&quot;test-trace-id&quot;,&quot;userId&quot;:null,&quot;path&quot;:&quot;/test&quot;,&quot;message&quot;:&quot;Profile API response&quot;,&quot;type&quot;:&quot;general&quot;,&quot;endpoint&quot;:&quot;https://financialmodelingprep.com/stable/company/profile/AAPL?apikey=z5xjUUlsab7zBKntL5QnMzWyPuq2iWsM&quot;,&quot;responseType&quot;:&quot;array&quot;,&quot;responseLength&quot;:0}
{&quot;timestamp&quot;:&quot;2025-12-14T20:04:25.577Z&quot;,&quot;service&quot;:&quot;stockly-api-test&quot;,&quot;level&quot;:&quot;DEBUG&quot;,&quot;traceId&quot;:&quot;test-trace-id&quot;,&quot;userId&quot;:null,&quot;path&quot;:&quot;/test&quot;,&quot;message&quot;:&quot;Profile API returned empty array&quot;,&quot;type&quot;:&quot;general&quot;,&quot;endpoint&quot;:&quot;https://financialmodelingprep.com/stable/company/profile/AAPL?apikey=z5xjUUlsab7zBKntL5QnMzWyPuq2iWsM&quot;}

{&quot;timestamp&quot;:&quot;2025-12-14T20:04:25.577Z&quot;,&quot;service&quot;:&quot;stockly-api-test&quot;,&quot;level&quot;:&quot;DEBUG&quot;,&quot;traceId&quot;:&quot;test-trace-id&quot;,&quot;userId&quot;:null,&quot;path&quot;:&quot;/test&quot;,&quot;message&quot;:&quot;FMP API: GET /profile&quot;,&quot;type&quot;:&quot;api_call&quot;,&quot;apiProvider&quot;:&quot;FMP&quot;,&quot;endpoint&quot;:&quot;/profile&quot;,&quot;method&quot;:&quot;GET&quot;,&quot;latencyMs&quot;:0}

{&quot;timestamp&quot;:&quot;2025-12-14T20:04:25.577Z&quot;,&quot;service&quot;:&quot;stockly-api-test&quot;,&quot;level&quot;:&quot;DEBUG&quot;,&quot;traceId&quot;:&quot;test-trace-id&quot;,&quot;userId&quot;:null,&quot;path&quot;:&quot;/test&quot;,&quot;message&quot;:&quot;Profile API response&quot;,&quot;type&quot;:&quot;general&quot;,&quot;endpoint&quot;:&quot;https://financialmodelingprep.com/api/v3/profile/AAPL?apikey=z5xjUUlsab7zBKntL5QnMzWyPuq2iWsM&quot;,&quot;responseType&quot;:&quot;array&quot;,&quot;responseLength&quot;:0}
{&quot;timestamp&quot;:&quot;2025-12-14T20:04:25.577Z&quot;,&quot;service&quot;:&quot;stockly-api-test&quot;,&quot;level&quot;:&quot;DEBUG&quot;,&quot;traceId&quot;:&quot;test-trace-id&quot;,&quot;userId&quot;:null,&quot;path&quot;:&quot;/test&quot;,&quot;message&quot;:&quot;Profile API returned empty array&quot;,&quot;type&quot;:&quot;general&quot;,&quot;endpoint&quot;:&quot;https://financialmodelingprep.com/api/v3/profile/AAPL?apikey=z5xjUUlsab7zBKntL5QnMzWyPuq2iWsM&quot;}

{&quot;timestamp&quot;:&quot;2025-12-14T20:04:25.577Z&quot;,&quot;service&quot;:&quot;stockly-api-test&quot;,&quot;level&quot;:&quot;DEBUG&quot;,&quot;traceId&quot;:&quot;test-trace-id&quot;,&quot;userId&quot;:null,&quot;path&quot;:&quot;/test&quot;,&quot;message&quot;:&quot;Final description resolved&quot;,&quot;type&quot;:&quot;general&quot;,&quot;hasDescription&quot;:false,&quot;descriptionLength&quot;:0,&quot;source&quot;:&quot;none&quot;}

            </system-out>
        </testcase>
        <testcase classname="test/get-stock.spec.ts" name="getStock handler &gt; returns an error when the upstream API fails" time="0.046">
            <system-out>
{&quot;timestamp&quot;:&quot;2025-12-14T20:04:25.639Z&quot;,&quot;service&quot;:&quot;stockly-api-test&quot;,&quot;level&quot;:&quot;INFO&quot;,&quot;traceId&quot;:&quot;test-trace-id&quot;,&quot;userId&quot;:null,&quot;path&quot;:&quot;/test&quot;,&quot;message&quot;:&quot;No cache for TSLA&quot;,&quot;type&quot;:&quot;general&quot;,&quot;cacheStatus&quot;:&quot;MISS&quot;}

            </system-out>
            <system-err>
{&quot;timestamp&quot;:&quot;2025-12-14T20:04:25.639Z&quot;,&quot;service&quot;:&quot;stockly-api-test&quot;,&quot;level&quot;:&quot;ERROR&quot;,&quot;traceId&quot;:&quot;test-trace-id&quot;,&quot;userId&quot;:null,&quot;path&quot;:&quot;/test&quot;,&quot;message&quot;:&quot;ERROR in getStock&quot;,&quot;type&quot;:&quot;general&quot;,&quot;symbol&quot;:&quot;TSLA&quot;,&quot;error&quot;:{&quot;name&quot;:&quot;Error&quot;,&quot;message&quot;:&quot;fail&quot;,&quot;stack&quot;:&quot;Error: fail\n    at /home/sngvahmed/workspace/stockly/api/test/get-stock.spec.ts:136:60\n    at home/sngvahmed/workspace/stockly/api/node_modules/@vitest/runner/dist/chunk-hooks.js:155:11\n    at home/sngvahmed/workspace/stockly/api/node_modules/@vitest/runner/dist/chunk-hooks.js:752:26\n    at home/sngvahmed/workspace/stockly/api/node_modules/@vitest/runner/dist/chunk-hooks.js:1897:20\n    at new Promise (&lt;anonymous&gt;)\n    at runWithTimeout (home/sngvahmed/workspace/stockly/api/node_modules/@vitest/runner/dist/chunk-hooks.js:1863:10)\n    at runTest (home/sngvahmed/workspace/stockly/api/node_modules/@vitest/runner/dist/chunk-hooks.js:1574:12)\n    at runSuite (home/sngvahmed/workspace/stockly/api/node_modules/@vitest/runner/dist/chunk-hooks.js:1729:8)\n    at runSuite (home/sngvahmed/workspace/stockly/api/node_modules/@vitest/runner/dist/chunk-hooks.js:1729:8)\n    at runFiles (home/sngvahmed/workspace/stockly/api/node_modules/@vitest/runner/dist/chunk-hooks.js:1787:3)&quot;}}

            </system-err>
        </testcase>
        <testcase classname="test/get-stock.spec.ts" name="getStock handler &gt; returns stale data from DB when simulation mode is enabled" time="0.093">
            <system-out>
{&quot;timestamp&quot;:&quot;2025-12-14T20:04:25.735Z&quot;,&quot;service&quot;:&quot;stockly-api-test&quot;,&quot;level&quot;:&quot;INFO&quot;,&quot;traceId&quot;:&quot;test-trace-id&quot;,&quot;userId&quot;:null,&quot;path&quot;:&quot;/test&quot;,&quot;message&quot;:&quot;No cache for AAPL&quot;,&quot;type&quot;:&quot;general&quot;,&quot;cacheStatus&quot;:&quot;MISS&quot;}

            </system-out>
        </testcase>
        <testcase classname="test/get-stock.spec.ts" name="getStock handler &gt; returns no_price_available when simulation is enabled but no DB data exists" time="0.044">
            <system-out>
{&quot;timestamp&quot;:&quot;2025-12-14T20:04:25.781Z&quot;,&quot;service&quot;:&quot;stockly-api-test&quot;,&quot;level&quot;:&quot;INFO&quot;,&quot;traceId&quot;:&quot;test-trace-id&quot;,&quot;userId&quot;:null,&quot;path&quot;:&quot;/test&quot;,&quot;message&quot;:&quot;No cache for AAPL&quot;,&quot;type&quot;:&quot;general&quot;,&quot;cacheStatus&quot;:&quot;MISS&quot;}

            </system-out>
        </testcase>
        <testcase classname="test/get-stock.spec.ts" name="getStock handler &gt; calls provider normally when simulation is disabled" time="0.035">
            <system-out>
{&quot;timestamp&quot;:&quot;2025-12-14T20:04:25.822Z&quot;,&quot;service&quot;:&quot;stockly-api-test&quot;,&quot;level&quot;:&quot;INFO&quot;,&quot;traceId&quot;:&quot;test-trace-id&quot;,&quot;userId&quot;:null,&quot;path&quot;:&quot;/test&quot;,&quot;message&quot;:&quot;No cache for AAPL&quot;,&quot;type&quot;:&quot;general&quot;,&quot;cacheStatus&quot;:&quot;MISS&quot;}

{&quot;timestamp&quot;:&quot;2025-12-14T20:04:25.822Z&quot;,&quot;service&quot;:&quot;stockly-api-test&quot;,&quot;level&quot;:&quot;DEBUG&quot;,&quot;traceId&quot;:&quot;test-trace-id&quot;,&quot;userId&quot;:null,&quot;path&quot;:&quot;/test&quot;,&quot;message&quot;:&quot;FMP API: GET /quote&quot;,&quot;type&quot;:&quot;api_call&quot;,&quot;apiProvider&quot;:&quot;FMP&quot;,&quot;endpoint&quot;:&quot;/quote&quot;,&quot;method&quot;:&quot;GET&quot;,&quot;latencyMs&quot;:0}

{&quot;timestamp&quot;:&quot;2025-12-14T20:04:25.822Z&quot;,&quot;service&quot;:&quot;stockly-api-test&quot;,&quot;level&quot;:&quot;DEBUG&quot;,&quot;traceId&quot;:&quot;test-trace-id&quot;,&quot;userId&quot;:null,&quot;path&quot;:&quot;/test&quot;,&quot;message&quot;:&quot;FMP API: GET /profile&quot;,&quot;type&quot;:&quot;api_call&quot;,&quot;apiProvider&quot;:&quot;FMP&quot;,&quot;endpoint&quot;:&quot;/profile&quot;,&quot;method&quot;:&quot;GET&quot;,&quot;latencyMs&quot;:0}

{&quot;timestamp&quot;:&quot;2025-12-14T20:04:25.823Z&quot;,&quot;service&quot;:&quot;stockly-api-test&quot;,&quot;level&quot;:&quot;DEBUG&quot;,&quot;traceId&quot;:&quot;test-trace-id&quot;,&quot;userId&quot;:null,&quot;path&quot;:&quot;/test&quot;,&quot;message&quot;:&quot;Profile API response&quot;,&quot;type&quot;:&quot;general&quot;,&quot;endpoint&quot;:&quot;https://financialmodelingprep.com/stable/profile?symbol=AAPL&amp;apikey=z5xjUUlsab7zBKntL5QnMzWyPuq2iWsM&quot;,&quot;responseType&quot;:&quot;array&quot;,&quot;responseLength&quot;:0}
{&quot;timestamp&quot;:&quot;2025-12-14T20:04:25.823Z&quot;,&quot;service&quot;:&quot;stockly-api-test&quot;,&quot;level&quot;:&quot;DEBUG&quot;,&quot;traceId&quot;:&quot;test-trace-id&quot;,&quot;userId&quot;:null,&quot;path&quot;:&quot;/test&quot;,&quot;message&quot;:&quot;Profile API returned empty array&quot;,&quot;type&quot;:&quot;general&quot;,&quot;endpoint&quot;:&quot;https://financialmodelingprep.com/stable/profile?symbol=AAPL&amp;apikey=z5xjUUlsab7zBKntL5QnMzWyPuq2iWsM&quot;}

{&quot;timestamp&quot;:&quot;2025-12-14T20:04:25.823Z&quot;,&quot;service&quot;:&quot;stockly-api-test&quot;,&quot;level&quot;:&quot;DEBUG&quot;,&quot;traceId&quot;:&quot;test-trace-id&quot;,&quot;userId&quot;:null,&quot;path&quot;:&quot;/test&quot;,&quot;message&quot;:&quot;FMP API: GET /profile&quot;,&quot;type&quot;:&quot;api_call&quot;,&quot;apiProvider&quot;:&quot;FMP&quot;,&quot;endpoint&quot;:&quot;/profile&quot;,&quot;method&quot;:&quot;GET&quot;,&quot;latencyMs&quot;:0}

{&quot;timestamp&quot;:&quot;2025-12-14T20:04:25.823Z&quot;,&quot;service&quot;:&quot;stockly-api-test&quot;,&quot;level&quot;:&quot;DEBUG&quot;,&quot;traceId&quot;:&quot;test-trace-id&quot;,&quot;userId&quot;:null,&quot;path&quot;:&quot;/test&quot;,&quot;message&quot;:&quot;Profile API response&quot;,&quot;type&quot;:&quot;general&quot;,&quot;endpoint&quot;:&quot;https://financialmodelingprep.com/stable/profile/AAPL?apikey=z5xjUUlsab7zBKntL5QnMzWyPuq2iWsM&quot;,&quot;responseType&quot;:&quot;array&quot;,&quot;responseLength&quot;:0}
{&quot;timestamp&quot;:&quot;2025-12-14T20:04:25.823Z&quot;,&quot;service&quot;:&quot;stockly-api-test&quot;,&quot;level&quot;:&quot;DEBUG&quot;,&quot;traceId&quot;:&quot;test-trace-id&quot;,&quot;userId&quot;:null,&quot;path&quot;:&quot;/test&quot;,&quot;message&quot;:&quot;Profile API returned empty array&quot;,&quot;type&quot;:&quot;general&quot;,&quot;endpoint&quot;:&quot;https://financialmodelingprep.com/stable/profile/AAPL?apikey=z5xjUUlsab7zBKntL5QnMzWyPuq2iWsM&quot;}

{&quot;timestamp&quot;:&quot;2025-12-14T20:04:25.823Z&quot;,&quot;service&quot;:&quot;stockly-api-test&quot;,&quot;level&quot;:&quot;DEBUG&quot;,&quot;traceId&quot;:&quot;test-trace-id&quot;,&quot;userId&quot;:null,&quot;path&quot;:&quot;/test&quot;,&quot;message&quot;:&quot;FMP API: GET /profile&quot;,&quot;type&quot;:&quot;api_call&quot;,&quot;apiProvider&quot;:&quot;FMP&quot;,&quot;endpoint&quot;:&quot;/profile&quot;,&quot;method&quot;:&quot;GET&quot;,&quot;latencyMs&quot;:0}

{&quot;timestamp&quot;:&quot;2025-12-14T20:04:25.823Z&quot;,&quot;service&quot;:&quot;stockly-api-test&quot;,&quot;level&quot;:&quot;DEBUG&quot;,&quot;traceId&quot;:&quot;test-trace-id&quot;,&quot;userId&quot;:null,&quot;path&quot;:&quot;/test&quot;,&quot;message&quot;:&quot;Profile API response&quot;,&quot;type&quot;:&quot;general&quot;,&quot;endpoint&quot;:&quot;https://financialmodelingprep.com/stable/company/profile/AAPL?apikey=z5xjUUlsab7zBKntL5QnMzWyPuq2iWsM&quot;,&quot;responseType&quot;:&quot;array&quot;,&quot;responseLength&quot;:0}
{&quot;timestamp&quot;:&quot;2025-12-14T20:04:25.823Z&quot;,&quot;service&quot;:&quot;stockly-api-test&quot;,&quot;level&quot;:&quot;DEBUG&quot;,&quot;traceId&quot;:&quot;test-trace-id&quot;,&quot;userId&quot;:null,&quot;path&quot;:&quot;/test&quot;,&quot;message&quot;:&quot;Profile API returned empty array&quot;,&quot;type&quot;:&quot;general&quot;,&quot;endpoint&quot;:&quot;https://financialmodelingprep.com/stable/company/profile/AAPL?apikey=z5xjUUlsab7zBKntL5QnMzWyPuq2iWsM&quot;}

{&quot;timestamp&quot;:&quot;2025-12-14T20:04:25.823Z&quot;,&quot;service&quot;:&quot;stockly-api-test&quot;,&quot;level&quot;:&quot;DEBUG&quot;,&quot;traceId&quot;:&quot;test-trace-id&quot;,&quot;userId&quot;:null,&quot;path&quot;:&quot;/test&quot;,&quot;message&quot;:&quot;FMP API: GET /profile&quot;,&quot;type&quot;:&quot;api_call&quot;,&quot;apiProvider&quot;:&quot;FMP&quot;,&quot;endpoint&quot;:&quot;/profile&quot;,&quot;method&quot;:&quot;GET&quot;,&quot;latencyMs&quot;:0}

{&quot;timestamp&quot;:&quot;2025-12-14T20:04:25.823Z&quot;,&quot;service&quot;:&quot;stockly-api-test&quot;,&quot;level&quot;:&quot;DEBUG&quot;,&quot;traceId&quot;:&quot;test-trace-id&quot;,&quot;userId&quot;:null,&quot;path&quot;:&quot;/test&quot;,&quot;message&quot;:&quot;Profile API response&quot;,&quot;type&quot;:&quot;general&quot;,&quot;endpoint&quot;:&quot;https://financialmodelingprep.com/api/v3/profile/AAPL?apikey=z5xjUUlsab7zBKntL5QnMzWyPuq2iWsM&quot;,&quot;responseType&quot;:&quot;array&quot;,&quot;responseLength&quot;:0}
{&quot;timestamp&quot;:&quot;2025-12-14T20:04:25.823Z&quot;,&quot;service&quot;:&quot;stockly-api-test&quot;,&quot;level&quot;:&quot;DEBUG&quot;,&quot;traceId&quot;:&quot;test-trace-id&quot;,&quot;userId&quot;:null,&quot;path&quot;:&quot;/test&quot;,&quot;message&quot;:&quot;Profile API returned empty array&quot;,&quot;type&quot;:&quot;general&quot;,&quot;endpoint&quot;:&quot;https://financialmodelingprep.com/api/v3/profile/AAPL?apikey=z5xjUUlsab7zBKntL5QnMzWyPuq2iWsM&quot;}

{&quot;timestamp&quot;:&quot;2025-12-14T20:04:25.824Z&quot;,&quot;service&quot;:&quot;stockly-api-test&quot;,&quot;level&quot;:&quot;DEBUG&quot;,&quot;traceId&quot;:&quot;test-trace-id&quot;,&quot;userId&quot;:null,&quot;path&quot;:&quot;/test&quot;,&quot;message&quot;:&quot;Final description resolved&quot;,&quot;type&quot;:&quot;general&quot;,&quot;hasDescription&quot;:false,&quot;descriptionLength&quot;:0,&quot;source&quot;:&quot;none&quot;}

            </system-out>
        </testcase>
        <testcase classname="test/get-stock.spec.ts" name="getStock handler &gt; falls back to DB and returns stale data when provider API fails" time="0.082">
            <system-out>
{&quot;timestamp&quot;:&quot;2025-12-14T20:04:25.855Z&quot;,&quot;service&quot;:&quot;stockly-api-test&quot;,&quot;level&quot;:&quot;INFO&quot;,&quot;traceId&quot;:&quot;test-trace-id&quot;,&quot;userId&quot;:null,&quot;path&quot;:&quot;/test&quot;,&quot;message&quot;:&quot;No cache for AAPL&quot;,&quot;type&quot;:&quot;general&quot;,&quot;cacheStatus&quot;:&quot;MISS&quot;}

{&quot;timestamp&quot;:&quot;2025-12-14T20:04:25.856Z&quot;,&quot;service&quot;:&quot;stockly-api-test&quot;,&quot;level&quot;:&quot;DEBUG&quot;,&quot;traceId&quot;:&quot;test-trace-id&quot;,&quot;userId&quot;:null,&quot;path&quot;:&quot;/test&quot;,&quot;message&quot;:&quot;FMP API: GET /quote&quot;,&quot;type&quot;:&quot;api_call&quot;,&quot;apiProvider&quot;:&quot;FMP&quot;,&quot;endpoint&quot;:&quot;/quote&quot;,&quot;method&quot;:&quot;GET&quot;,&quot;statusCode&quot;:500,&quot;latencyMs&quot;:1}

            </system-out>
            <system-err>
{&quot;timestamp&quot;:&quot;2025-12-14T20:04:25.856Z&quot;,&quot;service&quot;:&quot;stockly-api-test&quot;,&quot;level&quot;:&quot;WARN&quot;,&quot;traceId&quot;:&quot;test-trace-id&quot;,&quot;userId&quot;:null,&quot;path&quot;:&quot;/test&quot;,&quot;message&quot;:&quot;Provider API failed for AAPL&quot;,&quot;type&quot;:&quot;general&quot;,&quot;statusCode&quot;:500,&quot;apiProvider&quot;:&quot;FMP&quot;}

{&quot;timestamp&quot;:&quot;2025-12-14T20:04:25.908Z&quot;,&quot;service&quot;:&quot;stockly-api-test&quot;,&quot;level&quot;:&quot;ERROR&quot;,&quot;traceId&quot;:&quot;test-trace-id&quot;,&quot;userId&quot;:null,&quot;path&quot;:&quot;/test&quot;,&quot;message&quot;:&quot;Failed to send provider failure notifications&quot;,&quot;type&quot;:&quot;general&quot;,&quot;symbol&quot;:&quot;AAPL&quot;,&quot;error&quot;:{&quot;name&quot;:&quot;TypeError&quot;,&quot;message&quot;:&quot;env.stockly.prepare(...).all is not a function&quot;,&quot;stack&quot;:&quot;TypeError: env.stockly.prepare(...).all is not a function\n    at notifyUsersOfProviderFailure (/home/sngvahmed/workspace/stockly/api/src/api/get-stock.ts:452:8)&quot;}}

            </system-err>
        </testcase>
        <testcase classname="test/get-stock.spec.ts" name="getStock handler &gt; falls back to DB when provider returns invalid data" time="0.04">
            <system-out>
{&quot;timestamp&quot;:&quot;2025-12-14T20:04:25.936Z&quot;,&quot;service&quot;:&quot;stockly-api-test&quot;,&quot;level&quot;:&quot;INFO&quot;,&quot;traceId&quot;:&quot;test-trace-id&quot;,&quot;userId&quot;:null,&quot;path&quot;:&quot;/test&quot;,&quot;message&quot;:&quot;No cache for TSLA&quot;,&quot;type&quot;:&quot;general&quot;,&quot;cacheStatus&quot;:&quot;MISS&quot;}

{&quot;timestamp&quot;:&quot;2025-12-14T20:04:25.936Z&quot;,&quot;service&quot;:&quot;stockly-api-test&quot;,&quot;level&quot;:&quot;DEBUG&quot;,&quot;traceId&quot;:&quot;test-trace-id&quot;,&quot;userId&quot;:null,&quot;path&quot;:&quot;/test&quot;,&quot;message&quot;:&quot;FMP API: GET /quote&quot;,&quot;type&quot;:&quot;api_call&quot;,&quot;apiProvider&quot;:&quot;FMP&quot;,&quot;endpoint&quot;:&quot;/quote&quot;,&quot;method&quot;:&quot;GET&quot;,&quot;latencyMs&quot;:0}

            </system-out>
            <system-err>
{&quot;timestamp&quot;:&quot;2025-12-14T20:04:25.936Z&quot;,&quot;service&quot;:&quot;stockly-api-test&quot;,&quot;level&quot;:&quot;WARN&quot;,&quot;traceId&quot;:&quot;test-trace-id&quot;,&quot;userId&quot;:null,&quot;path&quot;:&quot;/test&quot;,&quot;message&quot;:&quot;Provider API returned invalid data for TSLA&quot;,&quot;type&quot;:&quot;general&quot;,&quot;apiProvider&quot;:&quot;FMP&quot;}

{&quot;timestamp&quot;:&quot;2025-12-14T20:04:25.954Z&quot;,&quot;service&quot;:&quot;stockly-api-test&quot;,&quot;level&quot;:&quot;ERROR&quot;,&quot;traceId&quot;:&quot;test-trace-id&quot;,&quot;userId&quot;:null,&quot;path&quot;:&quot;/test&quot;,&quot;message&quot;:&quot;Failed to send provider failure notifications&quot;,&quot;type&quot;:&quot;general&quot;,&quot;symbol&quot;:&quot;TSLA&quot;,&quot;error&quot;:{&quot;name&quot;:&quot;TypeError&quot;,&quot;message&quot;:&quot;env.stockly.prepare(...).all is not a function&quot;,&quot;stack&quot;:&quot;TypeError: env.stockly.prepare(...).all is not a function\n    at notifyUsersOfProviderFailure (/home/sngvahmed/workspace/stockly/api/src/api/get-stock.ts:452:8)&quot;}}

            </system-err>
        </testcase>
        <testcase classname="test/get-stock.spec.ts" name="getStock handler &gt; falls back to DB when provider network request fails" time="0.043">
            <system-out>
{&quot;timestamp&quot;:&quot;2025-12-14T20:04:25.976Z&quot;,&quot;service&quot;:&quot;stockly-api-test&quot;,&quot;level&quot;:&quot;INFO&quot;,&quot;traceId&quot;:&quot;test-trace-id&quot;,&quot;userId&quot;:null,&quot;path&quot;:&quot;/test&quot;,&quot;message&quot;:&quot;No cache for MSFT&quot;,&quot;type&quot;:&quot;general&quot;,&quot;cacheStatus&quot;:&quot;MISS&quot;}

            </system-out>
            <system-err>
{&quot;timestamp&quot;:&quot;2025-12-14T20:04:25.977Z&quot;,&quot;service&quot;:&quot;stockly-api-test&quot;,&quot;level&quot;:&quot;ERROR&quot;,&quot;traceId&quot;:&quot;test-trace-id&quot;,&quot;userId&quot;:null,&quot;path&quot;:&quot;/test&quot;,&quot;message&quot;:&quot;ERROR in getStock&quot;,&quot;type&quot;:&quot;general&quot;,&quot;symbol&quot;:&quot;MSFT&quot;,&quot;error&quot;:{&quot;name&quot;:&quot;Error&quot;,&quot;message&quot;:&quot;Failed to fetch&quot;,&quot;stack&quot;:&quot;Error: Failed to fetch\n    at /home/sngvahmed/workspace/stockly/api/test/get-stock.spec.ts:477:7\n    at home/sngvahmed/workspace/stockly/api/node_modules/@vitest/runner/dist/chunk-hooks.js:155:11\n    at home/sngvahmed/workspace/stockly/api/node_modules/@vitest/runner/dist/chunk-hooks.js:752:26\n    at home/sngvahmed/workspace/stockly/api/node_modules/@vitest/runner/dist/chunk-hooks.js:1897:20\n    at new Promise (&lt;anonymous&gt;)\n    at runWithTimeout (home/sngvahmed/workspace/stockly/api/node_modules/@vitest/runner/dist/chunk-hooks.js:1863:10)\n    at runTest (home/sngvahmed/workspace/stockly/api/node_modules/@vitest/runner/dist/chunk-hooks.js:1574:12)\n    at runSuite (home/sngvahmed/workspace/stockly/api/node_modules/@vitest/runner/dist/chunk-hooks.js:1729:8)\n    at runSuite (home/sngvahmed/workspace/stockly/api/node_modules/@vitest/runner/dist/chunk-hooks.js:1729:8)\n    at runFiles (home/sngvahmed/workspace/stockly/api/node_modules/@vitest/runner/dist/chunk-hooks.js:1787:3)&quot;}}
{&quot;timestamp&quot;:&quot;2025-12-14T20:04:25.977Z&quot;,&quot;service&quot;:&quot;stockly-api-test&quot;,&quot;level&quot;:&quot;WARN&quot;,&quot;traceId&quot;:&quot;test-trace-id&quot;,&quot;userId&quot;:null,&quot;path&quot;:&quot;/test&quot;,&quot;message&quot;:&quot;Provider fetch error for MSFT&quot;,&quot;type&quot;:&quot;general&quot;,&quot;error&quot;:&quot;Failed to fetch&quot;,&quot;apiProvider&quot;:&quot;FMP&quot;}

{&quot;timestamp&quot;:&quot;2025-12-14T20:04:25.996Z&quot;,&quot;service&quot;:&quot;stockly-api-test&quot;,&quot;level&quot;:&quot;ERROR&quot;,&quot;traceId&quot;:&quot;test-trace-id&quot;,&quot;userId&quot;:null,&quot;path&quot;:&quot;/test&quot;,&quot;message&quot;:&quot;Failed to send provider failure notifications&quot;,&quot;type&quot;:&quot;general&quot;,&quot;symbol&quot;:&quot;MSFT&quot;,&quot;error&quot;:{&quot;name&quot;:&quot;TypeError&quot;,&quot;message&quot;:&quot;env.stockly.prepare(...).all is not a function&quot;,&quot;stack&quot;:&quot;TypeError: env.stockly.prepare(...).all is not a function\n    at notifyUsersOfProviderFailure (/home/sngvahmed/workspace/stockly/api/src/api/get-stock.ts:452:8)&quot;}}

            </system-err>
        </testcase>
    </testsuite>
    <testsuite name="test/get-stocks.spec.ts" timestamp="2025-12-14T20:04:38.206Z" hostname="sngvahmed" tests="10" failures="0" errors="0" skipped="0" time="0.633">
        <testcase classname="test/get-stocks.spec.ts" name="getStocks handler &gt; requires symbols param" time="0.038">
        </testcase>
        <testcase classname="test/get-stocks.spec.ts" name="getStocks handler &gt; serves fresh entries from cache" time="0.05">
            <system-err>
alertsKv not available, using default config

            </system-err>
        </testcase>
        <testcase classname="test/get-stocks.spec.ts" name="getStocks handler &gt; refreshes from API when cache misses to get full data" time="0.074">
        </testcase>
        <testcase classname="test/get-stocks.spec.ts" name="getStocks handler &gt; fetches from API when cache and DB entries are stale" time="0.052">
        </testcase>
        <testcase classname="test/get-stocks.spec.ts" name="getStocks handler &gt; returns empty array when all API calls fail" time="0.071">
            <system-err>
Failed to fetch quote for MSFT: Error: boom
    at /home/sngvahmed/workspace/stockly/api/test/get-stocks.spec.ts:191:60
    at home/sngvahmed/workspace/stockly/api/node_modules/@vitest/runner/dist/chunk-hooks.js:155:11
    at home/sngvahmed/workspace/stockly/api/node_modules/@vitest/runner/dist/chunk-hooks.js:752:26
    at home/sngvahmed/workspace/stockly/api/node_modules/@vitest/runner/dist/chunk-hooks.js:1897:20
    at new Promise (&lt;anonymous&gt;)
    at runWithTimeout (home/sngvahmed/workspace/stockly/api/node_modules/@vitest/runner/dist/chunk-hooks.js:1863:10)
    at runTest (home/sngvahmed/workspace/stockly/api/node_modules/@vitest/runner/dist/chunk-hooks.js:1574:12)
    at runSuite (home/sngvahmed/workspace/stockly/api/node_modules/@vitest/runner/dist/chunk-hooks.js:1729:8)
    at runSuite (home/sngvahmed/workspace/stockly/api/node_modules/@vitest/runner/dist/chunk-hooks.js:1729:8)
    at runFiles (home/sngvahmed/workspace/stockly/api/node_modules/@vitest/runner/dist/chunk-hooks.js:1787:3)

            </system-err>
        </testcase>
        <testcase classname="test/get-stocks.spec.ts" name="getStocks handler &gt; returns full data structure with all required fields for single stock" time="0.086">
        </testcase>
        <testcase classname="test/get-stocks.spec.ts" name="getStocks handler &gt; returns full data structure for multiple stocks" time="0.04">
        </testcase>
        <testcase classname="test/get-stocks.spec.ts" name="getStocks handler &gt; sets name from companyName if name is missing" time="0.059">
        </testcase>
        <testcase classname="test/get-stocks.spec.ts" name="getStocks handler &gt; always includes image even if profile fetch fails" time="0.043">
        </testcase>
        <testcase classname="test/get-stocks.spec.ts" name="getStocks handler &gt; handles partial failures gracefully with Promise.allSettled" time="0.058">
            <system-err>
Failed to fetch quote for INVALID: Error: Failed to fetch INVALID
    at fetchQuoteFromApi (/home/sngvahmed/workspace/stockly/api/src/api/get-stocks.ts:178:11)
    at async Promise.allSettled (index 1)
    at fetchQuotesBatchFromApi (/home/sngvahmed/workspace/stockly/api/src/api/get-stocks.ts:216:24)
    at getStocks (/home/sngvahmed/workspace/stockly/api/src/api/get-stocks.ts:304:25)
    at /home/sngvahmed/workspace/stockly/api/test/get-stocks.spec.ts:473:22
    at home/sngvahmed/workspace/stockly/api/node_modules/@vitest/runner/dist/chunk-hooks.js:752:20

            </system-err>
        </testcase>
    </testsuite>
    <testsuite name="test/index.spec.ts" timestamp="2025-12-14T20:04:38.207Z" hostname="sngvahmed" tests="6" failures="0" errors="0" skipped="0" time="0.031">
        <testcase classname="test/index.spec.ts" name="worker router &gt; returns the health check" time="0.006">
        </testcase>
        <testcase classname="test/index.spec.ts" name="worker router &gt; delegates /get-stock requests" time="0.004">
        </testcase>
        <testcase classname="test/index.spec.ts" name="worker router &gt; delegates /search-stock requests" time="0.003">
        </testcase>
        <testcase classname="test/index.spec.ts" name="worker router &gt; delegates /get-stocks requests" time="0.004">
        </testcase>
        <testcase classname="test/index.spec.ts" name="worker router &gt; returns 404 for unknown routes" time="0.006">
            <system-err>
{&quot;timestamp&quot;:&quot;2025-12-14T20:04:26.248Z&quot;,&quot;service&quot;:&quot;stockly-api&quot;,&quot;level&quot;:&quot;WARN&quot;,&quot;traceId&quot;:&quot;2f18ad1d-2874-4f28-bd62-c7bb2bc402d4&quot;,&quot;userId&quot;:null,&quot;path&quot;:&quot;/v1/api/unknown&quot;,&quot;message&quot;:&quot;Route not found&quot;,&quot;type&quot;:&quot;general&quot;,&quot;pathname&quot;:&quot;/v1/api/unknown&quot;,&quot;method&quot;:&quot;GET&quot;}

            </system-err>
        </testcase>
        <testcase classname="test/index.spec.ts" name="worker router &gt; responds to CORS preflight requests" time="0.004">
        </testcase>
    </testsuite>
    <testsuite name="test/search-stock.spec.ts" timestamp="2025-12-14T20:04:38.208Z" hostname="sngvahmed" tests="6" failures="0" errors="0" skipped="0" time="0.4">
        <testcase classname="test/search-stock.spec.ts" name="searchStock handler &gt; returns empty results when query is invalid" time="0.04">
        </testcase>
        <testcase classname="test/search-stock.spec.ts" name="searchStock handler &gt; serves cached responses from memory" time="0.035">
        </testcase>
        <testcase classname="test/search-stock.spec.ts" name="searchStock handler &gt; returns cached entries from D1 when still valid" time="0.072">
        </testcase>
        <testcase classname="test/search-stock.spec.ts" name="searchStock handler &gt; invokes the upstream API, normalizes payload, and stores cache" time="0.047">
        </testcase>
        <testcase classname="test/search-stock.spec.ts" name="searchStock handler &gt; ignores expired D1 cache entries and fetches fresh data" time="0.063">
        </testcase>
        <testcase classname="test/search-stock.spec.ts" name="searchStock handler &gt; returns empty array when upstream request fails gracefully" time="0.061">
        </testcase>
    </testsuite>
    <testsuite name="test/util.spec.ts" timestamp="2025-12-14T20:04:38.209Z" hostname="sngvahmed" tests="2" failures="0" errors="0" skipped="0" time="0.166">
        <testcase classname="test/util.spec.ts" name="json utility &gt; serializes payload into a JSON Response" time="0.039">
        </testcase>
        <testcase classname="test/util.spec.ts" name="json utility &gt; allows overriding the status code" time="0.034">
        </testcase>
    </testsuite>
    <testsuite name="test/alerts/state-cache.spec.ts" timestamp="2025-12-14T20:04:38.209Z" hostname="sngvahmed" tests="19" failures="0" errors="0" skipped="0" time="1.267">
        <testcase classname="test/alerts/state-cache.spec.ts" name="Alert State Cache &gt; getCachedState &gt; should return null when state not cached" time="0.037">
        </testcase>
        <testcase classname="test/alerts/state-cache.spec.ts" name="Alert State Cache &gt; getCachedState &gt; should return cached state" time="0.031">
            <system-out>
[KV Cache] Queued state update for alert alert-1 (1 pending writes)

            </system-out>
        </testcase>
        <testcase classname="test/alerts/state-cache.spec.ts" name="Alert State Cache &gt; updateStateInCache &gt; should update state in cache" time="0.024">
            <system-out>
[KV Cache] Queued state update for alert alert-1 (1 pending writes)

            </system-out>
        </testcase>
        <testcase classname="test/alerts/state-cache.spec.ts" name="Alert State Cache &gt; updateStateInCache &gt; should queue state for KV write" time="0.024">
            <system-out>
[KV Cache] Queued state update for alert alert-1 (1 pending writes)

            </system-out>
        </testcase>
        <testcase classname="test/alerts/state-cache.spec.ts" name="Alert State Cache &gt; loadAllStatesFromKV &gt; should load states from KV" time="0.03">
            <system-out>
[KV Cache] Loading 2 alert states from KV...

[KV Cache] Loaded 2 states from KV

            </system-out>
        </testcase>
        <testcase classname="test/alerts/state-cache.spec.ts" name="Alert State Cache &gt; loadAllStatesFromKV &gt; should cache loaded states in memory" time="0.032">
            <system-out>
[KV Cache] Loading 1 alert states from KV...

[KV Cache] Loaded 1 states from KV

            </system-out>
        </testcase>
        <testcase classname="test/alerts/state-cache.spec.ts" name="Alert State Cache &gt; loadAllStatesFromKV &gt; should return cached data if cache is fresh" time="0.056">
            <system-out>
[KV Cache] Loading 1 alert states from KV...

[KV Cache] Loaded 1 states from KV

            </system-out>
        </testcase>
        <testcase classname="test/alerts/state-cache.spec.ts" name="Alert State Cache &gt; loadAllStatesFromKV &gt; should handle missing states" time="0.028">
            <system-out>
[KV Cache] Loading 2 alert states from KV...

[KV Cache] Loaded 1 states from KV

            </system-out>
        </testcase>
        <testcase classname="test/alerts/state-cache.spec.ts" name="Alert State Cache &gt; loadAllStatesFromKV &gt; should handle invalid JSON" time="0.059">
            <system-out>
[KV Cache] Loading 1 alert states from KV...

[KV Cache] Loaded 0 states from KV

            </system-out>
            <system-err>
[KV Cache] Failed to load state for alert alert-1: SyntaxError: Unexpected token &apos;i&apos;, &quot;invalid json&quot; is not valid JSON
    at JSON.parse (&lt;anonymous&gt;)
    at /home/sngvahmed/workspace/stockly/api/src/alerts/state-cache.ts:54:29
    at async Promise.all (index 0)
    at loadAllStatesFromKV (/home/sngvahmed/workspace/stockly/api/src/alerts/state-cache.ts:64:19)
    at /home/sngvahmed/workspace/stockly/api/test/alerts/state-cache.spec.ts:158:22
    at home/sngvahmed/workspace/stockly/api/node_modules/@vitest/runner/dist/chunk-hooks.js:752:20

            </system-err>
        </testcase>
        <testcase classname="test/alerts/state-cache.spec.ts" name="Alert State Cache &gt; loadAllStatesFromKV &gt; should handle KV read errors" time="0.022">
            <system-out>
[KV Cache] Loading 1 alert states from KV...

[KV Cache] Loaded 0 states from KV

            </system-out>
            <system-err>
[KV Cache] Failed to load state for alert alert-1: Error: KV error
    at /home/sngvahmed/workspace/stockly/api/test/alerts/state-cache.spec.ts:166:47
    at home/sngvahmed/workspace/stockly/api/node_modules/@vitest/runner/dist/chunk-hooks.js:155:11
    at home/sngvahmed/workspace/stockly/api/node_modules/@vitest/runner/dist/chunk-hooks.js:752:26
    at home/sngvahmed/workspace/stockly/api/node_modules/@vitest/runner/dist/chunk-hooks.js:1897:20
    at new Promise (&lt;anonymous&gt;)
    at runWithTimeout (home/sngvahmed/workspace/stockly/api/node_modules/@vitest/runner/dist/chunk-hooks.js:1863:10)
    at runTest (home/sngvahmed/workspace/stockly/api/node_modules/@vitest/runner/dist/chunk-hooks.js:1574:12)
    at runSuite (home/sngvahmed/workspace/stockly/api/node_modules/@vitest/runner/dist/chunk-hooks.js:1729:8)
    at runSuite (home/sngvahmed/workspace/stockly/api/node_modules/@vitest/runner/dist/chunk-hooks.js:1729:8)
    at runSuite (home/sngvahmed/workspace/stockly/api/node_modules/@vitest/runner/dist/chunk-hooks.js:1729:8)

            </system-err>
        </testcase>
        <testcase classname="test/alerts/state-cache.spec.ts" name="Alert State Cache &gt; flushPendingWritesToKV &gt; should write pending states to KV" time="0.027">
            <system-out>
[KV Cache] Queued state update for alert alert-1 (1 pending writes)
[KV Cache] Flushing 1 pending writes to KV...

[KV Cache] Flushed 1/1 writes to KV

            </system-out>
        </testcase>
        <testcase classname="test/alerts/state-cache.spec.ts" name="Alert State Cache &gt; flushPendingWritesToKV &gt; should batch multiple writes" time="0.024">
            <system-out>
[KV Cache] Queued state update for alert alert-1 (1 pending writes)
[KV Cache] Queued state update for alert alert-2 (2 pending writes)
[KV Cache] Flushing 2 pending writes to KV...

[KV Cache] Flushed 2/2 writes to KV

            </system-out>
        </testcase>
        <testcase classname="test/alerts/state-cache.spec.ts" name="Alert State Cache &gt; flushPendingWritesToKV &gt; should not write if interval has not passed" time="0.025">
            <system-out>
[KV Cache] Queued state update for alert alert-1 (1 pending writes)
[KV Cache] Flushing 1 pending writes to KV...

[KV Cache] Flushed 1/1 writes to KV

[KV Cache] Queued state update for alert alert-2 (1 pending writes)
[KV Cache] Skipping KV write - only 0s since last write (interval: 3600s)

            </system-out>
        </testcase>
        <testcase classname="test/alerts/state-cache.spec.ts" name="Alert State Cache &gt; flushPendingWritesToKV &gt; should write if interval has passed" time="0.075">
            <system-out>
[KV Cache] Queued state update for alert alert-1 (1 pending writes)
[KV Cache] Flushing 1 pending writes to KV...

[KV Cache] Flushed 1/1 writes to KV

[KV Cache] Queued state update for alert alert-2 (1 pending writes)
[KV Cache] Flushing 1 pending writes to KV...

[KV Cache] Flushed 1/1 writes to KV

            </system-out>
        </testcase>
        <testcase classname="test/alerts/state-cache.spec.ts" name="Alert State Cache &gt; flushPendingWritesToKV &gt; should handle KV write errors gracefully" time="0.032">
            <system-out>
[KV Cache] Queued state update for alert alert-1 (1 pending writes)
[KV Cache] Flushing 1 pending writes to KV...

[KV Cache] Flushed 0/1 writes to KV

            </system-out>
            <system-err>
[KV Cache] Failed to write state for alert alert-1: Error: KV write failed
    at /home/sngvahmed/workspace/stockly/api/test/alerts/state-cache.spec.ts:264:47
    at home/sngvahmed/workspace/stockly/api/node_modules/@vitest/runner/dist/chunk-hooks.js:155:11
    at home/sngvahmed/workspace/stockly/api/node_modules/@vitest/runner/dist/chunk-hooks.js:752:26
    at home/sngvahmed/workspace/stockly/api/node_modules/@vitest/runner/dist/chunk-hooks.js:1897:20
    at new Promise (&lt;anonymous&gt;)
    at runWithTimeout (home/sngvahmed/workspace/stockly/api/node_modules/@vitest/runner/dist/chunk-hooks.js:1863:10)
    at runTest (home/sngvahmed/workspace/stockly/api/node_modules/@vitest/runner/dist/chunk-hooks.js:1574:12)
    at runSuite (home/sngvahmed/workspace/stockly/api/node_modules/@vitest/runner/dist/chunk-hooks.js:1729:8)
    at runSuite (home/sngvahmed/workspace/stockly/api/node_modules/@vitest/runner/dist/chunk-hooks.js:1729:8)
    at runSuite (home/sngvahmed/workspace/stockly/api/node_modules/@vitest/runner/dist/chunk-hooks.js:1729:8)

            </system-err>
        </testcase>
        <testcase classname="test/alerts/state-cache.spec.ts" name="Alert State Cache &gt; flushPendingWritesToKV &gt; should return early if no pending writes" time="0.083">
        </testcase>
        <testcase classname="test/alerts/state-cache.spec.ts" name="Alert State Cache &gt; invalidateState &gt; should remove state from cache and pending writes" time="0.09">
            <system-out>
[KV Cache] Queued state update for alert alert-1 (1 pending writes)

            </system-out>
        </testcase>
        <testcase classname="test/alerts/state-cache.spec.ts" name="Alert State Cache &gt; clearCache &gt; should clear all cached states" time="0.074">
            <system-out>
[KV Cache] Queued state update for alert alert-1 (1 pending writes)
[KV Cache] Queued state update for alert alert-2 (2 pending writes)

            </system-out>
        </testcase>
        <testcase classname="test/alerts/state-cache.spec.ts" name="Alert State Cache &gt; getCacheStats &gt; should return cache statistics" time="0.058">
            <system-out>
[KV Cache] Queued state update for alert alert-1 (1 pending writes)
[KV Cache] Queued state update for alert alert-2 (2 pending writes)

            </system-out>
        </testcase>
    </testsuite>
    <testsuite name="test/api/admin.spec.ts" timestamp="2025-12-14T20:04:38.213Z" hostname="sngvahmed" tests="14" failures="0" errors="0" skipped="0" time="0.783">
        <testcase classname="test/api/admin.spec.ts" name="Admin API &gt; getRecentNotifications &gt; should return recent notifications" time="0.053">
        </testcase>
        <testcase classname="test/api/admin.spec.ts" name="Admin API &gt; getRecentNotifications &gt; should return empty array when no notifications" time="0.088">
        </testcase>
        <testcase classname="test/api/admin.spec.ts" name="Admin API &gt; getRecentNotifications &gt; should handle database errors" time="0.094">
            <system-err>
Failed to retrieve recent notifications: Error: Database error
    at /home/sngvahmed/workspace/stockly/api/test/api/admin.spec.ts:130:40
    at home/sngvahmed/workspace/stockly/api/node_modules/@vitest/runner/dist/chunk-hooks.js:155:11
    at home/sngvahmed/workspace/stockly/api/node_modules/@vitest/runner/dist/chunk-hooks.js:752:26
    at home/sngvahmed/workspace/stockly/api/node_modules/@vitest/runner/dist/chunk-hooks.js:1897:20
    at new Promise (&lt;anonymous&gt;)
    at runWithTimeout (home/sngvahmed/workspace/stockly/api/node_modules/@vitest/runner/dist/chunk-hooks.js:1863:10)
    at runTest (home/sngvahmed/workspace/stockly/api/node_modules/@vitest/runner/dist/chunk-hooks.js:1574:12)
    at runSuite (home/sngvahmed/workspace/stockly/api/node_modules/@vitest/runner/dist/chunk-hooks.js:1729:8)
    at runSuite (home/sngvahmed/workspace/stockly/api/node_modules/@vitest/runner/dist/chunk-hooks.js:1729:8)
    at runSuite (home/sngvahmed/workspace/stockly/api/node_modules/@vitest/runner/dist/chunk-hooks.js:1729:8)

            </system-err>
        </testcase>
        <testcase classname="test/api/admin.spec.ts" name="Admin API &gt; getRecentNotifications &gt; should limit to 100 notifications" time="0.055">
        </testcase>
        <testcase classname="test/api/admin.spec.ts" name="Admin API &gt; getRecentNotifications &gt; should order by sent_at DESC" time="0.062">
        </testcase>
        <testcase classname="test/api/admin.spec.ts" name="Admin API &gt; getFailedNotifications &gt; should return only failed notifications" time="0.056">
        </testcase>
        <testcase classname="test/api/admin.spec.ts" name="Admin API &gt; getFailedNotifications &gt; should return empty array when no failed notifications" time="0.041">
        </testcase>
        <testcase classname="test/api/admin.spec.ts" name="Admin API &gt; getFailedNotifications &gt; should handle database errors" time="0.034">
            <system-err>
Failed to retrieve failed notifications: Error: Database error
    at /home/sngvahmed/workspace/stockly/api/test/api/admin.spec.ts:236:40
    at home/sngvahmed/workspace/stockly/api/node_modules/@vitest/runner/dist/chunk-hooks.js:155:11
    at home/sngvahmed/workspace/stockly/api/node_modules/@vitest/runner/dist/chunk-hooks.js:752:26
    at home/sngvahmed/workspace/stockly/api/node_modules/@vitest/runner/dist/chunk-hooks.js:1897:20
    at new Promise (&lt;anonymous&gt;)
    at runWithTimeout (home/sngvahmed/workspace/stockly/api/node_modules/@vitest/runner/dist/chunk-hooks.js:1863:10)
    at runTest (home/sngvahmed/workspace/stockly/api/node_modules/@vitest/runner/dist/chunk-hooks.js:1574:12)
    at runSuite (home/sngvahmed/workspace/stockly/api/node_modules/@vitest/runner/dist/chunk-hooks.js:1729:8)
    at runSuite (home/sngvahmed/workspace/stockly/api/node_modules/@vitest/runner/dist/chunk-hooks.js:1729:8)
    at runSuite (home/sngvahmed/workspace/stockly/api/node_modules/@vitest/runner/dist/chunk-hooks.js:1729:8)

            </system-err>
        </testcase>
        <testcase classname="test/api/admin.spec.ts" name="Admin API &gt; retryNotification &gt; should retry failed notification successfully" time="0.032">
        </testcase>
        <testcase classname="test/api/admin.spec.ts" name="Admin API &gt; retryNotification &gt; should return 404 when log not found" time="0.024">
        </testcase>
        <testcase classname="test/api/admin.spec.ts" name="Admin API &gt; retryNotification &gt; should handle retry failure" time="0.033">
        </testcase>
        <testcase classname="test/api/admin.spec.ts" name="Admin API &gt; retryNotification &gt; should create new log entry with attempt count 1" time="0.022">
        </testcase>
        <testcase classname="test/api/admin.spec.ts" name="Admin API &gt; retryNotification &gt; should handle database errors during retry" time="0.029">
            <system-err>
Failed to retry notification: Error: Database error
    at /home/sngvahmed/workspace/stockly/api/test/api/admin.spec.ts:472:40
    at home/sngvahmed/workspace/stockly/api/node_modules/@vitest/runner/dist/chunk-hooks.js:155:11
    at home/sngvahmed/workspace/stockly/api/node_modules/@vitest/runner/dist/chunk-hooks.js:752:26
    at home/sngvahmed/workspace/stockly/api/node_modules/@vitest/runner/dist/chunk-hooks.js:1897:20
    at new Promise (&lt;anonymous&gt;)
    at runWithTimeout (home/sngvahmed/workspace/stockly/api/node_modules/@vitest/runner/dist/chunk-hooks.js:1863:10)
    at runTest (home/sngvahmed/workspace/stockly/api/node_modules/@vitest/runner/dist/chunk-hooks.js:1574:12)
    at runSuite (home/sngvahmed/workspace/stockly/api/node_modules/@vitest/runner/dist/chunk-hooks.js:1729:8)
    at runSuite (home/sngvahmed/workspace/stockly/api/node_modules/@vitest/runner/dist/chunk-hooks.js:1729:8)
    at runSuite (home/sngvahmed/workspace/stockly/api/node_modules/@vitest/runner/dist/chunk-hooks.js:1729:8)

            </system-err>
        </testcase>
        <testcase classname="test/api/admin.spec.ts" name="Admin API &gt; retryNotification &gt; should handle FCM send errors" time="0.017">
        </testcase>
    </testsuite>
    <testsuite name="test/api/auth.spec.ts" timestamp="2025-12-14T20:04:38.215Z" hostname="sngvahmed" tests="14" failures="0" errors="0" skipped="0" time="0.718">
        <testcase classname="test/api/auth.spec.ts" name="Authentication API &gt; handleGoogleAuth &gt; should reject non-POST requests" time="0.063">
        </testcase>
        <testcase classname="test/api/auth.spec.ts" name="Authentication API &gt; handleGoogleAuth &gt; should reject requests without idToken" time="0.076">
        </testcase>
        <testcase classname="test/api/auth.spec.ts" name="Authentication API &gt; handleGoogleAuth &gt; should reject invalid JSON payload" time="0.043">
        </testcase>
        <testcase classname="test/api/auth.spec.ts" name="Authentication API &gt; checkUsernameAvailability &gt; should return available for new username" time="0.037">
        </testcase>
        <testcase classname="test/api/auth.spec.ts" name="Authentication API &gt; checkUsernameAvailability &gt; should return unavailable for existing username" time="0.06">
        </testcase>
        <testcase classname="test/api/auth.spec.ts" name="Authentication API &gt; checkUsernameAvailability &gt; should reject invalid username format" time="0.034">
        </testcase>
        <testcase classname="test/api/auth.spec.ts" name="Authentication API &gt; checkUsernameAvailability &gt; should reject reserved usernames" time="0.032">
        </testcase>
        <testcase classname="test/api/auth.spec.ts" name="Authentication API &gt; setUsername &gt; should set username for authenticated user" time="0.025">
        </testcase>
        <testcase classname="test/api/auth.spec.ts" name="Authentication API &gt; setUsername &gt; should reject username if already taken" time="0.025">
        </testcase>
        <testcase classname="test/api/auth.spec.ts" name="Authentication API &gt; refreshToken &gt; should refresh access token with valid refresh token" time="0.036">
        </testcase>
        <testcase classname="test/api/auth.spec.ts" name="Authentication API &gt; refreshToken &gt; should reject invalid refresh token" time="0.018">
        </testcase>
        <testcase classname="test/api/auth.spec.ts" name="Authentication API &gt; getCurrentUser &gt; should return current user for authenticated request" time="0.015">
        </testcase>
        <testcase classname="test/api/auth.spec.ts" name="Authentication API &gt; getCurrentUser &gt; should return 401 for unauthenticated request" time="0.014">
        </testcase>
        <testcase classname="test/api/auth.spec.ts" name="Authentication API &gt; logout &gt; should clear cookies and return success" time="0.015">
            <system-out>
{&quot;timestamp&quot;:&quot;2025-12-14T20:04:26.093Z&quot;,&quot;service&quot;:&quot;stockly-api-test&quot;,&quot;level&quot;:&quot;INFO&quot;,&quot;traceId&quot;:&quot;test-trace-id&quot;,&quot;path&quot;:&quot;/test&quot;,&quot;message&quot;:&quot;User logged out&quot;,&quot;type&quot;:&quot;general&quot;}
{&quot;timestamp&quot;:&quot;2025-12-14T20:04:26.094Z&quot;,&quot;service&quot;:&quot;stockly-api-test&quot;,&quot;level&quot;:&quot;INFO&quot;,&quot;traceId&quot;:&quot;test-trace-id&quot;,&quot;userId&quot;:null,&quot;path&quot;:&quot;/test&quot;,&quot;message&quot;:&quot;Auth event: sign_out&quot;,&quot;type&quot;:&quot;sign_out&quot;,&quot;success&quot;:true}

            </system-out>
        </testcase>
    </testsuite>
    <testsuite name="test/api/devices.spec.ts" timestamp="2025-12-14T20:04:38.216Z" hostname="sngvahmed" tests="25" failures="0" errors="0" skipped="0" time="0.455">
        <testcase classname="test/api/devices.spec.ts" name="Devices API &gt; getAllDevices &gt; should return devices for regular user" time="0.036">
        </testcase>
        <testcase classname="test/api/devices.spec.ts" name="Devices API &gt; getAllDevices &gt; should return all devices for admin user" time="0.034">
        </testcase>
        <testcase classname="test/api/devices.spec.ts" name="Devices API &gt; getAllDevices &gt; should handle missing device_type column gracefully" time="0.041">
        </testcase>
        <testcase classname="test/api/devices.spec.ts" name="Devices API &gt; getAllDevices &gt; should handle missing username column gracefully" time="0.026">
        </testcase>
        <testcase classname="test/api/devices.spec.ts" name="Devices API &gt; getAllDevices &gt; should return empty array when no devices found" time="0.024">
        </testcase>
        <testcase classname="test/api/devices.spec.ts" name="Devices API &gt; getAllDevices &gt; should return 401 when authentication fails" time="0.021">
        </testcase>
        <testcase classname="test/api/devices.spec.ts" name="Devices API &gt; getAllDevices &gt; should handle database errors gracefully" time="0.028">
        </testcase>
        <testcase classname="test/api/devices.spec.ts" name="Devices API &gt; getAllDevices &gt; should log warning when devices have null username" time="0.021">
        </testcase>
        <testcase classname="test/api/devices.spec.ts" name="Devices API &gt; deleteDevice &gt; should delete device for regular user" time="0.016">
        </testcase>
        <testcase classname="test/api/devices.spec.ts" name="Devices API &gt; deleteDevice &gt; should allow admin to delete any device" time="0.02">
        </testcase>
        <testcase classname="test/api/devices.spec.ts" name="Devices API &gt; deleteDevice &gt; should return 403 when user tries to delete another user&apos;s device" time="0.017">
        </testcase>
        <testcase classname="test/api/devices.spec.ts" name="Devices API &gt; deleteDevice &gt; should return 400 when pushToken is missing" time="0.014">
        </testcase>
        <testcase classname="test/api/devices.spec.ts" name="Devices API &gt; deleteDevice &gt; should return 404 when device not found" time="0.014">
        </testcase>
        <testcase classname="test/api/devices.spec.ts" name="Devices API &gt; deleteDevice &gt; should return 401 when authentication fails" time="0.01">
        </testcase>
        <testcase classname="test/api/devices.spec.ts" name="Devices API &gt; deleteDevice &gt; should handle database errors gracefully" time="0.009">
        </testcase>
        <testcase classname="test/api/devices.spec.ts" name="Devices API &gt; sendTestNotification &gt; should send test notification successfully" time="0.008">
        </testcase>
        <testcase classname="test/api/devices.spec.ts" name="Devices API &gt; sendTestNotification &gt; should use default message when not provided" time="0.006">
        </testcase>
        <testcase classname="test/api/devices.spec.ts" name="Devices API &gt; sendTestNotification &gt; should return 405 for non-POST requests" time="0.005">
        </testcase>
        <testcase classname="test/api/devices.spec.ts" name="Devices API &gt; sendTestNotification &gt; should return 400 when pushToken is missing" time="0.004">
        </testcase>
        <testcase classname="test/api/devices.spec.ts" name="Devices API &gt; sendTestNotification &gt; should return 404 when user not found" time="0.006">
        </testcase>
        <testcase classname="test/api/devices.spec.ts" name="Devices API &gt; sendTestNotification &gt; should return 404 when device not found" time="0.003">
        </testcase>
        <testcase classname="test/api/devices.spec.ts" name="Devices API &gt; sendTestNotification &gt; should return 500 when FCM notification fails" time="0.003">
        </testcase>
        <testcase classname="test/api/devices.spec.ts" name="Devices API &gt; sendTestNotification &gt; should return 401 when authentication fails" time="0.003">
        </testcase>
        <testcase classname="test/api/devices.spec.ts" name="Devices API &gt; sendTestNotification &gt; should handle invalid JSON body gracefully" time="0.003">
        </testcase>
        <testcase classname="test/api/devices.spec.ts" name="Devices API &gt; sendTestNotification &gt; should handle database errors gracefully" time="0.003">
        </testcase>
    </testsuite>
    <testsuite name="test/api/edge-cases.spec.ts" timestamp="2025-12-14T20:04:38.218Z" hostname="sngvahmed" tests="19" failures="0" errors="0" skipped="0" time="1.125">
        <testcase classname="test/api/edge-cases.spec.ts" name="Edge Cases and Error Scenarios &gt; Invalid Input Handling &gt; should handle empty symbol in getStock" time="0.045">
        </testcase>
        <testcase classname="test/api/edge-cases.spec.ts" name="Edge Cases and Error Scenarios &gt; Invalid Input Handling &gt; should handle invalid symbol format" time="0.977">
            <system-out>
{&quot;timestamp&quot;:&quot;2025-12-14T20:04:25.772Z&quot;,&quot;service&quot;:&quot;stockly-api-test&quot;,&quot;level&quot;:&quot;INFO&quot;,&quot;traceId&quot;:&quot;test-trace-id&quot;,&quot;userId&quot;:null,&quot;path&quot;:&quot;/test&quot;,&quot;message&quot;:&quot;No cache for !!!&quot;,&quot;type&quot;:&quot;general&quot;,&quot;cacheStatus&quot;:&quot;MISS&quot;}

{&quot;timestamp&quot;:&quot;2025-12-14T20:04:26.195Z&quot;,&quot;service&quot;:&quot;stockly-api-test&quot;,&quot;level&quot;:&quot;DEBUG&quot;,&quot;traceId&quot;:&quot;test-trace-id&quot;,&quot;userId&quot;:null,&quot;path&quot;:&quot;/test&quot;,&quot;message&quot;:&quot;FMP API: GET /quote&quot;,&quot;type&quot;:&quot;api_call&quot;,&quot;apiProvider&quot;:&quot;FMP&quot;,&quot;endpoint&quot;:&quot;/quote&quot;,&quot;method&quot;:&quot;GET&quot;,&quot;statusCode&quot;:200,&quot;latencyMs&quot;:421}

{&quot;timestamp&quot;:&quot;2025-12-14T20:04:26.290Z&quot;,&quot;service&quot;:&quot;stockly-api-test&quot;,&quot;level&quot;:&quot;DEBUG&quot;,&quot;traceId&quot;:&quot;test-trace-id&quot;,&quot;userId&quot;:null,&quot;path&quot;:&quot;/test&quot;,&quot;message&quot;:&quot;FMP API: GET /profile&quot;,&quot;type&quot;:&quot;api_call&quot;,&quot;apiProvider&quot;:&quot;FMP&quot;,&quot;endpoint&quot;:&quot;/profile&quot;,&quot;method&quot;:&quot;GET&quot;,&quot;statusCode&quot;:200,&quot;latencyMs&quot;:95}

{&quot;timestamp&quot;:&quot;2025-12-14T20:04:26.290Z&quot;,&quot;service&quot;:&quot;stockly-api-test&quot;,&quot;level&quot;:&quot;DEBUG&quot;,&quot;traceId&quot;:&quot;test-trace-id&quot;,&quot;userId&quot;:null,&quot;path&quot;:&quot;/test&quot;,&quot;message&quot;:&quot;Profile API response&quot;,&quot;type&quot;:&quot;general&quot;,&quot;endpoint&quot;:&quot;https://financialmodelingprep.com/stable/profile?symbol=!!!&amp;apikey=z5xjUUlsab7zBKntL5QnMzWyPuq2iWsM&quot;,&quot;responseType&quot;:&quot;array&quot;,&quot;responseLength&quot;:0}
{&quot;timestamp&quot;:&quot;2025-12-14T20:04:26.291Z&quot;,&quot;service&quot;:&quot;stockly-api-test&quot;,&quot;level&quot;:&quot;DEBUG&quot;,&quot;traceId&quot;:&quot;test-trace-id&quot;,&quot;userId&quot;:null,&quot;path&quot;:&quot;/test&quot;,&quot;message&quot;:&quot;Profile API returned empty array&quot;,&quot;type&quot;:&quot;general&quot;,&quot;endpoint&quot;:&quot;https://financialmodelingprep.com/stable/profile?symbol=!!!&amp;apikey=z5xjUUlsab7zBKntL5QnMzWyPuq2iWsM&quot;}

{&quot;timestamp&quot;:&quot;2025-12-14T20:04:26.408Z&quot;,&quot;service&quot;:&quot;stockly-api-test&quot;,&quot;level&quot;:&quot;DEBUG&quot;,&quot;traceId&quot;:&quot;test-trace-id&quot;,&quot;userId&quot;:null,&quot;path&quot;:&quot;/test&quot;,&quot;message&quot;:&quot;FMP API: GET /profile&quot;,&quot;type&quot;:&quot;api_call&quot;,&quot;apiProvider&quot;:&quot;FMP&quot;,&quot;endpoint&quot;:&quot;/profile&quot;,&quot;method&quot;:&quot;GET&quot;,&quot;statusCode&quot;:404,&quot;latencyMs&quot;:117}

{&quot;timestamp&quot;:&quot;2025-12-14T20:04:26.503Z&quot;,&quot;service&quot;:&quot;stockly-api-test&quot;,&quot;level&quot;:&quot;DEBUG&quot;,&quot;traceId&quot;:&quot;test-trace-id&quot;,&quot;userId&quot;:null,&quot;path&quot;:&quot;/test&quot;,&quot;message&quot;:&quot;FMP API: GET /profile&quot;,&quot;type&quot;:&quot;api_call&quot;,&quot;apiProvider&quot;:&quot;FMP&quot;,&quot;endpoint&quot;:&quot;/profile&quot;,&quot;method&quot;:&quot;GET&quot;,&quot;statusCode&quot;:404,&quot;latencyMs&quot;:94}

{&quot;timestamp&quot;:&quot;2025-12-14T20:04:26.598Z&quot;,&quot;service&quot;:&quot;stockly-api-test&quot;,&quot;level&quot;:&quot;DEBUG&quot;,&quot;traceId&quot;:&quot;test-trace-id&quot;,&quot;userId&quot;:null,&quot;path&quot;:&quot;/test&quot;,&quot;message&quot;:&quot;FMP API: GET /profile&quot;,&quot;type&quot;:&quot;api_call&quot;,&quot;apiProvider&quot;:&quot;FMP&quot;,&quot;endpoint&quot;:&quot;/profile&quot;,&quot;method&quot;:&quot;GET&quot;,&quot;statusCode&quot;:403,&quot;latencyMs&quot;:94}

{&quot;timestamp&quot;:&quot;2025-12-14T20:04:26.729Z&quot;,&quot;service&quot;:&quot;stockly-api-test&quot;,&quot;level&quot;:&quot;DEBUG&quot;,&quot;traceId&quot;:&quot;test-trace-id&quot;,&quot;userId&quot;:null,&quot;path&quot;:&quot;/test&quot;,&quot;message&quot;:&quot;Final description resolved&quot;,&quot;type&quot;:&quot;general&quot;,&quot;hasDescription&quot;:false,&quot;descriptionLength&quot;:0,&quot;source&quot;:&quot;none&quot;}

            </system-out>
            <system-err>
{&quot;timestamp&quot;:&quot;2025-12-14T20:04:26.409Z&quot;,&quot;service&quot;:&quot;stockly-api-test&quot;,&quot;level&quot;:&quot;WARN&quot;,&quot;traceId&quot;:&quot;test-trace-id&quot;,&quot;userId&quot;:null,&quot;path&quot;:&quot;/test&quot;,&quot;message&quot;:&quot;Profile API returned non-ok status&quot;,&quot;type&quot;:&quot;general&quot;,&quot;endpoint&quot;:&quot;https://financialmodelingprep.com/stable/profile/!!!?apikey=z5xjUUlsab7zBKntL5QnMzWyPuq2iWsM&quot;,&quot;statusCode&quot;:404,&quot;errorText&quot;:&quot;[]&quot;}

{&quot;timestamp&quot;:&quot;2025-12-14T20:04:26.504Z&quot;,&quot;service&quot;:&quot;stockly-api-test&quot;,&quot;level&quot;:&quot;WARN&quot;,&quot;traceId&quot;:&quot;test-trace-id&quot;,&quot;userId&quot;:null,&quot;path&quot;:&quot;/test&quot;,&quot;message&quot;:&quot;Profile API returned non-ok status&quot;,&quot;type&quot;:&quot;general&quot;,&quot;endpoint&quot;:&quot;https://financialmodelingprep.com/stable/company/profile/!!!?apikey=z5xjUUlsab7zBKntL5QnMzWyPuq2iWsM&quot;,&quot;statusCode&quot;:404,&quot;errorText&quot;:&quot;[]&quot;}

{&quot;timestamp&quot;:&quot;2025-12-14T20:04:26.598Z&quot;,&quot;service&quot;:&quot;stockly-api-test&quot;,&quot;level&quot;:&quot;WARN&quot;,&quot;traceId&quot;:&quot;test-trace-id&quot;,&quot;userId&quot;:null,&quot;path&quot;:&quot;/test&quot;,&quot;message&quot;:&quot;Profile API returned non-ok status&quot;,&quot;type&quot;:&quot;general&quot;,&quot;endpoint&quot;:&quot;https://financialmodelingprep.com/api/v3/profile/!!!?apikey=z5xjUUlsab7zBKntL5QnMzWyPuq2iWsM&quot;,&quot;statusCode&quot;:403,&quot;errorText&quot;:&quot;{\n  \&quot;Error Message\&quot;: \&quot;Legacy Endpoint : Due to Legacy endpoints being no longer supported - This endpoint is only available for legacy users who have valid subscriptions prior August 31, 2025. Please &quot;}

{&quot;timestamp&quot;:&quot;2025-12-14T20:04:26.729Z&quot;,&quot;service&quot;:&quot;stockly-api-test&quot;,&quot;level&quot;:&quot;ERROR&quot;,&quot;traceId&quot;:&quot;test-trace-id&quot;,&quot;userId&quot;:null,&quot;path&quot;:&quot;/test&quot;,&quot;message&quot;:&quot;ERROR in getStock&quot;,&quot;type&quot;:&quot;general&quot;,&quot;symbol&quot;:&quot;!!!&quot;,&quot;error&quot;:{&quot;name&quot;:&quot;TypeError&quot;,&quot;message&quot;:&quot;Cannot read properties of undefined (reading &apos;bind&apos;)&quot;,&quot;stack&quot;:&quot;TypeError: Cannot read properties of undefined (reading &apos;bind&apos;)\n    at Module.getStock (/home/sngvahmed/workspace/stockly/api/src/api/get-stock.ts:309:7)\n    at /home/sngvahmed/workspace/stockly/api/test/api/edge-cases.spec.ts:42:24\n    at home/sngvahmed/workspace/stockly/api/node_modules/@vitest/runner/dist/chunk-hooks.js:752:20&quot;}}
{&quot;timestamp&quot;:&quot;2025-12-14T20:04:26.732Z&quot;,&quot;service&quot;:&quot;stockly-api-test&quot;,&quot;level&quot;:&quot;ERROR&quot;,&quot;traceId&quot;:&quot;test-trace-id&quot;,&quot;userId&quot;:null,&quot;path&quot;:&quot;/test&quot;,&quot;message&quot;:&quot;Failed to fetch from DB during provider failure&quot;,&quot;type&quot;:&quot;general&quot;,&quot;error&quot;:{&quot;name&quot;:&quot;TypeError&quot;,&quot;message&quot;:&quot;Cannot read properties of undefined (reading &apos;bind&apos;)&quot;,&quot;stack&quot;:&quot;TypeError: Cannot read properties of undefined (reading &apos;bind&apos;)\n    at handleProviderFailure (/home/sngvahmed/workspace/stockly/api/src/api/get-stock.ts:373:7)\n    at Module.getStock (/home/sngvahmed/workspace/stockly/api/src/api/get-stock.ts:345:20)\n    at /home/sngvahmed/workspace/stockly/api/test/api/edge-cases.spec.ts:42:24\n    at home/sngvahmed/workspace/stockly/api/node_modules/@vitest/runner/dist/chunk-hooks.js:752:20&quot;}}

            </system-err>
        </testcase>
        <testcase classname="test/api/edge-cases.spec.ts" name="Edge Cases and Error Scenarios &gt; Invalid Input Handling &gt; should handle empty symbols array in getStocks" time="0.003">
        </testcase>
        <testcase classname="test/api/edge-cases.spec.ts" name="Edge Cases and Error Scenarios &gt; Invalid Input Handling &gt; should handle very long symbol list in getStocks" time="0.008">
            <system-err>
Failed to fetch profile from https://financialmodelingprep.com/stable/profile?symbol=AAPL&amp;apikey=z5xjUUlsab7zBKntL5QnMzWyPuq2iWsM: TypeError: Body has already been used. It can only be used once. Use tee() first if you need to read it twice.
    at fetchProfileFromApi (/home/sngvahmed/workspace/stockly/api/src/api/get-stocks.ts:101:46)
    at fetchQuoteFromApi (/home/sngvahmed/workspace/stockly/api/src/api/get-stocks.ts:187:36)
    at async Promise.allSettled (index 0)
    at fetchQuotesBatchFromApi (/home/sngvahmed/workspace/stockly/api/src/api/get-stocks.ts:216:24)
    at Module.getStocks (/home/sngvahmed/workspace/stockly/api/src/api/get-stocks.ts:304:25)
    at /home/sngvahmed/workspace/stockly/api/test/api/edge-cases.spec.ts:79:24
    at home/sngvahmed/workspace/stockly/api/node_modules/@vitest/runner/dist/chunk-hooks.js:752:20

Failed to fetch profile from https://financialmodelingprep.com/stable/profile/AAPL?apikey=z5xjUUlsab7zBKntL5QnMzWyPuq2iWsM: TypeError: Body has already been used. It can only be used once. Use tee() first if you need to read it twice.
    at fetchProfileFromApi (/home/sngvahmed/workspace/stockly/api/src/api/get-stocks.ts:101:46)
    at fetchQuoteFromApi (/home/sngvahmed/workspace/stockly/api/src/api/get-stocks.ts:187:36)
    at async Promise.allSettled (index 0)
    at fetchQuotesBatchFromApi (/home/sngvahmed/workspace/stockly/api/src/api/get-stocks.ts:216:24)
    at Module.getStocks (/home/sngvahmed/workspace/stockly/api/src/api/get-stocks.ts:304:25)
    at /home/sngvahmed/workspace/stockly/api/test/api/edge-cases.spec.ts:79:24
    at home/sngvahmed/workspace/stockly/api/node_modules/@vitest/runner/dist/chunk-hooks.js:752:20

Failed to fetch profile from https://financialmodelingprep.com/stable/company/profile/AAPL?apikey=z5xjUUlsab7zBKntL5QnMzWyPuq2iWsM: TypeError: Body has already been used. It can only be used once. Use tee() first if you need to read it twice.
    at fetchProfileFromApi (/home/sngvahmed/workspace/stockly/api/src/api/get-stocks.ts:101:46)
    at fetchQuoteFromApi (/home/sngvahmed/workspace/stockly/api/src/api/get-stocks.ts:187:36)
    at async Promise.allSettled (index 0)
    at fetchQuotesBatchFromApi (/home/sngvahmed/workspace/stockly/api/src/api/get-stocks.ts:216:24)
    at Module.getStocks (/home/sngvahmed/workspace/stockly/api/src/api/get-stocks.ts:304:25)
    at /home/sngvahmed/workspace/stockly/api/test/api/edge-cases.spec.ts:79:24
    at home/sngvahmed/workspace/stockly/api/node_modules/@vitest/runner/dist/chunk-hooks.js:752:20

Failed to fetch profile from https://financialmodelingprep.com/api/v3/profile/AAPL?apikey=z5xjUUlsab7zBKntL5QnMzWyPuq2iWsM: TypeError: Body has already been used. It can only be used once. Use tee() first if you need to read it twice.
    at fetchProfileFromApi (/home/sngvahmed/workspace/stockly/api/src/api/get-stocks.ts:101:46)
    at fetchQuoteFromApi (/home/sngvahmed/workspace/stockly/api/src/api/get-stocks.ts:187:36)
    at async Promise.allSettled (index 0)
    at fetchQuotesBatchFromApi (/home/sngvahmed/workspace/stockly/api/src/api/get-stocks.ts:216:24)
    at Module.getStocks (/home/sngvahmed/workspace/stockly/api/src/api/get-stocks.ts:304:25)
    at /home/sngvahmed/workspace/stockly/api/test/api/edge-cases.spec.ts:79:24
    at home/sngvahmed/workspace/stockly/api/node_modules/@vitest/runner/dist/chunk-hooks.js:752:20

Failed to fetch from Wikipedia: TypeError: Body has already been used. It can only be used once. Use tee() first if you need to read it twice.
    at fetchProfileFromApi (/home/sngvahmed/workspace/stockly/api/src/api/get-stocks.ts:155:40)
    at fetchQuoteFromApi (/home/sngvahmed/workspace/stockly/api/src/api/get-stocks.ts:187:36)
    at async Promise.allSettled (index 0)
    at fetchQuotesBatchFromApi (/home/sngvahmed/workspace/stockly/api/src/api/get-stocks.ts:216:24)
    at Module.getStocks (/home/sngvahmed/workspace/stockly/api/src/api/get-stocks.ts:304:25)
    at /home/sngvahmed/workspace/stockly/api/test/api/edge-cases.spec.ts:79:24
    at home/sngvahmed/workspace/stockly/api/node_modules/@vitest/runner/dist/chunk-hooks.js:752:20

            </system-err>
        </testcase>
        <testcase classname="test/api/edge-cases.spec.ts" name="Edge Cases and Error Scenarios &gt; Invalid Input Handling &gt; should handle empty search query" time="0.002">
        </testcase>
        <testcase classname="test/api/edge-cases.spec.ts" name="Edge Cases and Error Scenarios &gt; Invalid Input Handling &gt; should handle SQL injection attempts in search" time="0.005">
            <system-err>
Failed to read search cache TypeError: Cannot read properties of undefined (reading &apos;bind&apos;)
    at getDbCachedResults (/home/sngvahmed/workspace/stockly/api/src/api/search-stock.ts:24:7)
    at Module.searchStock (/home/sngvahmed/workspace/stockly/api/src/api/search-stock.ts:129:26)
    at /home/sngvahmed/workspace/stockly/api/test/api/edge-cases.spec.ts:100:30
    at home/sngvahmed/workspace/stockly/api/node_modules/@vitest/runner/dist/chunk-hooks.js:155:11
    at home/sngvahmed/workspace/stockly/api/node_modules/@vitest/runner/dist/chunk-hooks.js:752:26
    at home/sngvahmed/workspace/stockly/api/node_modules/@vitest/runner/dist/chunk-hooks.js:1897:20
    at new Promise (&lt;anonymous&gt;)
    at runWithTimeout (home/sngvahmed/workspace/stockly/api/node_modules/@vitest/runner/dist/chunk-hooks.js:1863:10)
    at runTest (home/sngvahmed/workspace/stockly/api/node_modules/@vitest/runner/dist/chunk-hooks.js:1574:12)
    at runSuite (home/sngvahmed/workspace/stockly/api/node_modules/@vitest/runner/dist/chunk-hooks.js:1729:8)

Failed to parse /search-name response: TypeError: Body has already been used. It can only be used once. Use tee() first if you need to read it twice.
    at Module.searchStock (/home/sngvahmed/workspace/stockly/api/src/api/search-stock.ts:158:40)
    at /home/sngvahmed/workspace/stockly/api/test/api/edge-cases.spec.ts:100:24
    at home/sngvahmed/workspace/stockly/api/node_modules/@vitest/runner/dist/chunk-hooks.js:752:20

Failed to parse /search-symbol response: TypeError: Body has already been used. It can only be used once. Use tee() first if you need to read it twice.
    at Module.searchStock (/home/sngvahmed/workspace/stockly/api/src/api/search-stock.ts:170:44)
    at /home/sngvahmed/workspace/stockly/api/test/api/edge-cases.spec.ts:100:24
    at home/sngvahmed/workspace/stockly/api/node_modules/@vitest/runner/dist/chunk-hooks.js:752:20

            </system-err>
        </testcase>
        <testcase classname="test/api/edge-cases.spec.ts" name="Edge Cases and Error Scenarios &gt; Database Error Handling &gt; should handle database connection errors gracefully" time="0.004">
            <system-out>
{&quot;timestamp&quot;:&quot;2025-12-14T20:04:26.756Z&quot;,&quot;service&quot;:&quot;stockly-api-test&quot;,&quot;level&quot;:&quot;INFO&quot;,&quot;traceId&quot;:&quot;test-trace-id&quot;,&quot;userId&quot;:null,&quot;path&quot;:&quot;/test&quot;,&quot;message&quot;:&quot;Cache hit for AAPL&quot;,&quot;type&quot;:&quot;general&quot;,&quot;ageSeconds&quot;:0,&quot;pollingIntervalSec&quot;:30,&quot;cacheStatus&quot;:&quot;HIT&quot;}

            </system-out>
        </testcase>
        <testcase classname="test/api/edge-cases.spec.ts" name="Edge Cases and Error Scenarios &gt; Database Error Handling &gt; should handle database timeout errors" time="0.004">
            <system-out>
{&quot;timestamp&quot;:&quot;2025-12-14T20:04:26.760Z&quot;,&quot;service&quot;:&quot;stockly-api-test&quot;,&quot;level&quot;:&quot;INFO&quot;,&quot;traceId&quot;:&quot;test-trace-id&quot;,&quot;userId&quot;:null,&quot;path&quot;:&quot;/test&quot;,&quot;message&quot;:&quot;Cache hit for AAPL&quot;,&quot;type&quot;:&quot;general&quot;,&quot;ageSeconds&quot;:0,&quot;pollingIntervalSec&quot;:30,&quot;cacheStatus&quot;:&quot;HIT&quot;}

            </system-out>
        </testcase>
        <testcase classname="test/api/edge-cases.spec.ts" name="Edge Cases and Error Scenarios &gt; External API Error Handling &gt; should handle external API rate limiting" time="0.003">
            <system-out>
{&quot;timestamp&quot;:&quot;2025-12-14T20:04:26.766Z&quot;,&quot;service&quot;:&quot;stockly-api-test&quot;,&quot;level&quot;:&quot;INFO&quot;,&quot;traceId&quot;:&quot;test-trace-id&quot;,&quot;userId&quot;:null,&quot;path&quot;:&quot;/test&quot;,&quot;message&quot;:&quot;Cache hit for AAPL&quot;,&quot;type&quot;:&quot;general&quot;,&quot;ageSeconds&quot;:0,&quot;pollingIntervalSec&quot;:30,&quot;cacheStatus&quot;:&quot;HIT&quot;}

            </system-out>
        </testcase>
        <testcase classname="test/api/edge-cases.spec.ts" name="Edge Cases and Error Scenarios &gt; External API Error Handling &gt; should handle external API timeout" time="0.003">
            <system-out>
{&quot;timestamp&quot;:&quot;2025-12-14T20:04:26.769Z&quot;,&quot;service&quot;:&quot;stockly-api-test&quot;,&quot;level&quot;:&quot;INFO&quot;,&quot;traceId&quot;:&quot;test-trace-id&quot;,&quot;userId&quot;:null,&quot;path&quot;:&quot;/test&quot;,&quot;message&quot;:&quot;Cache hit for AAPL&quot;,&quot;type&quot;:&quot;general&quot;,&quot;ageSeconds&quot;:0,&quot;pollingIntervalSec&quot;:30,&quot;cacheStatus&quot;:&quot;HIT&quot;}

            </system-out>
        </testcase>
        <testcase classname="test/api/edge-cases.spec.ts" name="Edge Cases and Error Scenarios &gt; External API Error Handling &gt; should handle external API returning invalid JSON" time="0.003">
            <system-out>
{&quot;timestamp&quot;:&quot;2025-12-14T20:04:26.772Z&quot;,&quot;service&quot;:&quot;stockly-api-test&quot;,&quot;level&quot;:&quot;INFO&quot;,&quot;traceId&quot;:&quot;test-trace-id&quot;,&quot;userId&quot;:null,&quot;path&quot;:&quot;/test&quot;,&quot;message&quot;:&quot;Cache hit for AAPL&quot;,&quot;type&quot;:&quot;general&quot;,&quot;ageSeconds&quot;:0,&quot;pollingIntervalSec&quot;:30,&quot;cacheStatus&quot;:&quot;HIT&quot;}

            </system-out>
        </testcase>
        <testcase classname="test/api/edge-cases.spec.ts" name="Edge Cases and Error Scenarios &gt; Authentication Edge Cases &gt; should handle expired access token" time="0.003">
        </testcase>
        <testcase classname="test/api/edge-cases.spec.ts" name="Edge Cases and Error Scenarios &gt; Authentication Edge Cases &gt; should handle malformed authorization header" time="0.002">
        </testcase>
        <testcase classname="test/api/edge-cases.spec.ts" name="Edge Cases and Error Scenarios &gt; Alert Edge Cases &gt; should handle negative threshold values" time="0.003">
        </testcase>
        <testcase classname="test/api/edge-cases.spec.ts" name="Edge Cases and Error Scenarios &gt; Alert Edge Cases &gt; should handle extremely large threshold values" time="0.002">
        </testcase>
        <testcase classname="test/api/edge-cases.spec.ts" name="Edge Cases and Error Scenarios &gt; Alert Edge Cases &gt; should handle missing required fields in alert creation" time="0.002">
        </testcase>
        <testcase classname="test/api/edge-cases.spec.ts" name="Edge Cases and Error Scenarios &gt; Boundary Conditions &gt; should handle maximum number of symbols in batch request" time="0.002">
        </testcase>
        <testcase classname="test/api/edge-cases.spec.ts" name="Edge Cases and Error Scenarios &gt; Boundary Conditions &gt; should handle very long search query" time="0.004">
            <system-err>
Failed to read search cache TypeError: Cannot read properties of undefined (reading &apos;bind&apos;)
    at getDbCachedResults (/home/sngvahmed/workspace/stockly/api/src/api/search-stock.ts:24:7)
    at Module.searchStock (/home/sngvahmed/workspace/stockly/api/src/api/search-stock.ts:129:26)
    at /home/sngvahmed/workspace/stockly/api/test/api/edge-cases.spec.ts:304:30
    at home/sngvahmed/workspace/stockly/api/node_modules/@vitest/runner/dist/chunk-hooks.js:155:11
    at home/sngvahmed/workspace/stockly/api/node_modules/@vitest/runner/dist/chunk-hooks.js:752:26
    at home/sngvahmed/workspace/stockly/api/node_modules/@vitest/runner/dist/chunk-hooks.js:1897:20
    at new Promise (&lt;anonymous&gt;)
    at runWithTimeout (home/sngvahmed/workspace/stockly/api/node_modules/@vitest/runner/dist/chunk-hooks.js:1863:10)
    at runTest (home/sngvahmed/workspace/stockly/api/node_modules/@vitest/runner/dist/chunk-hooks.js:1574:12)
    at runSuite (home/sngvahmed/workspace/stockly/api/node_modules/@vitest/runner/dist/chunk-hooks.js:1729:8)

Failed to parse /search-name response: Error: Invalid JSON
    at Object.json (/home/sngvahmed/workspace/stockly/api/test/api/edge-cases.spec.ts:198:17)
    at Module.searchStock (/home/sngvahmed/workspace/stockly/api/src/api/search-stock.ts:158:40)
    at /home/sngvahmed/workspace/stockly/api/test/api/edge-cases.spec.ts:304:24
    at home/sngvahmed/workspace/stockly/api/node_modules/@vitest/runner/dist/chunk-hooks.js:752:20

Failed to parse /search-symbol response: Error: Invalid JSON
    at Object.json (/home/sngvahmed/workspace/stockly/api/test/api/edge-cases.spec.ts:198:17)
    at Module.searchStock (/home/sngvahmed/workspace/stockly/api/src/api/search-stock.ts:170:44)
    at /home/sngvahmed/workspace/stockly/api/test/api/edge-cases.spec.ts:304:24
    at home/sngvahmed/workspace/stockly/api/node_modules/@vitest/runner/dist/chunk-hooks.js:752:20

            </system-err>
        </testcase>
        <testcase classname="test/api/edge-cases.spec.ts" name="Edge Cases and Error Scenarios &gt; Concurrent Request Handling &gt; should handle multiple simultaneous requests for same symbol" time="0.003">
            <system-out>
{&quot;timestamp&quot;:&quot;2025-12-14T20:04:26.800Z&quot;,&quot;service&quot;:&quot;stockly-api-test&quot;,&quot;level&quot;:&quot;INFO&quot;,&quot;traceId&quot;:&quot;test-trace-id&quot;,&quot;userId&quot;:null,&quot;path&quot;:&quot;/test&quot;,&quot;message&quot;:&quot;Cache hit for AAPL&quot;,&quot;type&quot;:&quot;general&quot;,&quot;ageSeconds&quot;:0,&quot;pollingIntervalSec&quot;:30,&quot;cacheStatus&quot;:&quot;HIT&quot;}
{&quot;timestamp&quot;:&quot;2025-12-14T20:04:26.800Z&quot;,&quot;service&quot;:&quot;stockly-api-test&quot;,&quot;level&quot;:&quot;INFO&quot;,&quot;traceId&quot;:&quot;test-trace-id&quot;,&quot;userId&quot;:null,&quot;path&quot;:&quot;/test&quot;,&quot;message&quot;:&quot;Cache hit for AAPL&quot;,&quot;type&quot;:&quot;general&quot;,&quot;ageSeconds&quot;:0,&quot;pollingIntervalSec&quot;:30,&quot;cacheStatus&quot;:&quot;HIT&quot;}
{&quot;timestamp&quot;:&quot;2025-12-14T20:04:26.800Z&quot;,&quot;service&quot;:&quot;stockly-api-test&quot;,&quot;level&quot;:&quot;INFO&quot;,&quot;traceId&quot;:&quot;test-trace-id&quot;,&quot;userId&quot;:null,&quot;path&quot;:&quot;/test&quot;,&quot;message&quot;:&quot;Cache hit for AAPL&quot;,&quot;type&quot;:&quot;general&quot;,&quot;ageSeconds&quot;:0,&quot;pollingIntervalSec&quot;:30,&quot;cacheStatus&quot;:&quot;HIT&quot;}
{&quot;timestamp&quot;:&quot;2025-12-14T20:04:26.800Z&quot;,&quot;service&quot;:&quot;stockly-api-test&quot;,&quot;level&quot;:&quot;INFO&quot;,&quot;traceId&quot;:&quot;test-trace-id&quot;,&quot;userId&quot;:null,&quot;path&quot;:&quot;/test&quot;,&quot;message&quot;:&quot;Cache hit for AAPL&quot;,&quot;type&quot;:&quot;general&quot;,&quot;ageSeconds&quot;:0,&quot;pollingIntervalSec&quot;:30,&quot;cacheStatus&quot;:&quot;HIT&quot;}
{&quot;timestamp&quot;:&quot;2025-12-14T20:04:26.800Z&quot;,&quot;service&quot;:&quot;stockly-api-test&quot;,&quot;level&quot;:&quot;INFO&quot;,&quot;traceId&quot;:&quot;test-trace-id&quot;,&quot;userId&quot;:null,&quot;path&quot;:&quot;/test&quot;,&quot;message&quot;:&quot;Cache hit for AAPL&quot;,&quot;type&quot;:&quot;general&quot;,&quot;ageSeconds&quot;:0,&quot;pollingIntervalSec&quot;:30,&quot;cacheStatus&quot;:&quot;HIT&quot;}
{&quot;timestamp&quot;:&quot;2025-12-14T20:04:26.800Z&quot;,&quot;service&quot;:&quot;stockly-api-test&quot;,&quot;level&quot;:&quot;INFO&quot;,&quot;traceId&quot;:&quot;test-trace-id&quot;,&quot;userId&quot;:null,&quot;path&quot;:&quot;/test&quot;,&quot;message&quot;:&quot;Cache hit for AAPL&quot;,&quot;type&quot;:&quot;general&quot;,&quot;ageSeconds&quot;:0,&quot;pollingIntervalSec&quot;:30,&quot;cacheStatus&quot;:&quot;HIT&quot;}
{&quot;timestamp&quot;:&quot;2025-12-14T20:04:26.800Z&quot;,&quot;service&quot;:&quot;stockly-api-test&quot;,&quot;level&quot;:&quot;INFO&quot;,&quot;traceId&quot;:&quot;test-trace-id&quot;,&quot;userId&quot;:null,&quot;path&quot;:&quot;/test&quot;,&quot;message&quot;:&quot;Cache hit for AAPL&quot;,&quot;type&quot;:&quot;general&quot;,&quot;ageSeconds&quot;:0,&quot;pollingIntervalSec&quot;:30,&quot;cacheStatus&quot;:&quot;HIT&quot;}
{&quot;timestamp&quot;:&quot;2025-12-14T20:04:26.800Z&quot;,&quot;service&quot;:&quot;stockly-api-test&quot;,&quot;level&quot;:&quot;INFO&quot;,&quot;traceId&quot;:&quot;test-trace-id&quot;,&quot;userId&quot;:null,&quot;path&quot;:&quot;/test&quot;,&quot;message&quot;:&quot;Cache hit for AAPL&quot;,&quot;type&quot;:&quot;general&quot;,&quot;ageSeconds&quot;:0,&quot;pollingIntervalSec&quot;:30,&quot;cacheStatus&quot;:&quot;HIT&quot;}
{&quot;timestamp&quot;:&quot;2025-12-14T20:04:26.800Z&quot;,&quot;service&quot;:&quot;stockly-api-test&quot;,&quot;level&quot;:&quot;INFO&quot;,&quot;traceId&quot;:&quot;test-trace-id&quot;,&quot;userId&quot;:null,&quot;path&quot;:&quot;/test&quot;,&quot;message&quot;:&quot;Cache hit for AAPL&quot;,&quot;type&quot;:&quot;general&quot;,&quot;ageSeconds&quot;:0,&quot;pollingIntervalSec&quot;:30,&quot;cacheStatus&quot;:&quot;HIT&quot;}
{&quot;timestamp&quot;:&quot;2025-12-14T20:04:26.800Z&quot;,&quot;service&quot;:&quot;stockly-api-test&quot;,&quot;level&quot;:&quot;INFO&quot;,&quot;traceId&quot;:&quot;test-trace-id&quot;,&quot;userId&quot;:null,&quot;path&quot;:&quot;/test&quot;,&quot;message&quot;:&quot;Cache hit for AAPL&quot;,&quot;type&quot;:&quot;general&quot;,&quot;ageSeconds&quot;:0,&quot;pollingIntervalSec&quot;:30,&quot;cacheStatus&quot;:&quot;HIT&quot;}

            </system-out>
        </testcase>
    </testsuite>
    <testsuite name="test/api/favorite-stocks.spec.ts" timestamp="2025-12-14T20:04:38.221Z" hostname="sngvahmed" tests="5" failures="0" errors="0" skipped="0" time="0.564">
        <testcase classname="test/api/favorite-stocks.spec.ts" name="Favorite Stocks API &gt; getFavoriteStocks &gt; should return favorite stocks for authenticated user" time="0.053">
            <system-out>
{&quot;timestamp&quot;:&quot;2025-12-14T20:04:25.270Z&quot;,&quot;service&quot;:&quot;stockly-api-test&quot;,&quot;level&quot;:&quot;INFO&quot;,&quot;traceId&quot;:&quot;test-trace-id&quot;,&quot;userId&quot;:null,&quot;path&quot;:&quot;/test&quot;,&quot;message&quot;:&quot;Fetched favorite stocks&quot;,&quot;type&quot;:&quot;general&quot;,&quot;username&quot;:&quot;testuser&quot;,&quot;count&quot;:2}

            </system-out>
        </testcase>
        <testcase classname="test/api/favorite-stocks.spec.ts" name="Favorite Stocks API &gt; getFavoriteStocks &gt; should return 401 for unauthenticated request" time="0.072">
        </testcase>
        <testcase classname="test/api/favorite-stocks.spec.ts" name="Favorite Stocks API &gt; updateFavoriteStocks &gt; should update favorite stocks for authenticated user" time="0.099">
            <system-out>
{&quot;timestamp&quot;:&quot;2025-12-14T20:04:25.484Z&quot;,&quot;service&quot;:&quot;stockly-api-test&quot;,&quot;level&quot;:&quot;DEBUG&quot;,&quot;traceId&quot;:&quot;test-trace-id&quot;,&quot;userId&quot;:&quot;user-123&quot;,&quot;path&quot;:&quot;/test&quot;,&quot;message&quot;:&quot;Received favorite stocks update request&quot;,&quot;type&quot;:&quot;general&quot;,&quot;bodyType&quot;:&quot;object&quot;,&quot;bodyStringified&quot;:&quot;{\&quot;symbols\&quot;:[\&quot;AAPL\&quot;,\&quot;GOOGL\&quot;]}&quot;,&quot;hasSymbols&quot;:true,&quot;bodyKeys&quot;:[&quot;symbols&quot;]}
{&quot;timestamp&quot;:&quot;2025-12-14T20:04:25.484Z&quot;,&quot;service&quot;:&quot;stockly-api-test&quot;,&quot;level&quot;:&quot;DEBUG&quot;,&quot;traceId&quot;:&quot;test-trace-id&quot;,&quot;userId&quot;:&quot;user-123&quot;,&quot;path&quot;:&quot;/test&quot;,&quot;message&quot;:&quot;Processing symbols array&quot;,&quot;type&quot;:&quot;general&quot;,&quot;symbolsArrayLength&quot;:2,&quot;symbolsArray&quot;:&quot;[\&quot;AAPL\&quot;,\&quot;GOOGL\&quot;]&quot;,&quot;symbolsArrayTypes&quot;:[&quot;string&quot;,&quot;string&quot;]}
{&quot;timestamp&quot;:&quot;2025-12-14T20:04:25.484Z&quot;,&quot;service&quot;:&quot;stockly-api-test&quot;,&quot;level&quot;:&quot;DEBUG&quot;,&quot;traceId&quot;:&quot;test-trace-id&quot;,&quot;userId&quot;:&quot;user-123&quot;,&quot;path&quot;:&quot;/test&quot;,&quot;message&quot;:&quot;Normalized symbols&quot;,&quot;type&quot;:&quot;general&quot;,&quot;originalCount&quot;:2,&quot;normalizedCount&quot;:2,&quot;uniqueCount&quot;:2,&quot;uniqueSymbols&quot;:[&quot;AAPL&quot;,&quot;GOOGL&quot;]}

{&quot;timestamp&quot;:&quot;2025-12-14T20:04:25.484Z&quot;,&quot;service&quot;:&quot;stockly-api-test&quot;,&quot;level&quot;:&quot;INFO&quot;,&quot;traceId&quot;:&quot;test-trace-id&quot;,&quot;userId&quot;:&quot;user-123&quot;,&quot;path&quot;:&quot;/test&quot;,&quot;message&quot;:&quot;Updated favorite stocks&quot;,&quot;type&quot;:&quot;general&quot;,&quot;username&quot;:&quot;testuser&quot;,&quot;count&quot;:2,&quot;symbols&quot;:[&quot;AAPL&quot;,&quot;GOOGL&quot;]}

            </system-out>
        </testcase>
        <testcase classname="test/api/favorite-stocks.spec.ts" name="Favorite Stocks API &gt; updateFavoriteStocks &gt; should validate symbols array" time="0.082">
            <system-err>
{&quot;timestamp&quot;:&quot;2025-12-14T20:04:25.545Z&quot;,&quot;service&quot;:&quot;stockly-api-test&quot;,&quot;level&quot;:&quot;ERROR&quot;,&quot;traceId&quot;:&quot;test-trace-id&quot;,&quot;userId&quot;:null,&quot;path&quot;:&quot;/test&quot;,&quot;message&quot;:&quot;Cannot read properties of undefined (reading &apos;bind&apos;)&quot;,&quot;type&quot;:&quot;general&quot;,&quot;username&quot;:&quot;testuser&quot;,&quot;name&quot;:&quot;TypeError&quot;,&quot;stack&quot;:&quot;TypeError: Cannot read properties of undefined (reading &apos;bind&apos;)\n    at Module.updateFavoriteStocks (/home/sngvahmed/workspace/stockly/api/src/api/favorite-stocks.ts:111:57)\n    at /home/sngvahmed/workspace/stockly/api/test/api/favorite-stocks.spec.ts:134:24\n    at home/sngvahmed/workspace/stockly/api/node_modules/@vitest/runner/dist/chunk-hooks.js:752:20&quot;,&quot;error&quot;:{&quot;name&quot;:&quot;TypeError&quot;,&quot;message&quot;:&quot;Cannot read properties of undefined (reading &apos;bind&apos;)&quot;,&quot;stack&quot;:&quot;TypeError: Cannot read properties of undefined (reading &apos;bind&apos;)\n    at Module.updateFavoriteStocks (/home/sngvahmed/workspace/stockly/api/src/api/favorite-stocks.ts:111:57)\n    at /home/sngvahmed/workspace/stockly/api/test/api/favorite-stocks.spec.ts:134:24\n    at home/sngvahmed/workspace/stockly/api/node_modules/@vitest/runner/dist/chunk-hooks.js:752:20&quot;}}
{&quot;timestamp&quot;:&quot;2025-12-14T20:04:25.545Z&quot;,&quot;service&quot;:&quot;stockly-api-test&quot;,&quot;level&quot;:&quot;ERROR&quot;,&quot;traceId&quot;:&quot;test-trace-id&quot;,&quot;userId&quot;:null,&quot;path&quot;:&quot;/test&quot;,&quot;message&quot;:&quot;Unexpected error in updateFavoriteStocks&quot;,&quot;type&quot;:&quot;general&quot;,&quot;error&quot;:&quot;[object Object]&quot;}

            </system-err>
        </testcase>
        <testcase classname="test/api/favorite-stocks.spec.ts" name="Favorite Stocks API &gt; deleteFavoriteStock &gt; should delete favorite stock for authenticated user" time="0.056">
            <system-out>
{&quot;timestamp&quot;:&quot;2025-12-14T20:04:25.687Z&quot;,&quot;service&quot;:&quot;stockly-api-test&quot;,&quot;level&quot;:&quot;INFO&quot;,&quot;traceId&quot;:&quot;test-trace-id&quot;,&quot;userId&quot;:null,&quot;path&quot;:&quot;/test&quot;,&quot;message&quot;:&quot;Deleted favorite stock&quot;,&quot;type&quot;:&quot;general&quot;,&quot;username&quot;:&quot;testuser&quot;,&quot;symbol&quot;:&quot;AAPL&quot;}

            </system-out>
        </testcase>
    </testsuite>
    <testsuite name="test/api/get-historical-intraday.spec.ts" timestamp="2025-12-14T20:04:38.222Z" hostname="sngvahmed" tests="19" failures="0" errors="0" skipped="0" time="0.933">
        <testcase classname="test/api/get-historical-intraday.spec.ts" name="getHistoricalIntraday handler &gt; Parameter validation &gt; requires a symbol parameter" time="0.047">
        </testcase>
        <testcase classname="test/api/get-historical-intraday.spec.ts" name="getHistoricalIntraday handler &gt; Parameter validation &gt; validates days parameter - must be between 1 and 30" time="0.074">
            <system-out>
[getHistoricalIntraday] Fetching 4h data for AAPL (2025-12-13 to 2025-12-14)
[fetch30MinuteData] Fetching 30-min data for AAPL from 2025-12-13 to 2025-12-14

[fetch30MinuteData] Received 0 30-minute candles

[getHistoricalIntraday] Fetching 4h data for AAPL (2025-11-29 to 2025-12-14)
[fetch30MinuteData] Fetching 30-min data for AAPL from 2025-11-29 to 2025-12-14

[fetch30MinuteData] Received 0 30-minute candles

[getHistoricalIntraday] Fetching 4h data for AAPL (2025-11-14 to 2025-12-14)
[fetch30MinuteData] Fetching 30-min data for AAPL from 2025-11-14 to 2025-12-14

[fetch30MinuteData] Received 0 30-minute candles

            </system-out>
            <system-err>
[getHistoricalIntraday] No 30-minute data available for AAPL

[getHistoricalIntraday] No 30-minute data available for AAPL

[getHistoricalIntraday] No 30-minute data available for AAPL

            </system-err>
        </testcase>
        <testcase classname="test/api/get-historical-intraday.spec.ts" name="getHistoricalIntraday handler &gt; Parameter validation &gt; validates interval format" time="0.066">
            <system-out>
[getHistoricalIntraday] Fetching 4h data for AAPL (2025-12-11 to 2025-12-14)
[fetch30MinuteData] Fetching 30-min data for AAPL from 2025-12-11 to 2025-12-14

[fetch30MinuteData] Received 0 30-minute candles

[getHistoricalIntraday] Fetching 1h data for AAPL (2025-12-11 to 2025-12-14)
[fetch30MinuteData] Fetching 30-min data for AAPL from 2025-12-11 to 2025-12-14

[fetch30MinuteData] Received 0 30-minute candles

[getHistoricalIntraday] Fetching 4h data for AAPL (2025-12-11 to 2025-12-14)
[fetch30MinuteData] Fetching 30-min data for AAPL from 2025-12-11 to 2025-12-14

[fetch30MinuteData] Received 0 30-minute candles

[getHistoricalIntraday] Fetching 30m data for AAPL (2025-12-11 to 2025-12-14)
[fetch30MinuteData] Fetching 30-min data for AAPL from 2025-12-11 to 2025-12-14

[fetch30MinuteData] Received 0 30-minute candles

[getHistoricalIntraday] Fetching 15m data for AAPL (2025-12-11 to 2025-12-14)
[fetch30MinuteData] Fetching 30-min data for AAPL from 2025-12-11 to 2025-12-14

[fetch30MinuteData] Received 0 30-minute candles

[getHistoricalIntraday] Fetching 2h data for AAPL (2025-12-11 to 2025-12-14)
[fetch30MinuteData] Fetching 30-min data for AAPL from 2025-12-11 to 2025-12-14

[fetch30MinuteData] Received 0 30-minute candles

            </system-out>
            <system-err>
[getHistoricalIntraday] No 30-minute data available for AAPL

[getHistoricalIntraday] No 30-minute data available for AAPL

[getHistoricalIntraday] No 30-minute data available for AAPL

[getHistoricalIntraday] No 30-minute data available for AAPL

[getHistoricalIntraday] No 30-minute data available for AAPL

[getHistoricalIntraday] No 30-minute data available for AAPL

            </system-err>
        </testcase>
        <testcase classname="test/api/get-historical-intraday.spec.ts" name="getHistoricalIntraday handler &gt; Parameter validation &gt; uses default interval (4h) when not provided" time="0.304">
            <system-out>
[getHistoricalIntraday] Fetching 4h data for AAPL (2025-12-11 to 2025-12-14)
[fetch30MinuteData] Fetching 30-min data for AAPL from 2025-12-11 to 2025-12-14

[fetch30MinuteData] Received 0 30-minute candles

            </system-out>
            <system-err>
[getHistoricalIntraday] No 30-minute data available for AAPL

            </system-err>
        </testcase>
        <testcase classname="test/api/get-historical-intraday.spec.ts" name="getHistoricalIntraday handler &gt; Parameter validation &gt; uses default days (3) when not provided" time="0.035">
            <system-out>
[getHistoricalIntraday] Fetching 4h data for AAPL (2025-12-11 to 2025-12-14)
[fetch30MinuteData] Fetching 30-min data for AAPL from 2025-12-11 to 2025-12-14

[fetch30MinuteData] Received 0 30-minute candles

            </system-out>
            <system-err>
[getHistoricalIntraday] No 30-minute data available for AAPL

            </system-err>
        </testcase>
        <testcase classname="test/api/get-historical-intraday.spec.ts" name="getHistoricalIntraday handler &gt; Parameter validation &gt; normalizes symbol to uppercase" time="0.035">
            <system-out>
[getHistoricalIntraday] Fetching 4h data for AAPL (2025-12-11 to 2025-12-14)
[fetch30MinuteData] Fetching 30-min data for AAPL from 2025-12-11 to 2025-12-14

[fetch30MinuteData] Received 0 30-minute candles

            </system-out>
            <system-err>
[getHistoricalIntraday] No 30-minute data available for AAPL

            </system-err>
        </testcase>
        <testcase classname="test/api/get-historical-intraday.spec.ts" name="getHistoricalIntraday handler &gt; Date range calculation &gt; calculates correct date range based on days parameter" time="0.025">
            <system-out>
[getHistoricalIntraday] Fetching 4h data for AAPL (2025-12-09 to 2025-12-14)
[fetch30MinuteData] Fetching 30-min data for AAPL from 2025-12-09 to 2025-12-14

[fetch30MinuteData] Received 10 30-minute candles

[getHistoricalIntraday] Aggregated 10 30-min candles into 2 4h candles

            </system-out>
        </testcase>
        <testcase classname="test/api/get-historical-intraday.spec.ts" name="getHistoricalIntraday handler &gt; FMP API integration &gt; calls FMP API with correct parameters" time="0.032">
            <system-out>
[getHistoricalIntraday] Fetching 4h data for AAPL (2025-12-11 to 2025-12-14)
[fetch30MinuteData] Fetching 30-min data for AAPL from 2025-12-11 to 2025-12-14

[fetch30MinuteData] Received 10 30-minute candles

[getHistoricalIntraday] Aggregated 10 30-min candles into 2 4h candles

            </system-out>
        </testcase>
        <testcase classname="test/api/get-historical-intraday.spec.ts" name="getHistoricalIntraday handler &gt; FMP API integration &gt; handles FMP API errors gracefully" time="0.033">
            <system-out>
[getHistoricalIntraday] Fetching 4h data for INVALID (2025-12-11 to 2025-12-14)
[fetch30MinuteData] Fetching 30-min data for INVALID from 2025-12-11 to 2025-12-14

            </system-out>
            <system-err>
[fetch30MinuteData] FMP API error: Invalid symbol

[getHistoricalIntraday] Error: FMP API error: Invalid symbol Error: FMP API error: Invalid symbol
    at fetch30MinuteData (/home/sngvahmed/workspace/stockly/api/src/api/get-historical-intraday.ts:182:19)
    at getHistoricalIntraday (/home/sngvahmed/workspace/stockly/api/src/api/get-historical-intraday.ts:252:31)
    at /home/sngvahmed/workspace/stockly/api/test/api/get-historical-intraday.spec.ts:281:24
    at home/sngvahmed/workspace/stockly/api/node_modules/@vitest/runner/dist/chunk-hooks.js:752:20

            </system-err>
        </testcase>
        <testcase classname="test/api/get-historical-intraday.spec.ts" name="getHistoricalIntraday handler &gt; FMP API integration &gt; handles HTTP errors from FMP API" time="0.021">
            <system-out>
[getHistoricalIntraday] Fetching 4h data for AAPL (2025-12-11 to 2025-12-14)
[fetch30MinuteData] Fetching 30-min data for AAPL from 2025-12-11 to 2025-12-14

            </system-out>
            <system-err>
[fetch30MinuteData] HTTP 500: Internal Server Error

[getHistoricalIntraday] Error: Failed to fetch 30-minute data: HTTP 500 Error: Failed to fetch 30-minute data: HTTP 500
    at fetch30MinuteData (/home/sngvahmed/workspace/stockly/api/src/api/get-historical-intraday.ts:171:15)
    at getHistoricalIntraday (/home/sngvahmed/workspace/stockly/api/src/api/get-historical-intraday.ts:252:31)
    at /home/sngvahmed/workspace/stockly/api/test/api/get-historical-intraday.spec.ts:300:24
    at home/sngvahmed/workspace/stockly/api/node_modules/@vitest/runner/dist/chunk-hooks.js:752:20

            </system-err>
        </testcase>
        <testcase classname="test/api/get-historical-intraday.spec.ts" name="getHistoricalIntraday handler &gt; FMP API integration &gt; handles empty data response" time="0.02">
            <system-out>
[getHistoricalIntraday] Fetching 4h data for AAPL (2025-12-11 to 2025-12-14)
[fetch30MinuteData] Fetching 30-min data for AAPL from 2025-12-11 to 2025-12-14

[fetch30MinuteData] Received 0 30-minute candles

            </system-out>
            <system-err>
[getHistoricalIntraday] No 30-minute data available for AAPL

            </system-err>
        </testcase>
        <testcase classname="test/api/get-historical-intraday.spec.ts" name="getHistoricalIntraday handler &gt; FMP API integration &gt; filters out invalid records from API response" time="0.021">
            <system-out>
[getHistoricalIntraday] Fetching 1h data for AAPL (2025-12-11 to 2025-12-14)
[fetch30MinuteData] Fetching 30-min data for AAPL from 2025-12-11 to 2025-12-14

[fetch30MinuteData] Received 4 30-minute candles

[getHistoricalIntraday] Aggregated 2 30-min candles into 2 1h candles

            </system-out>
        </testcase>
        <testcase classname="test/api/get-historical-intraday.spec.ts" name="getHistoricalIntraday handler &gt; OHLC aggregation &gt; aggregates 30-minute data to 1-hour intervals" time="0.017">
            <system-out>
[getHistoricalIntraday] Fetching 1h data for AAPL (2025-12-13 to 2025-12-14)
[fetch30MinuteData] Fetching 30-min data for AAPL from 2025-12-13 to 2025-12-14

[fetch30MinuteData] Received 4 30-minute candles

[getHistoricalIntraday] Aggregated 4 30-min candles into 2 1h candles

            </system-out>
        </testcase>
        <testcase classname="test/api/get-historical-intraday.spec.ts" name="getHistoricalIntraday handler &gt; OHLC aggregation &gt; aggregates 30-minute data to 4-hour intervals" time="0.015">
            <system-out>
[getHistoricalIntraday] Fetching 4h data for AAPL (2025-12-13 to 2025-12-14)
[fetch30MinuteData] Fetching 30-min data for AAPL from 2025-12-13 to 2025-12-14

[fetch30MinuteData] Received 8 30-minute candles

[getHistoricalIntraday] Aggregated 8 30-min candles into 1 4h candles

            </system-out>
        </testcase>
        <testcase classname="test/api/get-historical-intraday.spec.ts" name="getHistoricalIntraday handler &gt; OHLC aggregation &gt; correctly calculates OHLC values during aggregation" time="0.014">
            <system-out>
[getHistoricalIntraday] Fetching 1h data for AAPL (2025-12-13 to 2025-12-14)
[fetch30MinuteData] Fetching 30-min data for AAPL from 2025-12-13 to 2025-12-14

[fetch30MinuteData] Received 4 30-minute candles

[getHistoricalIntraday] Aggregated 4 30-min candles into 2 1h candles

            </system-out>
        </testcase>
        <testcase classname="test/api/get-historical-intraday.spec.ts" name="getHistoricalIntraday handler &gt; Response format &gt; returns correct JSON structure on success" time="0.009">
            <system-out>
[getHistoricalIntraday] Fetching 4h data for AAPL (2025-12-11 to 2025-12-14)
[fetch30MinuteData] Fetching 30-min data for AAPL from 2025-12-11 to 2025-12-14

[fetch30MinuteData] Received 10 30-minute candles

[getHistoricalIntraday] Aggregated 10 30-min candles into 2 4h candles

            </system-out>
        </testcase>
        <testcase classname="test/api/get-historical-intraday.spec.ts" name="getHistoricalIntraday handler &gt; Response format &gt; returns correct structure on empty data" time="0.013">
            <system-out>
[getHistoricalIntraday] Fetching 4h data for AAPL (2025-12-11 to 2025-12-14)
[fetch30MinuteData] Fetching 30-min data for AAPL from 2025-12-11 to 2025-12-14

[fetch30MinuteData] Received 0 30-minute candles

            </system-out>
            <system-err>
[getHistoricalIntraday] No 30-minute data available for AAPL

            </system-err>
        </testcase>
        <testcase classname="test/api/get-historical-intraday.spec.ts" name="getHistoricalIntraday handler &gt; Error handling &gt; handles network errors" time="0.006">
            <system-out>
[getHistoricalIntraday] Fetching 4h data for AAPL (2025-12-11 to 2025-12-14)
[fetch30MinuteData] Fetching 30-min data for AAPL from 2025-12-11 to 2025-12-14

            </system-out>
            <system-err>
[getHistoricalIntraday] Error: Network error Error: Network error
    at /home/sngvahmed/workspace/stockly/api/test/api/get-historical-intraday.spec.ts:525:9
    at home/sngvahmed/workspace/stockly/api/node_modules/@vitest/runner/dist/chunk-hooks.js:155:11
    at home/sngvahmed/workspace/stockly/api/node_modules/@vitest/runner/dist/chunk-hooks.js:752:26
    at home/sngvahmed/workspace/stockly/api/node_modules/@vitest/runner/dist/chunk-hooks.js:1897:20
    at new Promise (&lt;anonymous&gt;)
    at runWithTimeout (home/sngvahmed/workspace/stockly/api/node_modules/@vitest/runner/dist/chunk-hooks.js:1863:10)
    at runTest (home/sngvahmed/workspace/stockly/api/node_modules/@vitest/runner/dist/chunk-hooks.js:1574:12)
    at runSuite (home/sngvahmed/workspace/stockly/api/node_modules/@vitest/runner/dist/chunk-hooks.js:1729:8)
    at runSuite (home/sngvahmed/workspace/stockly/api/node_modules/@vitest/runner/dist/chunk-hooks.js:1729:8)
    at runSuite (home/sngvahmed/workspace/stockly/api/node_modules/@vitest/runner/dist/chunk-hooks.js:1729:8)

            </system-err>
        </testcase>
        <testcase classname="test/api/get-historical-intraday.spec.ts" name="getHistoricalIntraday handler &gt; Error handling &gt; handles invalid JSON response" time="0.005">
            <system-out>
[getHistoricalIntraday] Fetching 4h data for AAPL (2025-12-11 to 2025-12-14)
[fetch30MinuteData] Fetching 30-min data for AAPL from 2025-12-11 to 2025-12-14

            </system-out>
            <system-err>
[getHistoricalIntraday] Error: Unexpected token &apos;I&apos;, &quot;Invalid JSON&quot; is not valid JSON SyntaxError: Unexpected token &apos;I&apos;, &quot;Invalid JSON&quot; is not valid JSON
    at fetch30MinuteData (/home/sngvahmed/workspace/stockly/api/src/api/get-historical-intraday.ts:174:18)
    at getHistoricalIntraday (/home/sngvahmed/workspace/stockly/api/src/api/get-historical-intraday.ts:252:31)
    at /home/sngvahmed/workspace/stockly/api/test/api/get-historical-intraday.spec.ts:549:24
    at home/sngvahmed/workspace/stockly/api/node_modules/@vitest/runner/dist/chunk-hooks.js:752:20

            </system-err>
        </testcase>
    </testsuite>
    <testsuite name="test/api/get-news.spec.ts" timestamp="2025-12-14T20:04:38.227Z" hostname="sngvahmed" tests="4" failures="0" errors="0" skipped="0" time="0.451">
        <testcase classname="test/api/get-news.spec.ts" name="Get News API &gt; getNews &gt; should return news articles" time="0.053">
            <system-out>
News cache miss for AAPL, fetching from API...

            </system-out>
        </testcase>
        <testcase classname="test/api/get-news.spec.ts" name="Get News API &gt; getNews &gt; should handle pagination correctly" time="0.089">
            <system-out>
News cache miss for AAPL, fetching from API...

            </system-out>
        </testcase>
        <testcase classname="test/api/get-news.spec.ts" name="Get News API &gt; getNews &gt; should handle external API errors gracefully" time="0.09">
            <system-out>
News cache miss for AAPL, fetching from API...

            </system-out>
            <system-err>
Failed to fetch news from FMP API for symbols AAPL: Error: FMP API failed: HTTP 500
    at fetchNewsFromApi (/home/sngvahmed/workspace/stockly/api/src/api/get-news.ts:68:13)
    at Module.getNews (/home/sngvahmed/workspace/stockly/api/src/api/get-news.ts:293:22)
    at /home/sngvahmed/workspace/stockly/api/test/api/get-news.spec.ts:86:24
    at home/sngvahmed/workspace/stockly/api/node_modules/@vitest/runner/dist/chunk-hooks.js:752:20

Error fetching news for AAPL: Error: FMP API failed: HTTP 500
    at fetchNewsFromApi (/home/sngvahmed/workspace/stockly/api/src/api/get-news.ts:68:13)
    at Module.getNews (/home/sngvahmed/workspace/stockly/api/src/api/get-news.ts:293:22)
    at /home/sngvahmed/workspace/stockly/api/test/api/get-news.spec.ts:86:24
    at home/sngvahmed/workspace/stockly/api/node_modules/@vitest/runner/dist/chunk-hooks.js:752:20

            </system-err>
        </testcase>
        <testcase classname="test/api/get-news.spec.ts" name="Get News API &gt; getFavoriteNews &gt; should return favorite news for authenticated user" time="0.058">
            <system-out>
{&quot;timestamp&quot;:&quot;2025-12-14T20:04:25.682Z&quot;,&quot;service&quot;:&quot;stockly-api-test&quot;,&quot;level&quot;:&quot;INFO&quot;,&quot;traceId&quot;:&quot;test-trace-id&quot;,&quot;userId&quot;:null,&quot;path&quot;:&quot;/test&quot;,&quot;message&quot;:&quot;Fetching favorite news&quot;,&quot;type&quot;:&quot;general&quot;,&quot;username&quot;:&quot;testuser&quot;}

{&quot;timestamp&quot;:&quot;2025-12-14T20:04:25.683Z&quot;,&quot;service&quot;:&quot;stockly-api-test&quot;,&quot;level&quot;:&quot;INFO&quot;,&quot;traceId&quot;:&quot;test-trace-id&quot;,&quot;userId&quot;:null,&quot;path&quot;:&quot;/test&quot;,&quot;message&quot;:&quot;No favorite symbols selected&quot;,&quot;type&quot;:&quot;general&quot;,&quot;username&quot;:&quot;testuser&quot;}

            </system-out>
        </testcase>
    </testsuite>
    <testsuite name="test/api/news-archive.spec.ts" timestamp="2025-12-14T20:04:38.229Z" hostname="sngvahmed" tests="4" failures="0" errors="0" skipped="0" time="0.422">
        <testcase classname="test/api/news-archive.spec.ts" name="News Archive API &gt; getArchivedNews &gt; should return archived news for authenticated user" time="0.042">
            <system-out>
{&quot;timestamp&quot;:&quot;2025-12-14T20:04:25.239Z&quot;,&quot;service&quot;:&quot;stockly-api-test&quot;,&quot;level&quot;:&quot;INFO&quot;,&quot;traceId&quot;:&quot;test-trace-id&quot;,&quot;userId&quot;:&quot;user-123&quot;,&quot;path&quot;:&quot;/test&quot;,&quot;message&quot;:&quot;Fetching archived news&quot;,&quot;type&quot;:&quot;general&quot;,&quot;username&quot;:&quot;testuser&quot;,&quot;page&quot;:1,&quot;limit&quot;:10}

{&quot;timestamp&quot;:&quot;2025-12-14T20:04:25.240Z&quot;,&quot;service&quot;:&quot;stockly-api-test&quot;,&quot;level&quot;:&quot;INFO&quot;,&quot;traceId&quot;:&quot;test-trace-id&quot;,&quot;userId&quot;:&quot;user-123&quot;,&quot;path&quot;:&quot;/test&quot;,&quot;message&quot;:&quot;Archived news fetched successfully&quot;,&quot;type&quot;:&quot;general&quot;,&quot;username&quot;:&quot;testuser&quot;,&quot;page&quot;:1,&quot;limit&quot;:10,&quot;total&quot;:10,&quot;returned&quot;:1,&quot;hasMore&quot;:false}

            </system-out>
        </testcase>
        <testcase classname="test/api/news-archive.spec.ts" name="News Archive API &gt; getArchivedNews &gt; should handle pagination correctly" time="0.046">
            <system-out>
{&quot;timestamp&quot;:&quot;2025-12-14T20:04:25.280Z&quot;,&quot;service&quot;:&quot;stockly-api-test&quot;,&quot;level&quot;:&quot;INFO&quot;,&quot;traceId&quot;:&quot;test-trace-id&quot;,&quot;userId&quot;:&quot;user-123&quot;,&quot;path&quot;:&quot;/test&quot;,&quot;message&quot;:&quot;Fetching archived news&quot;,&quot;type&quot;:&quot;general&quot;,&quot;username&quot;:&quot;testuser&quot;,&quot;page&quot;:2,&quot;limit&quot;:10}

{&quot;timestamp&quot;:&quot;2025-12-14T20:04:25.280Z&quot;,&quot;service&quot;:&quot;stockly-api-test&quot;,&quot;level&quot;:&quot;INFO&quot;,&quot;traceId&quot;:&quot;test-trace-id&quot;,&quot;userId&quot;:&quot;user-123&quot;,&quot;path&quot;:&quot;/test&quot;,&quot;message&quot;:&quot;Archived news fetched successfully&quot;,&quot;type&quot;:&quot;general&quot;,&quot;username&quot;:&quot;testuser&quot;,&quot;page&quot;:2,&quot;limit&quot;:10,&quot;total&quot;:25,&quot;returned&quot;:0,&quot;hasMore&quot;:true}

            </system-out>
        </testcase>
        <testcase classname="test/api/news-archive.spec.ts" name="News Archive API &gt; toggleArchivedNews &gt; should save article to archive" time="0.051">
            <system-out>
{&quot;timestamp&quot;:&quot;2025-12-14T20:04:25.401Z&quot;,&quot;service&quot;:&quot;stockly-api-test&quot;,&quot;level&quot;:&quot;INFO&quot;,&quot;traceId&quot;:&quot;test-trace-id&quot;,&quot;userId&quot;:null,&quot;path&quot;:&quot;/test&quot;,&quot;message&quot;:&quot;Article saved successfully&quot;,&quot;type&quot;:&quot;general&quot;,&quot;username&quot;:&quot;testuser&quot;,&quot;articleId&quot;:&quot;article-123&quot;,&quot;symbol&quot;:&quot;AAPL&quot;}

            </system-out>
        </testcase>
        <testcase classname="test/api/news-archive.spec.ts" name="News Archive API &gt; toggleArchivedNews &gt; should remove article from archive if already saved" time="0.067">
            <system-out>
{&quot;timestamp&quot;:&quot;2025-12-14T20:04:25.465Z&quot;,&quot;service&quot;:&quot;stockly-api-test&quot;,&quot;level&quot;:&quot;INFO&quot;,&quot;traceId&quot;:&quot;test-trace-id&quot;,&quot;userId&quot;:null,&quot;path&quot;:&quot;/test&quot;,&quot;message&quot;:&quot;Article unsaved successfully&quot;,&quot;type&quot;:&quot;general&quot;,&quot;username&quot;:&quot;testuser&quot;,&quot;articleId&quot;:&quot;article-123&quot;}

            </system-out>
        </testcase>
    </testsuite>
    <testsuite name="test/api/preferences.spec.ts" timestamp="2025-12-14T20:04:38.230Z" hostname="sngvahmed" tests="5" failures="0" errors="0" skipped="0" time="0.46">
        <testcase classname="test/api/preferences.spec.ts" name="Preferences API &gt; getPreferences &gt; should return preferences for authenticated user" time="0.05">
        </testcase>
        <testcase classname="test/api/preferences.spec.ts" name="Preferences API &gt; getPreferences &gt; should return default preferences if none exist" time="0.051">
        </testcase>
        <testcase classname="test/api/preferences.spec.ts" name="Preferences API &gt; updatePreferences &gt; should update preferences for authenticated user" time="0.063">
        </testcase>
        <testcase classname="test/api/preferences.spec.ts" name="Preferences API &gt; updatePreferences &gt; should create preferences if they don&apos;t exist" time="0.056">
        </testcase>
        <testcase classname="test/api/preferences.spec.ts" name="Preferences API &gt; updatePreferences &gt; should validate quiet hours format" time="0.054">
        </testcase>
    </testsuite>
    <testsuite name="test/api/push-token.spec.ts" timestamp="2025-12-14T20:04:38.230Z" hostname="sngvahmed" tests="5" failures="0" errors="0" skipped="0" time="0.502">
        <testcase classname="test/api/push-token.spec.ts" name="Push Token API &gt; registerPushToken &gt; should register new push token" time="0.052">
            <system-out>
✅ FCM token validation passed: length=30, format valid

{&quot;timestamp&quot;:&quot;2025-12-14T20:04:25.279Z&quot;,&quot;service&quot;:&quot;stockly-api-test&quot;,&quot;level&quot;:&quot;INFO&quot;,&quot;traceId&quot;:&quot;test-trace-id&quot;,&quot;userId&quot;:&quot;user-123&quot;,&quot;path&quot;:&quot;/test&quot;,&quot;message&quot;:&quot;Registering new push token&quot;,&quot;type&quot;:&quot;general&quot;,&quot;username&quot;:&quot;testuser&quot;,&quot;deviceType&quot;:&quot;android&quot;,&quot;tokenPreview&quot;:&quot;fcm-token-1234567890...&quot;}

{&quot;timestamp&quot;:&quot;2025-12-14T20:04:25.279Z&quot;,&quot;service&quot;:&quot;stockly-api-test&quot;,&quot;level&quot;:&quot;INFO&quot;,&quot;traceId&quot;:&quot;test-trace-id&quot;,&quot;userId&quot;:&quot;user-123&quot;,&quot;path&quot;:&quot;/test&quot;,&quot;message&quot;:&quot;Push token registered successfully&quot;,&quot;type&quot;:&quot;general&quot;,&quot;username&quot;:&quot;testuser&quot;,&quot;deviceType&quot;:&quot;android&quot;,&quot;deviceId&quot;:&quot;fcm-token-1234567890...&quot;}

            </system-out>
        </testcase>
        <testcase classname="test/api/push-token.spec.ts" name="Push Token API &gt; registerPushToken &gt; should update existing push token" time="0.078">
            <system-out>
✅ FCM token validation passed: length=30, format valid

{&quot;timestamp&quot;:&quot;2025-12-14T20:04:25.330Z&quot;,&quot;service&quot;:&quot;stockly-api-test&quot;,&quot;level&quot;:&quot;INFO&quot;,&quot;traceId&quot;:&quot;test-trace-id&quot;,&quot;userId&quot;:&quot;user-123&quot;,&quot;path&quot;:&quot;/test&quot;,&quot;message&quot;:&quot;Updating existing push token&quot;,&quot;type&quot;:&quot;general&quot;,&quot;username&quot;:&quot;testuser&quot;,&quot;deviceType&quot;:&quot;android&quot;}

{&quot;timestamp&quot;:&quot;2025-12-14T20:04:25.330Z&quot;,&quot;service&quot;:&quot;stockly-api-test&quot;,&quot;level&quot;:&quot;INFO&quot;,&quot;traceId&quot;:&quot;test-trace-id&quot;,&quot;userId&quot;:&quot;user-123&quot;,&quot;path&quot;:&quot;/test&quot;,&quot;message&quot;:&quot;Push token updated successfully&quot;,&quot;type&quot;:&quot;general&quot;,&quot;username&quot;:&quot;testuser&quot;,&quot;deviceType&quot;:&quot;android&quot;}

            </system-out>
        </testcase>
        <testcase classname="test/api/push-token.spec.ts" name="Push Token API &gt; registerPushToken &gt; should reassign token to new user if different user" time="0.06">
            <system-out>
✅ FCM token validation passed: length=30, format valid

{&quot;timestamp&quot;:&quot;2025-12-14T20:04:25.406Z&quot;,&quot;service&quot;:&quot;stockly-api-test&quot;,&quot;level&quot;:&quot;INFO&quot;,&quot;traceId&quot;:&quot;test-trace-id&quot;,&quot;userId&quot;:&quot;user-123&quot;,&quot;path&quot;:&quot;/test&quot;,&quot;message&quot;:&quot;Reassigning push token to different user&quot;,&quot;type&quot;:&quot;general&quot;,&quot;username&quot;:&quot;testuser&quot;,&quot;previousUserId&quot;:&quot;user-456&quot;,&quot;deviceType&quot;:&quot;android&quot;}

{&quot;timestamp&quot;:&quot;2025-12-14T20:04:25.406Z&quot;,&quot;service&quot;:&quot;stockly-api-test&quot;,&quot;level&quot;:&quot;INFO&quot;,&quot;traceId&quot;:&quot;test-trace-id&quot;,&quot;userId&quot;:&quot;user-123&quot;,&quot;path&quot;:&quot;/test&quot;,&quot;message&quot;:&quot;Push token reassigned successfully&quot;,&quot;type&quot;:&quot;general&quot;,&quot;username&quot;:&quot;testuser&quot;,&quot;deviceType&quot;:&quot;android&quot;}

            </system-out>
        </testcase>
        <testcase classname="test/api/push-token.spec.ts" name="Push Token API &gt; registerPushToken &gt; should validate token format" time="0.09">
        </testcase>
        <testcase classname="test/api/push-token.spec.ts" name="Push Token API &gt; getPushToken &gt; should return push tokens for authenticated user" time="0.069">
        </testcase>
    </testsuite>
    <testsuite name="test/api/settings.spec.ts" timestamp="2025-12-14T20:04:38.231Z" hostname="sngvahmed" tests="4" failures="0" errors="0" skipped="0" time="0.446">
        <testcase classname="test/api/settings.spec.ts" name="Settings API &gt; getSettings &gt; should return settings for authenticated user" time="0.049">
        </testcase>
        <testcase classname="test/api/settings.spec.ts" name="Settings API &gt; getSettings &gt; should return default settings if none exist" time="0.079">
        </testcase>
        <testcase classname="test/api/settings.spec.ts" name="Settings API &gt; updateSettings &gt; should update settings for authenticated user" time="0.052">
        </testcase>
        <testcase classname="test/api/settings.spec.ts" name="Settings API &gt; updateSettings &gt; should create settings if they don&apos;t exist" time="0.075">
        </testcase>
    </testsuite>
    <testsuite name="test/api/throttle-cache.spec.ts" timestamp="2025-12-14T20:04:38.232Z" hostname="sngvahmed" tests="21" failures="0" errors="0" skipped="0" time="1.144">
        <testcase classname="test/api/throttle-cache.spec.ts" name="Throttle Cache &gt; isThrottled &gt; should return false if key is not throttled" time="0.035">
        </testcase>
        <testcase classname="test/api/throttle-cache.spec.ts" name="Throttle Cache &gt; isThrottled &gt; should return true if key was recently throttled" time="0.033">
        </testcase>
        <testcase classname="test/api/throttle-cache.spec.ts" name="Throttle Cache &gt; isThrottled &gt; should return false if throttle window has expired" time="0.062">
        </testcase>
        <testcase classname="test/api/throttle-cache.spec.ts" name="Throttle Cache &gt; isThrottled &gt; should return true if within throttle window" time="0.033">
        </testcase>
        <testcase classname="test/api/throttle-cache.spec.ts" name="Throttle Cache &gt; isThrottled &gt; should handle multiple keys independently" time="0.049">
        </testcase>
        <testcase classname="test/api/throttle-cache.spec.ts" name="Throttle Cache &gt; markThrottled &gt; should mark a key as throttled" time="0.025">
        </testcase>
        <testcase classname="test/api/throttle-cache.spec.ts" name="Throttle Cache &gt; markThrottled &gt; should update throttle timestamp when called again" time="0.056">
        </testcase>
        <testcase classname="test/api/throttle-cache.spec.ts" name="Throttle Cache &gt; markThrottled &gt; should handle empty string key" time="0.031">
        </testcase>
        <testcase classname="test/api/throttle-cache.spec.ts" name="Throttle Cache &gt; markThrottled &gt; should handle special characters in key" time="0.029">
        </testcase>
        <testcase classname="test/api/throttle-cache.spec.ts" name="Throttle Cache &gt; clearThrottle &gt; should clear throttle for a key" time="0.027">
        </testcase>
        <testcase classname="test/api/throttle-cache.spec.ts" name="Throttle Cache &gt; clearThrottle &gt; should not throw if clearing non-existent key" time="0.027">
        </testcase>
        <testcase classname="test/api/throttle-cache.spec.ts" name="Throttle Cache &gt; clearThrottle &gt; should clear one key without affecting others" time="0.053">
        </testcase>
        <testcase classname="test/api/throttle-cache.spec.ts" name="Throttle Cache &gt; getThrottleCacheStats &gt; should return cache statistics" time="0.022">
        </testcase>
        <testcase classname="test/api/throttle-cache.spec.ts" name="Throttle Cache &gt; getThrottleCacheStats &gt; should reflect correct number of cached keys" time="0.026">
        </testcase>
        <testcase classname="test/api/throttle-cache.spec.ts" name="Throttle Cache &gt; getThrottleCacheStats &gt; should handle empty cache" time="0.044">
        </testcase>
        <testcase classname="test/api/throttle-cache.spec.ts" name="Throttle Cache &gt; getThrottleCacheStats &gt; should increase count when marking multiple unique keys" time="0.02">
        </testcase>
        <testcase classname="test/api/throttle-cache.spec.ts" name="Throttle Cache &gt; Throttle window (5 minutes) &gt; should throttle for approximately 5 minutes" time="0.035">
        </testcase>
        <testcase classname="test/api/throttle-cache.spec.ts" name="Throttle Cache &gt; Throttle window (5 minutes) &gt; should use seconds precision (not milliseconds)" time="0.033">
        </testcase>
        <testcase classname="test/api/throttle-cache.spec.ts" name="Throttle Cache &gt; Edge cases &gt; should handle very long keys" time="0.073">
        </testcase>
        <testcase classname="test/api/throttle-cache.spec.ts" name="Throttle Cache &gt; Edge cases &gt; should handle unicode keys" time="0.047">
        </testcase>
        <testcase classname="test/api/throttle-cache.spec.ts" name="Throttle Cache &gt; Edge cases &gt; should handle concurrent marks and clears" time="0.073">
        </testcase>
    </testsuite>
    <testsuite name="test/api/user-preferences.spec.ts" timestamp="2025-12-14T20:04:38.234Z" hostname="sngvahmed" tests="3" failures="0" errors="0" skipped="0" time="0.322">
        <testcase classname="test/api/user-preferences.spec.ts" name="User Preferences API &gt; updateUserPreferences &gt; should update news favorite symbols" time="0.049">
        </testcase>
        <testcase classname="test/api/user-preferences.spec.ts" name="User Preferences API &gt; updateUserPreferences &gt; should create settings if they don&apos;t exist" time="0.05">
        </testcase>
        <testcase classname="test/api/user-preferences.spec.ts" name="User Preferences API &gt; updateUserPreferences &gt; should validate symbols array" time="0.068">
            <system-err>
{&quot;timestamp&quot;:&quot;2025-12-14T20:04:25.385Z&quot;,&quot;service&quot;:&quot;stockly-api-test&quot;,&quot;level&quot;:&quot;ERROR&quot;,&quot;traceId&quot;:&quot;test-trace-id&quot;,&quot;path&quot;:&quot;/test&quot;,&quot;message&quot;:&quot;Failed to update user preferences&quot;,&quot;type&quot;:&quot;general&quot;,&quot;username&quot;:&quot;testuser&quot;,&quot;error&quot;:{&quot;name&quot;:&quot;TypeError&quot;,&quot;message&quot;:&quot;Cannot read properties of undefined (reading &apos;bind&apos;)&quot;,&quot;stack&quot;:&quot;TypeError: Cannot read properties of undefined (reading &apos;bind&apos;)\n    at Module.updateUserPreferences (/home/sngvahmed/workspace/stockly/api/src/api/user-preferences.ts:36:63)\n    at /home/sngvahmed/workspace/stockly/api/test/api/user-preferences.spec.ts:136:24\n    at home/sngvahmed/workspace/stockly/api/node_modules/@vitest/runner/dist/chunk-hooks.js:752:20&quot;}}

            </system-err>
        </testcase>
    </testsuite>
    <testsuite name="test/contract/openapi-validation.spec.ts" timestamp="2025-12-14T20:04:38.235Z" hostname="sngvahmed" tests="6" failures="0" errors="0" skipped="0" time="0.473">
        <testcase classname="test/contract/openapi-validation.spec.ts" name="OpenAPI Contract Validation &gt; Schema Validation &gt; should validate get-stock response matches OpenAPI schema" time="0.027">
        </testcase>
        <testcase classname="test/contract/openapi-validation.spec.ts" name="OpenAPI Contract Validation &gt; Schema Validation &gt; should validate get-stocks response matches OpenAPI schema" time="0.027">
        </testcase>
        <testcase classname="test/contract/openapi-validation.spec.ts" name="OpenAPI Contract Validation &gt; Schema Validation &gt; should validate error responses match OpenAPI schema" time="0.024">
        </testcase>
        <testcase classname="test/contract/openapi-validation.spec.ts" name="OpenAPI Contract Validation &gt; Endpoint Coverage &gt; should have all endpoints documented in OpenAPI spec" time="0.031">
        </testcase>
        <testcase classname="test/contract/openapi-validation.spec.ts" name="OpenAPI Contract Validation &gt; Request/Response Validation &gt; should validate request parameters match OpenAPI spec" time="0.073">
        </testcase>
        <testcase classname="test/contract/openapi-validation.spec.ts" name="OpenAPI Contract Validation &gt; Request/Response Validation &gt; should validate response structure matches OpenAPI spec" time="0.051">
        </testcase>
    </testsuite>
    <testsuite name="test/cron/alerts-cron.spec.ts" timestamp="2025-12-14T20:04:38.236Z" hostname="sngvahmed" tests="15" failures="0" errors="0" skipped="0" time="0.951">
        <testcase classname="test/cron/alerts-cron.spec.ts" name="Alert Cron Job &gt; runAlertCron &gt; should skip cron if alertsKv is not configured" time="0.023">
            <system-err>
{&quot;timestamp&quot;:&quot;2025-12-14T20:04:25.059Z&quot;,&quot;service&quot;:&quot;stockly-api&quot;,&quot;level&quot;:&quot;WARN&quot;,&quot;traceId&quot;:&quot;cron-1765742665059&quot;,&quot;userId&quot;:null,&quot;path&quot;:&quot;/cron/alerts&quot;,&quot;message&quot;:&quot;Alerts KV is not configured; skipping cron&quot;,&quot;type&quot;:&quot;general&quot;}

            </system-err>
        </testcase>
        <testcase classname="test/cron/alerts-cron.spec.ts" name="Alert Cron Job &gt; runAlertCron &gt; should skip cron if no active alerts found" time="0.03">
            <system-out>
{&quot;timestamp&quot;:&quot;2025-12-14T20:04:25.084Z&quot;,&quot;service&quot;:&quot;stockly-api&quot;,&quot;level&quot;:&quot;INFO&quot;,&quot;traceId&quot;:&quot;cron-1765742665084&quot;,&quot;userId&quot;:null,&quot;path&quot;:&quot;/cron/alerts&quot;,&quot;message&quot;:&quot;Starting alert evaluation cron job&quot;,&quot;type&quot;:&quot;general&quot;}

{&quot;timestamp&quot;:&quot;2025-12-14T20:04:25.084Z&quot;,&quot;service&quot;:&quot;stockly-api&quot;,&quot;level&quot;:&quot;INFO&quot;,&quot;traceId&quot;:&quot;cron-1765742665084&quot;,&quot;userId&quot;:null,&quot;path&quot;:&quot;/cron/alerts&quot;,&quot;message&quot;:&quot;No active alerts found&quot;,&quot;type&quot;:&quot;general&quot;}

            </system-out>
        </testcase>
        <testcase classname="test/cron/alerts-cron.spec.ts" name="Alert Cron Job &gt; runAlertCron &gt; should process alerts and send notifications" time="0.025">
            <system-out>
{&quot;timestamp&quot;:&quot;2025-12-14T20:04:25.111Z&quot;,&quot;service&quot;:&quot;stockly-api&quot;,&quot;level&quot;:&quot;INFO&quot;,&quot;traceId&quot;:&quot;cron-1765742665111&quot;,&quot;userId&quot;:null,&quot;path&quot;:&quot;/cron/alerts&quot;,&quot;message&quot;:&quot;Starting alert evaluation cron job&quot;,&quot;type&quot;:&quot;general&quot;}

{&quot;timestamp&quot;:&quot;2025-12-14T20:04:25.111Z&quot;,&quot;service&quot;:&quot;stockly-api&quot;,&quot;level&quot;:&quot;INFO&quot;,&quot;traceId&quot;:&quot;cron-1765742665111&quot;,&quot;userId&quot;:null,&quot;path&quot;:&quot;/cron/alerts&quot;,&quot;message&quot;:&quot;Processing 1 active alerts&quot;,&quot;type&quot;:&quot;general&quot;}
{&quot;timestamp&quot;:&quot;2025-12-14T20:04:25.111Z&quot;,&quot;service&quot;:&quot;stockly-api&quot;,&quot;level&quot;:&quot;DEBUG&quot;,&quot;traceId&quot;:&quot;cron-1765742665111&quot;,&quot;userId&quot;:null,&quot;path&quot;:&quot;/cron/alerts&quot;,&quot;message&quot;:&quot;Fetching prices for 1 unique symbols&quot;,&quot;type&quot;:&quot;general&quot;,&quot;symbols&quot;:[&quot;AAPL&quot;]}

{&quot;timestamp&quot;:&quot;2025-12-14T20:04:25.112Z&quot;,&quot;service&quot;:&quot;stockly-api&quot;,&quot;level&quot;:&quot;INFO&quot;,&quot;traceId&quot;:&quot;cron-1765742665111&quot;,&quot;userId&quot;:null,&quot;path&quot;:&quot;/cron/alerts&quot;,&quot;message&quot;:&quot;Successfully fetched prices for 1 symbols&quot;,&quot;type&quot;:&quot;general&quot;}

{&quot;timestamp&quot;:&quot;2025-12-14T20:04:25.112Z&quot;,&quot;service&quot;:&quot;stockly-api&quot;,&quot;level&quot;:&quot;INFO&quot;,&quot;traceId&quot;:&quot;cron-1765742665111&quot;,&quot;userId&quot;:null,&quot;path&quot;:&quot;/cron/alerts&quot;,&quot;message&quot;:&quot;Evaluated 1 alerts, 1 triggered&quot;,&quot;type&quot;:&quot;general&quot;}
{&quot;timestamp&quot;:&quot;2025-12-14T20:04:25.112Z&quot;,&quot;service&quot;:&quot;stockly-api&quot;,&quot;level&quot;:&quot;INFO&quot;,&quot;traceId&quot;:&quot;cron-1765742665111&quot;,&quot;userId&quot;:null,&quot;path&quot;:&quot;/cron/alerts&quot;,&quot;message&quot;:&quot;Alert triggered&quot;,&quot;type&quot;:&quot;general&quot;,&quot;alertId&quot;:&quot;alert-1&quot;,&quot;symbol&quot;:&quot;AAPL&quot;,&quot;price&quot;:205,&quot;direction&quot;:&quot;above&quot;,&quot;threshold&quot;:200,&quot;channel&quot;:&quot;notification&quot;}

{&quot;timestamp&quot;:&quot;2025-12-14T20:04:25.112Z&quot;,&quot;service&quot;:&quot;stockly-api&quot;,&quot;level&quot;:&quot;INFO&quot;,&quot;traceId&quot;:&quot;cron-1765742665111&quot;,&quot;userId&quot;:null,&quot;path&quot;:&quot;/cron/alerts&quot;,&quot;message&quot;:&quot;FCM notification sent successfully&quot;,&quot;type&quot;:&quot;general&quot;,&quot;alertId&quot;:&quot;alert-1&quot;,&quot;symbol&quot;:&quot;AAPL&quot;,&quot;pushToken&quot;:&quot;fcm-token-123&quot;}

{&quot;timestamp&quot;:&quot;2025-12-14T20:04:25.113Z&quot;,&quot;service&quot;:&quot;stockly-api&quot;,&quot;level&quot;:&quot;INFO&quot;,&quot;traceId&quot;:&quot;cron-1765742665111&quot;,&quot;userId&quot;:null,&quot;path&quot;:&quot;/cron/alerts&quot;,&quot;message&quot;:&quot;Alert notification sent to all user devices&quot;,&quot;type&quot;:&quot;general&quot;,&quot;alertId&quot;:&quot;alert-1&quot;,&quot;symbol&quot;:&quot;AAPL&quot;,&quot;username&quot;:&quot;testuser&quot;,&quot;devicesCount&quot;:1,&quot;successCount&quot;:1,&quot;failCount&quot;:0}
{&quot;timestamp&quot;:&quot;2025-12-14T20:04:25.113Z&quot;,&quot;service&quot;:&quot;stockly-api&quot;,&quot;level&quot;:&quot;INFO&quot;,&quot;traceId&quot;:&quot;cron-1765742665111&quot;,&quot;userId&quot;:null,&quot;path&quot;:&quot;/cron/alerts&quot;,&quot;message&quot;:&quot;Alert cron job completed successfully&quot;,&quot;type&quot;:&quot;general&quot;,&quot;alertsProcessed&quot;:1,&quot;notificationsSent&quot;:1}

            </system-out>
        </testcase>
        <testcase classname="test/cron/alerts-cron.spec.ts" name="Alert Cron Job &gt; runAlertCron &gt; should handle fetch price failures gracefully" time="0.1">
            <system-out>
{&quot;timestamp&quot;:&quot;2025-12-14T20:04:25.203Z&quot;,&quot;service&quot;:&quot;stockly-api&quot;,&quot;level&quot;:&quot;INFO&quot;,&quot;traceId&quot;:&quot;cron-1765742665203&quot;,&quot;userId&quot;:null,&quot;path&quot;:&quot;/cron/alerts&quot;,&quot;message&quot;:&quot;Starting alert evaluation cron job&quot;,&quot;type&quot;:&quot;general&quot;}

{&quot;timestamp&quot;:&quot;2025-12-14T20:04:25.203Z&quot;,&quot;service&quot;:&quot;stockly-api&quot;,&quot;level&quot;:&quot;INFO&quot;,&quot;traceId&quot;:&quot;cron-1765742665203&quot;,&quot;userId&quot;:null,&quot;path&quot;:&quot;/cron/alerts&quot;,&quot;message&quot;:&quot;Processing 1 active alerts&quot;,&quot;type&quot;:&quot;general&quot;}
{&quot;timestamp&quot;:&quot;2025-12-14T20:04:25.203Z&quot;,&quot;service&quot;:&quot;stockly-api&quot;,&quot;level&quot;:&quot;DEBUG&quot;,&quot;traceId&quot;:&quot;cron-1765742665203&quot;,&quot;userId&quot;:null,&quot;path&quot;:&quot;/cron/alerts&quot;,&quot;message&quot;:&quot;Fetching prices for 1 unique symbols&quot;,&quot;type&quot;:&quot;general&quot;,&quot;symbols&quot;:[&quot;AAPL&quot;]}

            </system-out>
            <system-err>
{&quot;timestamp&quot;:&quot;2025-12-14T20:04:25.204Z&quot;,&quot;service&quot;:&quot;stockly-api&quot;,&quot;level&quot;:&quot;ERROR&quot;,&quot;traceId&quot;:&quot;cron-1765742665203&quot;,&quot;userId&quot;:null,&quot;path&quot;:&quot;/cron/alerts&quot;,&quot;message&quot;:&quot;Failed to fetch quote for alert&quot;,&quot;type&quot;:&quot;general&quot;,&quot;symbol&quot;:&quot;AAPL&quot;,&quot;error&quot;:{&quot;name&quot;:&quot;Error&quot;,&quot;message&quot;:&quot;Network error&quot;,&quot;stack&quot;:&quot;Error: Network error\n    at /home/sngvahmed/workspace/stockly/api/test/cron/alerts-cron.spec.ts:199:49\n    at home/sngvahmed/workspace/stockly/api/node_modules/@vitest/runner/dist/chunk-hooks.js:155:11\n    at home/sngvahmed/workspace/stockly/api/node_modules/@vitest/runner/dist/chunk-hooks.js:752:26\n    at home/sngvahmed/workspace/stockly/api/node_modules/@vitest/runner/dist/chunk-hooks.js:1897:20\n    at new Promise (&lt;anonymous&gt;)\n    at runWithTimeout (home/sngvahmed/workspace/stockly/api/node_modules/@vitest/runner/dist/chunk-hooks.js:1863:10)\n    at runTest (home/sngvahmed/workspace/stockly/api/node_modules/@vitest/runner/dist/chunk-hooks.js:1574:12)\n    at runSuite (home/sngvahmed/workspace/stockly/api/node_modules/@vitest/runner/dist/chunk-hooks.js:1729:8)\n    at runSuite (home/sngvahmed/workspace/stockly/api/node_modules/@vitest/runner/dist/chunk-hooks.js:1729:8)\n    at runSuite (home/sngvahmed/workspace/stockly/api/node_modules/@vitest/runner/dist/chunk-hooks.js:1729:8)&quot;}}

{&quot;timestamp&quot;:&quot;2025-12-14T20:04:25.207Z&quot;,&quot;service&quot;:&quot;stockly-api&quot;,&quot;level&quot;:&quot;WARN&quot;,&quot;traceId&quot;:&quot;cron-1765742665203&quot;,&quot;userId&quot;:null,&quot;path&quot;:&quot;/cron/alerts&quot;,&quot;message&quot;:&quot;No prices available for alerts run&quot;,&quot;type&quot;:&quot;general&quot;,&quot;symbols&quot;:[&quot;AAPL&quot;]}

            </system-err>
        </testcase>
        <testcase classname="test/cron/alerts-cron.spec.ts" name="Alert Cron Job &gt; runAlertCron &gt; should skip alert with old Expo token" time="0.097">
            <system-out>
{&quot;timestamp&quot;:&quot;2025-12-14T20:04:25.290Z&quot;,&quot;service&quot;:&quot;stockly-api&quot;,&quot;level&quot;:&quot;INFO&quot;,&quot;traceId&quot;:&quot;cron-1765742665290&quot;,&quot;userId&quot;:null,&quot;path&quot;:&quot;/cron/alerts&quot;,&quot;message&quot;:&quot;Starting alert evaluation cron job&quot;,&quot;type&quot;:&quot;general&quot;}

{&quot;timestamp&quot;:&quot;2025-12-14T20:04:25.290Z&quot;,&quot;service&quot;:&quot;stockly-api&quot;,&quot;level&quot;:&quot;INFO&quot;,&quot;traceId&quot;:&quot;cron-1765742665290&quot;,&quot;userId&quot;:null,&quot;path&quot;:&quot;/cron/alerts&quot;,&quot;message&quot;:&quot;Processing 1 active alerts&quot;,&quot;type&quot;:&quot;general&quot;}
{&quot;timestamp&quot;:&quot;2025-12-14T20:04:25.291Z&quot;,&quot;service&quot;:&quot;stockly-api&quot;,&quot;level&quot;:&quot;DEBUG&quot;,&quot;traceId&quot;:&quot;cron-1765742665290&quot;,&quot;userId&quot;:null,&quot;path&quot;:&quot;/cron/alerts&quot;,&quot;message&quot;:&quot;Fetching prices for 1 unique symbols&quot;,&quot;type&quot;:&quot;general&quot;,&quot;symbols&quot;:[&quot;AAPL&quot;]}

{&quot;timestamp&quot;:&quot;2025-12-14T20:04:25.291Z&quot;,&quot;service&quot;:&quot;stockly-api&quot;,&quot;level&quot;:&quot;INFO&quot;,&quot;traceId&quot;:&quot;cron-1765742665290&quot;,&quot;userId&quot;:null,&quot;path&quot;:&quot;/cron/alerts&quot;,&quot;message&quot;:&quot;Successfully fetched prices for 1 symbols&quot;,&quot;type&quot;:&quot;general&quot;}

{&quot;timestamp&quot;:&quot;2025-12-14T20:04:25.291Z&quot;,&quot;service&quot;:&quot;stockly-api&quot;,&quot;level&quot;:&quot;INFO&quot;,&quot;traceId&quot;:&quot;cron-1765742665290&quot;,&quot;userId&quot;:null,&quot;path&quot;:&quot;/cron/alerts&quot;,&quot;message&quot;:&quot;Evaluated 1 alerts, 1 triggered&quot;,&quot;type&quot;:&quot;general&quot;}
{&quot;timestamp&quot;:&quot;2025-12-14T20:04:25.291Z&quot;,&quot;service&quot;:&quot;stockly-api&quot;,&quot;level&quot;:&quot;INFO&quot;,&quot;traceId&quot;:&quot;cron-1765742665290&quot;,&quot;userId&quot;:null,&quot;path&quot;:&quot;/cron/alerts&quot;,&quot;message&quot;:&quot;Alert triggered&quot;,&quot;type&quot;:&quot;general&quot;,&quot;alertId&quot;:&quot;alert-1&quot;,&quot;symbol&quot;:&quot;AAPL&quot;,&quot;price&quot;:205,&quot;direction&quot;:&quot;above&quot;,&quot;threshold&quot;:200,&quot;channel&quot;:&quot;notification&quot;}

{&quot;timestamp&quot;:&quot;2025-12-14T20:04:25.291Z&quot;,&quot;service&quot;:&quot;stockly-api&quot;,&quot;level&quot;:&quot;INFO&quot;,&quot;traceId&quot;:&quot;cron-1765742665290&quot;,&quot;userId&quot;:null,&quot;path&quot;:&quot;/cron/alerts&quot;,&quot;message&quot;:&quot;Alert notification sent to all user devices&quot;,&quot;type&quot;:&quot;general&quot;,&quot;alertId&quot;:&quot;alert-1&quot;,&quot;symbol&quot;:&quot;AAPL&quot;,&quot;username&quot;:&quot;testuser&quot;,&quot;devicesCount&quot;:1,&quot;successCount&quot;:0,&quot;failCount&quot;:1}
{&quot;timestamp&quot;:&quot;2025-12-14T20:04:25.291Z&quot;,&quot;service&quot;:&quot;stockly-api&quot;,&quot;level&quot;:&quot;INFO&quot;,&quot;traceId&quot;:&quot;cron-1765742665290&quot;,&quot;userId&quot;:null,&quot;path&quot;:&quot;/cron/alerts&quot;,&quot;message&quot;:&quot;Alert cron job completed successfully&quot;,&quot;type&quot;:&quot;general&quot;,&quot;alertsProcessed&quot;:1,&quot;notificationsSent&quot;:1}

            </system-out>
            <system-err>
{&quot;timestamp&quot;:&quot;2025-12-14T20:04:25.291Z&quot;,&quot;service&quot;:&quot;stockly-api&quot;,&quot;level&quot;:&quot;WARN&quot;,&quot;traceId&quot;:&quot;cron-1765742665290&quot;,&quot;userId&quot;:null,&quot;path&quot;:&quot;/cron/alerts&quot;,&quot;message&quot;:&quot;Skipping alert with old Expo token - FCM migration required&quot;,&quot;type&quot;:&quot;general&quot;,&quot;alertId&quot;:&quot;alert-1&quot;,&quot;symbol&quot;:&quot;AAPL&quot;,&quot;pushToken&quot;:&quot;ExponentPushToken[123]&quot;}

            </system-err>
        </testcase>
        <testcase classname="test/cron/alerts-cron.spec.ts" name="Alert Cron Job &gt; runAlertCron &gt; should log failed FCM notifications" time="0.104">
            <system-out>
{&quot;timestamp&quot;:&quot;2025-12-14T20:04:25.338Z&quot;,&quot;service&quot;:&quot;stockly-api&quot;,&quot;level&quot;:&quot;INFO&quot;,&quot;traceId&quot;:&quot;cron-1765742665338&quot;,&quot;userId&quot;:null,&quot;path&quot;:&quot;/cron/alerts&quot;,&quot;message&quot;:&quot;Starting alert evaluation cron job&quot;,&quot;type&quot;:&quot;general&quot;}

{&quot;timestamp&quot;:&quot;2025-12-14T20:04:25.338Z&quot;,&quot;service&quot;:&quot;stockly-api&quot;,&quot;level&quot;:&quot;INFO&quot;,&quot;traceId&quot;:&quot;cron-1765742665338&quot;,&quot;userId&quot;:null,&quot;path&quot;:&quot;/cron/alerts&quot;,&quot;message&quot;:&quot;Processing 1 active alerts&quot;,&quot;type&quot;:&quot;general&quot;}
{&quot;timestamp&quot;:&quot;2025-12-14T20:04:25.338Z&quot;,&quot;service&quot;:&quot;stockly-api&quot;,&quot;level&quot;:&quot;DEBUG&quot;,&quot;traceId&quot;:&quot;cron-1765742665338&quot;,&quot;userId&quot;:null,&quot;path&quot;:&quot;/cron/alerts&quot;,&quot;message&quot;:&quot;Fetching prices for 1 unique symbols&quot;,&quot;type&quot;:&quot;general&quot;,&quot;symbols&quot;:[&quot;AAPL&quot;]}

{&quot;timestamp&quot;:&quot;2025-12-14T20:04:25.338Z&quot;,&quot;service&quot;:&quot;stockly-api&quot;,&quot;level&quot;:&quot;INFO&quot;,&quot;traceId&quot;:&quot;cron-1765742665338&quot;,&quot;userId&quot;:null,&quot;path&quot;:&quot;/cron/alerts&quot;,&quot;message&quot;:&quot;Successfully fetched prices for 1 symbols&quot;,&quot;type&quot;:&quot;general&quot;}

{&quot;timestamp&quot;:&quot;2025-12-14T20:04:25.338Z&quot;,&quot;service&quot;:&quot;stockly-api&quot;,&quot;level&quot;:&quot;INFO&quot;,&quot;traceId&quot;:&quot;cron-1765742665338&quot;,&quot;userId&quot;:null,&quot;path&quot;:&quot;/cron/alerts&quot;,&quot;message&quot;:&quot;Evaluated 1 alerts, 1 triggered&quot;,&quot;type&quot;:&quot;general&quot;}
{&quot;timestamp&quot;:&quot;2025-12-14T20:04:25.338Z&quot;,&quot;service&quot;:&quot;stockly-api&quot;,&quot;level&quot;:&quot;INFO&quot;,&quot;traceId&quot;:&quot;cron-1765742665338&quot;,&quot;userId&quot;:null,&quot;path&quot;:&quot;/cron/alerts&quot;,&quot;message&quot;:&quot;Alert triggered&quot;,&quot;type&quot;:&quot;general&quot;,&quot;alertId&quot;:&quot;alert-1&quot;,&quot;symbol&quot;:&quot;AAPL&quot;,&quot;price&quot;:205,&quot;direction&quot;:&quot;above&quot;,&quot;threshold&quot;:200,&quot;channel&quot;:&quot;notification&quot;}

{&quot;timestamp&quot;:&quot;2025-12-14T20:04:25.340Z&quot;,&quot;service&quot;:&quot;stockly-api&quot;,&quot;level&quot;:&quot;INFO&quot;,&quot;traceId&quot;:&quot;cron-1765742665338&quot;,&quot;userId&quot;:null,&quot;path&quot;:&quot;/cron/alerts&quot;,&quot;message&quot;:&quot;Alert notification sent to all user devices&quot;,&quot;type&quot;:&quot;general&quot;,&quot;alertId&quot;:&quot;alert-1&quot;,&quot;symbol&quot;:&quot;AAPL&quot;,&quot;username&quot;:&quot;testuser&quot;,&quot;devicesCount&quot;:1,&quot;successCount&quot;:0,&quot;failCount&quot;:1}
{&quot;timestamp&quot;:&quot;2025-12-14T20:04:25.340Z&quot;,&quot;service&quot;:&quot;stockly-api&quot;,&quot;level&quot;:&quot;INFO&quot;,&quot;traceId&quot;:&quot;cron-1765742665338&quot;,&quot;userId&quot;:null,&quot;path&quot;:&quot;/cron/alerts&quot;,&quot;message&quot;:&quot;Alert cron job completed successfully&quot;,&quot;type&quot;:&quot;general&quot;,&quot;alertsProcessed&quot;:1,&quot;notificationsSent&quot;:1}

            </system-out>
            <system-err>
{&quot;timestamp&quot;:&quot;2025-12-14T20:04:25.338Z&quot;,&quot;service&quot;:&quot;stockly-api&quot;,&quot;level&quot;:&quot;ERROR&quot;,&quot;traceId&quot;:&quot;cron-1765742665338&quot;,&quot;userId&quot;:null,&quot;path&quot;:&quot;/cron/alerts&quot;,&quot;message&quot;:&quot;Failed to send FCM notification&quot;,&quot;type&quot;:&quot;general&quot;,&quot;alertId&quot;:&quot;alert-1&quot;,&quot;symbol&quot;:&quot;AAPL&quot;,&quot;pushToken&quot;:&quot;fcm-token-123&quot;,&quot;error&quot;:{&quot;name&quot;:&quot;Error&quot;,&quot;message&quot;:&quot;FCM send returned false&quot;,&quot;stack&quot;:&quot;Error: FCM send returned false\n    at Module.runAlertCron (/home/sngvahmed/workspace/stockly/api/src/cron/alerts-cron.ts:204:63)\n    at /home/sngvahmed/workspace/stockly/api/test/cron/alerts-cron.spec.ts:309:7\n    at home/sngvahmed/workspace/stockly/api/node_modules/@vitest/runner/dist/chunk-hooks.js:752:20&quot;}}

            </system-err>
        </testcase>
        <testcase classname="test/cron/alerts-cron.spec.ts" name="Alert Cron Job &gt; runAlertCron &gt; should handle FCM notification errors" time="0.116">
            <system-out>
{&quot;timestamp&quot;:&quot;2025-12-14T20:04:25.449Z&quot;,&quot;service&quot;:&quot;stockly-api&quot;,&quot;level&quot;:&quot;INFO&quot;,&quot;traceId&quot;:&quot;cron-1765742665449&quot;,&quot;userId&quot;:null,&quot;path&quot;:&quot;/cron/alerts&quot;,&quot;message&quot;:&quot;Starting alert evaluation cron job&quot;,&quot;type&quot;:&quot;general&quot;}

{&quot;timestamp&quot;:&quot;2025-12-14T20:04:25.450Z&quot;,&quot;service&quot;:&quot;stockly-api&quot;,&quot;level&quot;:&quot;INFO&quot;,&quot;traceId&quot;:&quot;cron-1765742665449&quot;,&quot;userId&quot;:null,&quot;path&quot;:&quot;/cron/alerts&quot;,&quot;message&quot;:&quot;Processing 1 active alerts&quot;,&quot;type&quot;:&quot;general&quot;}
{&quot;timestamp&quot;:&quot;2025-12-14T20:04:25.450Z&quot;,&quot;service&quot;:&quot;stockly-api&quot;,&quot;level&quot;:&quot;DEBUG&quot;,&quot;traceId&quot;:&quot;cron-1765742665449&quot;,&quot;userId&quot;:null,&quot;path&quot;:&quot;/cron/alerts&quot;,&quot;message&quot;:&quot;Fetching prices for 1 unique symbols&quot;,&quot;type&quot;:&quot;general&quot;,&quot;symbols&quot;:[&quot;AAPL&quot;]}

{&quot;timestamp&quot;:&quot;2025-12-14T20:04:25.450Z&quot;,&quot;service&quot;:&quot;stockly-api&quot;,&quot;level&quot;:&quot;INFO&quot;,&quot;traceId&quot;:&quot;cron-1765742665449&quot;,&quot;userId&quot;:null,&quot;path&quot;:&quot;/cron/alerts&quot;,&quot;message&quot;:&quot;Successfully fetched prices for 1 symbols&quot;,&quot;type&quot;:&quot;general&quot;}

{&quot;timestamp&quot;:&quot;2025-12-14T20:04:25.450Z&quot;,&quot;service&quot;:&quot;stockly-api&quot;,&quot;level&quot;:&quot;INFO&quot;,&quot;traceId&quot;:&quot;cron-1765742665449&quot;,&quot;userId&quot;:null,&quot;path&quot;:&quot;/cron/alerts&quot;,&quot;message&quot;:&quot;Evaluated 1 alerts, 1 triggered&quot;,&quot;type&quot;:&quot;general&quot;}
{&quot;timestamp&quot;:&quot;2025-12-14T20:04:25.450Z&quot;,&quot;service&quot;:&quot;stockly-api&quot;,&quot;level&quot;:&quot;INFO&quot;,&quot;traceId&quot;:&quot;cron-1765742665449&quot;,&quot;userId&quot;:null,&quot;path&quot;:&quot;/cron/alerts&quot;,&quot;message&quot;:&quot;Alert triggered&quot;,&quot;type&quot;:&quot;general&quot;,&quot;alertId&quot;:&quot;alert-1&quot;,&quot;symbol&quot;:&quot;AAPL&quot;,&quot;price&quot;:205,&quot;direction&quot;:&quot;above&quot;,&quot;threshold&quot;:200,&quot;channel&quot;:&quot;notification&quot;}

{&quot;timestamp&quot;:&quot;2025-12-14T20:04:25.450Z&quot;,&quot;service&quot;:&quot;stockly-api&quot;,&quot;level&quot;:&quot;INFO&quot;,&quot;traceId&quot;:&quot;cron-1765742665449&quot;,&quot;userId&quot;:null,&quot;path&quot;:&quot;/cron/alerts&quot;,&quot;message&quot;:&quot;Alert notification sent to all user devices&quot;,&quot;type&quot;:&quot;general&quot;,&quot;alertId&quot;:&quot;alert-1&quot;,&quot;symbol&quot;:&quot;AAPL&quot;,&quot;username&quot;:&quot;testuser&quot;,&quot;devicesCount&quot;:1,&quot;successCount&quot;:0,&quot;failCount&quot;:1}
{&quot;timestamp&quot;:&quot;2025-12-14T20:04:25.450Z&quot;,&quot;service&quot;:&quot;stockly-api&quot;,&quot;level&quot;:&quot;INFO&quot;,&quot;traceId&quot;:&quot;cron-1765742665449&quot;,&quot;userId&quot;:null,&quot;path&quot;:&quot;/cron/alerts&quot;,&quot;message&quot;:&quot;Alert cron job completed successfully&quot;,&quot;type&quot;:&quot;general&quot;,&quot;alertsProcessed&quot;:1,&quot;notificationsSent&quot;:1}

            </system-out>
            <system-err>
{&quot;timestamp&quot;:&quot;2025-12-14T20:04:25.450Z&quot;,&quot;service&quot;:&quot;stockly-api&quot;,&quot;level&quot;:&quot;ERROR&quot;,&quot;traceId&quot;:&quot;cron-1765742665449&quot;,&quot;userId&quot;:null,&quot;path&quot;:&quot;/cron/alerts&quot;,&quot;message&quot;:&quot;Error sending FCM notification&quot;,&quot;type&quot;:&quot;general&quot;,&quot;alertId&quot;:&quot;alert-1&quot;,&quot;symbol&quot;:&quot;AAPL&quot;,&quot;pushToken&quot;:&quot;fcm-token-123&quot;,&quot;error&quot;:{&quot;name&quot;:&quot;Error&quot;,&quot;message&quot;:&quot;FCM send failed&quot;,&quot;stack&quot;:&quot;Error: FCM send failed\n    at /home/sngvahmed/workspace/stockly/api/test/cron/alerts-cron.spec.ts:343:9\n    at home/sngvahmed/workspace/stockly/api/node_modules/@vitest/runner/dist/chunk-hooks.js:155:11\n    at home/sngvahmed/workspace/stockly/api/node_modules/@vitest/runner/dist/chunk-hooks.js:752:26\n    at home/sngvahmed/workspace/stockly/api/node_modules/@vitest/runner/dist/chunk-hooks.js:1897:20\n    at new Promise (&lt;anonymous&gt;)\n    at runWithTimeout (home/sngvahmed/workspace/stockly/api/node_modules/@vitest/runner/dist/chunk-hooks.js:1863:10)\n    at runTest (home/sngvahmed/workspace/stockly/api/node_modules/@vitest/runner/dist/chunk-hooks.js:1574:12)\n    at runSuite (home/sngvahmed/workspace/stockly/api/node_modules/@vitest/runner/dist/chunk-hooks.js:1729:8)\n    at runSuite (home/sngvahmed/workspace/stockly/api/node_modules/@vitest/runner/dist/chunk-hooks.js:1729:8)\n    at runSuite (home/sngvahmed/workspace/stockly/api/node_modules/@vitest/runner/dist/chunk-hooks.js:1729:8)&quot;}}

            </system-err>
        </testcase>
        <testcase classname="test/cron/alerts-cron.spec.ts" name="Alert Cron Job &gt; runAlertCron &gt; should handle multiple alerts" time="0.085">
            <system-out>
{&quot;timestamp&quot;:&quot;2025-12-14T20:04:25.564Z&quot;,&quot;service&quot;:&quot;stockly-api&quot;,&quot;level&quot;:&quot;INFO&quot;,&quot;traceId&quot;:&quot;cron-1765742665564&quot;,&quot;userId&quot;:null,&quot;path&quot;:&quot;/cron/alerts&quot;,&quot;message&quot;:&quot;Starting alert evaluation cron job&quot;,&quot;type&quot;:&quot;general&quot;}

{&quot;timestamp&quot;:&quot;2025-12-14T20:04:25.564Z&quot;,&quot;service&quot;:&quot;stockly-api&quot;,&quot;level&quot;:&quot;INFO&quot;,&quot;traceId&quot;:&quot;cron-1765742665564&quot;,&quot;userId&quot;:null,&quot;path&quot;:&quot;/cron/alerts&quot;,&quot;message&quot;:&quot;Processing 2 active alerts&quot;,&quot;type&quot;:&quot;general&quot;}
{&quot;timestamp&quot;:&quot;2025-12-14T20:04:25.564Z&quot;,&quot;service&quot;:&quot;stockly-api&quot;,&quot;level&quot;:&quot;DEBUG&quot;,&quot;traceId&quot;:&quot;cron-1765742665564&quot;,&quot;userId&quot;:null,&quot;path&quot;:&quot;/cron/alerts&quot;,&quot;message&quot;:&quot;Fetching prices for 2 unique symbols&quot;,&quot;type&quot;:&quot;general&quot;,&quot;symbols&quot;:[&quot;AAPL&quot;,&quot;MSFT&quot;]}

{&quot;timestamp&quot;:&quot;2025-12-14T20:04:25.564Z&quot;,&quot;service&quot;:&quot;stockly-api&quot;,&quot;level&quot;:&quot;INFO&quot;,&quot;traceId&quot;:&quot;cron-1765742665564&quot;,&quot;userId&quot;:null,&quot;path&quot;:&quot;/cron/alerts&quot;,&quot;message&quot;:&quot;Successfully fetched prices for 2 symbols&quot;,&quot;type&quot;:&quot;general&quot;}

{&quot;timestamp&quot;:&quot;2025-12-14T20:04:25.565Z&quot;,&quot;service&quot;:&quot;stockly-api&quot;,&quot;level&quot;:&quot;INFO&quot;,&quot;traceId&quot;:&quot;cron-1765742665564&quot;,&quot;userId&quot;:null,&quot;path&quot;:&quot;/cron/alerts&quot;,&quot;message&quot;:&quot;Evaluated 2 alerts, 2 triggered&quot;,&quot;type&quot;:&quot;general&quot;}
{&quot;timestamp&quot;:&quot;2025-12-14T20:04:25.565Z&quot;,&quot;service&quot;:&quot;stockly-api&quot;,&quot;level&quot;:&quot;INFO&quot;,&quot;traceId&quot;:&quot;cron-1765742665564&quot;,&quot;userId&quot;:null,&quot;path&quot;:&quot;/cron/alerts&quot;,&quot;message&quot;:&quot;Alert triggered&quot;,&quot;type&quot;:&quot;general&quot;,&quot;alertId&quot;:&quot;alert-1&quot;,&quot;symbol&quot;:&quot;AAPL&quot;,&quot;price&quot;:205,&quot;direction&quot;:&quot;above&quot;,&quot;threshold&quot;:200,&quot;channel&quot;:&quot;notification&quot;}

{&quot;timestamp&quot;:&quot;2025-12-14T20:04:25.565Z&quot;,&quot;service&quot;:&quot;stockly-api&quot;,&quot;level&quot;:&quot;INFO&quot;,&quot;traceId&quot;:&quot;cron-1765742665564&quot;,&quot;userId&quot;:null,&quot;path&quot;:&quot;/cron/alerts&quot;,&quot;message&quot;:&quot;FCM notification sent successfully&quot;,&quot;type&quot;:&quot;general&quot;,&quot;alertId&quot;:&quot;alert-1&quot;,&quot;symbol&quot;:&quot;AAPL&quot;,&quot;pushToken&quot;:&quot;fcm-token-123&quot;}

{&quot;timestamp&quot;:&quot;2025-12-14T20:04:25.565Z&quot;,&quot;service&quot;:&quot;stockly-api&quot;,&quot;level&quot;:&quot;INFO&quot;,&quot;traceId&quot;:&quot;cron-1765742665564&quot;,&quot;userId&quot;:null,&quot;path&quot;:&quot;/cron/alerts&quot;,&quot;message&quot;:&quot;Alert notification sent to all user devices&quot;,&quot;type&quot;:&quot;general&quot;,&quot;alertId&quot;:&quot;alert-1&quot;,&quot;symbol&quot;:&quot;AAPL&quot;,&quot;username&quot;:&quot;testuser&quot;,&quot;devicesCount&quot;:1,&quot;successCount&quot;:1,&quot;failCount&quot;:0}
{&quot;timestamp&quot;:&quot;2025-12-14T20:04:25.565Z&quot;,&quot;service&quot;:&quot;stockly-api&quot;,&quot;level&quot;:&quot;INFO&quot;,&quot;traceId&quot;:&quot;cron-1765742665564&quot;,&quot;userId&quot;:null,&quot;path&quot;:&quot;/cron/alerts&quot;,&quot;message&quot;:&quot;Alert triggered&quot;,&quot;type&quot;:&quot;general&quot;,&quot;alertId&quot;:&quot;alert-2&quot;,&quot;symbol&quot;:&quot;MSFT&quot;,&quot;price&quot;:310,&quot;direction&quot;:&quot;above&quot;,&quot;threshold&quot;:300,&quot;channel&quot;:&quot;notification&quot;}

{&quot;timestamp&quot;:&quot;2025-12-14T20:04:25.565Z&quot;,&quot;service&quot;:&quot;stockly-api&quot;,&quot;level&quot;:&quot;INFO&quot;,&quot;traceId&quot;:&quot;cron-1765742665564&quot;,&quot;userId&quot;:null,&quot;path&quot;:&quot;/cron/alerts&quot;,&quot;message&quot;:&quot;FCM notification sent successfully&quot;,&quot;type&quot;:&quot;general&quot;,&quot;alertId&quot;:&quot;alert-2&quot;,&quot;symbol&quot;:&quot;MSFT&quot;,&quot;pushToken&quot;:&quot;fcm-token-123&quot;}

{&quot;timestamp&quot;:&quot;2025-12-14T20:04:25.565Z&quot;,&quot;service&quot;:&quot;stockly-api&quot;,&quot;level&quot;:&quot;INFO&quot;,&quot;traceId&quot;:&quot;cron-1765742665564&quot;,&quot;userId&quot;:null,&quot;path&quot;:&quot;/cron/alerts&quot;,&quot;message&quot;:&quot;Alert notification sent to all user devices&quot;,&quot;type&quot;:&quot;general&quot;,&quot;alertId&quot;:&quot;alert-2&quot;,&quot;symbol&quot;:&quot;MSFT&quot;,&quot;username&quot;:&quot;testuser&quot;,&quot;devicesCount&quot;:1,&quot;successCount&quot;:1,&quot;failCount&quot;:0}
{&quot;timestamp&quot;:&quot;2025-12-14T20:04:25.565Z&quot;,&quot;service&quot;:&quot;stockly-api&quot;,&quot;level&quot;:&quot;INFO&quot;,&quot;traceId&quot;:&quot;cron-1765742665564&quot;,&quot;userId&quot;:null,&quot;path&quot;:&quot;/cron/alerts&quot;,&quot;message&quot;:&quot;Alert cron job completed successfully&quot;,&quot;type&quot;:&quot;general&quot;,&quot;alertsProcessed&quot;:2,&quot;notificationsSent&quot;:2}

            </system-out>
        </testcase>
        <testcase classname="test/cron/alerts-cron.spec.ts" name="Alert Cron Job &gt; runAlertCron &gt; should skip when no prices available" time="0.042">
            <system-out>
{&quot;timestamp&quot;:&quot;2025-12-14T20:04:25.644Z&quot;,&quot;service&quot;:&quot;stockly-api&quot;,&quot;level&quot;:&quot;INFO&quot;,&quot;traceId&quot;:&quot;cron-1765742665644&quot;,&quot;userId&quot;:null,&quot;path&quot;:&quot;/cron/alerts&quot;,&quot;message&quot;:&quot;Starting alert evaluation cron job&quot;,&quot;type&quot;:&quot;general&quot;}

{&quot;timestamp&quot;:&quot;2025-12-14T20:04:25.644Z&quot;,&quot;service&quot;:&quot;stockly-api&quot;,&quot;level&quot;:&quot;INFO&quot;,&quot;traceId&quot;:&quot;cron-1765742665644&quot;,&quot;userId&quot;:null,&quot;path&quot;:&quot;/cron/alerts&quot;,&quot;message&quot;:&quot;Processing 1 active alerts&quot;,&quot;type&quot;:&quot;general&quot;}
{&quot;timestamp&quot;:&quot;2025-12-14T20:04:25.644Z&quot;,&quot;service&quot;:&quot;stockly-api&quot;,&quot;level&quot;:&quot;DEBUG&quot;,&quot;traceId&quot;:&quot;cron-1765742665644&quot;,&quot;userId&quot;:null,&quot;path&quot;:&quot;/cron/alerts&quot;,&quot;message&quot;:&quot;Fetching prices for 1 unique symbols&quot;,&quot;type&quot;:&quot;general&quot;,&quot;symbols&quot;:[&quot;AAPL&quot;]}

            </system-out>
            <system-err>
{&quot;timestamp&quot;:&quot;2025-12-14T20:04:25.644Z&quot;,&quot;service&quot;:&quot;stockly-api&quot;,&quot;level&quot;:&quot;WARN&quot;,&quot;traceId&quot;:&quot;cron-1765742665644&quot;,&quot;userId&quot;:null,&quot;path&quot;:&quot;/cron/alerts&quot;,&quot;message&quot;:&quot;No prices available for alerts run&quot;,&quot;type&quot;:&quot;general&quot;,&quot;symbols&quot;:[&quot;AAPL&quot;]}

            </system-err>
        </testcase>
        <testcase classname="test/cron/alerts-cron.spec.ts" name="Alert Cron Job &gt; runAlertCron &gt; should flush pending KV writes" time="0.075">
            <system-out>
{&quot;timestamp&quot;:&quot;2025-12-14T20:04:25.716Z&quot;,&quot;service&quot;:&quot;stockly-api&quot;,&quot;level&quot;:&quot;INFO&quot;,&quot;traceId&quot;:&quot;cron-1765742665716&quot;,&quot;userId&quot;:null,&quot;path&quot;:&quot;/cron/alerts&quot;,&quot;message&quot;:&quot;Starting alert evaluation cron job&quot;,&quot;type&quot;:&quot;general&quot;}

{&quot;timestamp&quot;:&quot;2025-12-14T20:04:25.716Z&quot;,&quot;service&quot;:&quot;stockly-api&quot;,&quot;level&quot;:&quot;INFO&quot;,&quot;traceId&quot;:&quot;cron-1765742665716&quot;,&quot;userId&quot;:null,&quot;path&quot;:&quot;/cron/alerts&quot;,&quot;message&quot;:&quot;Processing 1 active alerts&quot;,&quot;type&quot;:&quot;general&quot;}
{&quot;timestamp&quot;:&quot;2025-12-14T20:04:25.716Z&quot;,&quot;service&quot;:&quot;stockly-api&quot;,&quot;level&quot;:&quot;DEBUG&quot;,&quot;traceId&quot;:&quot;cron-1765742665716&quot;,&quot;userId&quot;:null,&quot;path&quot;:&quot;/cron/alerts&quot;,&quot;message&quot;:&quot;Fetching prices for 1 unique symbols&quot;,&quot;type&quot;:&quot;general&quot;,&quot;symbols&quot;:[&quot;AAPL&quot;]}

{&quot;timestamp&quot;:&quot;2025-12-14T20:04:25.716Z&quot;,&quot;service&quot;:&quot;stockly-api&quot;,&quot;level&quot;:&quot;INFO&quot;,&quot;traceId&quot;:&quot;cron-1765742665716&quot;,&quot;userId&quot;:null,&quot;path&quot;:&quot;/cron/alerts&quot;,&quot;message&quot;:&quot;Successfully fetched prices for 1 symbols&quot;,&quot;type&quot;:&quot;general&quot;}

{&quot;timestamp&quot;:&quot;2025-12-14T20:04:25.716Z&quot;,&quot;service&quot;:&quot;stockly-api&quot;,&quot;level&quot;:&quot;INFO&quot;,&quot;traceId&quot;:&quot;cron-1765742665716&quot;,&quot;userId&quot;:null,&quot;path&quot;:&quot;/cron/alerts&quot;,&quot;message&quot;:&quot;Evaluated 1 alerts, 0 triggered&quot;,&quot;type&quot;:&quot;general&quot;}
{&quot;timestamp&quot;:&quot;2025-12-14T20:04:25.716Z&quot;,&quot;service&quot;:&quot;stockly-api&quot;,&quot;level&quot;:&quot;INFO&quot;,&quot;traceId&quot;:&quot;cron-1765742665716&quot;,&quot;userId&quot;:null,&quot;path&quot;:&quot;/cron/alerts&quot;,&quot;message&quot;:&quot;Alert cron job completed successfully&quot;,&quot;type&quot;:&quot;general&quot;,&quot;alertsProcessed&quot;:1,&quot;notificationsSent&quot;:0}

            </system-out>
        </testcase>
        <testcase classname="test/cron/alerts-cron.spec.ts" name="Alert Cron Job &gt; runAlertCron &gt; should send logs to Loki if configured" time="0.043">
            <system-out>
{&quot;timestamp&quot;:&quot;2025-12-14T20:04:25.759Z&quot;,&quot;service&quot;:&quot;stockly-api&quot;,&quot;level&quot;:&quot;INFO&quot;,&quot;traceId&quot;:&quot;cron-1765742665759&quot;,&quot;userId&quot;:null,&quot;path&quot;:&quot;/cron/alerts&quot;,&quot;message&quot;:&quot;Starting alert evaluation cron job&quot;,&quot;type&quot;:&quot;general&quot;}

{&quot;timestamp&quot;:&quot;2025-12-14T20:04:25.759Z&quot;,&quot;service&quot;:&quot;stockly-api&quot;,&quot;level&quot;:&quot;INFO&quot;,&quot;traceId&quot;:&quot;cron-1765742665759&quot;,&quot;userId&quot;:null,&quot;path&quot;:&quot;/cron/alerts&quot;,&quot;message&quot;:&quot;Processing 1 active alerts&quot;,&quot;type&quot;:&quot;general&quot;}
{&quot;timestamp&quot;:&quot;2025-12-14T20:04:25.759Z&quot;,&quot;service&quot;:&quot;stockly-api&quot;,&quot;level&quot;:&quot;DEBUG&quot;,&quot;traceId&quot;:&quot;cron-1765742665759&quot;,&quot;userId&quot;:null,&quot;path&quot;:&quot;/cron/alerts&quot;,&quot;message&quot;:&quot;Fetching prices for 1 unique symbols&quot;,&quot;type&quot;:&quot;general&quot;,&quot;symbols&quot;:[&quot;AAPL&quot;]}

{&quot;timestamp&quot;:&quot;2025-12-14T20:04:25.759Z&quot;,&quot;service&quot;:&quot;stockly-api&quot;,&quot;level&quot;:&quot;INFO&quot;,&quot;traceId&quot;:&quot;cron-1765742665759&quot;,&quot;userId&quot;:null,&quot;path&quot;:&quot;/cron/alerts&quot;,&quot;message&quot;:&quot;Successfully fetched prices for 1 symbols&quot;,&quot;type&quot;:&quot;general&quot;}

{&quot;timestamp&quot;:&quot;2025-12-14T20:04:25.759Z&quot;,&quot;service&quot;:&quot;stockly-api&quot;,&quot;level&quot;:&quot;INFO&quot;,&quot;traceId&quot;:&quot;cron-1765742665759&quot;,&quot;userId&quot;:null,&quot;path&quot;:&quot;/cron/alerts&quot;,&quot;message&quot;:&quot;Evaluated 1 alerts, 0 triggered&quot;,&quot;type&quot;:&quot;general&quot;}
{&quot;timestamp&quot;:&quot;2025-12-14T20:04:25.759Z&quot;,&quot;service&quot;:&quot;stockly-api&quot;,&quot;level&quot;:&quot;INFO&quot;,&quot;traceId&quot;:&quot;cron-1765742665759&quot;,&quot;userId&quot;:null,&quot;path&quot;:&quot;/cron/alerts&quot;,&quot;message&quot;:&quot;Alert cron job completed successfully&quot;,&quot;type&quot;:&quot;general&quot;,&quot;alertsProcessed&quot;:1,&quot;notificationsSent&quot;:0}

            </system-out>
        </testcase>
        <testcase classname="test/cron/alerts-cron.spec.ts" name="Alert Cron Job &gt; runAlertCron &gt; should not send logs to Loki if not configured" time="0.045">
            <system-out>
{&quot;timestamp&quot;:&quot;2025-12-14T20:04:25.809Z&quot;,&quot;service&quot;:&quot;stockly-api&quot;,&quot;level&quot;:&quot;INFO&quot;,&quot;traceId&quot;:&quot;cron-1765742665809&quot;,&quot;userId&quot;:null,&quot;path&quot;:&quot;/cron/alerts&quot;,&quot;message&quot;:&quot;Starting alert evaluation cron job&quot;,&quot;type&quot;:&quot;general&quot;}

{&quot;timestamp&quot;:&quot;2025-12-14T20:04:25.809Z&quot;,&quot;service&quot;:&quot;stockly-api&quot;,&quot;level&quot;:&quot;INFO&quot;,&quot;traceId&quot;:&quot;cron-1765742665809&quot;,&quot;userId&quot;:null,&quot;path&quot;:&quot;/cron/alerts&quot;,&quot;message&quot;:&quot;Processing 1 active alerts&quot;,&quot;type&quot;:&quot;general&quot;}
{&quot;timestamp&quot;:&quot;2025-12-14T20:04:25.809Z&quot;,&quot;service&quot;:&quot;stockly-api&quot;,&quot;level&quot;:&quot;DEBUG&quot;,&quot;traceId&quot;:&quot;cron-1765742665809&quot;,&quot;userId&quot;:null,&quot;path&quot;:&quot;/cron/alerts&quot;,&quot;message&quot;:&quot;Fetching prices for 1 unique symbols&quot;,&quot;type&quot;:&quot;general&quot;,&quot;symbols&quot;:[&quot;AAPL&quot;]}

            </system-out>
            <system-err>
{&quot;timestamp&quot;:&quot;2025-12-14T20:04:25.809Z&quot;,&quot;service&quot;:&quot;stockly-api&quot;,&quot;level&quot;:&quot;WARN&quot;,&quot;traceId&quot;:&quot;cron-1765742665809&quot;,&quot;userId&quot;:null,&quot;path&quot;:&quot;/cron/alerts&quot;,&quot;message&quot;:&quot;No prices available for alerts run&quot;,&quot;type&quot;:&quot;general&quot;,&quot;symbols&quot;:[&quot;AAPL&quot;]}

            </system-err>
        </testcase>
        <testcase classname="test/cron/alerts-cron.spec.ts" name="Alert Cron Job &gt; runAlertCron &gt; should handle fatal errors and re-throw" time="0.032">
            <system-out>
{&quot;timestamp&quot;:&quot;2025-12-14T20:04:25.845Z&quot;,&quot;service&quot;:&quot;stockly-api&quot;,&quot;level&quot;:&quot;INFO&quot;,&quot;traceId&quot;:&quot;cron-1765742665845&quot;,&quot;userId&quot;:null,&quot;path&quot;:&quot;/cron/alerts&quot;,&quot;message&quot;:&quot;Starting alert evaluation cron job&quot;,&quot;type&quot;:&quot;general&quot;}

            </system-out>
            <system-err>
{&quot;timestamp&quot;:&quot;2025-12-14T20:04:25.846Z&quot;,&quot;service&quot;:&quot;stockly-api&quot;,&quot;level&quot;:&quot;ERROR&quot;,&quot;traceId&quot;:&quot;cron-1765742665845&quot;,&quot;userId&quot;:null,&quot;path&quot;:&quot;/cron/alerts&quot;,&quot;message&quot;:&quot;Fatal error in alert cron job&quot;,&quot;type&quot;:&quot;general&quot;,&quot;error&quot;:{&quot;name&quot;:&quot;Error&quot;,&quot;message&quot;:&quot;Fatal error&quot;,&quot;stack&quot;:&quot;Error: Fatal error\n    at /home/sngvahmed/workspace/stockly/api/test/cron/alerts-cron.spec.ts:530:21\n    at home/sngvahmed/workspace/stockly/api/node_modules/@vitest/runner/dist/chunk-hooks.js:155:11\n    at home/sngvahmed/workspace/stockly/api/node_modules/@vitest/runner/dist/chunk-hooks.js:752:26\n    at home/sngvahmed/workspace/stockly/api/node_modules/@vitest/runner/dist/chunk-hooks.js:1897:20\n    at new Promise (&lt;anonymous&gt;)\n    at runWithTimeout (home/sngvahmed/workspace/stockly/api/node_modules/@vitest/runner/dist/chunk-hooks.js:1863:10)\n    at runTest (home/sngvahmed/workspace/stockly/api/node_modules/@vitest/runner/dist/chunk-hooks.js:1574:12)\n    at runSuite (home/sngvahmed/workspace/stockly/api/node_modules/@vitest/runner/dist/chunk-hooks.js:1729:8)\n    at runSuite (home/sngvahmed/workspace/stockly/api/node_modules/@vitest/runner/dist/chunk-hooks.js:1729:8)\n    at runSuite (home/sngvahmed/workspace/stockly/api/node_modules/@vitest/runner/dist/chunk-hooks.js:1729:8)&quot;}}

            </system-err>
        </testcase>
        <testcase classname="test/cron/alerts-cron.spec.ts" name="Alert Cron Job &gt; runAlertCron &gt; should use default KV write interval if not in config" time="0.036">
            <system-out>
{&quot;timestamp&quot;:&quot;2025-12-14T20:04:25.880Z&quot;,&quot;service&quot;:&quot;stockly-api&quot;,&quot;level&quot;:&quot;INFO&quot;,&quot;traceId&quot;:&quot;cron-1765742665880&quot;,&quot;userId&quot;:null,&quot;path&quot;:&quot;/cron/alerts&quot;,&quot;message&quot;:&quot;Starting alert evaluation cron job&quot;,&quot;type&quot;:&quot;general&quot;}

{&quot;timestamp&quot;:&quot;2025-12-14T20:04:25.880Z&quot;,&quot;service&quot;:&quot;stockly-api&quot;,&quot;level&quot;:&quot;INFO&quot;,&quot;traceId&quot;:&quot;cron-1765742665880&quot;,&quot;userId&quot;:null,&quot;path&quot;:&quot;/cron/alerts&quot;,&quot;message&quot;:&quot;Processing 1 active alerts&quot;,&quot;type&quot;:&quot;general&quot;}
{&quot;timestamp&quot;:&quot;2025-12-14T20:04:25.880Z&quot;,&quot;service&quot;:&quot;stockly-api&quot;,&quot;level&quot;:&quot;DEBUG&quot;,&quot;traceId&quot;:&quot;cron-1765742665880&quot;,&quot;userId&quot;:null,&quot;path&quot;:&quot;/cron/alerts&quot;,&quot;message&quot;:&quot;Fetching prices for 1 unique symbols&quot;,&quot;type&quot;:&quot;general&quot;,&quot;symbols&quot;:[&quot;AAPL&quot;]}

{&quot;timestamp&quot;:&quot;2025-12-14T20:04:25.880Z&quot;,&quot;service&quot;:&quot;stockly-api&quot;,&quot;level&quot;:&quot;INFO&quot;,&quot;traceId&quot;:&quot;cron-1765742665880&quot;,&quot;userId&quot;:null,&quot;path&quot;:&quot;/cron/alerts&quot;,&quot;message&quot;:&quot;Successfully fetched prices for 1 symbols&quot;,&quot;type&quot;:&quot;general&quot;}

{&quot;timestamp&quot;:&quot;2025-12-14T20:04:25.880Z&quot;,&quot;service&quot;:&quot;stockly-api&quot;,&quot;level&quot;:&quot;INFO&quot;,&quot;traceId&quot;:&quot;cron-1765742665880&quot;,&quot;userId&quot;:null,&quot;path&quot;:&quot;/cron/alerts&quot;,&quot;message&quot;:&quot;Evaluated 1 alerts, 0 triggered&quot;,&quot;type&quot;:&quot;general&quot;}
{&quot;timestamp&quot;:&quot;2025-12-14T20:04:25.880Z&quot;,&quot;service&quot;:&quot;stockly-api&quot;,&quot;level&quot;:&quot;INFO&quot;,&quot;traceId&quot;:&quot;cron-1765742665880&quot;,&quot;userId&quot;:null,&quot;path&quot;:&quot;/cron/alerts&quot;,&quot;message&quot;:&quot;Alert cron job completed successfully&quot;,&quot;type&quot;:&quot;general&quot;,&quot;alertsProcessed&quot;:1,&quot;notificationsSent&quot;:0}

            </system-out>
        </testcase>
        <testcase classname="test/cron/alerts-cron.spec.ts" name="Alert Cron Job &gt; runAlertCron &gt; should handle array response from quote API" time="0.03">
            <system-out>
{&quot;timestamp&quot;:&quot;2025-12-14T20:04:25.914Z&quot;,&quot;service&quot;:&quot;stockly-api&quot;,&quot;level&quot;:&quot;INFO&quot;,&quot;traceId&quot;:&quot;cron-1765742665914&quot;,&quot;userId&quot;:null,&quot;path&quot;:&quot;/cron/alerts&quot;,&quot;message&quot;:&quot;Starting alert evaluation cron job&quot;,&quot;type&quot;:&quot;general&quot;}

{&quot;timestamp&quot;:&quot;2025-12-14T20:04:25.914Z&quot;,&quot;service&quot;:&quot;stockly-api&quot;,&quot;level&quot;:&quot;INFO&quot;,&quot;traceId&quot;:&quot;cron-1765742665914&quot;,&quot;userId&quot;:null,&quot;path&quot;:&quot;/cron/alerts&quot;,&quot;message&quot;:&quot;Processing 1 active alerts&quot;,&quot;type&quot;:&quot;general&quot;}
{&quot;timestamp&quot;:&quot;2025-12-14T20:04:25.914Z&quot;,&quot;service&quot;:&quot;stockly-api&quot;,&quot;level&quot;:&quot;DEBUG&quot;,&quot;traceId&quot;:&quot;cron-1765742665914&quot;,&quot;userId&quot;:null,&quot;path&quot;:&quot;/cron/alerts&quot;,&quot;message&quot;:&quot;Fetching prices for 1 unique symbols&quot;,&quot;type&quot;:&quot;general&quot;,&quot;symbols&quot;:[&quot;AAPL&quot;]}

{&quot;timestamp&quot;:&quot;2025-12-14T20:04:25.914Z&quot;,&quot;service&quot;:&quot;stockly-api&quot;,&quot;level&quot;:&quot;INFO&quot;,&quot;traceId&quot;:&quot;cron-1765742665914&quot;,&quot;userId&quot;:null,&quot;path&quot;:&quot;/cron/alerts&quot;,&quot;message&quot;:&quot;Successfully fetched prices for 1 symbols&quot;,&quot;type&quot;:&quot;general&quot;}

{&quot;timestamp&quot;:&quot;2025-12-14T20:04:25.914Z&quot;,&quot;service&quot;:&quot;stockly-api&quot;,&quot;level&quot;:&quot;INFO&quot;,&quot;traceId&quot;:&quot;cron-1765742665914&quot;,&quot;userId&quot;:null,&quot;path&quot;:&quot;/cron/alerts&quot;,&quot;message&quot;:&quot;Evaluated 1 alerts, 0 triggered&quot;,&quot;type&quot;:&quot;general&quot;}
{&quot;timestamp&quot;:&quot;2025-12-14T20:04:25.914Z&quot;,&quot;service&quot;:&quot;stockly-api&quot;,&quot;level&quot;:&quot;INFO&quot;,&quot;traceId&quot;:&quot;cron-1765742665914&quot;,&quot;userId&quot;:null,&quot;path&quot;:&quot;/cron/alerts&quot;,&quot;message&quot;:&quot;Alert cron job completed successfully&quot;,&quot;type&quot;:&quot;general&quot;,&quot;alertsProcessed&quot;:1,&quot;notificationsSent&quot;:0}

            </system-out>
        </testcase>
    </testsuite>
    <testsuite name="test/cron/news-alert-cron.spec.ts" timestamp="2025-12-14T20:04:38.240Z" hostname="sngvahmed" tests="18" failures="0" errors="0" skipped="0" time="1.371">
        <testcase classname="test/cron/news-alert-cron.spec.ts" name="News Alert Cron Job &gt; User Symbol Collection &gt; should collect unique symbols from all users" time="0.03">
            <system-out>
{&quot;timestamp&quot;:&quot;2025-12-14T20:04:24.757Z&quot;,&quot;service&quot;:&quot;stockly-api&quot;,&quot;level&quot;:&quot;INFO&quot;,&quot;traceId&quot;:&quot;cron-news-1765742664757&quot;,&quot;userId&quot;:null,&quot;path&quot;:&quot;/cron/news-alerts&quot;,&quot;message&quot;:&quot;Starting news alert cron job&quot;,&quot;type&quot;:&quot;general&quot;}

{&quot;timestamp&quot;:&quot;2025-12-14T20:04:24.758Z&quot;,&quot;service&quot;:&quot;stockly-api&quot;,&quot;level&quot;:&quot;INFO&quot;,&quot;traceId&quot;:&quot;cron-news-1765742664757&quot;,&quot;userId&quot;:null,&quot;path&quot;:&quot;/cron/news-alerts&quot;,&quot;message&quot;:&quot;Checking news for 4 unique symbols: LXEO, AMZN, AAPL, BABA&quot;,&quot;type&quot;:&quot;general&quot;}
{&quot;timestamp&quot;:&quot;2025-12-14T20:04:24.759Z&quot;,&quot;service&quot;:&quot;stockly-api&quot;,&quot;level&quot;:&quot;INFO&quot;,&quot;traceId&quot;:&quot;cron-news-1765742664757&quot;,&quot;userId&quot;:null,&quot;path&quot;:&quot;/cron/news-alerts&quot;,&quot;message&quot;:&quot;Fetching news for all symbols published today (2025-12-14)&quot;,&quot;type&quot;:&quot;general&quot;}

{&quot;timestamp&quot;:&quot;2025-12-14T20:04:24.759Z&quot;,&quot;service&quot;:&quot;stockly-api&quot;,&quot;level&quot;:&quot;INFO&quot;,&quot;traceId&quot;:&quot;cron-news-1765742664757&quot;,&quot;userId&quot;:null,&quot;path&quot;:&quot;/cron/news-alerts&quot;,&quot;message&quot;:&quot;Fetched 0 news articles published today&quot;,&quot;type&quot;:&quot;general&quot;}
{&quot;timestamp&quot;:&quot;2025-12-14T20:04:24.759Z&quot;,&quot;service&quot;:&quot;stockly-api&quot;,&quot;level&quot;:&quot;INFO&quot;,&quot;traceId&quot;:&quot;cron-news-1765742664757&quot;,&quot;userId&quot;:null,&quot;path&quot;:&quot;/cron/news-alerts&quot;,&quot;message&quot;:&quot;Found news for 0 symbols: &quot;,&quot;type&quot;:&quot;general&quot;}
{&quot;timestamp&quot;:&quot;2025-12-14T20:04:24.759Z&quot;,&quot;service&quot;:&quot;stockly-api&quot;,&quot;level&quot;:&quot;INFO&quot;,&quot;traceId&quot;:&quot;cron-news-1765742664757&quot;,&quot;userId&quot;:null,&quot;path&quot;:&quot;/cron/news-alerts&quot;,&quot;message&quot;:&quot;News alert cron job completed&quot;,&quot;type&quot;:&quot;general&quot;}

            </system-out>
        </testcase>
        <testcase classname="test/cron/news-alert-cron.spec.ts" name="News Alert Cron Job &gt; User Symbol Collection &gt; should normalize symbols to uppercase" time="0.029">
            <system-out>
{&quot;timestamp&quot;:&quot;2025-12-14T20:04:24.786Z&quot;,&quot;service&quot;:&quot;stockly-api&quot;,&quot;level&quot;:&quot;INFO&quot;,&quot;traceId&quot;:&quot;cron-news-1765742664786&quot;,&quot;userId&quot;:null,&quot;path&quot;:&quot;/cron/news-alerts&quot;,&quot;message&quot;:&quot;Starting news alert cron job&quot;,&quot;type&quot;:&quot;general&quot;}

{&quot;timestamp&quot;:&quot;2025-12-14T20:04:24.786Z&quot;,&quot;service&quot;:&quot;stockly-api&quot;,&quot;level&quot;:&quot;INFO&quot;,&quot;traceId&quot;:&quot;cron-news-1765742664786&quot;,&quot;userId&quot;:null,&quot;path&quot;:&quot;/cron/news-alerts&quot;,&quot;message&quot;:&quot;Checking news for 2 unique symbols: LXEO, AMZN&quot;,&quot;type&quot;:&quot;general&quot;}
{&quot;timestamp&quot;:&quot;2025-12-14T20:04:24.787Z&quot;,&quot;service&quot;:&quot;stockly-api&quot;,&quot;level&quot;:&quot;INFO&quot;,&quot;traceId&quot;:&quot;cron-news-1765742664786&quot;,&quot;userId&quot;:null,&quot;path&quot;:&quot;/cron/news-alerts&quot;,&quot;message&quot;:&quot;Fetching news for all symbols published today (2025-12-14)&quot;,&quot;type&quot;:&quot;general&quot;}

{&quot;timestamp&quot;:&quot;2025-12-14T20:04:24.787Z&quot;,&quot;service&quot;:&quot;stockly-api&quot;,&quot;level&quot;:&quot;INFO&quot;,&quot;traceId&quot;:&quot;cron-news-1765742664786&quot;,&quot;userId&quot;:null,&quot;path&quot;:&quot;/cron/news-alerts&quot;,&quot;message&quot;:&quot;Fetched 0 news articles published today&quot;,&quot;type&quot;:&quot;general&quot;}
{&quot;timestamp&quot;:&quot;2025-12-14T20:04:24.787Z&quot;,&quot;service&quot;:&quot;stockly-api&quot;,&quot;level&quot;:&quot;INFO&quot;,&quot;traceId&quot;:&quot;cron-news-1765742664786&quot;,&quot;userId&quot;:null,&quot;path&quot;:&quot;/cron/news-alerts&quot;,&quot;message&quot;:&quot;Found news for 0 symbols: &quot;,&quot;type&quot;:&quot;general&quot;}
{&quot;timestamp&quot;:&quot;2025-12-14T20:04:24.787Z&quot;,&quot;service&quot;:&quot;stockly-api&quot;,&quot;level&quot;:&quot;INFO&quot;,&quot;traceId&quot;:&quot;cron-news-1765742664786&quot;,&quot;userId&quot;:null,&quot;path&quot;:&quot;/cron/news-alerts&quot;,&quot;message&quot;:&quot;News alert cron job completed&quot;,&quot;type&quot;:&quot;general&quot;}

            </system-out>
        </testcase>
        <testcase classname="test/cron/news-alert-cron.spec.ts" name="News Alert Cron Job &gt; User Symbol Collection &gt; should skip users with no favorite symbols" time="0.085">
            <system-out>
{&quot;timestamp&quot;:&quot;2025-12-14T20:04:24.874Z&quot;,&quot;service&quot;:&quot;stockly-api&quot;,&quot;level&quot;:&quot;INFO&quot;,&quot;traceId&quot;:&quot;cron-news-1765742664874&quot;,&quot;userId&quot;:null,&quot;path&quot;:&quot;/cron/news-alerts&quot;,&quot;message&quot;:&quot;Starting news alert cron job&quot;,&quot;type&quot;:&quot;general&quot;}

{&quot;timestamp&quot;:&quot;2025-12-14T20:04:24.874Z&quot;,&quot;service&quot;:&quot;stockly-api&quot;,&quot;level&quot;:&quot;INFO&quot;,&quot;traceId&quot;:&quot;cron-news-1765742664874&quot;,&quot;userId&quot;:null,&quot;path&quot;:&quot;/cron/news-alerts&quot;,&quot;message&quot;:&quot;Checking news for 1 unique symbols: LXEO&quot;,&quot;type&quot;:&quot;general&quot;}
{&quot;timestamp&quot;:&quot;2025-12-14T20:04:24.874Z&quot;,&quot;service&quot;:&quot;stockly-api&quot;,&quot;level&quot;:&quot;INFO&quot;,&quot;traceId&quot;:&quot;cron-news-1765742664874&quot;,&quot;userId&quot;:null,&quot;path&quot;:&quot;/cron/news-alerts&quot;,&quot;message&quot;:&quot;Fetching news for all symbols published today (2025-12-14)&quot;,&quot;type&quot;:&quot;general&quot;}

{&quot;timestamp&quot;:&quot;2025-12-14T20:04:24.874Z&quot;,&quot;service&quot;:&quot;stockly-api&quot;,&quot;level&quot;:&quot;INFO&quot;,&quot;traceId&quot;:&quot;cron-news-1765742664874&quot;,&quot;userId&quot;:null,&quot;path&quot;:&quot;/cron/news-alerts&quot;,&quot;message&quot;:&quot;Fetched 0 news articles published today&quot;,&quot;type&quot;:&quot;general&quot;}
{&quot;timestamp&quot;:&quot;2025-12-14T20:04:24.874Z&quot;,&quot;service&quot;:&quot;stockly-api&quot;,&quot;level&quot;:&quot;INFO&quot;,&quot;traceId&quot;:&quot;cron-news-1765742664874&quot;,&quot;userId&quot;:null,&quot;path&quot;:&quot;/cron/news-alerts&quot;,&quot;message&quot;:&quot;Found news for 0 symbols: &quot;,&quot;type&quot;:&quot;general&quot;}
{&quot;timestamp&quot;:&quot;2025-12-14T20:04:24.874Z&quot;,&quot;service&quot;:&quot;stockly-api&quot;,&quot;level&quot;:&quot;INFO&quot;,&quot;traceId&quot;:&quot;cron-news-1765742664874&quot;,&quot;userId&quot;:null,&quot;path&quot;:&quot;/cron/news-alerts&quot;,&quot;message&quot;:&quot;News alert cron job completed&quot;,&quot;type&quot;:&quot;general&quot;}

            </system-out>
        </testcase>
        <testcase classname="test/cron/news-alert-cron.spec.ts" name="News Alert Cron Job &gt; News Fetching and Filtering &gt; should fetch news for all symbols in one batch call" time="0.027">
            <system-out>
{&quot;timestamp&quot;:&quot;2025-12-14T20:04:24.952Z&quot;,&quot;service&quot;:&quot;stockly-api&quot;,&quot;level&quot;:&quot;INFO&quot;,&quot;traceId&quot;:&quot;cron-news-1765742664952&quot;,&quot;userId&quot;:null,&quot;path&quot;:&quot;/cron/news-alerts&quot;,&quot;message&quot;:&quot;Starting news alert cron job&quot;,&quot;type&quot;:&quot;general&quot;}

{&quot;timestamp&quot;:&quot;2025-12-14T20:04:24.953Z&quot;,&quot;service&quot;:&quot;stockly-api&quot;,&quot;level&quot;:&quot;INFO&quot;,&quot;traceId&quot;:&quot;cron-news-1765742664952&quot;,&quot;userId&quot;:null,&quot;path&quot;:&quot;/cron/news-alerts&quot;,&quot;message&quot;:&quot;Checking news for 3 unique symbols: LXEO, AMZN, AAPL&quot;,&quot;type&quot;:&quot;general&quot;}
{&quot;timestamp&quot;:&quot;2025-12-14T20:04:24.953Z&quot;,&quot;service&quot;:&quot;stockly-api&quot;,&quot;level&quot;:&quot;INFO&quot;,&quot;traceId&quot;:&quot;cron-news-1765742664952&quot;,&quot;userId&quot;:null,&quot;path&quot;:&quot;/cron/news-alerts&quot;,&quot;message&quot;:&quot;Fetching news for all symbols published today (2025-12-14)&quot;,&quot;type&quot;:&quot;general&quot;}

{&quot;timestamp&quot;:&quot;2025-12-14T20:04:24.953Z&quot;,&quot;service&quot;:&quot;stockly-api&quot;,&quot;level&quot;:&quot;INFO&quot;,&quot;traceId&quot;:&quot;cron-news-1765742664952&quot;,&quot;userId&quot;:null,&quot;path&quot;:&quot;/cron/news-alerts&quot;,&quot;message&quot;:&quot;Fetched 2 news articles published today&quot;,&quot;type&quot;:&quot;general&quot;}
{&quot;timestamp&quot;:&quot;2025-12-14T20:04:24.953Z&quot;,&quot;service&quot;:&quot;stockly-api&quot;,&quot;level&quot;:&quot;INFO&quot;,&quot;traceId&quot;:&quot;cron-news-1765742664952&quot;,&quot;userId&quot;:null,&quot;path&quot;:&quot;/cron/news-alerts&quot;,&quot;message&quot;:&quot;Found news for 2 symbols: LXEO, AMZN&quot;,&quot;type&quot;:&quot;general&quot;}

{&quot;timestamp&quot;:&quot;2025-12-14T20:04:24.953Z&quot;,&quot;service&quot;:&quot;stockly-api&quot;,&quot;level&quot;:&quot;INFO&quot;,&quot;traceId&quot;:&quot;cron-news-1765742664952&quot;,&quot;userId&quot;:null,&quot;path&quot;:&quot;/cron/news-alerts&quot;,&quot;message&quot;:&quot;New article found (published today)&quot;,&quot;type&quot;:&quot;general&quot;,&quot;symbol&quot;:&quot;LXEO&quot;,&quot;title&quot;:&quot;LXEO News Today&quot;,&quot;publishedDate&quot;:&quot;2025-12-14T10:00:00Z&quot;}

{&quot;timestamp&quot;:&quot;2025-12-14T20:04:24.953Z&quot;,&quot;service&quot;:&quot;stockly-api&quot;,&quot;level&quot;:&quot;INFO&quot;,&quot;traceId&quot;:&quot;cron-news-1765742664952&quot;,&quot;userId&quot;:null,&quot;path&quot;:&quot;/cron/news-alerts&quot;,&quot;message&quot;:&quot;Found 1 users with LXEO in favorites: user1&quot;,&quot;type&quot;:&quot;general&quot;}

{&quot;timestamp&quot;:&quot;2025-12-14T20:04:24.953Z&quot;,&quot;service&quot;:&quot;stockly-api&quot;,&quot;level&quot;:&quot;INFO&quot;,&quot;traceId&quot;:&quot;cron-news-1765742664952&quot;,&quot;userId&quot;:null,&quot;path&quot;:&quot;/cron/news-alerts&quot;,&quot;message&quot;:&quot;Sent 2 notifications for LXEO news to 1 users&quot;,&quot;type&quot;:&quot;general&quot;}

{&quot;timestamp&quot;:&quot;2025-12-14T20:04:24.953Z&quot;,&quot;service&quot;:&quot;stockly-api&quot;,&quot;level&quot;:&quot;INFO&quot;,&quot;traceId&quot;:&quot;cron-news-1765742664952&quot;,&quot;userId&quot;:null,&quot;path&quot;:&quot;/cron/news-alerts&quot;,&quot;message&quot;:&quot;New article found (published today)&quot;,&quot;type&quot;:&quot;general&quot;,&quot;symbol&quot;:&quot;AMZN&quot;,&quot;title&quot;:&quot;AMZN News Today&quot;,&quot;publishedDate&quot;:&quot;2025-12-14T11:00:00Z&quot;}

{&quot;timestamp&quot;:&quot;2025-12-14T20:04:24.954Z&quot;,&quot;service&quot;:&quot;stockly-api&quot;,&quot;level&quot;:&quot;INFO&quot;,&quot;traceId&quot;:&quot;cron-news-1765742664952&quot;,&quot;userId&quot;:null,&quot;path&quot;:&quot;/cron/news-alerts&quot;,&quot;message&quot;:&quot;Found 1 users with AMZN in favorites: user1&quot;,&quot;type&quot;:&quot;general&quot;}

{&quot;timestamp&quot;:&quot;2025-12-14T20:04:24.954Z&quot;,&quot;service&quot;:&quot;stockly-api&quot;,&quot;level&quot;:&quot;INFO&quot;,&quot;traceId&quot;:&quot;cron-news-1765742664952&quot;,&quot;userId&quot;:null,&quot;path&quot;:&quot;/cron/news-alerts&quot;,&quot;message&quot;:&quot;Sent 2 notifications for AMZN news to 1 users&quot;,&quot;type&quot;:&quot;general&quot;}
{&quot;timestamp&quot;:&quot;2025-12-14T20:04:24.954Z&quot;,&quot;service&quot;:&quot;stockly-api&quot;,&quot;level&quot;:&quot;INFO&quot;,&quot;traceId&quot;:&quot;cron-news-1765742664952&quot;,&quot;userId&quot;:null,&quot;path&quot;:&quot;/cron/news-alerts&quot;,&quot;message&quot;:&quot;News alert cron job completed&quot;,&quot;type&quot;:&quot;general&quot;}

            </system-out>
        </testcase>
        <testcase classname="test/cron/news-alert-cron.spec.ts" name="News Alert Cron Job &gt; News Fetching and Filtering &gt; should only process news published today" time="0.025">
            <system-out>
{&quot;timestamp&quot;:&quot;2025-12-14T20:04:24.980Z&quot;,&quot;service&quot;:&quot;stockly-api&quot;,&quot;level&quot;:&quot;INFO&quot;,&quot;traceId&quot;:&quot;cron-news-1765742664980&quot;,&quot;userId&quot;:null,&quot;path&quot;:&quot;/cron/news-alerts&quot;,&quot;message&quot;:&quot;Starting news alert cron job&quot;,&quot;type&quot;:&quot;general&quot;}

{&quot;timestamp&quot;:&quot;2025-12-14T20:04:24.980Z&quot;,&quot;service&quot;:&quot;stockly-api&quot;,&quot;level&quot;:&quot;INFO&quot;,&quot;traceId&quot;:&quot;cron-news-1765742664980&quot;,&quot;userId&quot;:null,&quot;path&quot;:&quot;/cron/news-alerts&quot;,&quot;message&quot;:&quot;Checking news for 1 unique symbols: LXEO&quot;,&quot;type&quot;:&quot;general&quot;}
{&quot;timestamp&quot;:&quot;2025-12-14T20:04:24.980Z&quot;,&quot;service&quot;:&quot;stockly-api&quot;,&quot;level&quot;:&quot;INFO&quot;,&quot;traceId&quot;:&quot;cron-news-1765742664980&quot;,&quot;userId&quot;:null,&quot;path&quot;:&quot;/cron/news-alerts&quot;,&quot;message&quot;:&quot;Fetching news for all symbols published today (2025-12-14)&quot;,&quot;type&quot;:&quot;general&quot;}

{&quot;timestamp&quot;:&quot;2025-12-14T20:04:24.980Z&quot;,&quot;service&quot;:&quot;stockly-api&quot;,&quot;level&quot;:&quot;INFO&quot;,&quot;traceId&quot;:&quot;cron-news-1765742664980&quot;,&quot;userId&quot;:null,&quot;path&quot;:&quot;/cron/news-alerts&quot;,&quot;message&quot;:&quot;Fetched 2 news articles published today&quot;,&quot;type&quot;:&quot;general&quot;}
{&quot;timestamp&quot;:&quot;2025-12-14T20:04:24.980Z&quot;,&quot;service&quot;:&quot;stockly-api&quot;,&quot;level&quot;:&quot;INFO&quot;,&quot;traceId&quot;:&quot;cron-news-1765742664980&quot;,&quot;userId&quot;:null,&quot;path&quot;:&quot;/cron/news-alerts&quot;,&quot;message&quot;:&quot;Found news for 1 symbols: LXEO&quot;,&quot;type&quot;:&quot;general&quot;}

{&quot;timestamp&quot;:&quot;2025-12-14T20:04:24.980Z&quot;,&quot;service&quot;:&quot;stockly-api&quot;,&quot;level&quot;:&quot;INFO&quot;,&quot;traceId&quot;:&quot;cron-news-1765742664980&quot;,&quot;userId&quot;:null,&quot;path&quot;:&quot;/cron/news-alerts&quot;,&quot;message&quot;:&quot;New article found (published today)&quot;,&quot;type&quot;:&quot;general&quot;,&quot;symbol&quot;:&quot;LXEO&quot;,&quot;title&quot;:&quot;LXEO News Today&quot;,&quot;publishedDate&quot;:&quot;2025-12-14T10:00:00Z&quot;}

{&quot;timestamp&quot;:&quot;2025-12-14T20:04:24.981Z&quot;,&quot;service&quot;:&quot;stockly-api&quot;,&quot;level&quot;:&quot;INFO&quot;,&quot;traceId&quot;:&quot;cron-news-1765742664980&quot;,&quot;userId&quot;:null,&quot;path&quot;:&quot;/cron/news-alerts&quot;,&quot;message&quot;:&quot;Found 1 users with LXEO in favorites: user1&quot;,&quot;type&quot;:&quot;general&quot;}

{&quot;timestamp&quot;:&quot;2025-12-14T20:04:24.981Z&quot;,&quot;service&quot;:&quot;stockly-api&quot;,&quot;level&quot;:&quot;INFO&quot;,&quot;traceId&quot;:&quot;cron-news-1765742664980&quot;,&quot;userId&quot;:null,&quot;path&quot;:&quot;/cron/news-alerts&quot;,&quot;message&quot;:&quot;Sent 1 notifications for LXEO news to 1 users&quot;,&quot;type&quot;:&quot;general&quot;}
{&quot;timestamp&quot;:&quot;2025-12-14T20:04:24.981Z&quot;,&quot;service&quot;:&quot;stockly-api&quot;,&quot;level&quot;:&quot;DEBUG&quot;,&quot;traceId&quot;:&quot;cron-news-1765742664980&quot;,&quot;userId&quot;:null,&quot;path&quot;:&quot;/cron/news-alerts&quot;,&quot;message&quot;:&quot;Skipping article not published today: LXEO News Yesterday (2025-12-13T10:00:00Z)&quot;,&quot;type&quot;:&quot;general&quot;}
{&quot;timestamp&quot;:&quot;2025-12-14T20:04:24.981Z&quot;,&quot;service&quot;:&quot;stockly-api&quot;,&quot;level&quot;:&quot;INFO&quot;,&quot;traceId&quot;:&quot;cron-news-1765742664980&quot;,&quot;userId&quot;:null,&quot;path&quot;:&quot;/cron/news-alerts&quot;,&quot;message&quot;:&quot;News alert cron job completed&quot;,&quot;type&quot;:&quot;general&quot;}

            </system-out>
        </testcase>
        <testcase classname="test/cron/news-alert-cron.spec.ts" name="News Alert Cron Job &gt; News Fetching and Filtering &gt; should handle empty news response" time="0.029">
            <system-out>
{&quot;timestamp&quot;:&quot;2025-12-14T20:04:25.003Z&quot;,&quot;service&quot;:&quot;stockly-api&quot;,&quot;level&quot;:&quot;INFO&quot;,&quot;traceId&quot;:&quot;cron-news-1765742665003&quot;,&quot;userId&quot;:null,&quot;path&quot;:&quot;/cron/news-alerts&quot;,&quot;message&quot;:&quot;Starting news alert cron job&quot;,&quot;type&quot;:&quot;general&quot;}

{&quot;timestamp&quot;:&quot;2025-12-14T20:04:25.004Z&quot;,&quot;service&quot;:&quot;stockly-api&quot;,&quot;level&quot;:&quot;INFO&quot;,&quot;traceId&quot;:&quot;cron-news-1765742665003&quot;,&quot;userId&quot;:null,&quot;path&quot;:&quot;/cron/news-alerts&quot;,&quot;message&quot;:&quot;Checking news for 1 unique symbols: LXEO&quot;,&quot;type&quot;:&quot;general&quot;}
{&quot;timestamp&quot;:&quot;2025-12-14T20:04:25.004Z&quot;,&quot;service&quot;:&quot;stockly-api&quot;,&quot;level&quot;:&quot;INFO&quot;,&quot;traceId&quot;:&quot;cron-news-1765742665003&quot;,&quot;userId&quot;:null,&quot;path&quot;:&quot;/cron/news-alerts&quot;,&quot;message&quot;:&quot;Fetching news for all symbols published today (2025-12-14)&quot;,&quot;type&quot;:&quot;general&quot;}

{&quot;timestamp&quot;:&quot;2025-12-14T20:04:25.004Z&quot;,&quot;service&quot;:&quot;stockly-api&quot;,&quot;level&quot;:&quot;INFO&quot;,&quot;traceId&quot;:&quot;cron-news-1765742665003&quot;,&quot;userId&quot;:null,&quot;path&quot;:&quot;/cron/news-alerts&quot;,&quot;message&quot;:&quot;Fetched 0 news articles published today&quot;,&quot;type&quot;:&quot;general&quot;}
{&quot;timestamp&quot;:&quot;2025-12-14T20:04:25.004Z&quot;,&quot;service&quot;:&quot;stockly-api&quot;,&quot;level&quot;:&quot;INFO&quot;,&quot;traceId&quot;:&quot;cron-news-1765742665003&quot;,&quot;userId&quot;:null,&quot;path&quot;:&quot;/cron/news-alerts&quot;,&quot;message&quot;:&quot;Found news for 0 symbols: &quot;,&quot;type&quot;:&quot;general&quot;}
{&quot;timestamp&quot;:&quot;2025-12-14T20:04:25.004Z&quot;,&quot;service&quot;:&quot;stockly-api&quot;,&quot;level&quot;:&quot;INFO&quot;,&quot;traceId&quot;:&quot;cron-news-1765742665003&quot;,&quot;userId&quot;:null,&quot;path&quot;:&quot;/cron/news-alerts&quot;,&quot;message&quot;:&quot;News alert cron job completed&quot;,&quot;type&quot;:&quot;general&quot;}

            </system-out>
        </testcase>
        <testcase classname="test/cron/news-alert-cron.spec.ts" name="News Alert Cron Job &gt; Deduplication &gt; should not send duplicate notifications for the same article" time="0.033">
            <system-out>
{&quot;timestamp&quot;:&quot;2025-12-14T20:04:25.219Z&quot;,&quot;service&quot;:&quot;stockly-api&quot;,&quot;level&quot;:&quot;INFO&quot;,&quot;traceId&quot;:&quot;cron-news-1765742665219&quot;,&quot;userId&quot;:null,&quot;path&quot;:&quot;/cron/news-alerts&quot;,&quot;message&quot;:&quot;Starting news alert cron job&quot;,&quot;type&quot;:&quot;general&quot;}

{&quot;timestamp&quot;:&quot;2025-12-14T20:04:25.219Z&quot;,&quot;service&quot;:&quot;stockly-api&quot;,&quot;level&quot;:&quot;INFO&quot;,&quot;traceId&quot;:&quot;cron-news-1765742665219&quot;,&quot;userId&quot;:null,&quot;path&quot;:&quot;/cron/news-alerts&quot;,&quot;message&quot;:&quot;Checking news for 1 unique symbols: LXEO&quot;,&quot;type&quot;:&quot;general&quot;}
{&quot;timestamp&quot;:&quot;2025-12-14T20:04:25.219Z&quot;,&quot;service&quot;:&quot;stockly-api&quot;,&quot;level&quot;:&quot;INFO&quot;,&quot;traceId&quot;:&quot;cron-news-1765742665219&quot;,&quot;userId&quot;:null,&quot;path&quot;:&quot;/cron/news-alerts&quot;,&quot;message&quot;:&quot;Fetching news for all symbols published today (2025-12-14)&quot;,&quot;type&quot;:&quot;general&quot;}

{&quot;timestamp&quot;:&quot;2025-12-14T20:04:25.219Z&quot;,&quot;service&quot;:&quot;stockly-api&quot;,&quot;level&quot;:&quot;INFO&quot;,&quot;traceId&quot;:&quot;cron-news-1765742665219&quot;,&quot;userId&quot;:null,&quot;path&quot;:&quot;/cron/news-alerts&quot;,&quot;message&quot;:&quot;Fetched 1 news articles published today&quot;,&quot;type&quot;:&quot;general&quot;}
{&quot;timestamp&quot;:&quot;2025-12-14T20:04:25.219Z&quot;,&quot;service&quot;:&quot;stockly-api&quot;,&quot;level&quot;:&quot;INFO&quot;,&quot;traceId&quot;:&quot;cron-news-1765742665219&quot;,&quot;userId&quot;:null,&quot;path&quot;:&quot;/cron/news-alerts&quot;,&quot;message&quot;:&quot;Found news for 1 symbols: LXEO&quot;,&quot;type&quot;:&quot;general&quot;}

{&quot;timestamp&quot;:&quot;2025-12-14T20:04:25.219Z&quot;,&quot;service&quot;:&quot;stockly-api&quot;,&quot;level&quot;:&quot;INFO&quot;,&quot;traceId&quot;:&quot;cron-news-1765742665219&quot;,&quot;userId&quot;:null,&quot;path&quot;:&quot;/cron/news-alerts&quot;,&quot;message&quot;:&quot;New article found (published today)&quot;,&quot;type&quot;:&quot;general&quot;,&quot;symbol&quot;:&quot;LXEO&quot;,&quot;title&quot;:&quot;LXEO News Today&quot;,&quot;publishedDate&quot;:&quot;2025-12-14T10:00:00Z&quot;}

{&quot;timestamp&quot;:&quot;2025-12-14T20:04:25.219Z&quot;,&quot;service&quot;:&quot;stockly-api&quot;,&quot;level&quot;:&quot;INFO&quot;,&quot;traceId&quot;:&quot;cron-news-1765742665219&quot;,&quot;userId&quot;:null,&quot;path&quot;:&quot;/cron/news-alerts&quot;,&quot;message&quot;:&quot;Found 1 users with LXEO in favorites: user1&quot;,&quot;type&quot;:&quot;general&quot;}

{&quot;timestamp&quot;:&quot;2025-12-14T20:04:25.219Z&quot;,&quot;service&quot;:&quot;stockly-api&quot;,&quot;level&quot;:&quot;INFO&quot;,&quot;traceId&quot;:&quot;cron-news-1765742665219&quot;,&quot;userId&quot;:null,&quot;path&quot;:&quot;/cron/news-alerts&quot;,&quot;message&quot;:&quot;Sent 1 notifications for LXEO news to 1 users&quot;,&quot;type&quot;:&quot;general&quot;}
{&quot;timestamp&quot;:&quot;2025-12-14T20:04:25.219Z&quot;,&quot;service&quot;:&quot;stockly-api&quot;,&quot;level&quot;:&quot;INFO&quot;,&quot;traceId&quot;:&quot;cron-news-1765742665219&quot;,&quot;userId&quot;:null,&quot;path&quot;:&quot;/cron/news-alerts&quot;,&quot;message&quot;:&quot;News alert cron job completed&quot;,&quot;type&quot;:&quot;general&quot;}

{&quot;timestamp&quot;:&quot;2025-12-14T20:04:25.220Z&quot;,&quot;service&quot;:&quot;stockly-api&quot;,&quot;level&quot;:&quot;INFO&quot;,&quot;traceId&quot;:&quot;cron-news-1765742665220&quot;,&quot;userId&quot;:null,&quot;path&quot;:&quot;/cron/news-alerts&quot;,&quot;message&quot;:&quot;Starting news alert cron job&quot;,&quot;type&quot;:&quot;general&quot;}

{&quot;timestamp&quot;:&quot;2025-12-14T20:04:25.220Z&quot;,&quot;service&quot;:&quot;stockly-api&quot;,&quot;level&quot;:&quot;INFO&quot;,&quot;traceId&quot;:&quot;cron-news-1765742665220&quot;,&quot;userId&quot;:null,&quot;path&quot;:&quot;/cron/news-alerts&quot;,&quot;message&quot;:&quot;No favorite symbols found to check for news&quot;,&quot;type&quot;:&quot;general&quot;}

            </system-out>
            <system-err>
{&quot;timestamp&quot;:&quot;2025-12-14T20:04:25.220Z&quot;,&quot;service&quot;:&quot;stockly-api&quot;,&quot;level&quot;:&quot;WARN&quot;,&quot;traceId&quot;:&quot;cron-news-1765742665220&quot;,&quot;userId&quot;:&quot;user1&quot;,&quot;path&quot;:&quot;/cron/news-alerts&quot;,&quot;message&quot;:&quot;Failed to parse news_favorite_symbols&quot;,&quot;type&quot;:&quot;general&quot;}

            </system-err>
        </testcase>
        <testcase classname="test/cron/news-alert-cron.spec.ts" name="News Alert Cron Job &gt; Deduplication &gt; should mark articles as seen in KV after sending notification" time="0.196">
            <system-out>
{&quot;timestamp&quot;:&quot;2025-12-14T20:04:25.370Z&quot;,&quot;service&quot;:&quot;stockly-api&quot;,&quot;level&quot;:&quot;INFO&quot;,&quot;traceId&quot;:&quot;cron-news-1765742665370&quot;,&quot;userId&quot;:null,&quot;path&quot;:&quot;/cron/news-alerts&quot;,&quot;message&quot;:&quot;Starting news alert cron job&quot;,&quot;type&quot;:&quot;general&quot;}

{&quot;timestamp&quot;:&quot;2025-12-14T20:04:25.370Z&quot;,&quot;service&quot;:&quot;stockly-api&quot;,&quot;level&quot;:&quot;INFO&quot;,&quot;traceId&quot;:&quot;cron-news-1765742665370&quot;,&quot;userId&quot;:null,&quot;path&quot;:&quot;/cron/news-alerts&quot;,&quot;message&quot;:&quot;Checking news for 1 unique symbols: LXEO&quot;,&quot;type&quot;:&quot;general&quot;}
{&quot;timestamp&quot;:&quot;2025-12-14T20:04:25.370Z&quot;,&quot;service&quot;:&quot;stockly-api&quot;,&quot;level&quot;:&quot;INFO&quot;,&quot;traceId&quot;:&quot;cron-news-1765742665370&quot;,&quot;userId&quot;:null,&quot;path&quot;:&quot;/cron/news-alerts&quot;,&quot;message&quot;:&quot;Fetching news for all symbols published today (2025-12-14)&quot;,&quot;type&quot;:&quot;general&quot;}

{&quot;timestamp&quot;:&quot;2025-12-14T20:04:25.370Z&quot;,&quot;service&quot;:&quot;stockly-api&quot;,&quot;level&quot;:&quot;INFO&quot;,&quot;traceId&quot;:&quot;cron-news-1765742665370&quot;,&quot;userId&quot;:null,&quot;path&quot;:&quot;/cron/news-alerts&quot;,&quot;message&quot;:&quot;Fetched 1 news articles published today&quot;,&quot;type&quot;:&quot;general&quot;}
{&quot;timestamp&quot;:&quot;2025-12-14T20:04:25.370Z&quot;,&quot;service&quot;:&quot;stockly-api&quot;,&quot;level&quot;:&quot;INFO&quot;,&quot;traceId&quot;:&quot;cron-news-1765742665370&quot;,&quot;userId&quot;:null,&quot;path&quot;:&quot;/cron/news-alerts&quot;,&quot;message&quot;:&quot;Found news for 1 symbols: LXEO&quot;,&quot;type&quot;:&quot;general&quot;}

{&quot;timestamp&quot;:&quot;2025-12-14T20:04:25.370Z&quot;,&quot;service&quot;:&quot;stockly-api&quot;,&quot;level&quot;:&quot;INFO&quot;,&quot;traceId&quot;:&quot;cron-news-1765742665370&quot;,&quot;userId&quot;:null,&quot;path&quot;:&quot;/cron/news-alerts&quot;,&quot;message&quot;:&quot;New article found (published today)&quot;,&quot;type&quot;:&quot;general&quot;,&quot;symbol&quot;:&quot;LXEO&quot;,&quot;title&quot;:&quot;LXEO News Today&quot;,&quot;publishedDate&quot;:&quot;2025-12-14T10:00:00Z&quot;}

{&quot;timestamp&quot;:&quot;2025-12-14T20:04:25.370Z&quot;,&quot;service&quot;:&quot;stockly-api&quot;,&quot;level&quot;:&quot;INFO&quot;,&quot;traceId&quot;:&quot;cron-news-1765742665370&quot;,&quot;userId&quot;:null,&quot;path&quot;:&quot;/cron/news-alerts&quot;,&quot;message&quot;:&quot;Found 1 users with LXEO in favorites: user1&quot;,&quot;type&quot;:&quot;general&quot;}

{&quot;timestamp&quot;:&quot;2025-12-14T20:04:25.370Z&quot;,&quot;service&quot;:&quot;stockly-api&quot;,&quot;level&quot;:&quot;INFO&quot;,&quot;traceId&quot;:&quot;cron-news-1765742665370&quot;,&quot;userId&quot;:null,&quot;path&quot;:&quot;/cron/news-alerts&quot;,&quot;message&quot;:&quot;Sent 1 notifications for LXEO news to 1 users&quot;,&quot;type&quot;:&quot;general&quot;}
{&quot;timestamp&quot;:&quot;2025-12-14T20:04:25.370Z&quot;,&quot;service&quot;:&quot;stockly-api&quot;,&quot;level&quot;:&quot;INFO&quot;,&quot;traceId&quot;:&quot;cron-news-1765742665370&quot;,&quot;userId&quot;:null,&quot;path&quot;:&quot;/cron/news-alerts&quot;,&quot;message&quot;:&quot;News alert cron job completed&quot;,&quot;type&quot;:&quot;general&quot;}

            </system-out>
        </testcase>
        <testcase classname="test/cron/news-alert-cron.spec.ts" name="News Alert Cron Job &gt; Notification Sending &gt; should send notifications to all users who have the symbol in favorites" time="0.09">
            <system-out>
{&quot;timestamp&quot;:&quot;2025-12-14T20:04:25.545Z&quot;,&quot;service&quot;:&quot;stockly-api&quot;,&quot;level&quot;:&quot;INFO&quot;,&quot;traceId&quot;:&quot;cron-news-1765742665545&quot;,&quot;userId&quot;:null,&quot;path&quot;:&quot;/cron/news-alerts&quot;,&quot;message&quot;:&quot;Starting news alert cron job&quot;,&quot;type&quot;:&quot;general&quot;}

{&quot;timestamp&quot;:&quot;2025-12-14T20:04:25.545Z&quot;,&quot;service&quot;:&quot;stockly-api&quot;,&quot;level&quot;:&quot;INFO&quot;,&quot;traceId&quot;:&quot;cron-news-1765742665545&quot;,&quot;userId&quot;:null,&quot;path&quot;:&quot;/cron/news-alerts&quot;,&quot;message&quot;:&quot;Checking news for 4 unique symbols: LXEO, AMZN, AAPL, BABA&quot;,&quot;type&quot;:&quot;general&quot;}
{&quot;timestamp&quot;:&quot;2025-12-14T20:04:25.545Z&quot;,&quot;service&quot;:&quot;stockly-api&quot;,&quot;level&quot;:&quot;INFO&quot;,&quot;traceId&quot;:&quot;cron-news-1765742665545&quot;,&quot;userId&quot;:null,&quot;path&quot;:&quot;/cron/news-alerts&quot;,&quot;message&quot;:&quot;Fetching news for all symbols published today (2025-12-14)&quot;,&quot;type&quot;:&quot;general&quot;}

{&quot;timestamp&quot;:&quot;2025-12-14T20:04:25.545Z&quot;,&quot;service&quot;:&quot;stockly-api&quot;,&quot;level&quot;:&quot;INFO&quot;,&quot;traceId&quot;:&quot;cron-news-1765742665545&quot;,&quot;userId&quot;:null,&quot;path&quot;:&quot;/cron/news-alerts&quot;,&quot;message&quot;:&quot;Fetched 1 news articles published today&quot;,&quot;type&quot;:&quot;general&quot;}
{&quot;timestamp&quot;:&quot;2025-12-14T20:04:25.545Z&quot;,&quot;service&quot;:&quot;stockly-api&quot;,&quot;level&quot;:&quot;INFO&quot;,&quot;traceId&quot;:&quot;cron-news-1765742665545&quot;,&quot;userId&quot;:null,&quot;path&quot;:&quot;/cron/news-alerts&quot;,&quot;message&quot;:&quot;Found news for 1 symbols: LXEO&quot;,&quot;type&quot;:&quot;general&quot;}

{&quot;timestamp&quot;:&quot;2025-12-14T20:04:25.545Z&quot;,&quot;service&quot;:&quot;stockly-api&quot;,&quot;level&quot;:&quot;INFO&quot;,&quot;traceId&quot;:&quot;cron-news-1765742665545&quot;,&quot;userId&quot;:null,&quot;path&quot;:&quot;/cron/news-alerts&quot;,&quot;message&quot;:&quot;New article found (published today)&quot;,&quot;type&quot;:&quot;general&quot;,&quot;symbol&quot;:&quot;LXEO&quot;,&quot;title&quot;:&quot;LXEO News Today&quot;,&quot;publishedDate&quot;:&quot;2025-12-14T10:00:00Z&quot;}

{&quot;timestamp&quot;:&quot;2025-12-14T20:04:25.545Z&quot;,&quot;service&quot;:&quot;stockly-api&quot;,&quot;level&quot;:&quot;INFO&quot;,&quot;traceId&quot;:&quot;cron-news-1765742665545&quot;,&quot;userId&quot;:null,&quot;path&quot;:&quot;/cron/news-alerts&quot;,&quot;message&quot;:&quot;Found 2 users with LXEO in favorites: user1, user3&quot;,&quot;type&quot;:&quot;general&quot;}

{&quot;timestamp&quot;:&quot;2025-12-14T20:04:25.545Z&quot;,&quot;service&quot;:&quot;stockly-api&quot;,&quot;level&quot;:&quot;INFO&quot;,&quot;traceId&quot;:&quot;cron-news-1765742665545&quot;,&quot;userId&quot;:null,&quot;path&quot;:&quot;/cron/news-alerts&quot;,&quot;message&quot;:&quot;Sent 2 notifications for LXEO news to 2 users&quot;,&quot;type&quot;:&quot;general&quot;}
{&quot;timestamp&quot;:&quot;2025-12-14T20:04:25.546Z&quot;,&quot;service&quot;:&quot;stockly-api&quot;,&quot;level&quot;:&quot;INFO&quot;,&quot;traceId&quot;:&quot;cron-news-1765742665545&quot;,&quot;userId&quot;:null,&quot;path&quot;:&quot;/cron/news-alerts&quot;,&quot;message&quot;:&quot;News alert cron job completed&quot;,&quot;type&quot;:&quot;general&quot;}

            </system-out>
        </testcase>
        <testcase classname="test/cron/news-alert-cron.spec.ts" name="News Alert Cron Job &gt; Notification Sending &gt; should send separate notifications for different symbols" time="0.04">
            <system-out>
{&quot;timestamp&quot;:&quot;2025-12-14T20:04:25.602Z&quot;,&quot;service&quot;:&quot;stockly-api&quot;,&quot;level&quot;:&quot;INFO&quot;,&quot;traceId&quot;:&quot;cron-news-1765742665602&quot;,&quot;userId&quot;:null,&quot;path&quot;:&quot;/cron/news-alerts&quot;,&quot;message&quot;:&quot;Starting news alert cron job&quot;,&quot;type&quot;:&quot;general&quot;}

{&quot;timestamp&quot;:&quot;2025-12-14T20:04:25.603Z&quot;,&quot;service&quot;:&quot;stockly-api&quot;,&quot;level&quot;:&quot;INFO&quot;,&quot;traceId&quot;:&quot;cron-news-1765742665602&quot;,&quot;userId&quot;:null,&quot;path&quot;:&quot;/cron/news-alerts&quot;,&quot;message&quot;:&quot;Checking news for 2 unique symbols: LXEO, AMZN&quot;,&quot;type&quot;:&quot;general&quot;}
{&quot;timestamp&quot;:&quot;2025-12-14T20:04:25.603Z&quot;,&quot;service&quot;:&quot;stockly-api&quot;,&quot;level&quot;:&quot;INFO&quot;,&quot;traceId&quot;:&quot;cron-news-1765742665602&quot;,&quot;userId&quot;:null,&quot;path&quot;:&quot;/cron/news-alerts&quot;,&quot;message&quot;:&quot;Fetching news for all symbols published today (2025-12-14)&quot;,&quot;type&quot;:&quot;general&quot;}

{&quot;timestamp&quot;:&quot;2025-12-14T20:04:25.603Z&quot;,&quot;service&quot;:&quot;stockly-api&quot;,&quot;level&quot;:&quot;INFO&quot;,&quot;traceId&quot;:&quot;cron-news-1765742665602&quot;,&quot;userId&quot;:null,&quot;path&quot;:&quot;/cron/news-alerts&quot;,&quot;message&quot;:&quot;Fetched 2 news articles published today&quot;,&quot;type&quot;:&quot;general&quot;}
{&quot;timestamp&quot;:&quot;2025-12-14T20:04:25.603Z&quot;,&quot;service&quot;:&quot;stockly-api&quot;,&quot;level&quot;:&quot;INFO&quot;,&quot;traceId&quot;:&quot;cron-news-1765742665602&quot;,&quot;userId&quot;:null,&quot;path&quot;:&quot;/cron/news-alerts&quot;,&quot;message&quot;:&quot;Found news for 2 symbols: LXEO, AMZN&quot;,&quot;type&quot;:&quot;general&quot;}

{&quot;timestamp&quot;:&quot;2025-12-14T20:04:25.603Z&quot;,&quot;service&quot;:&quot;stockly-api&quot;,&quot;level&quot;:&quot;INFO&quot;,&quot;traceId&quot;:&quot;cron-news-1765742665602&quot;,&quot;userId&quot;:null,&quot;path&quot;:&quot;/cron/news-alerts&quot;,&quot;message&quot;:&quot;New article found (published today)&quot;,&quot;type&quot;:&quot;general&quot;,&quot;symbol&quot;:&quot;LXEO&quot;,&quot;title&quot;:&quot;LXEO News Today&quot;,&quot;publishedDate&quot;:&quot;2025-12-14T10:00:00Z&quot;}

{&quot;timestamp&quot;:&quot;2025-12-14T20:04:25.603Z&quot;,&quot;service&quot;:&quot;stockly-api&quot;,&quot;level&quot;:&quot;INFO&quot;,&quot;traceId&quot;:&quot;cron-news-1765742665602&quot;,&quot;userId&quot;:null,&quot;path&quot;:&quot;/cron/news-alerts&quot;,&quot;message&quot;:&quot;Found 1 users with LXEO in favorites: user1&quot;,&quot;type&quot;:&quot;general&quot;}

{&quot;timestamp&quot;:&quot;2025-12-14T20:04:25.603Z&quot;,&quot;service&quot;:&quot;stockly-api&quot;,&quot;level&quot;:&quot;INFO&quot;,&quot;traceId&quot;:&quot;cron-news-1765742665602&quot;,&quot;userId&quot;:null,&quot;path&quot;:&quot;/cron/news-alerts&quot;,&quot;message&quot;:&quot;Sent 2 notifications for LXEO news to 1 users&quot;,&quot;type&quot;:&quot;general&quot;}

{&quot;timestamp&quot;:&quot;2025-12-14T20:04:25.603Z&quot;,&quot;service&quot;:&quot;stockly-api&quot;,&quot;level&quot;:&quot;INFO&quot;,&quot;traceId&quot;:&quot;cron-news-1765742665602&quot;,&quot;userId&quot;:null,&quot;path&quot;:&quot;/cron/news-alerts&quot;,&quot;message&quot;:&quot;New article found (published today)&quot;,&quot;type&quot;:&quot;general&quot;,&quot;symbol&quot;:&quot;AMZN&quot;,&quot;title&quot;:&quot;AMZN News Today&quot;,&quot;publishedDate&quot;:&quot;2025-12-14T11:00:00Z&quot;}

{&quot;timestamp&quot;:&quot;2025-12-14T20:04:25.603Z&quot;,&quot;service&quot;:&quot;stockly-api&quot;,&quot;level&quot;:&quot;INFO&quot;,&quot;traceId&quot;:&quot;cron-news-1765742665602&quot;,&quot;userId&quot;:null,&quot;path&quot;:&quot;/cron/news-alerts&quot;,&quot;message&quot;:&quot;Found 2 users with AMZN in favorites: user1, user2&quot;,&quot;type&quot;:&quot;general&quot;}

{&quot;timestamp&quot;:&quot;2025-12-14T20:04:25.603Z&quot;,&quot;service&quot;:&quot;stockly-api&quot;,&quot;level&quot;:&quot;INFO&quot;,&quot;traceId&quot;:&quot;cron-news-1765742665602&quot;,&quot;userId&quot;:null,&quot;path&quot;:&quot;/cron/news-alerts&quot;,&quot;message&quot;:&quot;Sent 2 notifications for AMZN news to 2 users&quot;,&quot;type&quot;:&quot;general&quot;}
{&quot;timestamp&quot;:&quot;2025-12-14T20:04:25.603Z&quot;,&quot;service&quot;:&quot;stockly-api&quot;,&quot;level&quot;:&quot;INFO&quot;,&quot;traceId&quot;:&quot;cron-news-1765742665602&quot;,&quot;userId&quot;:null,&quot;path&quot;:&quot;/cron/news-alerts&quot;,&quot;message&quot;:&quot;News alert cron job completed&quot;,&quot;type&quot;:&quot;general&quot;}

            </system-out>
        </testcase>
        <testcase classname="test/cron/news-alert-cron.spec.ts" name="News Alert Cron Job &gt; Notification Sending &gt; should not send notifications if user has no push token" time="0.149">
            <system-out>
{&quot;timestamp&quot;:&quot;2025-12-14T20:04:25.730Z&quot;,&quot;service&quot;:&quot;stockly-api&quot;,&quot;level&quot;:&quot;INFO&quot;,&quot;traceId&quot;:&quot;cron-news-1765742665730&quot;,&quot;userId&quot;:null,&quot;path&quot;:&quot;/cron/news-alerts&quot;,&quot;message&quot;:&quot;Starting news alert cron job&quot;,&quot;type&quot;:&quot;general&quot;}

{&quot;timestamp&quot;:&quot;2025-12-14T20:04:25.730Z&quot;,&quot;service&quot;:&quot;stockly-api&quot;,&quot;level&quot;:&quot;INFO&quot;,&quot;traceId&quot;:&quot;cron-news-1765742665730&quot;,&quot;userId&quot;:null,&quot;path&quot;:&quot;/cron/news-alerts&quot;,&quot;message&quot;:&quot;Checking news for 1 unique symbols: LXEO&quot;,&quot;type&quot;:&quot;general&quot;}
{&quot;timestamp&quot;:&quot;2025-12-14T20:04:25.730Z&quot;,&quot;service&quot;:&quot;stockly-api&quot;,&quot;level&quot;:&quot;INFO&quot;,&quot;traceId&quot;:&quot;cron-news-1765742665730&quot;,&quot;userId&quot;:null,&quot;path&quot;:&quot;/cron/news-alerts&quot;,&quot;message&quot;:&quot;Fetching news for all symbols published today (2025-12-14)&quot;,&quot;type&quot;:&quot;general&quot;}

{&quot;timestamp&quot;:&quot;2025-12-14T20:04:25.730Z&quot;,&quot;service&quot;:&quot;stockly-api&quot;,&quot;level&quot;:&quot;INFO&quot;,&quot;traceId&quot;:&quot;cron-news-1765742665730&quot;,&quot;userId&quot;:null,&quot;path&quot;:&quot;/cron/news-alerts&quot;,&quot;message&quot;:&quot;Fetched 1 news articles published today&quot;,&quot;type&quot;:&quot;general&quot;}
{&quot;timestamp&quot;:&quot;2025-12-14T20:04:25.730Z&quot;,&quot;service&quot;:&quot;stockly-api&quot;,&quot;level&quot;:&quot;INFO&quot;,&quot;traceId&quot;:&quot;cron-news-1765742665730&quot;,&quot;userId&quot;:null,&quot;path&quot;:&quot;/cron/news-alerts&quot;,&quot;message&quot;:&quot;Found news for 1 symbols: LXEO&quot;,&quot;type&quot;:&quot;general&quot;}

{&quot;timestamp&quot;:&quot;2025-12-14T20:04:25.730Z&quot;,&quot;service&quot;:&quot;stockly-api&quot;,&quot;level&quot;:&quot;INFO&quot;,&quot;traceId&quot;:&quot;cron-news-1765742665730&quot;,&quot;userId&quot;:null,&quot;path&quot;:&quot;/cron/news-alerts&quot;,&quot;message&quot;:&quot;New article found (published today)&quot;,&quot;type&quot;:&quot;general&quot;,&quot;symbol&quot;:&quot;LXEO&quot;,&quot;title&quot;:&quot;LXEO News Today&quot;,&quot;publishedDate&quot;:&quot;2025-12-14T10:00:00Z&quot;}

{&quot;timestamp&quot;:&quot;2025-12-14T20:04:25.731Z&quot;,&quot;service&quot;:&quot;stockly-api&quot;,&quot;level&quot;:&quot;INFO&quot;,&quot;traceId&quot;:&quot;cron-news-1765742665730&quot;,&quot;userId&quot;:null,&quot;path&quot;:&quot;/cron/news-alerts&quot;,&quot;message&quot;:&quot;Found 1 users with LXEO in favorites: user1&quot;,&quot;type&quot;:&quot;general&quot;}

{&quot;timestamp&quot;:&quot;2025-12-14T20:04:25.731Z&quot;,&quot;service&quot;:&quot;stockly-api&quot;,&quot;level&quot;:&quot;INFO&quot;,&quot;traceId&quot;:&quot;cron-news-1765742665730&quot;,&quot;userId&quot;:null,&quot;path&quot;:&quot;/cron/news-alerts&quot;,&quot;message&quot;:&quot;Sent 0 notifications for LXEO news to 1 users&quot;,&quot;type&quot;:&quot;general&quot;}
{&quot;timestamp&quot;:&quot;2025-12-14T20:04:25.731Z&quot;,&quot;service&quot;:&quot;stockly-api&quot;,&quot;level&quot;:&quot;INFO&quot;,&quot;traceId&quot;:&quot;cron-news-1765742665730&quot;,&quot;userId&quot;:null,&quot;path&quot;:&quot;/cron/news-alerts&quot;,&quot;message&quot;:&quot;News alert cron job completed&quot;,&quot;type&quot;:&quot;general&quot;}

            </system-out>
        </testcase>
        <testcase classname="test/cron/news-alert-cron.spec.ts" name="News Alert Cron Job &gt; Error Handling &gt; should handle API fetch errors gracefully" time="0.035">
            <system-out>
{&quot;timestamp&quot;:&quot;2025-12-14T20:04:25.820Z&quot;,&quot;service&quot;:&quot;stockly-api&quot;,&quot;level&quot;:&quot;INFO&quot;,&quot;traceId&quot;:&quot;cron-news-1765742665820&quot;,&quot;userId&quot;:null,&quot;path&quot;:&quot;/cron/news-alerts&quot;,&quot;message&quot;:&quot;Starting news alert cron job&quot;,&quot;type&quot;:&quot;general&quot;}

{&quot;timestamp&quot;:&quot;2025-12-14T20:04:25.821Z&quot;,&quot;service&quot;:&quot;stockly-api&quot;,&quot;level&quot;:&quot;INFO&quot;,&quot;traceId&quot;:&quot;cron-news-1765742665820&quot;,&quot;userId&quot;:null,&quot;path&quot;:&quot;/cron/news-alerts&quot;,&quot;message&quot;:&quot;Checking news for 1 unique symbols: LXEO&quot;,&quot;type&quot;:&quot;general&quot;}
{&quot;timestamp&quot;:&quot;2025-12-14T20:04:25.821Z&quot;,&quot;service&quot;:&quot;stockly-api&quot;,&quot;level&quot;:&quot;INFO&quot;,&quot;traceId&quot;:&quot;cron-news-1765742665820&quot;,&quot;userId&quot;:null,&quot;path&quot;:&quot;/cron/news-alerts&quot;,&quot;message&quot;:&quot;Fetching news for all symbols published today (2025-12-14)&quot;,&quot;type&quot;:&quot;general&quot;}

            </system-out>
            <system-err>
{&quot;timestamp&quot;:&quot;2025-12-14T20:04:25.821Z&quot;,&quot;service&quot;:&quot;stockly-api&quot;,&quot;level&quot;:&quot;WARN&quot;,&quot;traceId&quot;:&quot;cron-news-1765742665820&quot;,&quot;userId&quot;:null,&quot;path&quot;:&quot;/cron/news-alerts&quot;,&quot;message&quot;:&quot;Failed to fetch news for symbols&quot;,&quot;type&quot;:&quot;general&quot;,&quot;status&quot;:500,&quot;symbols&quot;:&quot;LXEO&quot;}

            </system-err>
        </testcase>
        <testcase classname="test/cron/news-alert-cron.spec.ts" name="News Alert Cron Job &gt; Error Handling &gt; should handle network errors gracefully" time="0.037">
            <system-out>
{&quot;timestamp&quot;:&quot;2025-12-14T20:04:25.855Z&quot;,&quot;service&quot;:&quot;stockly-api&quot;,&quot;level&quot;:&quot;INFO&quot;,&quot;traceId&quot;:&quot;cron-news-1765742665855&quot;,&quot;userId&quot;:null,&quot;path&quot;:&quot;/cron/news-alerts&quot;,&quot;message&quot;:&quot;Starting news alert cron job&quot;,&quot;type&quot;:&quot;general&quot;}

{&quot;timestamp&quot;:&quot;2025-12-14T20:04:25.855Z&quot;,&quot;service&quot;:&quot;stockly-api&quot;,&quot;level&quot;:&quot;INFO&quot;,&quot;traceId&quot;:&quot;cron-news-1765742665855&quot;,&quot;userId&quot;:null,&quot;path&quot;:&quot;/cron/news-alerts&quot;,&quot;message&quot;:&quot;Checking news for 1 unique symbols: LXEO&quot;,&quot;type&quot;:&quot;general&quot;}
{&quot;timestamp&quot;:&quot;2025-12-14T20:04:25.855Z&quot;,&quot;service&quot;:&quot;stockly-api&quot;,&quot;level&quot;:&quot;INFO&quot;,&quot;traceId&quot;:&quot;cron-news-1765742665855&quot;,&quot;userId&quot;:null,&quot;path&quot;:&quot;/cron/news-alerts&quot;,&quot;message&quot;:&quot;Fetching news for all symbols published today (2025-12-14)&quot;,&quot;type&quot;:&quot;general&quot;}

{&quot;timestamp&quot;:&quot;2025-12-14T20:04:25.858Z&quot;,&quot;service&quot;:&quot;stockly-api&quot;,&quot;level&quot;:&quot;INFO&quot;,&quot;traceId&quot;:&quot;cron-news-1765742665855&quot;,&quot;userId&quot;:null,&quot;path&quot;:&quot;/cron/news-alerts&quot;,&quot;message&quot;:&quot;News alert cron job completed&quot;,&quot;type&quot;:&quot;general&quot;}

            </system-out>
            <system-err>
{&quot;timestamp&quot;:&quot;2025-12-14T20:04:25.855Z&quot;,&quot;service&quot;:&quot;stockly-api&quot;,&quot;level&quot;:&quot;ERROR&quot;,&quot;traceId&quot;:&quot;cron-news-1765742665855&quot;,&quot;userId&quot;:null,&quot;path&quot;:&quot;/cron/news-alerts&quot;,&quot;message&quot;:&quot;Failed to fetch news from FMP API&quot;,&quot;type&quot;:&quot;general&quot;,&quot;error&quot;:{&quot;name&quot;:&quot;Error&quot;,&quot;message&quot;:&quot;Network error&quot;,&quot;stack&quot;:&quot;Error: Network error\n    at /home/sngvahmed/workspace/stockly/api/test/cron/news-alert-cron.spec.ts:641:47\n    at home/sngvahmed/workspace/stockly/api/node_modules/@vitest/runner/dist/chunk-hooks.js:155:11\n    at home/sngvahmed/workspace/stockly/api/node_modules/@vitest/runner/dist/chunk-hooks.js:752:26\n    at home/sngvahmed/workspace/stockly/api/node_modules/@vitest/runner/dist/chunk-hooks.js:1897:20\n    at new Promise (&lt;anonymous&gt;)\n    at runWithTimeout (home/sngvahmed/workspace/stockly/api/node_modules/@vitest/runner/dist/chunk-hooks.js:1863:10)\n    at runTest (home/sngvahmed/workspace/stockly/api/node_modules/@vitest/runner/dist/chunk-hooks.js:1574:12)\n    at runSuite (home/sngvahmed/workspace/stockly/api/node_modules/@vitest/runner/dist/chunk-hooks.js:1729:8)\n    at runSuite (home/sngvahmed/workspace/stockly/api/node_modules/@vitest/runner/dist/chunk-hooks.js:1729:8)\n    at runSuite (home/sngvahmed/workspace/stockly/api/node_modules/@vitest/runner/dist/chunk-hooks.js:1729:8)&quot;}}

            </system-err>
        </testcase>
        <testcase classname="test/cron/news-alert-cron.spec.ts" name="News Alert Cron Job &gt; Error Handling &gt; should skip users with invalid favorite symbols JSON" time="0.025">
            <system-out>
{&quot;timestamp&quot;:&quot;2025-12-14T20:04:25.890Z&quot;,&quot;service&quot;:&quot;stockly-api&quot;,&quot;level&quot;:&quot;INFO&quot;,&quot;traceId&quot;:&quot;cron-news-1765742665890&quot;,&quot;userId&quot;:null,&quot;path&quot;:&quot;/cron/news-alerts&quot;,&quot;message&quot;:&quot;Starting news alert cron job&quot;,&quot;type&quot;:&quot;general&quot;}

{&quot;timestamp&quot;:&quot;2025-12-14T20:04:25.890Z&quot;,&quot;service&quot;:&quot;stockly-api&quot;,&quot;level&quot;:&quot;INFO&quot;,&quot;traceId&quot;:&quot;cron-news-1765742665890&quot;,&quot;userId&quot;:null,&quot;path&quot;:&quot;/cron/news-alerts&quot;,&quot;message&quot;:&quot;Checking news for 1 unique symbols: LXEO&quot;,&quot;type&quot;:&quot;general&quot;}
{&quot;timestamp&quot;:&quot;2025-12-14T20:04:25.890Z&quot;,&quot;service&quot;:&quot;stockly-api&quot;,&quot;level&quot;:&quot;INFO&quot;,&quot;traceId&quot;:&quot;cron-news-1765742665890&quot;,&quot;userId&quot;:null,&quot;path&quot;:&quot;/cron/news-alerts&quot;,&quot;message&quot;:&quot;Fetching news for all symbols published today (2025-12-14)&quot;,&quot;type&quot;:&quot;general&quot;}

{&quot;timestamp&quot;:&quot;2025-12-14T20:04:25.891Z&quot;,&quot;service&quot;:&quot;stockly-api&quot;,&quot;level&quot;:&quot;INFO&quot;,&quot;traceId&quot;:&quot;cron-news-1765742665890&quot;,&quot;userId&quot;:null,&quot;path&quot;:&quot;/cron/news-alerts&quot;,&quot;message&quot;:&quot;Fetched 0 news articles published today&quot;,&quot;type&quot;:&quot;general&quot;}
{&quot;timestamp&quot;:&quot;2025-12-14T20:04:25.891Z&quot;,&quot;service&quot;:&quot;stockly-api&quot;,&quot;level&quot;:&quot;INFO&quot;,&quot;traceId&quot;:&quot;cron-news-1765742665890&quot;,&quot;userId&quot;:null,&quot;path&quot;:&quot;/cron/news-alerts&quot;,&quot;message&quot;:&quot;Found news for 0 symbols: &quot;,&quot;type&quot;:&quot;general&quot;}
{&quot;timestamp&quot;:&quot;2025-12-14T20:04:25.891Z&quot;,&quot;service&quot;:&quot;stockly-api&quot;,&quot;level&quot;:&quot;INFO&quot;,&quot;traceId&quot;:&quot;cron-news-1765742665890&quot;,&quot;userId&quot;:null,&quot;path&quot;:&quot;/cron/news-alerts&quot;,&quot;message&quot;:&quot;News alert cron job completed&quot;,&quot;type&quot;:&quot;general&quot;}

            </system-out>
            <system-err>
{&quot;timestamp&quot;:&quot;2025-12-14T20:04:25.890Z&quot;,&quot;service&quot;:&quot;stockly-api&quot;,&quot;level&quot;:&quot;WARN&quot;,&quot;traceId&quot;:&quot;cron-news-1765742665890&quot;,&quot;userId&quot;:&quot;user2&quot;,&quot;path&quot;:&quot;/cron/news-alerts&quot;,&quot;message&quot;:&quot;Failed to parse news_favorite_symbols&quot;,&quot;type&quot;:&quot;general&quot;}

            </system-err>
        </testcase>
        <testcase classname="test/cron/news-alert-cron.spec.ts" name="News Alert Cron Job &gt; Edge Cases &gt; should handle no users with favorite symbols" time="0.029">
            <system-out>
{&quot;timestamp&quot;:&quot;2025-12-14T20:04:25.948Z&quot;,&quot;service&quot;:&quot;stockly-api&quot;,&quot;level&quot;:&quot;INFO&quot;,&quot;traceId&quot;:&quot;cron-news-1765742665948&quot;,&quot;userId&quot;:null,&quot;path&quot;:&quot;/cron/news-alerts&quot;,&quot;message&quot;:&quot;Starting news alert cron job&quot;,&quot;type&quot;:&quot;general&quot;}

{&quot;timestamp&quot;:&quot;2025-12-14T20:04:25.948Z&quot;,&quot;service&quot;:&quot;stockly-api&quot;,&quot;level&quot;:&quot;INFO&quot;,&quot;traceId&quot;:&quot;cron-news-1765742665948&quot;,&quot;userId&quot;:null,&quot;path&quot;:&quot;/cron/news-alerts&quot;,&quot;message&quot;:&quot;No favorite symbols found to check for news&quot;,&quot;type&quot;:&quot;general&quot;}

            </system-out>
        </testcase>
        <testcase classname="test/cron/news-alert-cron.spec.ts" name="News Alert Cron Job &gt; Edge Cases &gt; should handle missing alertsKv gracefully" time="0.028">
            <system-err>
{&quot;timestamp&quot;:&quot;2025-12-14T20:04:25.969Z&quot;,&quot;service&quot;:&quot;stockly-api&quot;,&quot;level&quot;:&quot;WARN&quot;,&quot;traceId&quot;:&quot;cron-news-1765742665969&quot;,&quot;userId&quot;:null,&quot;path&quot;:&quot;/cron/news-alerts&quot;,&quot;message&quot;:&quot;Alerts KV is not configured; skipping news alert cron&quot;,&quot;type&quot;:&quot;general&quot;}

            </system-err>
        </testcase>
        <testcase classname="test/cron/news-alert-cron.spec.ts" name="News Alert Cron Job &gt; Complete Use Case Flow &gt; should handle the complete use case: 3 PM check with multiple users and symbols" time="0.02">
            <system-out>
{&quot;timestamp&quot;:&quot;2025-12-14T20:04:26.016Z&quot;,&quot;service&quot;:&quot;stockly-api&quot;,&quot;level&quot;:&quot;INFO&quot;,&quot;traceId&quot;:&quot;cron-news-1765742666016&quot;,&quot;userId&quot;:null,&quot;path&quot;:&quot;/cron/news-alerts&quot;,&quot;message&quot;:&quot;Starting news alert cron job&quot;,&quot;type&quot;:&quot;general&quot;}

{&quot;timestamp&quot;:&quot;2025-12-14T20:04:26.016Z&quot;,&quot;service&quot;:&quot;stockly-api&quot;,&quot;level&quot;:&quot;INFO&quot;,&quot;traceId&quot;:&quot;cron-news-1765742666016&quot;,&quot;userId&quot;:null,&quot;path&quot;:&quot;/cron/news-alerts&quot;,&quot;message&quot;:&quot;Checking news for 4 unique symbols: LXEO, AMZN, AAPL, BABA&quot;,&quot;type&quot;:&quot;general&quot;}
{&quot;timestamp&quot;:&quot;2025-12-14T20:04:26.016Z&quot;,&quot;service&quot;:&quot;stockly-api&quot;,&quot;level&quot;:&quot;INFO&quot;,&quot;traceId&quot;:&quot;cron-news-1765742666016&quot;,&quot;userId&quot;:null,&quot;path&quot;:&quot;/cron/news-alerts&quot;,&quot;message&quot;:&quot;Fetching news for all symbols published today (2025-12-14)&quot;,&quot;type&quot;:&quot;general&quot;}

{&quot;timestamp&quot;:&quot;2025-12-14T20:04:26.016Z&quot;,&quot;service&quot;:&quot;stockly-api&quot;,&quot;level&quot;:&quot;INFO&quot;,&quot;traceId&quot;:&quot;cron-news-1765742666016&quot;,&quot;userId&quot;:null,&quot;path&quot;:&quot;/cron/news-alerts&quot;,&quot;message&quot;:&quot;Fetched 2 news articles published today&quot;,&quot;type&quot;:&quot;general&quot;}
{&quot;timestamp&quot;:&quot;2025-12-14T20:04:26.017Z&quot;,&quot;service&quot;:&quot;stockly-api&quot;,&quot;level&quot;:&quot;INFO&quot;,&quot;traceId&quot;:&quot;cron-news-1765742666016&quot;,&quot;userId&quot;:null,&quot;path&quot;:&quot;/cron/news-alerts&quot;,&quot;message&quot;:&quot;Found news for 2 symbols: LXEO, AMZN&quot;,&quot;type&quot;:&quot;general&quot;}

{&quot;timestamp&quot;:&quot;2025-12-14T20:04:26.017Z&quot;,&quot;service&quot;:&quot;stockly-api&quot;,&quot;level&quot;:&quot;INFO&quot;,&quot;traceId&quot;:&quot;cron-news-1765742666016&quot;,&quot;userId&quot;:null,&quot;path&quot;:&quot;/cron/news-alerts&quot;,&quot;message&quot;:&quot;New article found (published today)&quot;,&quot;type&quot;:&quot;general&quot;,&quot;symbol&quot;:&quot;LXEO&quot;,&quot;title&quot;:&quot;LXEO News Today&quot;,&quot;publishedDate&quot;:&quot;2025-12-14T10:00:00Z&quot;}

{&quot;timestamp&quot;:&quot;2025-12-14T20:04:26.017Z&quot;,&quot;service&quot;:&quot;stockly-api&quot;,&quot;level&quot;:&quot;INFO&quot;,&quot;traceId&quot;:&quot;cron-news-1765742666016&quot;,&quot;userId&quot;:null,&quot;path&quot;:&quot;/cron/news-alerts&quot;,&quot;message&quot;:&quot;Found 2 users with LXEO in favorites: user1, user3&quot;,&quot;type&quot;:&quot;general&quot;}

{&quot;timestamp&quot;:&quot;2025-12-14T20:04:26.017Z&quot;,&quot;service&quot;:&quot;stockly-api&quot;,&quot;level&quot;:&quot;INFO&quot;,&quot;traceId&quot;:&quot;cron-news-1765742666016&quot;,&quot;userId&quot;:null,&quot;path&quot;:&quot;/cron/news-alerts&quot;,&quot;message&quot;:&quot;Sent 3 notifications for LXEO news to 2 users&quot;,&quot;type&quot;:&quot;general&quot;}

{&quot;timestamp&quot;:&quot;2025-12-14T20:04:26.017Z&quot;,&quot;service&quot;:&quot;stockly-api&quot;,&quot;level&quot;:&quot;INFO&quot;,&quot;traceId&quot;:&quot;cron-news-1765742666016&quot;,&quot;userId&quot;:null,&quot;path&quot;:&quot;/cron/news-alerts&quot;,&quot;message&quot;:&quot;New article found (published today)&quot;,&quot;type&quot;:&quot;general&quot;,&quot;symbol&quot;:&quot;AMZN&quot;,&quot;title&quot;:&quot;AMZN News Today&quot;,&quot;publishedDate&quot;:&quot;2025-12-14T11:00:00Z&quot;}

{&quot;timestamp&quot;:&quot;2025-12-14T20:04:26.017Z&quot;,&quot;service&quot;:&quot;stockly-api&quot;,&quot;level&quot;:&quot;INFO&quot;,&quot;traceId&quot;:&quot;cron-news-1765742666016&quot;,&quot;userId&quot;:null,&quot;path&quot;:&quot;/cron/news-alerts&quot;,&quot;message&quot;:&quot;Found 2 users with AMZN in favorites: user1, user2&quot;,&quot;type&quot;:&quot;general&quot;}

{&quot;timestamp&quot;:&quot;2025-12-14T20:04:26.017Z&quot;,&quot;service&quot;:&quot;stockly-api&quot;,&quot;level&quot;:&quot;INFO&quot;,&quot;traceId&quot;:&quot;cron-news-1765742666016&quot;,&quot;userId&quot;:null,&quot;path&quot;:&quot;/cron/news-alerts&quot;,&quot;message&quot;:&quot;Sent 3 notifications for AMZN news to 2 users&quot;,&quot;type&quot;:&quot;general&quot;}
{&quot;timestamp&quot;:&quot;2025-12-14T20:04:26.017Z&quot;,&quot;service&quot;:&quot;stockly-api&quot;,&quot;level&quot;:&quot;INFO&quot;,&quot;traceId&quot;:&quot;cron-news-1765742666016&quot;,&quot;userId&quot;:null,&quot;path&quot;:&quot;/cron/news-alerts&quot;,&quot;message&quot;:&quot;News alert cron job completed&quot;,&quot;type&quot;:&quot;general&quot;}

            </system-out>
        </testcase>
        <testcase classname="test/cron/news-alert-cron.spec.ts" name="News Alert Cron Job &gt; Complete Use Case Flow &gt; should handle 7 PM check: no duplicate notifications for same articles" time="0.027">
            <system-out>
{&quot;timestamp&quot;:&quot;2025-12-14T20:04:26.038Z&quot;,&quot;service&quot;:&quot;stockly-api&quot;,&quot;level&quot;:&quot;INFO&quot;,&quot;traceId&quot;:&quot;cron-news-1765742666038&quot;,&quot;userId&quot;:null,&quot;path&quot;:&quot;/cron/news-alerts&quot;,&quot;message&quot;:&quot;Starting news alert cron job&quot;,&quot;type&quot;:&quot;general&quot;}

{&quot;timestamp&quot;:&quot;2025-12-14T20:04:26.038Z&quot;,&quot;service&quot;:&quot;stockly-api&quot;,&quot;level&quot;:&quot;INFO&quot;,&quot;traceId&quot;:&quot;cron-news-1765742666038&quot;,&quot;userId&quot;:null,&quot;path&quot;:&quot;/cron/news-alerts&quot;,&quot;message&quot;:&quot;Checking news for 1 unique symbols: LXEO&quot;,&quot;type&quot;:&quot;general&quot;}
{&quot;timestamp&quot;:&quot;2025-12-14T20:04:26.038Z&quot;,&quot;service&quot;:&quot;stockly-api&quot;,&quot;level&quot;:&quot;INFO&quot;,&quot;traceId&quot;:&quot;cron-news-1765742666038&quot;,&quot;userId&quot;:null,&quot;path&quot;:&quot;/cron/news-alerts&quot;,&quot;message&quot;:&quot;Fetching news for all symbols published today (2025-12-14)&quot;,&quot;type&quot;:&quot;general&quot;}

{&quot;timestamp&quot;:&quot;2025-12-14T20:04:26.038Z&quot;,&quot;service&quot;:&quot;stockly-api&quot;,&quot;level&quot;:&quot;INFO&quot;,&quot;traceId&quot;:&quot;cron-news-1765742666038&quot;,&quot;userId&quot;:null,&quot;path&quot;:&quot;/cron/news-alerts&quot;,&quot;message&quot;:&quot;Fetched 1 news articles published today&quot;,&quot;type&quot;:&quot;general&quot;}
{&quot;timestamp&quot;:&quot;2025-12-14T20:04:26.038Z&quot;,&quot;service&quot;:&quot;stockly-api&quot;,&quot;level&quot;:&quot;INFO&quot;,&quot;traceId&quot;:&quot;cron-news-1765742666038&quot;,&quot;userId&quot;:null,&quot;path&quot;:&quot;/cron/news-alerts&quot;,&quot;message&quot;:&quot;Found news for 1 symbols: LXEO&quot;,&quot;type&quot;:&quot;general&quot;}

{&quot;timestamp&quot;:&quot;2025-12-14T20:04:26.038Z&quot;,&quot;service&quot;:&quot;stockly-api&quot;,&quot;level&quot;:&quot;INFO&quot;,&quot;traceId&quot;:&quot;cron-news-1765742666038&quot;,&quot;userId&quot;:null,&quot;path&quot;:&quot;/cron/news-alerts&quot;,&quot;message&quot;:&quot;New article found (published today)&quot;,&quot;type&quot;:&quot;general&quot;,&quot;symbol&quot;:&quot;LXEO&quot;,&quot;title&quot;:&quot;LXEO News Today&quot;,&quot;publishedDate&quot;:&quot;2025-12-14T10:00:00Z&quot;}

{&quot;timestamp&quot;:&quot;2025-12-14T20:04:26.038Z&quot;,&quot;service&quot;:&quot;stockly-api&quot;,&quot;level&quot;:&quot;INFO&quot;,&quot;traceId&quot;:&quot;cron-news-1765742666038&quot;,&quot;userId&quot;:null,&quot;path&quot;:&quot;/cron/news-alerts&quot;,&quot;message&quot;:&quot;Found 1 users with LXEO in favorites: user1&quot;,&quot;type&quot;:&quot;general&quot;}

{&quot;timestamp&quot;:&quot;2025-12-14T20:04:26.038Z&quot;,&quot;service&quot;:&quot;stockly-api&quot;,&quot;level&quot;:&quot;INFO&quot;,&quot;traceId&quot;:&quot;cron-news-1765742666038&quot;,&quot;userId&quot;:null,&quot;path&quot;:&quot;/cron/news-alerts&quot;,&quot;message&quot;:&quot;Sent 1 notifications for LXEO news to 1 users&quot;,&quot;type&quot;:&quot;general&quot;}
{&quot;timestamp&quot;:&quot;2025-12-14T20:04:26.038Z&quot;,&quot;service&quot;:&quot;stockly-api&quot;,&quot;level&quot;:&quot;INFO&quot;,&quot;traceId&quot;:&quot;cron-news-1765742666038&quot;,&quot;userId&quot;:null,&quot;path&quot;:&quot;/cron/news-alerts&quot;,&quot;message&quot;:&quot;News alert cron job completed&quot;,&quot;type&quot;:&quot;general&quot;}

{&quot;timestamp&quot;:&quot;2025-12-14T20:04:26.038Z&quot;,&quot;service&quot;:&quot;stockly-api&quot;,&quot;level&quot;:&quot;INFO&quot;,&quot;traceId&quot;:&quot;cron-news-1765742666038&quot;,&quot;userId&quot;:null,&quot;path&quot;:&quot;/cron/news-alerts&quot;,&quot;message&quot;:&quot;Starting news alert cron job&quot;,&quot;type&quot;:&quot;general&quot;}

{&quot;timestamp&quot;:&quot;2025-12-14T20:04:26.038Z&quot;,&quot;service&quot;:&quot;stockly-api&quot;,&quot;level&quot;:&quot;INFO&quot;,&quot;traceId&quot;:&quot;cron-news-1765742666038&quot;,&quot;userId&quot;:null,&quot;path&quot;:&quot;/cron/news-alerts&quot;,&quot;message&quot;:&quot;No favorite symbols found to check for news&quot;,&quot;type&quot;:&quot;general&quot;}

            </system-out>
            <system-err>
{&quot;timestamp&quot;:&quot;2025-12-14T20:04:26.038Z&quot;,&quot;service&quot;:&quot;stockly-api&quot;,&quot;level&quot;:&quot;WARN&quot;,&quot;traceId&quot;:&quot;cron-news-1765742666038&quot;,&quot;userId&quot;:&quot;user1&quot;,&quot;path&quot;:&quot;/cron/news-alerts&quot;,&quot;message&quot;:&quot;Failed to parse news_favorite_symbols&quot;,&quot;type&quot;:&quot;general&quot;}

            </system-err>
        </testcase>
    </testsuite>
    <testsuite name="test/integration/alerts-flow.spec.ts" timestamp="2025-12-14T20:04:38.245Z" hostname="sngvahmed" tests="2" failures="0" errors="0" skipped="0" time="0.17">
        <testcase classname="test/integration/alerts-flow.spec.ts" name="Alerts Flow Integration &gt; Alert Creation to Notification Flow &gt; should complete flow: create alert -&gt; evaluate -&gt; send notification" time="0.026">
        </testcase>
        <testcase classname="test/integration/alerts-flow.spec.ts" name="Alerts Flow Integration &gt; Alert State Management &gt; should maintain alert state across evaluations" time="0.022">
        </testcase>
    </testsuite>
    <testsuite name="test/integration/auth-flow.spec.ts" timestamp="2025-12-14T20:04:38.245Z" hostname="sngvahmed" tests="2" failures="0" errors="0" skipped="0" time="0.167">
        <testcase classname="test/integration/auth-flow.spec.ts" name="Authentication Flow Integration &gt; Complete User Onboarding Flow &gt; should complete full flow: Google auth -&gt; username check -&gt; username set -&gt; get user" time="0.026">
        </testcase>
        <testcase classname="test/integration/auth-flow.spec.ts" name="Authentication Flow Integration &gt; Token Refresh Flow &gt; should refresh token and maintain session" time="0.022">
        </testcase>
    </testsuite>
    <testsuite name="test/integration/stock-flow.spec.ts" timestamp="2025-12-14T20:04:38.246Z" hostname="sngvahmed" tests="3" failures="0" errors="0" skipped="0" time="0.226">
        <testcase classname="test/integration/stock-flow.spec.ts" name="Stock Data Flow Integration &gt; Stock Search to Details Flow &gt; should complete flow: search -&gt; get stock -&gt; get details" time="0.044">
            <system-out>
{&quot;timestamp&quot;:&quot;2025-12-14T20:04:25.823Z&quot;,&quot;service&quot;:&quot;stockly-api-test&quot;,&quot;level&quot;:&quot;INFO&quot;,&quot;traceId&quot;:&quot;test-trace-id&quot;,&quot;userId&quot;:null,&quot;path&quot;:&quot;/test&quot;,&quot;message&quot;:&quot;No cache for AAPL&quot;,&quot;type&quot;:&quot;general&quot;,&quot;cacheStatus&quot;:&quot;MISS&quot;}

{&quot;timestamp&quot;:&quot;2025-12-14T20:04:25.825Z&quot;,&quot;service&quot;:&quot;stockly-api-test&quot;,&quot;level&quot;:&quot;DEBUG&quot;,&quot;traceId&quot;:&quot;test-trace-id&quot;,&quot;userId&quot;:null,&quot;path&quot;:&quot;/test&quot;,&quot;message&quot;:&quot;FMP API: GET /quote&quot;,&quot;type&quot;:&quot;api_call&quot;,&quot;apiProvider&quot;:&quot;FMP&quot;,&quot;endpoint&quot;:&quot;/quote&quot;,&quot;method&quot;:&quot;GET&quot;,&quot;latencyMs&quot;:1}

{&quot;timestamp&quot;:&quot;2025-12-14T20:04:25.825Z&quot;,&quot;service&quot;:&quot;stockly-api-test&quot;,&quot;level&quot;:&quot;DEBUG&quot;,&quot;traceId&quot;:&quot;test-trace-id&quot;,&quot;userId&quot;:null,&quot;path&quot;:&quot;/test&quot;,&quot;message&quot;:&quot;FMP API: GET /profile&quot;,&quot;type&quot;:&quot;api_call&quot;,&quot;apiProvider&quot;:&quot;FMP&quot;,&quot;endpoint&quot;:&quot;/profile&quot;,&quot;method&quot;:&quot;GET&quot;,&quot;latencyMs&quot;:0}

{&quot;timestamp&quot;:&quot;2025-12-14T20:04:25.825Z&quot;,&quot;service&quot;:&quot;stockly-api-test&quot;,&quot;level&quot;:&quot;DEBUG&quot;,&quot;traceId&quot;:&quot;test-trace-id&quot;,&quot;userId&quot;:null,&quot;path&quot;:&quot;/test&quot;,&quot;message&quot;:&quot;Profile API response&quot;,&quot;type&quot;:&quot;general&quot;,&quot;endpoint&quot;:&quot;https://financialmodelingprep.com/stable/profile?symbol=AAPL&amp;apikey=z5xjUUlsab7zBKntL5QnMzWyPuq2iWsM&quot;,&quot;responseType&quot;:&quot;object&quot;,&quot;responseLength&quot;:&quot;N/A&quot;}
{&quot;timestamp&quot;:&quot;2025-12-14T20:04:25.825Z&quot;,&quot;service&quot;:&quot;stockly-api-test&quot;,&quot;level&quot;:&quot;DEBUG&quot;,&quot;traceId&quot;:&quot;test-trace-id&quot;,&quot;userId&quot;:null,&quot;path&quot;:&quot;/test&quot;,&quot;message&quot;:&quot;Profile fetched but no description field&quot;,&quot;type&quot;:&quot;general&quot;,&quot;profileKeys&quot;:[&quot;price&quot;,&quot;symbol&quot;]}

{&quot;timestamp&quot;:&quot;2025-12-14T20:04:25.825Z&quot;,&quot;service&quot;:&quot;stockly-api-test&quot;,&quot;level&quot;:&quot;DEBUG&quot;,&quot;traceId&quot;:&quot;test-trace-id&quot;,&quot;userId&quot;:null,&quot;path&quot;:&quot;/test&quot;,&quot;message&quot;:&quot;Final description resolved&quot;,&quot;type&quot;:&quot;general&quot;,&quot;hasDescription&quot;:false,&quot;descriptionLength&quot;:0,&quot;source&quot;:&quot;none&quot;}

[fetchAndSaveHistoricalPrice] Starting fetch for AAPL from FMP API
[fetchAndSaveHistoricalPrice] Fetching from: https://financialmodelingprep.com/stable/historical-chart/30min?symbol=AAPL&amp;apikey=***

[fetchAndSaveHistoricalPrice] Received single record from FMP API
[fetchAndSaveHistoricalPrice] FMP API returned 1 records for AAPL
[fetchAndSaveHistoricalPrice] Sample record structure: {
  date: undefined,
  hasOpen: false,
  hasHigh: false,
  hasLow: false,
  hasClose: false,
  hasPrice: true,
  keys: [ &apos;price&apos;, &apos;symbol&apos; ]
}
Saved 0 daily candles (aggregated from 1 1-hour records) for AAPL with OHLC data

Cache miss for stock details: AAPL, fetching...

            </system-out>
            <system-err>
[fetchAndSaveHistoricalPrice] Failed to parse date from timestamp undefined, skipping record

            </system-err>
        </testcase>
        <testcase classname="test/integration/stock-flow.spec.ts" name="Stock Data Flow Integration &gt; Batch Stock Retrieval Flow &gt; should retrieve multiple stocks efficiently" time="0.032">
        </testcase>
        <testcase classname="test/integration/stock-flow.spec.ts" name="Stock Data Flow Integration &gt; Caching Flow &gt; should cache stock data and serve from cache on subsequent requests" time="0.021">
            <system-out>
{&quot;timestamp&quot;:&quot;2025-12-14T20:04:25.949Z&quot;,&quot;service&quot;:&quot;stockly-api-test&quot;,&quot;level&quot;:&quot;INFO&quot;,&quot;traceId&quot;:&quot;test-trace-id&quot;,&quot;userId&quot;:null,&quot;path&quot;:&quot;/test&quot;,&quot;message&quot;:&quot;Cache hit for AAPL&quot;,&quot;type&quot;:&quot;general&quot;,&quot;ageSeconds&quot;:0,&quot;pollingIntervalSec&quot;:30,&quot;cacheStatus&quot;:&quot;HIT&quot;}

{&quot;timestamp&quot;:&quot;2025-12-14T20:04:25.950Z&quot;,&quot;service&quot;:&quot;stockly-api-test&quot;,&quot;level&quot;:&quot;INFO&quot;,&quot;traceId&quot;:&quot;test-trace-id&quot;,&quot;userId&quot;:null,&quot;path&quot;:&quot;/test&quot;,&quot;message&quot;:&quot;Cache hit for AAPL&quot;,&quot;type&quot;:&quot;general&quot;,&quot;ageSeconds&quot;:0,&quot;pollingIntervalSec&quot;:30,&quot;cacheStatus&quot;:&quot;HIT&quot;}

            </system-out>
        </testcase>
    </testsuite>
    <testsuite name="test/logging/d1-wrapper.spec.ts" timestamp="2025-12-14T20:04:38.247Z" hostname="sngvahmed" tests="15" failures="0" errors="0" skipped="0" time="1.078">
        <testcase classname="test/logging/d1-wrapper.spec.ts" name="LoggedD1Database &gt; prepare &gt; should wrap prepared statement" time="0.036">
        </testcase>
        <testcase classname="test/logging/d1-wrapper.spec.ts" name="LoggedD1Database &gt; exec &gt; should log successful exec operation" time="0.068">
            <system-out>
{&quot;timestamp&quot;:&quot;2025-12-14T20:04:24.671Z&quot;,&quot;service&quot;:&quot;test&quot;,&quot;level&quot;:&quot;DEBUG&quot;,&quot;traceId&quot;:&quot;test-trace&quot;,&quot;userId&quot;:null,&quot;path&quot;:&quot;/test&quot;,&quot;message&quot;:&quot;D1 exec: SELECT * FROM alerts&quot;,&quot;type&quot;:&quot;data_operation&quot;,&quot;operation&quot;:&quot;d1&quot;,&quot;query&quot;:&quot;SELECT * FROM alerts&quot;,&quot;latencyMs&quot;:0,&quot;cacheStatus&quot;:&quot;N/A&quot;}

            </system-out>
        </testcase>
        <testcase classname="test/logging/d1-wrapper.spec.ts" name="LoggedD1Database &gt; exec &gt; should log failed exec operation" time="0.025">
            <system-out>
{&quot;timestamp&quot;:&quot;2025-12-14T20:04:24.699Z&quot;,&quot;service&quot;:&quot;test&quot;,&quot;level&quot;:&quot;DEBUG&quot;,&quot;traceId&quot;:&quot;test-trace&quot;,&quot;userId&quot;:null,&quot;path&quot;:&quot;/test&quot;,&quot;message&quot;:&quot;D1 exec failed: SELECT * FROM alerts&quot;,&quot;type&quot;:&quot;data_operation&quot;,&quot;operation&quot;:&quot;d1&quot;,&quot;query&quot;:&quot;SELECT * FROM alerts&quot;,&quot;latencyMs&quot;:0,&quot;cacheStatus&quot;:&quot;N/A&quot;,&quot;error&quot;:&quot;Database error&quot;}

            </system-out>
        </testcase>
        <testcase classname="test/logging/d1-wrapper.spec.ts" name="LoggedD1Database &gt; batch &gt; should log successful batch operation" time="0.054">
            <system-out>
{&quot;timestamp&quot;:&quot;2025-12-14T20:04:24.779Z&quot;,&quot;service&quot;:&quot;test&quot;,&quot;level&quot;:&quot;DEBUG&quot;,&quot;traceId&quot;:&quot;test-trace&quot;,&quot;userId&quot;:null,&quot;path&quot;:&quot;/test&quot;,&quot;message&quot;:&quot;D1 batch: BATCH(2 statements)&quot;,&quot;type&quot;:&quot;data_operation&quot;,&quot;operation&quot;:&quot;d1&quot;,&quot;query&quot;:&quot;BATCH(2 statements)&quot;,&quot;latencyMs&quot;:0,&quot;cacheStatus&quot;:&quot;N/A&quot;}

            </system-out>
        </testcase>
        <testcase classname="test/logging/d1-wrapper.spec.ts" name="LoggedD1Database &gt; batch &gt; should log failed batch operation" time="0.033">
            <system-out>
{&quot;timestamp&quot;:&quot;2025-12-14T20:04:24.810Z&quot;,&quot;service&quot;:&quot;test&quot;,&quot;level&quot;:&quot;DEBUG&quot;,&quot;traceId&quot;:&quot;test-trace&quot;,&quot;userId&quot;:null,&quot;path&quot;:&quot;/test&quot;,&quot;message&quot;:&quot;D1 batch failed: BATCH(2 statements)&quot;,&quot;type&quot;:&quot;data_operation&quot;,&quot;operation&quot;:&quot;d1&quot;,&quot;query&quot;:&quot;BATCH(2 statements)&quot;,&quot;latencyMs&quot;:0,&quot;cacheStatus&quot;:&quot;N/A&quot;,&quot;error&quot;:&quot;Batch failed&quot;}

            </system-out>
        </testcase>
        <testcase classname="test/logging/d1-wrapper.spec.ts" name="LoggedD1Database &gt; LoggedD1PreparedStatement &gt; bind &gt; should chain bind calls" time="0.028">
        </testcase>
        <testcase classname="test/logging/d1-wrapper.spec.ts" name="LoggedD1Database &gt; LoggedD1PreparedStatement &gt; bind &gt; should support multiple bind calls" time="0.026">
        </testcase>
        <testcase classname="test/logging/d1-wrapper.spec.ts" name="LoggedD1Database &gt; LoggedD1PreparedStatement &gt; first &gt; should log successful first operation" time="0.048">
            <system-out>
{&quot;timestamp&quot;:&quot;2025-12-14T20:04:24.996Z&quot;,&quot;service&quot;:&quot;test&quot;,&quot;level&quot;:&quot;DEBUG&quot;,&quot;traceId&quot;:&quot;test-trace&quot;,&quot;userId&quot;:null,&quot;path&quot;:&quot;/test&quot;,&quot;message&quot;:&quot;D1 first: SELECT * FROM alerts WHERE id = ?&quot;,&quot;type&quot;:&quot;data_operation&quot;,&quot;operation&quot;:&quot;d1&quot;,&quot;query&quot;:&quot;SELECT * FROM alerts WHERE id = ?&quot;,&quot;latencyMs&quot;:0,&quot;cacheStatus&quot;:&quot;N/A&quot;}

            </system-out>
        </testcase>
        <testcase classname="test/logging/d1-wrapper.spec.ts" name="LoggedD1Database &gt; LoggedD1PreparedStatement &gt; first &gt; should log failed first operation" time="0.025">
            <system-out>
{&quot;timestamp&quot;:&quot;2025-12-14T20:04:25.022Z&quot;,&quot;service&quot;:&quot;test&quot;,&quot;level&quot;:&quot;DEBUG&quot;,&quot;traceId&quot;:&quot;test-trace&quot;,&quot;userId&quot;:null,&quot;path&quot;:&quot;/test&quot;,&quot;message&quot;:&quot;D1 first failed: SELECT * FROM alerts WHERE id = ?&quot;,&quot;type&quot;:&quot;data_operation&quot;,&quot;operation&quot;:&quot;d1&quot;,&quot;query&quot;:&quot;SELECT * FROM alerts WHERE id = ?&quot;,&quot;latencyMs&quot;:0,&quot;cacheStatus&quot;:&quot;N/A&quot;,&quot;error&quot;:&quot;Query failed&quot;}

            </system-out>
        </testcase>
        <testcase classname="test/logging/d1-wrapper.spec.ts" name="LoggedD1Database &gt; LoggedD1PreparedStatement &gt; all &gt; should log successful all operation" time="0.023">
            <system-out>
{&quot;timestamp&quot;:&quot;2025-12-14T20:04:25.064Z&quot;,&quot;service&quot;:&quot;test&quot;,&quot;level&quot;:&quot;DEBUG&quot;,&quot;traceId&quot;:&quot;test-trace&quot;,&quot;userId&quot;:null,&quot;path&quot;:&quot;/test&quot;,&quot;message&quot;:&quot;D1 all: SELECT * FROM alerts WHERE id = ?&quot;,&quot;type&quot;:&quot;data_operation&quot;,&quot;operation&quot;:&quot;d1&quot;,&quot;query&quot;:&quot;SELECT * FROM alerts WHERE id = ?&quot;,&quot;latencyMs&quot;:0,&quot;cacheStatus&quot;:&quot;N/A&quot;}

            </system-out>
        </testcase>
        <testcase classname="test/logging/d1-wrapper.spec.ts" name="LoggedD1Database &gt; LoggedD1PreparedStatement &gt; all &gt; should log failed all operation" time="0.044">
            <system-out>
{&quot;timestamp&quot;:&quot;2025-12-14T20:04:25.110Z&quot;,&quot;service&quot;:&quot;test&quot;,&quot;level&quot;:&quot;DEBUG&quot;,&quot;traceId&quot;:&quot;test-trace&quot;,&quot;userId&quot;:null,&quot;path&quot;:&quot;/test&quot;,&quot;message&quot;:&quot;D1 all failed: SELECT * FROM alerts WHERE id = ?&quot;,&quot;type&quot;:&quot;data_operation&quot;,&quot;operation&quot;:&quot;d1&quot;,&quot;query&quot;:&quot;SELECT * FROM alerts WHERE id = ?&quot;,&quot;latencyMs&quot;:0,&quot;cacheStatus&quot;:&quot;N/A&quot;,&quot;error&quot;:&quot;Query failed&quot;}

            </system-out>
        </testcase>
        <testcase classname="test/logging/d1-wrapper.spec.ts" name="LoggedD1Database &gt; LoggedD1PreparedStatement &gt; run &gt; should log successful run operation" time="0.023">
            <system-out>
{&quot;timestamp&quot;:&quot;2025-12-14T20:04:25.154Z&quot;,&quot;service&quot;:&quot;test&quot;,&quot;level&quot;:&quot;DEBUG&quot;,&quot;traceId&quot;:&quot;test-trace&quot;,&quot;userId&quot;:null,&quot;path&quot;:&quot;/test&quot;,&quot;message&quot;:&quot;D1 run: SELECT * FROM alerts WHERE id = ?&quot;,&quot;type&quot;:&quot;data_operation&quot;,&quot;operation&quot;:&quot;d1&quot;,&quot;query&quot;:&quot;SELECT * FROM alerts WHERE id = ?&quot;,&quot;latencyMs&quot;:0,&quot;cacheStatus&quot;:&quot;N/A&quot;}

            </system-out>
        </testcase>
        <testcase classname="test/logging/d1-wrapper.spec.ts" name="LoggedD1Database &gt; LoggedD1PreparedStatement &gt; run &gt; should log failed run operation" time="0.037">
            <system-out>
{&quot;timestamp&quot;:&quot;2025-12-14T20:04:25.179Z&quot;,&quot;service&quot;:&quot;test&quot;,&quot;level&quot;:&quot;DEBUG&quot;,&quot;traceId&quot;:&quot;test-trace&quot;,&quot;userId&quot;:null,&quot;path&quot;:&quot;/test&quot;,&quot;message&quot;:&quot;D1 run failed: SELECT * FROM alerts WHERE id = ?&quot;,&quot;type&quot;:&quot;data_operation&quot;,&quot;operation&quot;:&quot;d1&quot;,&quot;query&quot;:&quot;SELECT * FROM alerts WHERE id = ?&quot;,&quot;latencyMs&quot;:0,&quot;cacheStatus&quot;:&quot;N/A&quot;,&quot;error&quot;:&quot;Update failed&quot;}

            </system-out>
        </testcase>
        <testcase classname="test/logging/d1-wrapper.spec.ts" name="LoggedD1Database &gt; LoggedD1PreparedStatement &gt; latency measurement &gt; should measure latency accurately" time="0.051">
            <system-out>
{&quot;timestamp&quot;:&quot;2025-12-14T20:04:25.264Z&quot;,&quot;service&quot;:&quot;test&quot;,&quot;level&quot;:&quot;DEBUG&quot;,&quot;traceId&quot;:&quot;test-trace&quot;,&quot;userId&quot;:null,&quot;path&quot;:&quot;/test&quot;,&quot;message&quot;:&quot;D1 first: SELECT * FROM alerts WHERE id = ?&quot;,&quot;type&quot;:&quot;data_operation&quot;,&quot;operation&quot;:&quot;d1&quot;,&quot;query&quot;:&quot;SELECT * FROM alerts WHERE id = ?&quot;,&quot;latencyMs&quot;:11,&quot;cacheStatus&quot;:&quot;N/A&quot;}

            </system-out>
        </testcase>
        <testcase classname="test/logging/d1-wrapper.spec.ts" name="LoggedD1Database &gt; LoggedD1PreparedStatement &gt; error propagation &gt; should re-throw errors after logging" time="0.049">
            <system-out>
{&quot;timestamp&quot;:&quot;2025-12-14T20:04:25.382Z&quot;,&quot;service&quot;:&quot;test&quot;,&quot;level&quot;:&quot;DEBUG&quot;,&quot;traceId&quot;:&quot;test-trace&quot;,&quot;userId&quot;:null,&quot;path&quot;:&quot;/test&quot;,&quot;message&quot;:&quot;D1 first failed: SELECT * FROM alerts WHERE id = ?&quot;,&quot;type&quot;:&quot;data_operation&quot;,&quot;operation&quot;:&quot;d1&quot;,&quot;query&quot;:&quot;SELECT * FROM alerts WHERE id = ?&quot;,&quot;latencyMs&quot;:0,&quot;cacheStatus&quot;:&quot;N/A&quot;,&quot;error&quot;:&quot;Database error&quot;}

            </system-out>
        </testcase>
    </testsuite>
    <testsuite name="test/logging/kv-wrapper.spec.ts" timestamp="2025-12-14T20:04:38.249Z" hostname="sngvahmed" tests="26" failures="0" errors="0" skipped="0" time="1.388">
        <testcase classname="test/logging/kv-wrapper.spec.ts" name="LoggedKVNamespace &gt; get &gt; should log HIT when value exists (text)" time="0.037">
            <system-out>
{&quot;timestamp&quot;:&quot;2025-12-14T20:04:24.585Z&quot;,&quot;service&quot;:&quot;test&quot;,&quot;level&quot;:&quot;DEBUG&quot;,&quot;traceId&quot;:&quot;test-trace&quot;,&quot;userId&quot;:null,&quot;path&quot;:&quot;/test&quot;,&quot;message&quot;:&quot;KV get: cache:key&quot;,&quot;type&quot;:&quot;data_operation&quot;,&quot;operation&quot;:&quot;kv&quot;,&quot;key&quot;:&quot;cache:key&quot;,&quot;latencyMs&quot;:0,&quot;cacheStatus&quot;:&quot;HIT&quot;}

            </system-out>
        </testcase>
        <testcase classname="test/logging/kv-wrapper.spec.ts" name="LoggedKVNamespace &gt; get &gt; should log MISS when value is null (text)" time="0.031">
            <system-out>
{&quot;timestamp&quot;:&quot;2025-12-14T20:04:24.616Z&quot;,&quot;service&quot;:&quot;test&quot;,&quot;level&quot;:&quot;DEBUG&quot;,&quot;traceId&quot;:&quot;test-trace&quot;,&quot;userId&quot;:null,&quot;path&quot;:&quot;/test&quot;,&quot;message&quot;:&quot;KV get: cache:key&quot;,&quot;type&quot;:&quot;data_operation&quot;,&quot;operation&quot;:&quot;kv&quot;,&quot;key&quot;:&quot;cache:key&quot;,&quot;latencyMs&quot;:0,&quot;cacheStatus&quot;:&quot;MISS&quot;}

            </system-out>
        </testcase>
        <testcase classname="test/logging/kv-wrapper.spec.ts" name="LoggedKVNamespace &gt; get &gt; should log HIT when value exists (json)" time="0.061">
            <system-out>
{&quot;timestamp&quot;:&quot;2025-12-14T20:04:24.683Z&quot;,&quot;service&quot;:&quot;test&quot;,&quot;level&quot;:&quot;DEBUG&quot;,&quot;traceId&quot;:&quot;test-trace&quot;,&quot;userId&quot;:null,&quot;path&quot;:&quot;/test&quot;,&quot;message&quot;:&quot;KV get: cache:key&quot;,&quot;type&quot;:&quot;data_operation&quot;,&quot;operation&quot;:&quot;kv&quot;,&quot;key&quot;:&quot;cache:key&quot;,&quot;latencyMs&quot;:0,&quot;cacheStatus&quot;:&quot;HIT&quot;}

            </system-out>
        </testcase>
        <testcase classname="test/logging/kv-wrapper.spec.ts" name="LoggedKVNamespace &gt; get &gt; should log MISS when value is null (json)" time="0.028">
            <system-out>
{&quot;timestamp&quot;:&quot;2025-12-14T20:04:24.710Z&quot;,&quot;service&quot;:&quot;test&quot;,&quot;level&quot;:&quot;DEBUG&quot;,&quot;traceId&quot;:&quot;test-trace&quot;,&quot;userId&quot;:null,&quot;path&quot;:&quot;/test&quot;,&quot;message&quot;:&quot;KV get: cache:key&quot;,&quot;type&quot;:&quot;data_operation&quot;,&quot;operation&quot;:&quot;kv&quot;,&quot;key&quot;:&quot;cache:key&quot;,&quot;latencyMs&quot;:0,&quot;cacheStatus&quot;:&quot;MISS&quot;}

            </system-out>
        </testcase>
        <testcase classname="test/logging/kv-wrapper.spec.ts" name="LoggedKVNamespace &gt; get &gt; should handle arrayBuffer type" time="0.026">
            <system-out>
{&quot;timestamp&quot;:&quot;2025-12-14T20:04:24.735Z&quot;,&quot;service&quot;:&quot;test&quot;,&quot;level&quot;:&quot;DEBUG&quot;,&quot;traceId&quot;:&quot;test-trace&quot;,&quot;userId&quot;:null,&quot;path&quot;:&quot;/test&quot;,&quot;message&quot;:&quot;KV get: cache:key&quot;,&quot;type&quot;:&quot;data_operation&quot;,&quot;operation&quot;:&quot;kv&quot;,&quot;key&quot;:&quot;cache:key&quot;,&quot;latencyMs&quot;:0,&quot;cacheStatus&quot;:&quot;HIT&quot;}

            </system-out>
        </testcase>
        <testcase classname="test/logging/kv-wrapper.spec.ts" name="LoggedKVNamespace &gt; get &gt; should handle stream type" time="0.053">
            <system-out>
{&quot;timestamp&quot;:&quot;2025-12-14T20:04:24.786Z&quot;,&quot;service&quot;:&quot;test&quot;,&quot;level&quot;:&quot;DEBUG&quot;,&quot;traceId&quot;:&quot;test-trace&quot;,&quot;userId&quot;:null,&quot;path&quot;:&quot;/test&quot;,&quot;message&quot;:&quot;KV get: cache:key&quot;,&quot;type&quot;:&quot;data_operation&quot;,&quot;operation&quot;:&quot;kv&quot;,&quot;key&quot;:&quot;cache:key&quot;,&quot;latencyMs&quot;:0,&quot;cacheStatus&quot;:&quot;HIT&quot;}

            </system-out>
        </testcase>
        <testcase classname="test/logging/kv-wrapper.spec.ts" name="LoggedKVNamespace &gt; get &gt; should log failed get operation" time="0.034">
            <system-out>
{&quot;timestamp&quot;:&quot;2025-12-14T20:04:24.817Z&quot;,&quot;service&quot;:&quot;test&quot;,&quot;level&quot;:&quot;DEBUG&quot;,&quot;traceId&quot;:&quot;test-trace&quot;,&quot;userId&quot;:null,&quot;path&quot;:&quot;/test&quot;,&quot;message&quot;:&quot;KV get failed: cache:key&quot;,&quot;type&quot;:&quot;data_operation&quot;,&quot;operation&quot;:&quot;kv&quot;,&quot;key&quot;:&quot;cache:key&quot;,&quot;latencyMs&quot;:1,&quot;cacheStatus&quot;:&quot;N/A&quot;,&quot;error&quot;:&quot;KV error&quot;}

            </system-out>
        </testcase>
        <testcase classname="test/logging/kv-wrapper.spec.ts" name="LoggedKVNamespace &gt; get &gt; should measure latency" time="0.038">
            <system-out>
{&quot;timestamp&quot;:&quot;2025-12-14T20:04:24.860Z&quot;,&quot;service&quot;:&quot;test&quot;,&quot;level&quot;:&quot;DEBUG&quot;,&quot;traceId&quot;:&quot;test-trace&quot;,&quot;userId&quot;:null,&quot;path&quot;:&quot;/test&quot;,&quot;message&quot;:&quot;KV get: cache:key&quot;,&quot;type&quot;:&quot;data_operation&quot;,&quot;operation&quot;:&quot;kv&quot;,&quot;key&quot;:&quot;cache:key&quot;,&quot;latencyMs&quot;:11,&quot;cacheStatus&quot;:&quot;HIT&quot;}

            </system-out>
        </testcase>
        <testcase classname="test/logging/kv-wrapper.spec.ts" name="LoggedKVNamespace &gt; put &gt; should log successful put operation" time="0.028">
            <system-out>
{&quot;timestamp&quot;:&quot;2025-12-14T20:04:24.940Z&quot;,&quot;service&quot;:&quot;test&quot;,&quot;level&quot;:&quot;DEBUG&quot;,&quot;traceId&quot;:&quot;test-trace&quot;,&quot;userId&quot;:null,&quot;path&quot;:&quot;/test&quot;,&quot;message&quot;:&quot;KV put: cache:key&quot;,&quot;type&quot;:&quot;data_operation&quot;,&quot;operation&quot;:&quot;kv&quot;,&quot;key&quot;:&quot;cache:key&quot;,&quot;latencyMs&quot;:0,&quot;cacheStatus&quot;:&quot;N/A&quot;}

            </system-out>
        </testcase>
        <testcase classname="test/logging/kv-wrapper.spec.ts" name="LoggedKVNamespace &gt; put &gt; should log put with expiration options" time="0.026">
            <system-out>
{&quot;timestamp&quot;:&quot;2025-12-14T20:04:24.968Z&quot;,&quot;service&quot;:&quot;test&quot;,&quot;level&quot;:&quot;DEBUG&quot;,&quot;traceId&quot;:&quot;test-trace&quot;,&quot;userId&quot;:null,&quot;path&quot;:&quot;/test&quot;,&quot;message&quot;:&quot;KV put: cache:key&quot;,&quot;type&quot;:&quot;data_operation&quot;,&quot;operation&quot;:&quot;kv&quot;,&quot;key&quot;:&quot;cache:key&quot;,&quot;latencyMs&quot;:0,&quot;cacheStatus&quot;:&quot;N/A&quot;}

            </system-out>
        </testcase>
        <testcase classname="test/logging/kv-wrapper.spec.ts" name="LoggedKVNamespace &gt; put &gt; should log failed put operation" time="0.049">
            <system-out>
{&quot;timestamp&quot;:&quot;2025-12-14T20:04:25.019Z&quot;,&quot;service&quot;:&quot;test&quot;,&quot;level&quot;:&quot;DEBUG&quot;,&quot;traceId&quot;:&quot;test-trace&quot;,&quot;userId&quot;:null,&quot;path&quot;:&quot;/test&quot;,&quot;message&quot;:&quot;KV put failed: cache:key&quot;,&quot;type&quot;:&quot;data_operation&quot;,&quot;operation&quot;:&quot;kv&quot;,&quot;key&quot;:&quot;cache:key&quot;,&quot;latencyMs&quot;:0,&quot;cacheStatus&quot;:&quot;N/A&quot;,&quot;error&quot;:&quot;Put failed&quot;}

            </system-out>
        </testcase>
        <testcase classname="test/logging/kv-wrapper.spec.ts" name="LoggedKVNamespace &gt; put &gt; should handle ArrayBuffer value" time="0.02">
            <system-out>
{&quot;timestamp&quot;:&quot;2025-12-14T20:04:25.041Z&quot;,&quot;service&quot;:&quot;test&quot;,&quot;level&quot;:&quot;DEBUG&quot;,&quot;traceId&quot;:&quot;test-trace&quot;,&quot;userId&quot;:null,&quot;path&quot;:&quot;/test&quot;,&quot;message&quot;:&quot;KV put: cache:key&quot;,&quot;type&quot;:&quot;data_operation&quot;,&quot;operation&quot;:&quot;kv&quot;,&quot;key&quot;:&quot;cache:key&quot;,&quot;latencyMs&quot;:0,&quot;cacheStatus&quot;:&quot;N/A&quot;}

            </system-out>
        </testcase>
        <testcase classname="test/logging/kv-wrapper.spec.ts" name="LoggedKVNamespace &gt; delete &gt; should log successful delete operation" time="0.027">
            <system-out>
{&quot;timestamp&quot;:&quot;2025-12-14T20:04:25.086Z&quot;,&quot;service&quot;:&quot;test&quot;,&quot;level&quot;:&quot;DEBUG&quot;,&quot;traceId&quot;:&quot;test-trace&quot;,&quot;userId&quot;:null,&quot;path&quot;:&quot;/test&quot;,&quot;message&quot;:&quot;KV delete: cache:key&quot;,&quot;type&quot;:&quot;data_operation&quot;,&quot;operation&quot;:&quot;kv&quot;,&quot;key&quot;:&quot;cache:key&quot;,&quot;latencyMs&quot;:0,&quot;cacheStatus&quot;:&quot;N/A&quot;}

            </system-out>
        </testcase>
        <testcase classname="test/logging/kv-wrapper.spec.ts" name="LoggedKVNamespace &gt; delete &gt; should log failed delete operation" time="0.036">
            <system-out>
{&quot;timestamp&quot;:&quot;2025-12-14T20:04:25.122Z&quot;,&quot;service&quot;:&quot;test&quot;,&quot;level&quot;:&quot;DEBUG&quot;,&quot;traceId&quot;:&quot;test-trace&quot;,&quot;userId&quot;:null,&quot;path&quot;:&quot;/test&quot;,&quot;message&quot;:&quot;KV delete failed: cache:key&quot;,&quot;type&quot;:&quot;data_operation&quot;,&quot;operation&quot;:&quot;kv&quot;,&quot;key&quot;:&quot;cache:key&quot;,&quot;latencyMs&quot;:0,&quot;cacheStatus&quot;:&quot;N/A&quot;,&quot;error&quot;:&quot;Delete failed&quot;}

            </system-out>
        </testcase>
        <testcase classname="test/logging/kv-wrapper.spec.ts" name="LoggedKVNamespace &gt; list &gt; should log successful list operation without options" time="0.032">
            <system-out>
{&quot;timestamp&quot;:&quot;2025-12-14T20:04:25.168Z&quot;,&quot;service&quot;:&quot;test&quot;,&quot;level&quot;:&quot;DEBUG&quot;,&quot;traceId&quot;:&quot;test-trace&quot;,&quot;userId&quot;:null,&quot;path&quot;:&quot;/test&quot;,&quot;message&quot;:&quot;KV list: prefix=all&quot;,&quot;type&quot;:&quot;data_operation&quot;,&quot;operation&quot;:&quot;kv&quot;,&quot;key&quot;:&quot;*&quot;,&quot;latencyMs&quot;:0,&quot;cacheStatus&quot;:&quot;N/A&quot;}

            </system-out>
        </testcase>
        <testcase classname="test/logging/kv-wrapper.spec.ts" name="LoggedKVNamespace &gt; list &gt; should log successful list operation with prefix" time="0.056">
            <system-out>
{&quot;timestamp&quot;:&quot;2025-12-14T20:04:25.226Z&quot;,&quot;service&quot;:&quot;test&quot;,&quot;level&quot;:&quot;DEBUG&quot;,&quot;traceId&quot;:&quot;test-trace&quot;,&quot;userId&quot;:null,&quot;path&quot;:&quot;/test&quot;,&quot;message&quot;:&quot;KV list: prefix=cache:&quot;,&quot;type&quot;:&quot;data_operation&quot;,&quot;operation&quot;:&quot;kv&quot;,&quot;key&quot;:&quot;cache:&quot;,&quot;latencyMs&quot;:0,&quot;cacheStatus&quot;:&quot;N/A&quot;}

            </system-out>
        </testcase>
        <testcase classname="test/logging/kv-wrapper.spec.ts" name="LoggedKVNamespace &gt; list &gt; should log successful list operation with limit" time="0.042">
            <system-out>
{&quot;timestamp&quot;:&quot;2025-12-14T20:04:25.259Z&quot;,&quot;service&quot;:&quot;test&quot;,&quot;level&quot;:&quot;DEBUG&quot;,&quot;traceId&quot;:&quot;test-trace&quot;,&quot;userId&quot;:null,&quot;path&quot;:&quot;/test&quot;,&quot;message&quot;:&quot;KV list: prefix=all&quot;,&quot;type&quot;:&quot;data_operation&quot;,&quot;operation&quot;:&quot;kv&quot;,&quot;key&quot;:&quot;*&quot;,&quot;latencyMs&quot;:0,&quot;cacheStatus&quot;:&quot;N/A&quot;}

            </system-out>
        </testcase>
        <testcase classname="test/logging/kv-wrapper.spec.ts" name="LoggedKVNamespace &gt; list &gt; should log successful list operation with cursor" time="0.065">
            <system-out>
{&quot;timestamp&quot;:&quot;2025-12-14T20:04:25.306Z&quot;,&quot;service&quot;:&quot;test&quot;,&quot;level&quot;:&quot;DEBUG&quot;,&quot;traceId&quot;:&quot;test-trace&quot;,&quot;userId&quot;:null,&quot;path&quot;:&quot;/test&quot;,&quot;message&quot;:&quot;KV list: prefix=all&quot;,&quot;type&quot;:&quot;data_operation&quot;,&quot;operation&quot;:&quot;kv&quot;,&quot;key&quot;:&quot;*&quot;,&quot;latencyMs&quot;:0,&quot;cacheStatus&quot;:&quot;N/A&quot;}

            </system-out>
        </testcase>
        <testcase classname="test/logging/kv-wrapper.spec.ts" name="LoggedKVNamespace &gt; list &gt; should log failed list operation" time="0.046">
            <system-out>
{&quot;timestamp&quot;:&quot;2025-12-14T20:04:25.369Z&quot;,&quot;service&quot;:&quot;test&quot;,&quot;level&quot;:&quot;DEBUG&quot;,&quot;traceId&quot;:&quot;test-trace&quot;,&quot;userId&quot;:null,&quot;path&quot;:&quot;/test&quot;,&quot;message&quot;:&quot;KV list failed: prefix=all&quot;,&quot;type&quot;:&quot;data_operation&quot;,&quot;operation&quot;:&quot;kv&quot;,&quot;key&quot;:&quot;*&quot;,&quot;latencyMs&quot;:0,&quot;cacheStatus&quot;:&quot;N/A&quot;,&quot;error&quot;:&quot;List failed&quot;}

            </system-out>
        </testcase>
        <testcase classname="test/logging/kv-wrapper.spec.ts" name="LoggedKVNamespace &gt; error propagation &gt; should re-throw errors after logging" time="0.055">
            <system-out>
{&quot;timestamp&quot;:&quot;2025-12-14T20:04:25.504Z&quot;,&quot;service&quot;:&quot;test&quot;,&quot;level&quot;:&quot;DEBUG&quot;,&quot;traceId&quot;:&quot;test-trace&quot;,&quot;userId&quot;:null,&quot;path&quot;:&quot;/test&quot;,&quot;message&quot;:&quot;KV get failed: cache:key&quot;,&quot;type&quot;:&quot;data_operation&quot;,&quot;operation&quot;:&quot;kv&quot;,&quot;key&quot;:&quot;cache:key&quot;,&quot;latencyMs&quot;:0,&quot;cacheStatus&quot;:&quot;N/A&quot;,&quot;error&quot;:&quot;KV error&quot;}

            </system-out>
        </testcase>
        <testcase classname="test/logging/kv-wrapper.spec.ts" name="LoggedKVNamespace &gt; cache status detection &gt; should detect HIT for non-null text value" time="0.06">
            <system-out>
{&quot;timestamp&quot;:&quot;2025-12-14T20:04:25.610Z&quot;,&quot;service&quot;:&quot;test&quot;,&quot;level&quot;:&quot;DEBUG&quot;,&quot;traceId&quot;:&quot;test-trace&quot;,&quot;userId&quot;:null,&quot;path&quot;:&quot;/test&quot;,&quot;message&quot;:&quot;KV get: key&quot;,&quot;type&quot;:&quot;data_operation&quot;,&quot;operation&quot;:&quot;kv&quot;,&quot;key&quot;:&quot;key&quot;,&quot;latencyMs&quot;:0,&quot;cacheStatus&quot;:&quot;HIT&quot;}

            </system-out>
        </testcase>
        <testcase classname="test/logging/kv-wrapper.spec.ts" name="LoggedKVNamespace &gt; cache status detection &gt; should detect HIT for non-null json value" time="0.035">
            <system-out>
{&quot;timestamp&quot;:&quot;2025-12-14T20:04:25.673Z&quot;,&quot;service&quot;:&quot;test&quot;,&quot;level&quot;:&quot;DEBUG&quot;,&quot;traceId&quot;:&quot;test-trace&quot;,&quot;userId&quot;:null,&quot;path&quot;:&quot;/test&quot;,&quot;message&quot;:&quot;KV get: key&quot;,&quot;type&quot;:&quot;data_operation&quot;,&quot;operation&quot;:&quot;kv&quot;,&quot;key&quot;:&quot;key&quot;,&quot;latencyMs&quot;:0,&quot;cacheStatus&quot;:&quot;HIT&quot;}

            </system-out>
        </testcase>
        <testcase classname="test/logging/kv-wrapper.spec.ts" name="LoggedKVNamespace &gt; cache status detection &gt; should detect MISS for null value" time="0.039">
            <system-out>
{&quot;timestamp&quot;:&quot;2025-12-14T20:04:25.707Z&quot;,&quot;service&quot;:&quot;test&quot;,&quot;level&quot;:&quot;DEBUG&quot;,&quot;traceId&quot;:&quot;test-trace&quot;,&quot;userId&quot;:null,&quot;path&quot;:&quot;/test&quot;,&quot;message&quot;:&quot;KV get: key&quot;,&quot;type&quot;:&quot;data_operation&quot;,&quot;operation&quot;:&quot;kv&quot;,&quot;key&quot;:&quot;key&quot;,&quot;latencyMs&quot;:0,&quot;cacheStatus&quot;:&quot;MISS&quot;}

            </system-out>
        </testcase>
        <testcase classname="test/logging/kv-wrapper.spec.ts" name="LoggedKVNamespace &gt; cache status detection &gt; should use N/A for put operations" time="0.056">
            <system-out>
{&quot;timestamp&quot;:&quot;2025-12-14T20:04:25.760Z&quot;,&quot;service&quot;:&quot;test&quot;,&quot;level&quot;:&quot;DEBUG&quot;,&quot;traceId&quot;:&quot;test-trace&quot;,&quot;userId&quot;:null,&quot;path&quot;:&quot;/test&quot;,&quot;message&quot;:&quot;KV put: key&quot;,&quot;type&quot;:&quot;data_operation&quot;,&quot;operation&quot;:&quot;kv&quot;,&quot;key&quot;:&quot;key&quot;,&quot;latencyMs&quot;:0,&quot;cacheStatus&quot;:&quot;N/A&quot;}

            </system-out>
        </testcase>
        <testcase classname="test/logging/kv-wrapper.spec.ts" name="LoggedKVNamespace &gt; cache status detection &gt; should use N/A for delete operations" time="0.032">
            <system-out>
{&quot;timestamp&quot;:&quot;2025-12-14T20:04:25.800Z&quot;,&quot;service&quot;:&quot;test&quot;,&quot;level&quot;:&quot;DEBUG&quot;,&quot;traceId&quot;:&quot;test-trace&quot;,&quot;userId&quot;:null,&quot;path&quot;:&quot;/test&quot;,&quot;message&quot;:&quot;KV delete: key&quot;,&quot;type&quot;:&quot;data_operation&quot;,&quot;operation&quot;:&quot;kv&quot;,&quot;key&quot;:&quot;key&quot;,&quot;latencyMs&quot;:0,&quot;cacheStatus&quot;:&quot;N/A&quot;}

            </system-out>
        </testcase>
        <testcase classname="test/logging/kv-wrapper.spec.ts" name="LoggedKVNamespace &gt; cache status detection &gt; should use N/A for list operations" time="0.032">
            <system-out>
{&quot;timestamp&quot;:&quot;2025-12-14T20:04:25.834Z&quot;,&quot;service&quot;:&quot;test&quot;,&quot;level&quot;:&quot;DEBUG&quot;,&quot;traceId&quot;:&quot;test-trace&quot;,&quot;userId&quot;:null,&quot;path&quot;:&quot;/test&quot;,&quot;message&quot;:&quot;KV list: prefix=all&quot;,&quot;type&quot;:&quot;data_operation&quot;,&quot;operation&quot;:&quot;kv&quot;,&quot;key&quot;:&quot;*&quot;,&quot;latencyMs&quot;:0,&quot;cacheStatus&quot;:&quot;N/A&quot;}

            </system-out>
        </testcase>
    </testsuite>
    <testsuite name="test/logging/logger.spec.ts" timestamp="2025-12-14T20:04:38.254Z" hostname="sngvahmed" tests="31" failures="0" errors="0" skipped="0" time="1.668">
        <testcase classname="test/logging/logger.spec.ts" name="Logger &gt; constructor &gt; should initialize with context" time="0.035">
        </testcase>
        <testcase classname="test/logging/logger.spec.ts" name="Logger &gt; constructor &gt; should start with empty log buffer" time="0.033">
        </testcase>
        <testcase classname="test/logging/logger.spec.ts" name="Logger &gt; debug &gt; should create debug log entry" time="0.037">
            <system-out>
{&quot;timestamp&quot;:&quot;2025-12-14T20:04:24.636Z&quot;,&quot;service&quot;:&quot;stockly-api-test&quot;,&quot;level&quot;:&quot;DEBUG&quot;,&quot;traceId&quot;:&quot;test-trace-123&quot;,&quot;userId&quot;:&quot;user-456&quot;,&quot;path&quot;:&quot;/v1/api/test&quot;,&quot;message&quot;:&quot;Debug message&quot;,&quot;type&quot;:&quot;general&quot;,&quot;extra&quot;:&quot;data&quot;}

            </system-out>
        </testcase>
        <testcase classname="test/logging/logger.spec.ts" name="Logger &gt; info &gt; should create info log entry" time="0.054">
            <system-out>
{&quot;timestamp&quot;:&quot;2025-12-14T20:04:24.724Z&quot;,&quot;service&quot;:&quot;stockly-api-test&quot;,&quot;level&quot;:&quot;INFO&quot;,&quot;traceId&quot;:&quot;test-trace-123&quot;,&quot;userId&quot;:&quot;user-456&quot;,&quot;path&quot;:&quot;/v1/api/test&quot;,&quot;message&quot;:&quot;Info message&quot;,&quot;type&quot;:&quot;general&quot;,&quot;action&quot;:&quot;test&quot;}

            </system-out>
        </testcase>
        <testcase classname="test/logging/logger.spec.ts" name="Logger &gt; warn &gt; should create warn log entry" time="0.029">
            <system-err>
{&quot;timestamp&quot;:&quot;2025-12-14T20:04:24.777Z&quot;,&quot;service&quot;:&quot;stockly-api-test&quot;,&quot;level&quot;:&quot;WARN&quot;,&quot;traceId&quot;:&quot;test-trace-123&quot;,&quot;userId&quot;:&quot;user-456&quot;,&quot;path&quot;:&quot;/v1/api/test&quot;,&quot;message&quot;:&quot;Warning message&quot;,&quot;type&quot;:&quot;general&quot;,&quot;warning&quot;:&quot;test&quot;}

            </system-err>
        </testcase>
        <testcase classname="test/logging/logger.spec.ts" name="Logger &gt; error &gt; should create error log entry with Error object" time="0.028">
            <system-err>
{&quot;timestamp&quot;:&quot;2025-12-14T20:04:24.863Z&quot;,&quot;service&quot;:&quot;stockly-api-test&quot;,&quot;level&quot;:&quot;ERROR&quot;,&quot;traceId&quot;:&quot;test-trace-123&quot;,&quot;userId&quot;:&quot;user-456&quot;,&quot;path&quot;:&quot;/v1/api/test&quot;,&quot;message&quot;:&quot;Error message&quot;,&quot;type&quot;:&quot;general&quot;,&quot;context&quot;:&quot;test&quot;,&quot;error&quot;:{&quot;name&quot;:&quot;Error&quot;,&quot;message&quot;:&quot;Test error&quot;,&quot;stack&quot;:&quot;Error stack trace&quot;}}

            </system-err>
        </testcase>
        <testcase classname="test/logging/logger.spec.ts" name="Logger &gt; error &gt; should create error log entry with string error" time="0.026">
            <system-err>
{&quot;timestamp&quot;:&quot;2025-12-14T20:04:24.890Z&quot;,&quot;service&quot;:&quot;stockly-api-test&quot;,&quot;level&quot;:&quot;ERROR&quot;,&quot;traceId&quot;:&quot;test-trace-123&quot;,&quot;userId&quot;:&quot;user-456&quot;,&quot;path&quot;:&quot;/v1/api/test&quot;,&quot;message&quot;:&quot;Error message&quot;,&quot;type&quot;:&quot;general&quot;,&quot;context&quot;:&quot;test&quot;,&quot;error&quot;:&quot;String error&quot;}

            </system-err>
        </testcase>
        <testcase classname="test/logging/logger.spec.ts" name="Logger &gt; error &gt; should create error log entry without error" time="0.048">
            <system-err>
{&quot;timestamp&quot;:&quot;2025-12-14T20:04:24.936Z&quot;,&quot;service&quot;:&quot;stockly-api-test&quot;,&quot;level&quot;:&quot;ERROR&quot;,&quot;traceId&quot;:&quot;test-trace-123&quot;,&quot;userId&quot;:&quot;user-456&quot;,&quot;path&quot;:&quot;/v1/api/test&quot;,&quot;message&quot;:&quot;Error message&quot;,&quot;type&quot;:&quot;general&quot;,&quot;context&quot;:&quot;test&quot;}

            </system-err>
        </testcase>
        <testcase classname="test/logging/logger.spec.ts" name="Logger &gt; logApiCall &gt; should create API call log entry" time="0.022">
            <system-out>
{&quot;timestamp&quot;:&quot;2025-12-14T20:04:24.990Z&quot;,&quot;service&quot;:&quot;stockly-api-test&quot;,&quot;level&quot;:&quot;DEBUG&quot;,&quot;traceId&quot;:&quot;test-trace-123&quot;,&quot;userId&quot;:&quot;user-456&quot;,&quot;path&quot;:&quot;/v1/api/test&quot;,&quot;message&quot;:&quot;API call made&quot;,&quot;type&quot;:&quot;api_call&quot;,&quot;apiProvider&quot;:&quot;FMP&quot;,&quot;endpoint&quot;:&quot;/quote&quot;,&quot;method&quot;:&quot;GET&quot;,&quot;statusCode&quot;:200,&quot;latencyMs&quot;:150}

            </system-out>
        </testcase>
        <testcase classname="test/logging/logger.spec.ts" name="Logger &gt; logApiCall &gt; should create API call log entry with partial options" time="0.046">
            <system-out>
{&quot;timestamp&quot;:&quot;2025-12-14T20:04:25.037Z&quot;,&quot;service&quot;:&quot;stockly-api-test&quot;,&quot;level&quot;:&quot;DEBUG&quot;,&quot;traceId&quot;:&quot;test-trace-123&quot;,&quot;userId&quot;:&quot;user-456&quot;,&quot;path&quot;:&quot;/v1/api/test&quot;,&quot;message&quot;:&quot;API call&quot;,&quot;type&quot;:&quot;api_call&quot;,&quot;apiProvider&quot;:&quot;FMP&quot;,&quot;latencyMs&quot;:100}

            </system-out>
        </testcase>
        <testcase classname="test/logging/logger.spec.ts" name="Logger &gt; logDataOperation &gt; should create D1 operation log entry" time="0.029">
            <system-out>
{&quot;timestamp&quot;:&quot;2025-12-14T20:04:25.080Z&quot;,&quot;service&quot;:&quot;stockly-api-test&quot;,&quot;level&quot;:&quot;DEBUG&quot;,&quot;traceId&quot;:&quot;test-trace-123&quot;,&quot;userId&quot;:&quot;user-456&quot;,&quot;path&quot;:&quot;/v1/api/test&quot;,&quot;message&quot;:&quot;D1 query executed&quot;,&quot;type&quot;:&quot;data_operation&quot;,&quot;operation&quot;:&quot;d1&quot;,&quot;query&quot;:&quot;SELECT * FROM alerts&quot;,&quot;latencyMs&quot;:25,&quot;cacheStatus&quot;:&quot;N/A&quot;}

            </system-out>
        </testcase>
        <testcase classname="test/logging/logger.spec.ts" name="Logger &gt; logDataOperation &gt; should create KV operation log entry with HIT" time="0.021">
            <system-out>
{&quot;timestamp&quot;:&quot;2025-12-14T20:04:25.106Z&quot;,&quot;service&quot;:&quot;stockly-api-test&quot;,&quot;level&quot;:&quot;DEBUG&quot;,&quot;traceId&quot;:&quot;test-trace-123&quot;,&quot;userId&quot;:&quot;user-456&quot;,&quot;path&quot;:&quot;/v1/api/test&quot;,&quot;message&quot;:&quot;KV get&quot;,&quot;type&quot;:&quot;data_operation&quot;,&quot;operation&quot;:&quot;kv&quot;,&quot;key&quot;:&quot;cache:key&quot;,&quot;latencyMs&quot;:5,&quot;cacheStatus&quot;:&quot;HIT&quot;}

            </system-out>
        </testcase>
        <testcase classname="test/logging/logger.spec.ts" name="Logger &gt; logDataOperation &gt; should create KV operation log entry with MISS" time="0.043">
            <system-out>
{&quot;timestamp&quot;:&quot;2025-12-14T20:04:25.147Z&quot;,&quot;service&quot;:&quot;stockly-api-test&quot;,&quot;level&quot;:&quot;DEBUG&quot;,&quot;traceId&quot;:&quot;test-trace-123&quot;,&quot;userId&quot;:&quot;user-456&quot;,&quot;path&quot;:&quot;/v1/api/test&quot;,&quot;message&quot;:&quot;KV get&quot;,&quot;type&quot;:&quot;data_operation&quot;,&quot;operation&quot;:&quot;kv&quot;,&quot;key&quot;:&quot;cache:key&quot;,&quot;latencyMs&quot;:5,&quot;cacheStatus&quot;:&quot;MISS&quot;}

            </system-out>
        </testcase>
        <testcase classname="test/logging/logger.spec.ts" name="Logger &gt; logDataOperation &gt; should create data operation log entry with error" time="0.031">
            <system-out>
{&quot;timestamp&quot;:&quot;2025-12-14T20:04:25.170Z&quot;,&quot;service&quot;:&quot;stockly-api-test&quot;,&quot;level&quot;:&quot;DEBUG&quot;,&quot;traceId&quot;:&quot;test-trace-123&quot;,&quot;userId&quot;:&quot;user-456&quot;,&quot;path&quot;:&quot;/v1/api/test&quot;,&quot;message&quot;:&quot;D1 query failed&quot;,&quot;type&quot;:&quot;data_operation&quot;,&quot;operation&quot;:&quot;d1&quot;,&quot;query&quot;:&quot;SELECT * FROM alerts&quot;,&quot;latencyMs&quot;:25,&quot;cacheStatus&quot;:&quot;N/A&quot;,&quot;error&quot;:&quot;Database connection failed&quot;}

            </system-out>
        </testcase>
        <testcase classname="test/logging/logger.spec.ts" name="Logger &gt; logFCMError &gt; should create FCM error log entry" time="0.067">
            <system-err>
{&quot;timestamp&quot;:&quot;2025-12-14T20:04:25.263Z&quot;,&quot;service&quot;:&quot;stockly-api-test&quot;,&quot;level&quot;:&quot;ERROR&quot;,&quot;traceId&quot;:&quot;test-trace-123&quot;,&quot;userId&quot;:&quot;user-456&quot;,&quot;path&quot;:&quot;/v1/api/test&quot;,&quot;message&quot;:&quot;FCM notification failed&quot;,&quot;type&quot;:&quot;fcm_error&quot;,&quot;fcmErrorCode&quot;:&quot;5&quot;,&quot;fcmErrorType&quot;:&quot;NOT_FOUND&quot;,&quot;isPermanent&quot;:true,&quot;shouldCleanupToken&quot;:true,&quot;requestPayload&quot;:{&quot;token&quot;:&quot;fcm-token&quot;,&quot;title&quot;:&quot;Alert&quot;,&quot;body&quot;:&quot;Price alert&quot;},&quot;errorMessage&quot;:&quot;Token not found&quot;}

            </system-err>
        </testcase>
        <testcase classname="test/logging/logger.spec.ts" name="Logger &gt; getLogs &gt; should return copy of log buffer" time="0.079">
            <system-out>
{&quot;timestamp&quot;:&quot;2025-12-14T20:04:25.381Z&quot;,&quot;service&quot;:&quot;stockly-api-test&quot;,&quot;level&quot;:&quot;INFO&quot;,&quot;traceId&quot;:&quot;test-trace-123&quot;,&quot;userId&quot;:&quot;user-456&quot;,&quot;path&quot;:&quot;/v1/api/test&quot;,&quot;message&quot;:&quot;Message 1&quot;,&quot;type&quot;:&quot;general&quot;}
{&quot;timestamp&quot;:&quot;2025-12-14T20:04:25.381Z&quot;,&quot;service&quot;:&quot;stockly-api-test&quot;,&quot;level&quot;:&quot;INFO&quot;,&quot;traceId&quot;:&quot;test-trace-123&quot;,&quot;userId&quot;:&quot;user-456&quot;,&quot;path&quot;:&quot;/v1/api/test&quot;,&quot;message&quot;:&quot;Message 2&quot;,&quot;type&quot;:&quot;general&quot;}

            </system-out>
        </testcase>
        <testcase classname="test/logging/logger.spec.ts" name="Logger &gt; clearLogs &gt; should clear log buffer" time="0.055">
            <system-out>
{&quot;timestamp&quot;:&quot;2025-12-14T20:04:25.504Z&quot;,&quot;service&quot;:&quot;stockly-api-test&quot;,&quot;level&quot;:&quot;INFO&quot;,&quot;traceId&quot;:&quot;test-trace-123&quot;,&quot;userId&quot;:&quot;user-456&quot;,&quot;path&quot;:&quot;/v1/api/test&quot;,&quot;message&quot;:&quot;Message 1&quot;,&quot;type&quot;:&quot;general&quot;}
{&quot;timestamp&quot;:&quot;2025-12-14T20:04:25.504Z&quot;,&quot;service&quot;:&quot;stockly-api-test&quot;,&quot;level&quot;:&quot;INFO&quot;,&quot;traceId&quot;:&quot;test-trace-123&quot;,&quot;userId&quot;:&quot;user-456&quot;,&quot;path&quot;:&quot;/v1/api/test&quot;,&quot;message&quot;:&quot;Message 2&quot;,&quot;type&quot;:&quot;general&quot;}

            </system-out>
        </testcase>
        <testcase classname="test/logging/logger.spec.ts" name="Logger &gt; updateContext &gt; should update context" time="0.042">
        </testcase>
        <testcase classname="test/logging/logger.spec.ts" name="Logger &gt; updateContext &gt; should update multiple context fields" time="0.041">
        </testcase>
        <testcase classname="test/logging/logger.spec.ts" name="Logger &gt; updateContext &gt; should use updated context in new logs" time="0.043">
            <system-out>
{&quot;timestamp&quot;:&quot;2025-12-14T20:04:25.712Z&quot;,&quot;service&quot;:&quot;stockly-api-test&quot;,&quot;level&quot;:&quot;INFO&quot;,&quot;traceId&quot;:&quot;test-trace-123&quot;,&quot;userId&quot;:&quot;updated-user&quot;,&quot;path&quot;:&quot;/v1/api/test&quot;,&quot;message&quot;:&quot;New message&quot;,&quot;type&quot;:&quot;general&quot;}

            </system-out>
        </testcase>
        <testcase classname="test/logging/logger.spec.ts" name="Logger &gt; getContext &gt; should return copy of context" time="0.031">
        </testcase>
        <testcase classname="test/logging/logger.spec.ts" name="Logger &gt; log entry structure &gt; should include all required fields" time="0.032">
            <system-out>
{&quot;timestamp&quot;:&quot;2025-12-14T20:04:25.861Z&quot;,&quot;service&quot;:&quot;stockly-api-test&quot;,&quot;level&quot;:&quot;INFO&quot;,&quot;traceId&quot;:&quot;test-trace-123&quot;,&quot;userId&quot;:&quot;user-456&quot;,&quot;path&quot;:&quot;/v1/api/test&quot;,&quot;message&quot;:&quot;Test message&quot;,&quot;type&quot;:&quot;general&quot;}

            </system-out>
        </testcase>
        <testcase classname="test/logging/logger.spec.ts" name="Logger &gt; log entry structure &gt; should handle null userId" time="0.03">
            <system-out>
{&quot;timestamp&quot;:&quot;2025-12-14T20:04:25.898Z&quot;,&quot;service&quot;:&quot;stockly-api-test&quot;,&quot;level&quot;:&quot;INFO&quot;,&quot;traceId&quot;:&quot;test-trace-123&quot;,&quot;userId&quot;:null,&quot;path&quot;:&quot;/v1/api/test&quot;,&quot;message&quot;:&quot;Test&quot;,&quot;type&quot;:&quot;general&quot;}

            </system-out>
        </testcase>
        <testcase classname="test/logging/logger.spec.ts" name="Logger &gt; log entry structure &gt; should handle undefined userId" time="0.027">
            <system-out>
{&quot;timestamp&quot;:&quot;2025-12-14T20:04:25.923Z&quot;,&quot;service&quot;:&quot;test&quot;,&quot;level&quot;:&quot;INFO&quot;,&quot;traceId&quot;:&quot;test&quot;,&quot;userId&quot;:null,&quot;path&quot;:&quot;/test&quot;,&quot;message&quot;:&quot;Test&quot;,&quot;type&quot;:&quot;general&quot;}

            </system-out>
        </testcase>
        <testcase classname="test/logging/logger.spec.ts" name="extractUserId &gt; should extract userId from push-token path" time="0.022">
        </testcase>
        <testcase classname="test/logging/logger.spec.ts" name="extractUserId &gt; should extract userId from preferences path" time="0.024">
        </testcase>
        <testcase classname="test/logging/logger.spec.ts" name="extractUserId &gt; should extract userId from settings path" time="0.015">
        </testcase>
        <testcase classname="test/logging/logger.spec.ts" name="extractUserId &gt; should extract userId from devices path" time="0.014">
        </testcase>
        <testcase classname="test/logging/logger.spec.ts" name="extractUserId &gt; should return null when userId not in path" time="0.014">
        </testcase>
        <testcase classname="test/logging/logger.spec.ts" name="extractUserId &gt; should return null for paths without userId pattern" time="0.016">
        </testcase>
        <testcase classname="test/logging/logger.spec.ts" name="extractUserId &gt; should extract userId from path with query params" time="0.013">
        </testcase>
    </testsuite>
    <testsuite name="test/logging/loki-shipper.spec.ts" timestamp="2025-12-14T20:04:38.260Z" hostname="sngvahmed" tests="12" failures="0" errors="0" skipped="0" time="0.537">
        <testcase classname="test/logging/loki-shipper.spec.ts" name="Loki Shipper &gt; sendLogsToLoki &gt; should ship logs successfully" time="0.037">
            <system-out>
[Loki Shipper] Successfully shipped 2 log entries

            </system-out>
        </testcase>
        <testcase classname="test/logging/loki-shipper.spec.ts" name="Loki Shipper &gt; sendLogsToLoki &gt; should format timestamps as nanoseconds" time="0.036">
            <system-out>
[Loki Shipper] Successfully shipped 2 log entries

            </system-out>
        </testcase>
        <testcase classname="test/logging/loki-shipper.spec.ts" name="Loki Shipper &gt; sendLogsToLoki &gt; should handle URL with trailing slash" time="0.061">
            <system-out>
[Loki Shipper] Successfully shipped 2 log entries

            </system-out>
        </testcase>
        <testcase classname="test/logging/loki-shipper.spec.ts" name="Loki Shipper &gt; sendLogsToLoki &gt; should include Basic Auth when credentials provided" time="0.035">
            <system-out>
[Loki Shipper] Successfully shipped 2 log entries

            </system-out>
        </testcase>
        <testcase classname="test/logging/loki-shipper.spec.ts" name="Loki Shipper &gt; sendLogsToLoki &gt; should not include Auth when credentials not provided" time="0.046">
            <system-out>
[Loki Shipper] Successfully shipped 2 log entries

            </system-out>
        </testcase>
        <testcase classname="test/logging/loki-shipper.spec.ts" name="Loki Shipper &gt; sendLogsToLoki &gt; should include custom labels" time="0.026">
            <system-out>
[Loki Shipper] Successfully shipped 2 log entries

            </system-out>
        </testcase>
        <testcase classname="test/logging/loki-shipper.spec.ts" name="Loki Shipper &gt; sendLogsToLoki &gt; should return early if no logs" time="0.025">
        </testcase>
        <testcase classname="test/logging/loki-shipper.spec.ts" name="Loki Shipper &gt; sendLogsToLoki &gt; should return early if URL not configured" time="0.03">
        </testcase>
        <testcase classname="test/logging/loki-shipper.spec.ts" name="Loki Shipper &gt; sendLogsToLoki &gt; should handle non-200 response" time="0.042">
        </testcase>
        <testcase classname="test/logging/loki-shipper.spec.ts" name="Loki Shipper &gt; sendLogsToLoki &gt; should handle network errors gracefully" time="0.027">
        </testcase>
        <testcase classname="test/logging/loki-shipper.spec.ts" name="Loki Shipper &gt; sendLogsToLoki &gt; should handle fetch text() error" time="0.028">
        </testcase>
        <testcase classname="test/logging/loki-shipper.spec.ts" name="Loki Shipper &gt; sendLogsToLoki &gt; should format logs correctly with all log types" time="0.052">
            <system-out>
[Loki Shipper] Successfully shipped 3 log entries

            </system-out>
        </testcase>
    </testsuite>
    <testsuite name="test/notifications/fcm-sender.spec.ts" timestamp="2025-12-14T20:04:38.261Z" hostname="sngvahmed" tests="13" failures="0" errors="0" skipped="0" time="0.903">
        <testcase classname="test/notifications/fcm-sender.spec.ts" name="FCM Sender &gt; sendFCMNotificationWithLogs &gt; should reject invalid token format" time="0.026">
        </testcase>
        <testcase classname="test/notifications/fcm-sender.spec.ts" name="FCM Sender &gt; sendFCMNotificationWithLogs &gt; should reject null token" time="0.024">
        </testcase>
        <testcase classname="test/notifications/fcm-sender.spec.ts" name="FCM Sender &gt; sendFCMNotificationWithLogs &gt; should handle missing FCM_SERVICE_ACCOUNT" time="0.037">
        </testcase>
        <testcase classname="test/notifications/fcm-sender.spec.ts" name="FCM Sender &gt; sendFCMNotificationWithLogs &gt; should handle invalid service account JSON" time="0.057">
        </testcase>
        <testcase classname="test/notifications/fcm-sender.spec.ts" name="FCM Sender &gt; sendFCMNotificationWithLogs &gt; should handle JWT generation failure" time="0.052">
            <system-err>
Failed to get Google access token: Error: JWT generation failed
    at /home/sngvahmed/workspace/stockly/api/test/notifications/fcm-sender.spec.ts:116:54
    at home/sngvahmed/workspace/stockly/api/node_modules/@vitest/runner/dist/chunk-hooks.js:155:11
    at home/sngvahmed/workspace/stockly/api/node_modules/@vitest/runner/dist/chunk-hooks.js:752:26
    at home/sngvahmed/workspace/stockly/api/node_modules/@vitest/runner/dist/chunk-hooks.js:1897:20
    at new Promise (&lt;anonymous&gt;)
    at runWithTimeout (home/sngvahmed/workspace/stockly/api/node_modules/@vitest/runner/dist/chunk-hooks.js:1863:10)
    at runTest (home/sngvahmed/workspace/stockly/api/node_modules/@vitest/runner/dist/chunk-hooks.js:1574:12)
    at runSuite (home/sngvahmed/workspace/stockly/api/node_modules/@vitest/runner/dist/chunk-hooks.js:1729:8)
    at runSuite (home/sngvahmed/workspace/stockly/api/node_modules/@vitest/runner/dist/chunk-hooks.js:1729:8)
    at runSuite (home/sngvahmed/workspace/stockly/api/node_modules/@vitest/runner/dist/chunk-hooks.js:1729:8)

            </system-err>
        </testcase>
        <testcase classname="test/notifications/fcm-sender.spec.ts" name="FCM Sender &gt; sendFCMNotificationWithLogs &gt; should handle access token exchange failure" time="0.078">
            <system-err>
Failed to get Google access token: Error: Token exchange failed
    at /home/sngvahmed/workspace/stockly/api/test/notifications/fcm-sender.spec.ts:133:9
    at home/sngvahmed/workspace/stockly/api/node_modules/@vitest/runner/dist/chunk-hooks.js:155:11
    at home/sngvahmed/workspace/stockly/api/node_modules/@vitest/runner/dist/chunk-hooks.js:752:26
    at home/sngvahmed/workspace/stockly/api/node_modules/@vitest/runner/dist/chunk-hooks.js:1897:20
    at new Promise (&lt;anonymous&gt;)
    at runWithTimeout (home/sngvahmed/workspace/stockly/api/node_modules/@vitest/runner/dist/chunk-hooks.js:1863:10)
    at runTest (home/sngvahmed/workspace/stockly/api/node_modules/@vitest/runner/dist/chunk-hooks.js:1574:12)
    at runSuite (home/sngvahmed/workspace/stockly/api/node_modules/@vitest/runner/dist/chunk-hooks.js:1729:8)
    at runSuite (home/sngvahmed/workspace/stockly/api/node_modules/@vitest/runner/dist/chunk-hooks.js:1729:8)
    at runSuite (home/sngvahmed/workspace/stockly/api/node_modules/@vitest/runner/dist/chunk-hooks.js:1729:8)

            </system-err>
        </testcase>
        <testcase classname="test/notifications/fcm-sender.spec.ts" name="FCM Sender &gt; sendFCMNotificationWithLogs &gt; should send notification successfully" time="0.061">
        </testcase>
        <testcase classname="test/notifications/fcm-sender.spec.ts" name="FCM Sender &gt; sendFCMNotificationWithLogs &gt; should retry on temporary errors" time="0.281">
            <system-err>
{&quot;timestamp&quot;:&quot;2025-12-14T20:04:25.507Z&quot;,&quot;service&quot;:&quot;stockly-api-test&quot;,&quot;level&quot;:&quot;ERROR&quot;,&quot;traceId&quot;:&quot;test-trace-id&quot;,&quot;userId&quot;:null,&quot;path&quot;:&quot;/test&quot;,&quot;message&quot;:&quot;FCM push notification failed&quot;,&quot;type&quot;:&quot;fcm_error&quot;,&quot;fcmErrorCode&quot;:&quot;14&quot;,&quot;fcmErrorType&quot;:&quot;UNAVAILABLE&quot;,&quot;isPermanent&quot;:false,&quot;shouldCleanupToken&quot;:false,&quot;requestPayload&quot;:{&quot;token&quot;:&quot;dXXXXXXXXXXXXXXXXXXXXXXXXXXXXX...&quot;,&quot;title&quot;:&quot;Test Title&quot;,&quot;body&quot;:&quot;Test Body&quot;,&quot;dataKeys&quot;:[&quot;alertId&quot;]},&quot;errorMessage&quot;:&quot;Service unavailable&quot;}

            </system-err>
        </testcase>
        <testcase classname="test/notifications/fcm-sender.spec.ts" name="FCM Sender &gt; sendFCMNotificationWithLogs &gt; should not retry on permanent errors" time="0.057">
            <system-err>
{&quot;timestamp&quot;:&quot;2025-12-14T20:04:25.767Z&quot;,&quot;service&quot;:&quot;stockly-api-test&quot;,&quot;level&quot;:&quot;ERROR&quot;,&quot;traceId&quot;:&quot;test-trace-id&quot;,&quot;userId&quot;:null,&quot;path&quot;:&quot;/test&quot;,&quot;message&quot;:&quot;FCM push notification failed&quot;,&quot;type&quot;:&quot;fcm_error&quot;,&quot;fcmErrorCode&quot;:&quot;5&quot;,&quot;fcmErrorType&quot;:&quot;NOT_FOUND&quot;,&quot;isPermanent&quot;:true,&quot;shouldCleanupToken&quot;:true,&quot;requestPayload&quot;:{&quot;token&quot;:&quot;dXXXXXXXXXXXXXXXXXXXXXXXXXXXXX...&quot;,&quot;title&quot;:&quot;Test Title&quot;,&quot;body&quot;:&quot;Test Body&quot;,&quot;dataKeys&quot;:[&quot;alertId&quot;]},&quot;errorMessage&quot;:&quot;Token not found&quot;}

            </system-err>
        </testcase>
        <testcase classname="test/notifications/fcm-sender.spec.ts" name="FCM Sender &gt; sendFCMNotificationWithLogs &gt; should log FCM errors" time="0.034">
            <system-err>
{&quot;timestamp&quot;:&quot;2025-12-14T20:04:25.803Z&quot;,&quot;service&quot;:&quot;stockly-api-test&quot;,&quot;level&quot;:&quot;ERROR&quot;,&quot;traceId&quot;:&quot;test-trace-id&quot;,&quot;userId&quot;:null,&quot;path&quot;:&quot;/test&quot;,&quot;message&quot;:&quot;FCM push notification failed&quot;,&quot;type&quot;:&quot;fcm_error&quot;,&quot;fcmErrorCode&quot;:&quot;3&quot;,&quot;fcmErrorType&quot;:&quot;INVALID_ARGUMENT&quot;,&quot;isPermanent&quot;:true,&quot;shouldCleanupToken&quot;:true,&quot;requestPayload&quot;:{&quot;token&quot;:&quot;dXXXXXXXXXXXXXXXXXXXXXXXXXXXXX...&quot;,&quot;title&quot;:&quot;Test Title&quot;,&quot;body&quot;:&quot;Test Body&quot;,&quot;dataKeys&quot;:[&quot;alertId&quot;]},&quot;errorMessage&quot;:&quot;Invalid token&quot;}

            </system-err>
        </testcase>
        <testcase classname="test/notifications/fcm-sender.spec.ts" name="FCM Sender &gt; sendFCMNotificationWithLogs &gt; should convert data values to strings" time="0.03">
        </testcase>
        <testcase classname="test/notifications/fcm-sender.spec.ts" name="FCM Sender &gt; sendFCMNotification &gt; should return true on success" time="0.025">
        </testcase>
        <testcase classname="test/notifications/fcm-sender.spec.ts" name="FCM Sender &gt; sendFCMNotification &gt; should return false on failure" time="0.024">
            <system-err>
{&quot;timestamp&quot;:&quot;2025-12-14T20:04:25.931Z&quot;,&quot;service&quot;:&quot;stockly-api-test&quot;,&quot;level&quot;:&quot;ERROR&quot;,&quot;traceId&quot;:&quot;test-trace-id&quot;,&quot;userId&quot;:null,&quot;path&quot;:&quot;/test&quot;,&quot;message&quot;:&quot;FCM push notification failed&quot;,&quot;type&quot;:&quot;fcm_error&quot;,&quot;fcmErrorCode&quot;:&quot;3&quot;,&quot;fcmErrorType&quot;:&quot;INVALID_ARGUMENT&quot;,&quot;isPermanent&quot;:true,&quot;shouldCleanupToken&quot;:true,&quot;requestPayload&quot;:{&quot;token&quot;:&quot;dXXXXXXXXXXXXXXXXXXXXXXXXXXXXX...&quot;,&quot;title&quot;:&quot;Title&quot;,&quot;body&quot;:&quot;Body&quot;,&quot;dataKeys&quot;:[]},&quot;errorMessage&quot;:&quot;Invalid token&quot;}

            </system-err>
        </testcase>
    </testsuite>
    <testsuite name="test/notifications/jwt-helper.spec.ts" timestamp="2025-12-14T20:04:38.263Z" hostname="sngvahmed" tests="10" failures="0" errors="0" skipped="0" time="0.547">
        <testcase classname="test/notifications/jwt-helper.spec.ts" name="JWT Helper &gt; generateGoogleJWT &gt; should generate JWT with correct structure" time="0.035">
        </testcase>
        <testcase classname="test/notifications/jwt-helper.spec.ts" name="JWT Helper &gt; generateGoogleJWT &gt; should include correct header" time="0.064">
        </testcase>
        <testcase classname="test/notifications/jwt-helper.spec.ts" name="JWT Helper &gt; generateGoogleJWT &gt; should include correct payload" time="0.03">
        </testcase>
        <testcase classname="test/notifications/jwt-helper.spec.ts" name="JWT Helper &gt; generateGoogleJWT &gt; should use custom scope" time="0.063">
        </testcase>
        <testcase classname="test/notifications/jwt-helper.spec.ts" name="JWT Helper &gt; generateGoogleJWT &gt; should handle PEM key parsing" time="0.024">
        </testcase>
        <testcase classname="test/notifications/jwt-helper.spec.ts" name="JWT Helper &gt; generateGoogleJWT &gt; should sign with RSASSA-PKCS1-v1_5" time="0.028">
        </testcase>
        <testcase classname="test/notifications/jwt-helper.spec.ts" name="JWT Helper &gt; getGoogleAccessTokenFromJWT &gt; should exchange JWT for access token" time="0.034">
        </testcase>
        <testcase classname="test/notifications/jwt-helper.spec.ts" name="JWT Helper &gt; getGoogleAccessTokenFromJWT &gt; should handle non-ok response" time="0.03">
        </testcase>
        <testcase classname="test/notifications/jwt-helper.spec.ts" name="JWT Helper &gt; getGoogleAccessTokenFromJWT &gt; should handle missing access_token in response" time="0.052">
        </testcase>
        <testcase classname="test/notifications/jwt-helper.spec.ts" name="JWT Helper &gt; getGoogleAccessTokenFromJWT &gt; should handle network errors" time="0.026">
        </testcase>
    </testsuite>
</testsuites>
